{"version":3,"sources":["scripts/app.js"],"names":["checkEnter","field","event","theCode","keyCode","which","charCode","id","registerUsername","doCall","sendData","$","attr","unbind","username","val","bootbox","alert","removeAttr","click","test","register","request","videocall","send","message","createOffer","media","data","simulcast","doSimulcast","success","jsep","Janus","debug","body","error","doHangup","hangup","yourusername","text","reason","getQueryStringValue","name","replace","regex","RegExp","results","exec","location","search","decodeURIComponent","addSimulcastButtons","temporal","parent","append","removeClass","addClass","toastr","info","timeOut","hasClass","substream","updateSimulcastButtons","angular","module","constant","FRAME","EW_VEL","NS_VEL","BIN_LENGTH","SOUNDING","LATITUDE","LONGITUDE","HEAD","MMSI","IMMERSION","ALTITUDE","HEADING","ROLL","PITCH","HEAVE","DATA","QUALITY","SBE45_SEA_TEMP","SBE45_COND","SBE45_SAL","SBE45_SOUND_VEL","OPTODE_OXYGEN","OPTODE_SATURATION","SEA_POINT_TURB","AOA_GREEN_ALGAE","AOA_BLUE_ALGAE","AOA_DIATOMS","AOA_CRYPTOPHYTA","AOA_YELLOW_SUB","AOA_TOTAL_ALGAE","DATE","TIME","OPTODE_SEA_TEMP","AOA_SEA_TEMP","FB_PH_SEA_TEMP","FB_AIR_TEMP","PRESSURE","FLOW_IN","FLOW_MAIN","FLOW_PCO2","FLOW_BYPASS_2","FLOW_AOA","HALFFULL","FULL","FB_PH_VALUE","STARBOARD_LENGTH","STARBOARD_SPEED","STARBOARD_TENSION","PORT_LENGTH","PORT_SPEED","PORT_TENSION","FRAME_POSITION","GROUND_SPEED","GROUND_COURSE","FRAME_SAT_INFO","SATELLITE_NUMBER","HDOP","HEAD_FRAME","HEAD_ID","MAG","DEPTH","HAUL_ID","SPECIES_ID","SPECIES_SIGN","SPECIES_WEIGHT","POCKET","TOTAL_POCKET_WEIGHT","TOTAL_SORTED_SPECIES_WEIGHT","BOX_ID","BOX_WEIGHT","BOX_DESTINATION","DEVICE_ID","FRAME_SHIPNAV","SOUNDER","SURFACE_SPEED","SURFACE_COURSE","DRIFT_SPEED","DRIFT_COURSE","FRAME_ROUTING","PREV_DIST","PREV_COURSE","CUR_DIST","CUR_COURSE","ETA","LAPSE","FRAME_WAYPOINTS","INDEX","ID","ACC_X","ACC_Y","GRAVITY","SCALE","FILTER_ORDER","FILTER_TAU","GPS_ON","STATUS","DATATION","SEASTATE","EOETVOES","BOUGUER","FREEAIR","MEASURETS","TEMPERATURE","TANK_TEMP","TEMP","SALINITY","ANOMALY","SOUND_SPEED","CONDUCTIVITY","FRAME_FLUOROMETRY","FLUOROMETRY","FRAME_FLOW","FLOW","PN","PF","BEAM_NUMBER","ACROSS","ALONG","FLAG","DOOR_DISTANCE","HORIZONTAL_SPREAD","VERTICAL_SPREAD","CLEARANCE","COMMENT","LAT","LONG","PORTUNWOUND","STARBOARDUNWOUND","ALTITUDE_SUM","HORIZONTAL_SPREAD_SUM","PORTUNWOUND_SUM","VERTICAL_SPREAD_SUM","STARBOARDUNWOUND_SUM","ALTITUDE_NB","HORIZONTAL_SPREAD_NB","PORTUNWOUND_NB","VERTICAL_SPREAD_NB","STARBOARDUNWOUND_NB","DISTANCE_STRAIGHT","DISTANCE_REAL","RATIO","FRONT_TRANS","REAR_TRANS","MAIN","RUDDER_ANGLE_FRAME","RUDDER_ANGLE","FRONT_TRANS_ANGLE","MAIN_LEFT","MAIN_RIGHT","TRUE_AIR_SPEED","TRUE_AIR_HEADING","REL_AIR_SPEED","REL_AIR_HEADING","DATA_TO_DISPLAY","title","format","TENSION","LENGTH","SPINNING","DA1_POWER","DA2_POWER","DA3_POWER","DA4_POWER","MAIN_STARBOARD","MAIN_PORT","TRANS1_PROP","TRANS2_PROP","TRANS3_PROP","TRANS4_PROP","RUDDER_STARBOARD","RUDDER_PORT","TEXT","LEVEL","ENDDATE","CODE","HP","BP","M1","M2","M3","M4","M5","COG","SOG","SPEED","VELOCITY","GUST","DIRECTION","AIRTEMP","HUMIDITY","RADIATION","WATERTEMP","FLUO","CONDUCT","SIGMAT","TURBIDITYL","TURBIDITYH","OBSL","OBSH","CHLOROPHYLL","BLUEALGAE","CDOM","PH","FLUORESCENCE","PCO2","PAR","getDefaultUrl","protocol","path","res","window","host","console","log","TAG","get","viewList","length","NAVIGATION","dataAccessLists","navigation","WEATHER","weather","THERMOSAL","thermosal","shipId","hasOwnProperty","brokerIP","mdAddonsURL","janusServerUrl","JSON","parse","enableVideoCall","geomodServerAddress","qgisUrl","qgisMissionName","defaultDashboard","defaultStaticGrid","video","showExtraction","showStaticGrid","showTracking","enableChat","mapBackground","databaseIP","DEVICES","element","document","ready","bootstrap","fail","config","$mdThemingProvider","definePalette","50","100","200","300","400","500","600","700","800","900","A100","A200","A400","A700","contrastDefaultColor","contrastDarkColors","contrastLightColors","undefined","theme","primaryPalette","accentPalette","dark","alwaysWatchTheme","$translateProvider","useStaticFilesLoader","prefix","suffix","preferredLanguage","fallbackLanguage","tmhDynamicLocaleProvider","localeLocationPattern","locales","en_US","img","fr_FR","preferredLocale","ADMIN","MASTER","SDIV","USER","VIDEOCALL","LOG","CONFIG","ARCHIVE_DATA","ARCHIVE_DEVICES","CHANNEL","CONFIGURATION","DRIVER","DRIVER_PREVIEW","DEVICE","DESCRIPTION","FRONT_END_PARAMETERS","LOGIN","LOGOUT","MISSION","USER_CONFIG","CASINO","QGIS","CHAT","controller","themeService","vm","this","getTheme","ERROR","isErrorModule","routerConfig","$stateProvider","$urlRouterProvider","state","url","templateUrl","controllerAs","params","next","authority","nextParams","otherwise","$inject","run","$log","enhanceLogging","loggingFunc","context","modifiedArguments","slice","call","arguments","unshift","apply","getInstance","warn","AcquisitionController","acquisitionService","AUTHORITIES","dialogService","$interval","restService","$scope","statusService","stompService","TOPICS","userService","Item","device","files","framesNumber","frameNumber","lastTimeStamp","isSelected","isReceivingJSON","status","UNDEFINED","checkAuthority","deviceListListener","deviceJSONListener","logListener","statusListener","deviceListener","intervalPromise","selectedItem","textArea","logs","alertLogs","itemList","serverTime","availableSpace","consoleViews","LOGS","ALERTS","FRAMES","consoleView","orderDevice","OK","color","show","NO_DATA","TIME_OUT","OUT_OF_RANGE","displayMode","refreshItemList","deviceList","itemToDelete","forEach","item","itemDeviceExists","isEnabled","push","unsubscribeToJSONData","JSONDataListener","splice","indexOf","itemAlreadyExists","formatCapacity","rawCapacity","toFixed","parseStatusMessage","usableSpace","totalSpace","devFileStats","deviceFileStat","deviceFileStatId","file","filesizeFormated","filesize","parseLogMessage","level","addConsoleMsg","setItemStatus","toUpperCase","parseDevicesMessage","devices","deviceId","sequenceNumber","msg","substring","scrollTop","scrollHeight","init","getServerTime","registerForTopic","promise","then","getDeviceList","registerForDeviceList","getElementById","$on","unregisterForTopic","unregisterForDeviceList","cancel","selectItem","newSelectedItem","subscribeToJSONData","removeItem","showValidation","deleteDevice","changeConsole","value","logsToDisplay","DashboardController","$filter","$rootScope","dashboardService","currentDashboard","getCurrentDashboard","showDashboardSelection","dashboardListPerso","getDashboardListPerso","selectedDashboard","gridsterOpts","columns","draggable","enabled","handle","isMobile","rowHeight","deleteEnabled","isDefined","getCurrentUser","showSaveDialog","saveDashboard","currentUser","showDialog","showToast","showSaveDashboard","showDeleteDialog","removeDashboard","factory","DEFAULT_DASHBOARD","sizeX","sizeY","type","getAvailableId","row","getFirstFreeRow","col","availableIdFound","firstFreeRow","updateDashboardList","oldDashboardList","newDashboardList","key","Default","setCurrentDashboard","setPersoDashboardList","switchToNewDashboard","showAddItem","self","showSelectView","response","view","findVideoCall","found","find","addVideoCallIfNeeded","index","dataAccessController","$http","$window","archiveService","Blob","FileSaver","logger","currentMode","sendRequest","researchInProgress","csvInProgress","netcdfInProgress","getData","variableList","dateRange","start","end","maxValues","timeStampingStrategy","intervalOrRef","intervalStampFraction","saveAs","getDateRange","getParams","getVariableList","dataRequested","loginController","$state","$stateParams","goToNextPage","go","connectionInProgress","hasAuthority","deregistrationFunction","connection","login","password","statusText","onKeyPressed","keyEvent","StaticGridController","staticGridService","flex","cards","getCards","currentNavItemId","getSelectedCardId","service","showRow","isSingleMode","showCard","getViewMode","MODES","SINGLE","MULTIPLE_4","MULTIPLE_6","selectCard","rowIndex","setSelectedCardId","$watch","mode","selectedCard","saveStaticGrid","DEFAULT_STATIC_GRID","selectedCardId","changeViewMode","setViewMode","newMode","setCards","newCards","TrackingController","cardId","frameId","weatherId","ship","beam","xOffset","yOffset","lengthVector","WelcomeController","SHIP_ID","SHOW_EXTRACTION","cardController","$timeout","setType","newView","titleValue","icon","showChangeViewDialog","component","bindings","consoleController","$onInit","container","addConsole","addText","dataViewController","formatterService","dataId","registerForDevice","updateTitle","dataListener","registerForData","result","lastTimestamp","timestamp","updateValue","unregister","unregisterForData","subtitle","dataMissing","missingValueReceived","newValue","desc","getDataDescription","units","shortUnits","cFormat","getFormattedValue","multiplier","abs","onOff","missingValue","redGreen","frontColor","Math","round","alertValue","optTitle","longName","optSubtitle","isUndefined","frameList","Array","isArray","parseExcelDateDefaultToString","parseExcelDateNoSecToString","getLocalTimeZoneOffset","parseLatToString","parseLongToString","parseQualityFbxToString","parseMarineDistance","sprintf","parseTimeToString","watchdog","currentDate","time","periodList","optValue","watchdogInterval","$onChanges","changesObj","currentValue","$onDestroy","onUpdateTitle","titleDisabled","showSubtitle","doubleDataViewController","dataId1","frameId1","deviceId1","dataId2","frameId2","deviceId2","format1","format2","optValue1","optValue2","navbarController","$location","$translate","$mdSidenav","localeService","messagingService","$mdPanel","ENABLE_CHAT","ENABLE_VIDEOCALL","videoCallService","currentLocaleImg","getCurrentLocale","getLastMessage","_mdPanel","getLocaleList","currentUserProvider","getCurrentUserProvider","connected","isConnected","openSidenav","toggle","changeDayMode","THEME","DAY","setTheme","NIGHT","saveTheme","changeLocale","locale","setCurrentLocale","saveLanguage","isWelcomePage","goToHelpPage","open","use","openMessagingWindow","user","showMessaging","showMessagingAccess","isSDIVUserAndStaticView","showTimes","ev","position","newPanelPosition","relativeTo","addPanelPosition","xPosition","ALIGN_START","yPosition","BELOW","times","tz","attachTo","TimePopupPanelCtrl","template","panelClass","locals","changeTimezone","openFrom","clickOutsideToClose","escapeToClose","focusOnOpen","zIndex","mdPanelRef","_mdPanelRef","iana","date","Date","setTime","invdate","toLocaleString","timeZone","diff","getTime","prototype","closeDialog","panelRef","close","querySelector","focus","destroy","settingsButtonController","onChangeView","deleteClick","validCloseTitle","validCloseMsg","isStaticPage","sidenavController","SHOW_STATICGRID","SHOW_TRACKING","refreshButtonList","routeList","route","staticgrid_index","dashboard_index","tracking_index","acquisition_index","dataaccess_index","routeIndex","sref","disconnection","logout","closeSidenav","QGISService","$q","getCapabilities","getQGISCapabilities","pushQGISProject","updateQGISProject","AcquisitionService","Device","getOrCreateDevice","notifyDeviceListChanges","configurationCallback","lastConfMsgTimestamp","deviceConfigList","deviceConfig","frames","frame","getDescription","period","d","isInConfigMsg","setEnable","listenerCount","deviceListListeners","listener","notify","getEnabledDeviceList","enabledDeviceList","deferred","defer","Object","is","resolve","unregisterForDevice","listeners","Frame","parseFloat","Buffer","scaleInSec","maxSamples","scale","bufferPeriod","lastFrame","Data","buffers","bufferOneMinute","defaultMaxSamples","bufferFiveMinutes","bufferThirtyMinutes","bufferOneHour","bufferThreeHours","bufferSixHours","bufferTwelveHours","bufferOneDay","buffer","addFrame","dataList","isInRealTime","currentFrame","lastFrameStored","loadArchivedFrames","startDate","endDate","loadArchivedFramesExecuted","reject","resultPromise","getDataSimple","oldBufferDescription","getStringDetails","tmpFrames","toUTCString","startFrameTimestamp","startFrameHours","getUTCHours","getUTCMinutes","getUTCSeconds","endFrameTimestamp","endFrameHours","recordData","stopRecordData","force","getDataList","logRequestSending","requestBody","starttime","endtime","toJson","timestampingstrategy","numvalues","Variable","aggregate","columnName","min","max","defaultValue","varid","DEFAULT","AGGREGATE","colname","buildRequestBody","strategy","referenceOrResampleInterval","tablename","MAX_NUM_VALUES","STRATEGY","resampling","resampleinterval","RESAMPLE_INTERVAL","intervalstampfraction","INTERVAL_STAMP_FRATION","reference","REFERENCE","maxNumValues","getArchiveData","interval","DeviceFactory","acquisitionBufferService","jsonDataTopic","statusDeferred","dataListenerList","frameListenerList","jsonDataMsgListener","hackWindSpeed","startsWith","newStatus","startJSONMessageListening","jSONMessage","acquisitionTime","frameWithDataAsKey","samples","stopJSONMessageListening","registerForStatus","registerForFrame","unregisterForFrame","$resource","$httpParamSerializerJQLike","REST_API","ARCHIVES_REST_API","$cookies","QGIS_URL","QGIS_MISSION_NAME","pushRequest","requestId","requestStack","currentRequest","executeNextRequest","shift","cancelRequest","Channel","update","method","Configuration","Driver","Description","Chat","ChatLast","getRequestStack","getCurrentRequest","getArchiveDataRequest","post","headers","Accept","Content-Type","resultData","varID","duration","description","getArchiveAllData","getArchiveDevices","getChannels","query","$promise","putChannel","channelId","getConfiguration","getDrivers","postDriversPreview","DRIVERSPREVIEW","getDescriptions","descriptionName","getDevices","getDevice","putDevice","save","getFrontEndParameters","getMission","accept","setMission","mission","put","psw","saveUserConfig","casinoConnexion","pwd","getCasinoCruises","database","localStorage","getItem","getCasinoCurrentCruise","getCasinoDevices","getCasinoActions","getCasinoEvents","cruise","action","options","ActionCode","getCasinoCruiseEvents","limit","isDate","getCasinoCruiseDevices","getCasinoDeviceActions","getCasinoLastOperationId","postCasinoCruiseEvent","Content-type","SERVICE","VERSION","REQUEST","zip","getLastMessages","sendMessage","lastTimeReceive","localTimeZoneOffset","flag","timeOffset","STOMP_URL","Topic","subscription","stompClient","connectionCallback","connectionErrorCallbackList","topicList","topicListListener","errorListener","connect","passcode","Stomp","client","heartbeat","outgoing","incoming","connectionSuccessCallback","connectionFailureCallback","subscribe","topic","callback","addTopic","topicId","notifyTopicListChanges","errorMessage","toTimeString","setTimeout","$$state","stop","disconnect","registerForError","registerForTopicList","getTopicList","unsubscribe","CasinoService","setItem","getCruises","getCurrentCruise","setSelectCruises","selectedCruises","stringify","getSelectCruises","withActions","selectedActions","actions","map","filter","isSameDevice","DeviceId","isSelectedAction","setSelectDevices","selectedDevices","getSelectDevices","getEvents","getCruiseEvents","getCruiseDevices","getDeviceActions","getLastOperationId","postCruiseEvent","CasinoEventFactory","CasinoEvent","cruiseEventId","eventDate","latitude","longitude","observation","initPhase","initOperation","initHalieutic","phaseFullName","phaseType","initAction","actionFullName","actionCode","initDevice","deviceFullName","deviceCode","operationId","field1","field2","cleanByType","CasinoOperationIdFactory","CasinoOperationId","custom","number","updatePrefix","operationPrefix","updateNumber","lastOperationId","lastNumber","split","Number","getStringOperationId","$mdDialog","$mdToast","textContent","ariaLabel","ok","simple","hideDelay","showToastChat","showSelectData","showSelectDateRange","msgOk","msgCancel","UserFactory","User","roles","saveConfig","language","dashboardList","oldDashboard","copy","oldStaticGridConfig","staticGrid","UserService","setCurrentUser","dash","keys","$emit","getUserFromServer","fromJson","token","current","easelJsUtilsService","createBackRudder","backRudderShape","Shape","rudderRadius","sqrt","graphics","beginStroke","setStrokeStyle","moveTo","lineTo","arc","PI","endStroke","createRudder","rudderShape","m","w","hw","createBackGauge","backgroundColor","backGaugeShape","beginFill","drawRect","endFill","createGaugge","tickColor","zeroColor","plusColor","minusColor","gaugeShape","createVessel","vesselShape","vesselHeight","vesselWidth","cp1","cp2","hh","ch","ccp1","ccp2","bezierCurveTo","createArrow","arrowShape","arrowShift","createjs","Container","parseExcelDateToString","excelDate","lat","direction","degrees","minutes","long","dist","quality","parseInt","graphUtilsService","getChartOptions","stepSize","fill","animation","maintainAspectRatio","legend","display","tooltips","elements","line","borderWidth","tension","point","radius","scales","xAxes","gridLines","zeroLineColor","gridLinesColor","afterBuildTicks","ticks","tick","maxRotation","fixedStepSize","values","getUTCDate","getUTCMonth","getUTCFullYear","label","1 min","bufferId","5 min","30 min","1h","3h","6h","12h","24h","LocaleService","LOCALES","tmhDynamicLocale","documentElement","setAttribute","set","toLowerCase","proposedLanguage","currentTheme","newTheme","scope","callOnSubscribe","handler","items","reverse","filtered","sort","a","b","distance","timeInMinutes","hours","JANUS_SERVER_URL","checkUser","videoCallState","startJanus","stopJanus","isWebrtcSupported","janus","server","attach","plugin","opaqueId","pluginHandle","getPlugin","getId","consentDialog","on","mediaState","medium","webrtcState","onmessage","list","userList","mp","myusername","ringtone","play","pause","findOrOpenVideoCall","createAnswer","peer","handleRemoteJsep","onlocalstream","stream","attachMediaStream","localvideo","webrtcStuff","pc","iceConnectionState","videoTracks","getVideoTracks","onremotestream","remotevideo","ondataopen","ondata","oncleanup","destroyed","pollUsers","clearInterval","randomString","setVideo","lvideo","rvideo","getVideoCallState","videoCall","enableVideo","enableAudio","audio","VIDEO_PARAMS","successCallback","videoElm","streaming","mystreaming","stopStream","startStream","audioSend","videoSend","selectedStream","hostname","bitrateTimer","spinner","audioenabled","videoenabled","doSimulcast2","simulcastStarted","one","remove","html","blockUI","css","border","padding","top","left","navigator","mozGetUserMedia","unblockUI","unblock","hideAll","dialog","closeButton","buttons","className","danger","hide","muted","block","target","Spinner","spin","addButtons","bind","videoWidth","width","height","videoHeight","bitrate","webRTCAdapter","browserDetails","browser","setInterval","getBitrate","empty","reload","viewProvider","VIEW_LIST","getVideoView","vlcUrl","janusStreamIndex","mosaicUrl","mosaicIndex","videoItem","imageBackground","background-image","baseUrl","background-size","mosaicSize","imageCSSClass","rowspan","videoItemList","refreshVideoMosaic","refreshEnabled","mosaicArg","mosaic","mosaicRefreshInterval","mosaicList","viewProperties","Devices","category","Graphics","Numerical","Empty","Ephemeride","Generic","Message","Casino","Casino - Add event","EFPos","EFMet","EFTss","EFAum","Video Call","Menu","Attitude","GPS","Landing At","Navigation","Map","Mobile","Station","Route","ADCP","Anemometer","Flow","Depth","Ferrybox science","Ferrybox fluo","Gravimeter","Kss31","Magnetometer","Weather","Hull sound speed","Haul composition","Species","Multibeam","Thermometer","Thermosal","Ferrybox technic","Trawl","Trawling","Funes winch","Winch","Winch Info","Propulsion Tl","Propulsion At","Propulsion Pp","Winch Alarm Pp","Kley state","Debug","getBackupCss","stopRefreshMosaic","getViewList","dialog.view-selection.tabs.miscellaneous","dialog.view-selection.tabs.navigation","dialog.view-selection.tabs.scientific","dialog.view-selection.tabs.technic","dialog.view-selection.tabs.video","dialog.view-selection.tabs.debug","definedView","viewInfo","role","viewItem","devicePattern","navId","frameName","pattern","re","newViewItem","includes","getMosaicList","adcpController","createChart","chart1","chart2","canvas1","canvasId1","Chart","Scatter","chartData1","chartOptions","canvas2","canvasId2","chartData2","initDataListener","frameListener","datasets","borderColor","chartColor","lastFrameTimestamp","dateContent","dateColor","sounding","i","dataDescription","x","y","initDataWatcher","devicePeriod","initThemeWatcher","yAxes","timeoutPromise","xAxisID","yAxisID","scaleLabel","fontColor","labelString","beginAtZero","suggestedMax","suggestedMin","onChangeCardType","atPropulsionController","easelJsUtils","initCanvas","canvas","canvasId","stage","Stage","backContainer","frontContainer","addChild","offsetHeight","updateCanvasSize","offsetWidth","canvasWidth","canvasHeight","font-size","max-width","background-color","scaleX","scaleY","updateBackContainer","cache","updateFrontContainer","updateLabels","removeAllChildren","colors","background","rearPropBackGaugeShape","frontPropBackGaugeShape","mainBackGaugeShape","rotation","rudderColor","rudder","angle","red","green","rearPropGaugeShape","zero","frontPropAngle","frontPropGaugeShape","frontTrans","mainLeftGaugeShape","mainLeft","forward","backward","delta","readyToDraw","funkyBackground","themeChanged","mainRight","fontsize","attitudeController","ATTITUDE","parseAttitudeFrame","roll","pitch","trim","heading","heave","receivedFrame","casinoController","casinoService","casinoLoading","casinoErrorConnect","casinoErrorLoad","selectedCruise","eventsListToDisplay","casinoCanConnect","connectionParams","casinoConnection","refreshCruise","sendEvent","currentCruise","updateEventsTable","isDateParam","limitParam","FullName","casinoAddEventController","isFollow","validExitTitle","validExitMsg","casinoEvent","listCasinoDevices","listDeviceActions","eventTypeEnum","PHA","OPE","OBS","phaseTypeEnum","PROFIL","STATION","TRANSIT","GIRATION","ESCALE","initErrors","onResetClick","onResetForm","updateValidExit","updatePrefixOperation","onSubmit","toISOString","followIdx","checkFollow","updateAction","idx","getActionIdx","code","updateCruise","updateListCasinoDevices","OperationPrefix","updateNumberOperation","OperationId","updateDevice","updateListDeviceActions","debugController","stompConsole","topiConsole","currentTopicListener","currentTopic","bufferDeviceList","configId","disconnectTopic","startStompService","stopStompService","connectToTopic","topicConsole","clearTopicConsole","depthController","graphUtils","selectedScale","reloadChart","chart","chartData","updateGraph","recordedData","bufferLoading","initTimer","requestCallback","onChangeXScale","devicesController","lastJSONMessageTime","p","driverPreviewController","Field","driverList","getConverters","driver","configuration","header","driverClassName","fields","parameters","separator","fieldList","addField","postConvertersPreview","removeField","genericController","PEFAUM","efmapController","GEOMOD_SERVER_ADDRESS","MAP_BACKGROUND","mapService","getLastMobileTimestamp","loadUserConfig","routeEnabled","aisEnabled","traceEnabled","autoCenterEnabled","gridEnabled","multibeamEnabled","bottomBarEnabled","stationViewScale","trackingEnabled","mapComponent","luminosity","geolayer","carto","Luminosity","setLuminosity","shipnavDeviceId","frameNavId","mapId","shipLength","BackgroundProviderType","OwnShipSymbolType","ZOOM","shipBeam","shipXOffset","shipYOffset","gndcourse","gndspeed","surfspeed","mousePositionControl","stringMouseLatitude","stringMouseLongitude","positionStation","measureToolList","currentMeasureTool","onMeasureToolChange","selection","getMeasureTool","setActive","getOwnShipMeasureTool","clearMeasures","resetTool","focusOnBoat","setAutoCenterMode","showTrace","setShowTraceMode","showGrid","showGraticule","showBottomBar","PEFMET","PEFPOS","PEFTSS","ephemerideController","ephemerideService","offset","days","months","parseShipnav","updateDays","ldate","timeLabel","setDate","getDate","day","getDay","nbDate","month","getMonth","year","getFullYear","getTimezoneOffset","saint","getSaint","SunCalc","getTimes","moon","getMoonIllumination","moonImage","phase","shipnavFrameListener","nextDay","prevDay","EphemerideService","nbJours","ephemeride","ferryboxFluoController","FERRYBOX_SCIENCE","showInChart","cssClass","ferryboxScienceController","ferryboxTechnicController","FERRYBOX_TECHNIC","funesWinchController","FUNES_WINCH","recordedData1","starboardTension","recordedData2","portTension","starboardLength","starboardSpeed","portLength","portSpeed","gpsController","framePosition","groundSpeed","groundCourse","frameSatInfo","satNumber","hdop","graphicsController","ChartDataset","dataColor1","dataColor1bis","frameDataId1","frameDataId2","doubleYAxes","dataColor2","dataColor2bis","pointRadius","doubleAxesEnabled","data1","frameList1","data2","frameList2","dataLegend1","dataLegend2","zeroOption","selectedYScaleMode","YScaleModes","MANUAL","yAxes1Min","yAxes1Max","drawOnChartArea","yAxes2Min","yAxes2Max","loadArchivedData","loadArchivedDataEnd","dataLoaders","device1","device2","title1","chartTitle1","title2","chartTitle2","updateDataList1","onChangeData1","updateDataList2","onChangeData2","getYMaxValue","dataset","yValues","getYMinValue","AUTO","showSettings","updateChartOptions","onClearData1","onClearData2","updateYAxesMode","onZoomY","out","onCenterYAxes","middle","minVal","maxVal","gravimeterController","GRAVIMETER","haulCompositionController","HAUL","parseBlcarFrame","haul","pocketId","totalSorted","totalPocket","newSpecies","sign","weight","estimation","sortedPercentage","previousHaul","previousPocket","speciesList","speciesAlreadyExist","species","updateSpeciesTable","arrayHeight","pageCapacity","floor","pageArray","ceil","speciesListToDisplay","selectedPage","playEnabled","pocket","totalSortedSpecies","selectPage","page","hullSoundSpeedController","HULLSOUNDSPEED","kleyStateController","KLEY_STATE","datasRight","unit","datasLeft","KSS31","landingControllerAt","initPropulsionCanvas","propulsionCanvas","propulsionCanvasId","propulsionStage","propulsionBackContainer","propulsionFrontContainer","updatePropulsionCanvasSize","propulsionCanvasWidth","propulsionCanvasHeight","updatePropulsionBackContainer","updatePropulsionFrontContainer","updatePropulsionLabels","backLeftRudderShape","backRightRudderShape","mainLeftBackGaugeShape","mainRightBackGaugeShape","leftRudderShape","rightRudderShape","mainRightGaugeShape","arrowColor","frontTransArrowShape","canvasX","offsetLeft","canvasY","offsetTop","initWindCanvas","windCanvas","windCanvasId","windStage","drawBoat","updateWindCanvasSize","windCanvasSize","windCanvasWidth","windCanvasHeight","drawCompass","trueWindShape","drawWindFlag","speed","trueWindColor","relWindShape","relWindColor","boatShape","boatHeadingShape","setStrokeDash","boatLength","boatWidth","shape","flagLength","drawCircle","drawBarb","windSpeed","currentPosition","pennant","halfFlag","compassShape","strokeLength","cos","sin","drawText","textShape","Text","textBaseline","relHeading","navFrameId","weatherFrame","weatherDeviceId","trueWindHeadingId","trueWindSpeedId","relWindHeadingId","relWindSpeedId","gndCourse","gndSpeed","surfCourse","surfSpeed","surfNorth","surfWest","surfEast","surfSouth","gndNorth","gndWest","gndEast","gndSouth","navFrameListener","surfA","surfB","gndA","gndB","weatherFrameListener","trueSpeed","trueHeading","relSpeed","removeChild","magnetometerController","MAGNETOMETER","mapController","qgisService","MapServiceProvider","MAP","clearMobileArray","renderMap","setOwnShipData","setOwnShipTrace","getTraceArray","multibeamId","setSMFData","getMultibeamArray","mobileDeviceId","setMobiles","getMobileArray","aisDeviceId","setAIS","getAISArray","setWindForceAndDirection","wind","windHeading","isModeNavigation","setOwnShipRoute","getRoute","setStationViewCenterAndScale","render","initMap","serverAddress","CartoComponent","showStationView","MODE","setOwnShipGeometry","setMarineBackground","setOwnShipSymbolType","shipSymbol","showSMF","setShowRouteMode","setShowAISMode","getMap","e","coordinate","lonlat","proj","transform","DUSK","mapElement","setMapComponent","waypointsDeviceId","frameAisId","lestDeviceId","frameMobileId","trawlingId","addQGISLayers","addBoundariesLayers","addTrawlingLayer","getArchiveTrawling","getPosition","getWind","getPositionStation","stationIsUnvailable","showLayerMenu","stationViewScaleList","addCommonLayers","highlightClass","addBoundariesLayer","setLengthVector","destroyDataListener","onStationViewScaleChange","showMultibeam","clearMultibeamArray","showRoute","showAIS","toggleLayerMenu","getCustomPointMode","getCustomRouteMode","onToggleCustomPointMode","toggleCustomPointLayerMode","toggleCustomRouteLayerMode","onToggleCustomRouteMode","WAYPOINTS","MULTIBEAM","MOBILE","AIS","TRAWLING","parseShipnavFrame","stringLatitude","stringLongitude","traceIndex","coordinateHistoric","traceArray","addMultibeamData","sXOffset","sYOffset","pXOffset","pYOffset","multibeamArray","parseMultibeam","alongDistance","acrossDistance","sAccross","sAlong","pAccross","pAlong","parseTrawling","Latitude","Longitude","Field1","Field2","addTrawlingFeature","addPointToTraceRT","traceIndexTrawling","clearTraceRT","parseWaypoints","wptsLat","wptsLon","parseMobileFrame","lastMobileTimestamp","mobileLat","mobileLon","mobileHeading","mobileArray","MobileType","MobileStatus","ALIVE","parseLestFrame","LEST","parseAisFrame","mobile_MMSI","now","AISArray","millisec_diff","aisFrameListener","mobileFrameListener","lestFrameListener","multibeamFrameListener","waypointsFrameListener","trawlingFrameListener","trueWindSpeedListener","trueWindHeadingListener","componentNumber","stationInit","getMapComponent","clearAISArray","startdatestring","getHours","getMinutes","getSeconds","enddatestring","trace","trawling","addTrawlingTrace","weatherDevice","customRouteFileInput","removeEventListener","onUploadRoutes","mapSidemenuController","openCustomPointEditDialog","coordinates","detail","feature","getGeometry","getCoordinates","currentCustomPoint","getProperties","edited","positions","getPixelFromCoordinate","currentPointEdit","checkUserConnection","reader","onCustomPointHover","pointsHover","getElementsByClassName","parentNode","features","showLabel","feat","properties","geometry","contentPointHover","createElement","classList","add","style","innerHTML","appendChild","widthContent","selectedLayer","backdrop","contextualOptionMenu","opacity","layer","OPENSEAMAP","openCustomPointCreatedDialog","customPointForm","$setPristine","$setUntouched","new","contentElement","openCustomRouteDialog","currentRouteEdit","saveUploadPoint","saveUploadRoute","newVal","onCustomPointCreated","onCustomPointContextMenu","addEventListener","contains","$postLink","enableUploadRoutes","customPointFileInput","enableUploadPointSave","qgisUploadProjectFileInput","enableUploadQGISFile","getTreeLayer","treeLayers","branches","isBranchIsIndeterminate","branch","hadChild","checkedChild","getChildren","child","getVisible","openMenu","$mdMenu","getOpacity","setLayerOpacity","setOpacity","toggleMapBackground","getBackgroundLayer","getBackgroundLayerGroup","openUploadRouteDialog","targetEvent","closeRouteDialog","customRouteEdit","currentCustomRoute","customRouteFile","cancelImportRoutes","importCustomRoute","onRemoveAllCustomRoutes","removeAllCustomRoutes","onExportRoutes","exportString","exportCustomRoutes","href","btoa","saveCustomRoute","updateSelectedRouteCoordinate","deleteCustomRoute","removeCustomRoute","openUploadPointDialog","closePointDialog","removeCustomPoint","onUploadPoints","customPointFile","importCustomPoint","onRemoveAllCustomPoints","removeAllCustomPoints","toggleCustomPointLabel","setCustomPointShowLabel","getCustomPointShowLabel","getCustomPointLabelState","onExportPoints","exportCustomPoint","cancelImportPoint","saveCustomPoint","setCoordinates","setProperties","deleteCustomPoint","onOpenCasinoDialog","casinoState","cruises","casinoConnectionParams","onChangeCruise","selected","c","casinoSelectCruises","onChangeDevices","sd","DeviceName","DeviceCode","ActionName","indeterminate","onChangeAction","selectedAction","casinoSelectDevices","casinoLoadData","promises","fullfilledEventsPromise","events","all","cruiseData","concat","addCasinoLayers","openUploadQGISDialog","closeUploadQGISDialog","saveUploadQGIS","qgisFileUpload","onQGISFileUpload","FileReader","readAsDataURL","onload","menuController","menu","getMenu","transformResponse","messageController","lastMessage","mobileController","navigationController","wptsId","wptsIndex","lenght","currentWptName","isMD","sounder","surfaceSpeed","surfaceCourse","driftSpeed","driftCourse","frameRoutingId","curDist","curCourse","prevDist","prevCourse","eta","dataViewSize","dataFormat","angleFormat","positionFormat","multibeamController","portColor","starboardColor","minAcross","maxAcross","verticalDepth","acrossValues","nbValue","acrossValue","swathValue","maxAbs","showLines","afterTickToLabelConversion","numericalController","frameDataId","newFrameDataId","up","currentIndex","nextIndex","tmp","down","loadConfig","editionMode","addItem","propulsionControllerAt","PP_ENGINE","PP_VDR","backStarboardRudderShape","backPortRudderShape","mainStarboardBackGaugeShape","mainPortBackGaugeShape","updateRudder","port","updateArrow","updateMain","mainShape","PROP_VDR","starboardRudder","portRudder","trans1","trans2","trans3","trans4","PROP_ENGINE","portMain","starboardMain","DA","datas","updateData","testTimeOut","timeout","propulsionControllerTl","rearTrans","mainGaugeShape","main","gene1","gene2","gene3","gene4","routeController","$anchorScroll","MD_ADDONS_URL","curdist","currentWpt","previroute","updateReady","calculateRoute","parseRouting","updateRoute","routingFrameListener","toIndex","to","wpt","etanext","excelToDate","newPrevi","visible","curEta","curWpt","nextWpt","stationtype","stationtime","distVincenty","VincentyConstants","f","rad","lat1","lon1","lat2","lon2","p1","lon","p2","ct","L","U1","atan","tan","U2","sinU1","cosU1","sinU2","cosU2","lambda","lambdaP","iterLimit","sinLambda","cosLambda","sinSigma","cosSigma","sigma","atan2","alpha","asin","cosSqAlpha","cos2SigmaM","C","NaN","uSq","A","B","deltaSigma","s","speciesController","speciesId","box","boxWeight","boxDest","totalSpecies","thermoConfigController","FileUploader","thermo","instrument","intakeTemperatureSensor","conductivitySensor","temperatureSensor","csrf","csrftoken","uploader","X-XSRF-TOKEN","onSuccessItem","sensorArray","sensor","onAfterAddingFile","queue","thermometerController","THERMOMETER","thermosalController","flowDeviceId","TS","trawlController","TRAWL","drawTrawl","trawlShape","rectWidth","rectHeight","A1","B1","C1","D1","E1","A2","B2","C2","D2","E2","F1","quadCurveVertOffset","quadCurveHorzOffset","panelWidth","panelHeight","doorDistArrowOffset","quadraticCurveTo","drawArrow","doorDistance","horSpread","verSpread","clearance","altitude","immersion","drawSurfaceAndGround","startPoint","endPoint","headLength","surfShape","startPointSurface","endPointSurface","startPointGround","endPointGround","arcTo","temp","TrawlingServiceProvider","trawlingService","parseTrawlingFrame","starboardunwound","portunwound","waterropealt","comment","isAcquiring","lastMessageTimestamp","trawlingDeviceId","frameTrawlingId","trawlingController","isAdminLogged","horspread","horspread_mean","horspread_mean_nb","verspread","verspread_mean","verspread_mean_nb","altitude_mean","altitude_mean_nb","starboardunwound_mean","starboardunwound_mean_nb","portunwound_mean","portunwound_mean_nb","commentListener","distance_straight","distance_real","ratio","startAcquire","stopAcquire","videoController","videoStreamingService","videoId","parentDiv","videoCallController","parentId","disableVideo","diableAudio","toggleVideo","toggleAudio","disableAudio","weatherController","canvasSize","boatHeadingValue","ANEMOMETER","boatHeadingListener","weatherDataList","head","winchController","WINCH","winchFrameListener","spinningText","parseWinchFrame","spinning","deviceSoundingId","frameSounding","winchAlarmPpController","PP_WINCH_ALARM","alarmSwipe","last","alarms","newAlarm","enddate","findIndex","alarmInterval","winchInfoController","addChannelController","channel","newChannelId","newChannelURL","channelList","EditDeviceController","channels","drivers","triggerMode","triggerFrameName","triggerInterval","triggerValue","channelIds","exist","removeChannel","removeDriver","addChannel","addDriver","driverName","major","minor","editDriver","AddDriverController","fieldIndex","option","loadParams","headerLine","changeDriverSelected","match","dataSelectionController","DataList","dataIsIncluded","selectedDataList","frameIsSelected","oneDataIsSelected","allDataSelected","selectData","selectFrame","answer","dateRangeSelectionController","startTime","endTime","setHours","messagingController","messageList","currentMessage","$resolved","tabFunction","preventDefault","selectionStart","selectionEnd","messagingFactory","content","messageTime","connectionTime","getUser","messagingAccessController","passwordInput","inputMatch","redirect","SaveDashboardController","ValidationController","ViewSelectionController","selectView","codeNameFieldsController","listItems","itemCode","updateItem","onItemChange","$item","itemType","itemReadonly","itemFollow","paramSelectorController","simpleSampingInterval","resampleInterval","periodSelectorController","CUSTOM_RANGE","selectionList","LAST_HOUR","LAST_6_HOURS","LAST_24_HOURS","currentSelection","setCustomRange","resultCardController","DataSet","hidden","chartColors","chartColorIndex","updateChart","framesTable","variableSelectorController","DATA_ACCESS","addDataToSimpleList","dataAlreadyPresent","simpleDataList","dataInTheList","navigationDataList","thermosalDataList","aggregateList","advancedDataList","addData","default","clearAll","addNavData","addWeatherData","addTSData","$templateCache"],"mappings":"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,gCACA,wBACA,gCACA,8BAIR,WACE,YACAD,SAAQC,OAAO,gBACX,2BAIN,WACI,YACAD,SAAQC,OAAO,gBACX,oBACA,wBACA,sBACA,8BACA,8BACA,qBACA,qBACA,uBACA,6BACA,0BACA,4BACA,+BACA,+BACA,oBACA,0BACA,uBACA,mBACA,wBACA,0BACA,+BACA,8BACA,qBACA,0BACA,mBACA,2BACA,4BACA,uBACA,sBACA,yBACA,4BACA,yBACA,4BACA,4BACA,uBACA,yBACA,4BACA,2BACA,yBACA,wBACA,qBACA,uBACA,qBACA,yBACA,qBACA,qBACA,qBACA,qBACA,qBACA,4BACA,yBACA,yBACA,oBACA,4BAIR,WACE,YACAD,SAAQC,OAAO,+BAGjB,WACE,YACAD,SAAQC,OAAO,6BAGjB,WACE,YACAD,SAAQC,OAAO,wBACT,wCACA,qCACA,sCACA,uCAGR,WACE,YACAD,SAAQC,OAAO,yBAGjB,WACE,YACAD,SAAQC,OAAO,4BAGjB,WACE,YACAD,SAAQC,OAAO,gCAGjB,WACE,YACAD,SAAQC,OAAO,6BAGjB,WACI,YAKAD,SAAQC,OAAO,OAGVC,SAAS,QACNC,MAAO,uBACPC,OAAQ,WACRC,OAAQ,WACRC,WAAY,YACZC,SAAU,QAIbL,SAAS,OACNC,MAAO,MACPK,SAAU,MACVC,UAAW,OACXC,KAAM,OACNC,KAAM,SAITT,SAAS,UACNC,MAAO,SACPK,SAAU,MACVC,UAAW,OACXG,UAAW,MACXC,SAAU,QAIbX,SAAS,YACNC,MAAO,eACPW,QAAS,UACTC,KAAM,OACNC,MAAO,QACPC,MAAO,UAIVf,SAAS,QACNC,MAAO,OACPe,KAAM,SAIThB,SAAS,oBACNiB,QAAS,UACTC,eAAgB,gBAChBC,WAAY,aACZC,UAAW,YACXC,gBAAiB,iBACjBC,cAAe,gBACfC,kBAAmB,oBACnBC,eAAgB,gBAChBC,gBAAiB,iBACjBC,eAAgB,gBAChBC,YAAa,cACbC,gBAAiB,kBACjBC,eAAgB,gBAChBC,gBAAiB,mBAIpB9B,SAAS,oBACN+B,KAAM,OACNC,KAAM,OACNC,gBAAiB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","file":"scripts/app-e639d612e0.js","sourcesContent":["(function () {\n    'use strict';\n\n    angular.module('tsa',\n        ['ngAnimate',\n            'ngResource',\n            'ui.router',\n            'ngMaterial',\n            'ngCookies',\n            'gridster',\n            'pascalprecht.translate',\n            'tmh.dynamicLocale',\n            'angularFileUpload',\n            'ngFileSaver',\n            'tsa.components',\n            'tsa.pages',\n            'tsa.tsaViews',\n            'tsa.services',\n            'tsa.bootstrap'\n        ]);\n})();\n\n(function () {\n    'use strict';\n    angular.module(\"tsa.pages\", [\n        \"tsa.pages.acquisition\",\n        \"tsa.pages.dashboard\",\n        \"tsa.pages.login\",\n        \"tsa.pages.dataAccess\",\n        \"tsa.pages.tracking\",\n        \"tsa.pages.staticGrid\",\n        \"tsa.pages.welcome\"\n    ]);\n})();\n\n(function () {\n    'use strict';\n    angular.module(\"tsa.components\", [\n        \"tsa.components.card\",\n        \"tsa.components.console\",\n        \"tsa.components.dataView\",\n        \"tsa.components.doubleDataView\",\n        \"tsa.components.navbar\",\n        \"tsa.components.settingsButton\",\n        \"tsa.components.sidenav\"\n    ]);\n})();\n\n(function () {\n  'use strict';\n  angular.module(\"tsa.services\",[\n      'tsa.services.dialog'\n  ]);\n})();\n\n(function () {\n    'use strict';\n    angular.module(\"tsa.tsaViews\", [\n        'tsa.tsaViews.adcp',\n        'tsa.tsaViews.attitude',\n        'tsa.tsaViews.casino',\n        'tsa.tsaViews.casinoAddEvent',\n        \"tsa.tsaViews.codeNameFields\",\n        'tsa.tsaViews.debug',\n        'tsa.tsaViews.depth',\n        'tsa.tsaViews.devices',\n        'tsa.tsaViews.driverPreview',\n        'tsa.tsaViews.ephemeride',\n        'tsa.tsaViews.ferryboxFluo',\n        'tsa.tsaViews.ferryboxScience',\n        'tsa.tsaViews.ferryboxTechnic',\n        'tsa.tsaViews.flow',\n        'tsa.tsaViews.funesWinch',\n        'tsa.tsaViews.generic',\n        'tsa.tsaViews.gps',\n        'tsa.tsaViews.graphics',\n        'tsa.tsaViews.gravimeter',\n        'tsa.tsaViews.haulComposition',\n        'tsa.tsaViews.hullSoundSpeed',\n        'tsa.tsaViews.kss31',\n        'tsa.tsaViews.navigation',\n        'tsa.tsaViews.map',\n        'tsa.tsaViews.mapSidemenu',\n        'tsa.tsaViews.magnetometer',\n        'tsa.tsaViews.message',\n        'tsa.tsaViews.mobile',\n        'tsa.tsaViews.numerical',\n        'tsa.tsaViews.propulsionAt',\n        'tsa.tsaViews.landingAt',\n        'tsa.tsaViews.propulsionTl',\n        'tsa.tsaViews.propulsionPp',\n        'tsa.tsaViews.species',\n        'tsa.tsaViews.multibeam',\n        'tsa.tsaViews.thermoConfig',\n        'tsa.tsaViews.thermometer',\n        'tsa.tsaViews.thermosal',\n        'tsa.tsaViews.trawling',\n        'tsa.tsaViews.trawl',\n        'tsa.tsaViews.weather',\n        'tsa.tsaViews.video',\n        'tsa.tsaViews.videoCall',\n        'tsa.tsaViews.winch',\n        'tsa.tsaViews.EFPos',\n        'tsa.tsaViews.EFMet',\n        'tsa.tsaViews.EFTss',\n        'tsa.tsaViews.EFAum',\n        'tsa.tsaViews.winchAlarmPp',\n        'tsa.tsaViews.winchInfo',\n        'tsa.tsaViews.kleyState',\n        'tsa.tsaViews.menu',\n        'tsa.tsaViews.routeMd'\n    ]);\n})();\n\n(function () {\n  'use strict';\n  angular.module(\"tsa.pages.acquisition\",[]);\n})();\n\n(function () {\n  'use strict';\n  angular.module(\"tsa.pages.dashboard\",[]);\n})();\n\n(function () {\n  'use strict';\n  angular.module(\"tsa.pages.dataAccess\",[\n        \"tsa.pages.dataAccess.variableSelector\",\n        \"tsa.pages.dataAccess.paramSelector\",\n        \"tsa.pages.dataAccess.periodSelector\",\n        \"tsa.pages.dataAccess.resultCard\"]);\n})();\n\n(function () {\n  'use strict';\n  angular.module(\"tsa.pages.login\",[]);\n})();\n\n(function () {\n  'use strict';\n  angular.module(\"tsa.pages.tracking\",[]);\n})();\n\n(function () {\n  'use strict';\n  angular.module(\"tsa.components.console\",[]);\n})();\n\n(function () {\n  'use strict';\n  angular.module(\"tsa.services.dialog\",[]);\n})();\n\n(function () {\n    'use strict';\n\n    /***\n     * Constant file for devices properties\n     */\n    angular.module('tsa')\n\n        //-----------------  ADCP  -------------------\n        .constant('ADCP', {\n            FRAME: 'watercurrentvelocity',\n            EW_VEL: 'EWVelAbs',\n            NS_VEL: 'NSVelAbs',\n            BIN_LENGTH: 'binLength',\n            SOUNDING: 'snd'\n        })\n\n        //-----------------  AIS  -------------------\n        .constant('AIS', {\n            FRAME: 'ais',\n            LATITUDE: 'lat',\n            LONGITUDE: 'long',\n            HEAD: 'head',\n            MMSI: 'mmsi'\n        })\n\n        //-----------------  MOBILE  -------------------\n        .constant('MOBILE', {\n            FRAME: 'mobile',\n            LATITUDE: 'lat',\n            LONGITUDE: 'long',\n            IMMERSION: 'imm',\n            ALTITUDE: 'alt'\n        })\n\n        //-----------------  ATTITUDE  -------------------\n        .constant('ATTITUDE', {\n            FRAME: 'shipattitude',\n            HEADING: 'heading',\n            ROLL: 'roll',\n            PITCH: 'pitch',\n            HEAVE: 'heave'\n        })\n\n        //-----------------  CUFES  -------------------\n        .constant('FLOW', {\n            FRAME: 'flow',\n            DATA: 'flow'\n        })\n\n        //-----------------  FERRY BOX SCIENCE-------------------\n        .constant('FERRYBOX_SCIENCE', {\n            QUALITY: 'quality',\n            SBE45_SEA_TEMP: 'SBE45_SeaTemp',\n            SBE45_COND: 'SBE45_Cond',\n            SBE45_SAL: 'SBE45_Sal',\n            SBE45_SOUND_VEL: 'SBE45_SoundVel',\n            OPTODE_OXYGEN: 'optode_oxygen',\n            OPTODE_SATURATION: 'optode_saturation',\n            SEA_POINT_TURB: 'seapoint_turb',\n            AOA_GREEN_ALGAE: 'AOA_GreenAlgae',\n            AOA_BLUE_ALGAE: 'AOA_BlueAlgae',\n            AOA_DIATOMS: 'AOA_Diatoms',\n            AOA_CRYPTOPHYTA: 'AOA_Cryptophyta',\n            AOA_YELLOW_SUB: 'AOA_YellowSub',\n            AOA_TOTAL_ALGAE: 'AOA_TotalAlgae'\n        })\n\n        //-----------------  FERRY BOX TECHNIC-------------------\n        .constant('FERRYBOX_TECHNIC', {\n            DATE: 'date',\n            TIME: 'time',\n            OPTODE_SEA_TEMP: 'optode_seatemp',\n            AOA_SEA_TEMP: 'AOA_SeaTemp',\n            FB_PH_SEA_TEMP: 'FB_ph_seatemp',\n            FB_AIR_TEMP: 'FB_AirTemp',\n            PRESSURE: 'pressure',\n            FLOW_IN: 'flow_in',\n            FLOW_MAIN: 'flow_main',\n            FLOW_PCO2: 'flow_PCO2',\n            FLOW_BYPASS_2: 'flow_Bypass_2',\n            FLOW_AOA: 'flow_AOA',\n            HALFFULL: 'halffull',\n            FULL: 'full',\n            FB_PH_VALUE: 'FB_ph_value'\n        })\n\n        //-----------------  FUNES WINCH  -------------------\n        .constant('FUNES_WINCH', {\n            STARBOARD_LENGTH: 'starboardunwound',\n            STARBOARD_SPEED: 'starboardspinning',\n            STARBOARD_TENSION: 'starboardtension',\n            PORT_LENGTH: 'portunwound',\n            PORT_SPEED: 'portspinning',\n            PORT_TENSION: 'porttension'\n        })\n\n        //-----------------  GPS  -------------------\n        .constant('GPS', {\n            FRAME_POSITION: 'position',\n            LATITUDE: 'lat',\n            LONGITUDE: 'long',\n            GROUND_SPEED: 'gndspeed',\n            GROUND_COURSE: 'gndcourse',\n            HEADING: 'heading',\n            FRAME_SAT_INFO: 'satelliteinfo',\n            SATELLITE_NUMBER: 'nbused',\n            HDOP: 'HDOP'\n        })\n\n        //-----------------  GYRO  -------------------\n        .constant('GYRO', {\n            HEAD_FRAME: 'shipnav',\n            HEAD_ID: 'heading'\n        })\n\n        //-----------------  MAGNETOMETER -------------------\n        .constant('MAGNETOMETER', {\n            MAG: 'mag',\n            DEPTH: 'depth'\n        })\n\n        //-----------------  HAUL  -------------------\n        .constant('HAUL', {\n            FRAME: 'blcar',\n            HAUL_ID: 'curstation',\n            SPECIES_ID: 'speciesid',\n            SPECIES_SIGN: 'mark',\n            SPECIES_WEIGHT: 'speciesweight',\n            POCKET: 'curpocket',\n            TOTAL_POCKET_WEIGHT: 'pocketweight',\n            TOTAL_SORTED_SPECIES_WEIGHT: 'sortedspeciesweight',\n            BOX_ID: 'curbox',\n            BOX_WEIGHT: 'boxweight',\n            BOX_DESTINATION: 'boxdir'\n        })\n\n        //-----------------  CUFES  -------------------\n        .constant('HULLSOUNDSPEED', {\n            FRAME: 'hullsoundspeed',\n            DATA: 'sndspeed'\n        })\n\n        //-----------------  NAVIGATION - SHIPNAV  -------------------\n        .constant('NAVIGATION', {\n            DEVICE_ID: 'PP_SHIPNAV',\n            FRAME_SHIPNAV: 'shipnav',\n            LATITUDE: 'lat',\n            LONGITUDE: 'long',\n            HEADING: 'heading',\n            SOUNDER: 'depth',\n            GROUND_SPEED: 'gndspeed',\n            GROUND_COURSE: 'gndcourse',\n            SURFACE_SPEED: 'surfspeed',\n            SURFACE_COURSE: 'surfcourse',\n            DRIFT_SPEED: 'driftspeed',\n            DRIFT_COURSE: 'driftcourse',\n\n            FRAME_ROUTING: 'routing',\n            PREV_DIST: 'prevdist',\n            PREV_COURSE: 'prevcourse',\n            CUR_DIST: 'curdist',\n            CUR_COURSE: 'curcourse',\n            ETA: 'eta',\n            LAPSE: 'lapse',\n\n            FRAME_WAYPOINTS: 'waypoints',\n            INDEX: 'index',\n            ID: 'id'\n        })\n\n        //-----------------  GRAVIMETER -------------------\n        .constant('GRAVIMETER', {\n            ACC_X: 'acX',\n            ACC_Y: 'acY',\n            GRAVITY: 'gravity',\n            SCALE: 'grav_scale',\n            FILTER_ORDER: 'filterord',\n            FILTER_TAU: 'filtertau',\n            GPS_ON: 'GPS_on',\n            STATUS: 'status'\n        })\n\n        //-----------------  KSS31 -------------------\n        .constant('KSS31', {\n            ACC_X: 'acX',\n            ACC_Y: 'acY',\n            GRAVITY: 'gravity',\n            DATATION: 'datation',\n            SEASTATE: 'seastate',\n            EOETVOES: 'eoetvoes',\n            BOUGUER: 'bouguer',\n            FREEAIR: 'freeair',\n            MEASURETS: 'measureTS'\n        })\n\n        //-----------------  NAVIGATION - WAYPOINTS LIST  -------------------\n        .constant('WAYPOINTS_LIST', {\n            FRAME: 'waypoints',\n            ID: 'id',\n            LATITUDE: 'lat',\n            LONGITUDE: 'long'\n        })\n\n        //-----------------  NAVIGATION - WAYPOINTS -------------------\n        .constant('WAYPOINTS', {\n            FRAME: 'waypoints',\n            ID: 'id',\n            LATITUDE: 'lat',\n            LONGITUDE: 'long'\n        })\n\n        //-----------------  THERMOMETER  -------------------\n        .constant('THERMOMETER', {\n            FRAME: 'intake',\n            TEMPERATURE: 'intaketemp'\n        })\n\n        //-----------------  THERMOSALINOMETER  -------------------\n        .constant('THERMOSAL', {\n            FRAME: 'hydrology',\n            TANK_TEMP: 'temp',\n            TEMP: \"intaketemp\",\n            SALINITY: \"salinity\",\n            ANOMALY: \"density\",\n            SOUND_SPEED: \"sndspeed\",\n            CONDUCTIVITY: \"conduct\",\n            FRAME_FLUOROMETRY: \"fluo\",\n            FLUOROMETRY: \"fluo\",\n            FRAME_FLOW: \"flow\",\n            FLOW: \"flow\"\n        })\n\n        //-----------------  MULTIBEAM ECHO SOUNDER  -------------------\n        .constant('MULTIBEAM', {\n            FRAME: 'bathymetry',\n            PN: 'Pn',\n            PF: 'Pf',\n            BEAM_NUMBER: 'Nb',\n            DEPTH: 'De',\n            ACROSS: 'Ac',\n            ALONG: 'Al',\n            FLAG: 'mbSFlag'\n        })\n\n        //-----------------  TRAWL  -------------------\n        .constant('TRAWL', {\n            FRAME: 'trawl',\n            DEPTH: 'depth',\n            TEMP: 'temp',\n            ALTITUDE: 'waterropealt',\n            DOOR_DISTANCE: 'distdoor',\n            HORIZONTAL_SPREAD: 'horspread',\n            VERTICAL_SPREAD: 'vertspread',\n            CLEARANCE: 'clearance'\n        })\n\n\n        //-----------------  TRAWLING  -------------------\n        .constant('TRAWLING', {\n            FRAME: 'trawling',\n            COMMENT: 'comment',\n\n            LAT: 'lat',\n            LONG: 'long',\n            ALTITUDE: 'waterropealt',\n            HORIZONTAL_SPREAD: 'horspread',\n            PORTUNWOUND: 'portunwound',\n            VERTICAL_SPREAD: 'vertspread',\n            STARBOARDUNWOUND: 'starboardunwound',\n            ALTITUDE_SUM: 'waterropealt_sum',\n            HORIZONTAL_SPREAD_SUM: 'horspread_sum',\n            PORTUNWOUND_SUM: 'portunwound_sum',\n            VERTICAL_SPREAD_SUM: 'vertspread_sum',\n            STARBOARDUNWOUND_SUM: 'starboardunwound_sum',\n            ALTITUDE_NB: 'waterropealt_nb',\n            HORIZONTAL_SPREAD_NB: 'horspread_nb',\n            PORTUNWOUND_NB: 'portunwound_nb',\n            VERTICAL_SPREAD_NB: 'vertspread_nb',\n            STARBOARDUNWOUND_NB: 'starboardunwound_nb',\n\n            DISTANCE_STRAIGHT: 'distance_straight',\n            DISTANCE_REAL: 'distance_real',\n            RATIO: 'ratio'\n        })\n\n        //-----------------  PROPULSION TL  -----------------\n        .constant('PROPULSION_TL', {\n            DEVICE_ID: 'TL_PROPULSION',\n            FRAME: 'tlpropulsion',\n            FRONT_TRANS: 'fronttrans',\n            REAR_TRANS: 'reartrans',\n            MAIN: 'main',\n            RUDDER_ANGLE_FRAME: 'helm',\n            RUDDER_ANGLE: 'angle'\n        })\n\n        //-----------------  PROPULSION AT -----------------\n        .constant('PROPULSION_AT', {\n            DEVICE_ID: 'AT_PROPULSION',\n            FRAME: 'atpropulsion',\n            FRONT_TRANS: 'fronttrans',\n            FRONT_TRANS_ANGLE: 'frontpropangle',\n            MAIN_LEFT: 'mainleft',\n            MAIN_RIGHT: 'mainright',\n            RUDDER_ANGLE_FRAME: 'helm',\n            RUDDER_ANGLE: 'angle'\n        })\n\n        //-----------------  WEATHER -------------------\n        .constant('WEATHER', {\n            FRAME: 'weather',\n            TRUE_AIR_SPEED: 'trueairspeed',\n            TRUE_AIR_HEADING: 'trueairheading',\n            REL_AIR_SPEED: 'relairspeed',\n            REL_AIR_HEADING: 'relairheading',\n            DATA_TO_DISPLAY: [\n                { title: 'views.weather.air-temp', id: 'airtemp', format: '%.1f' },\n                { title: 'views.weather.water-temp', id: 'watertemp', format: '%.1f' },\n                { title: 'views.weather.air-pressure', id: 'airpressure', format: '%d' },\n                { title: 'views.weather.moisture', id: 'moisture', format: '%d' },\n                { title: 'views.weather.heatflux', id: 'heatflux', format: '%.1f' },\n                { title: 'views.weather.dew-point', id: 'dewpoint', format: '%.1f' }\n            ]\n        })\n\n        //-----------------  WINCH -------------------\n        .constant('WINCH', {\n            FRAME: 'winch',\n            TENSION: 'tension',\n            LENGTH: 'unwound',\n            SPINNING: 'spinning'\n        })\n\n        //-----------------  PP ENGINE -------------------\n\n        .constant('PP_ENGINE', {\n            FRAME: 'PpEngine',\n            DA1_POWER: 'DA1Power',\n            DA2_POWER: 'DA2Power',\n            DA3_POWER: 'DA3Power',\n            DA4_POWER: 'DA4Power',\n            MAIN_STARBOARD: 'mainstarboard',\n            MAIN_PORT: 'mainport'\n        })\n\n        .constant('PP_VDR', {\n            FRAME: 'khxdr',\n            TRANS1_PROP: 'trans1proppercent',\n            TRANS2_PROP: 'trans2proppercent',\n            TRANS3_PROP: 'trans3proppercent',\n            TRANS4_PROP: 'trans4proppercent',\n            RUDDER_STARBOARD: 'rudderstarboard',\n            RUDDER_PORT: 'rudderport'\n        })\n\n        .constant('PP_WINCH_ALARM', {\n            FRAME: 'info',\n            TEXT: 'text',\n            LEVEL: 'level',\n            ENDDATE: 'enddate',\n            CODE: 'code'\n        })\n\n        .constant('KLEY_STATE', {\n            FRAME: 'kley_state',\n            HP: 'hp',\n            BP: 'bp',\n            TEMP: 'temp',\n            M1: 'm1',\n            M2: 'm2',\n            M3: 'm3',\n            M4: 'm4',\n            M5: 'm5'\n        })\n\n        //-----------------  EUROFLEETS -------------------\n\n        //-----------------  POSITION -------------------\n\n        .constant('PEFPOS', {\n            FRAME: 'pefpos',\n            LATITUDE: 'lat',\n            HEADING: 'head',\n            COG: 'cog',\n            SOG: 'sog',\n            DEPTH: 'depth',\n            LONGITUDE: 'long',\n            SPEED: 'speed'\n        })\n\n        .constant('PEFMET', {\n            FRAME: 'pefmet',\n            VELOCITY: 'velocity',\n            GUST: 'gust',\n            DIRECTION: 'direction',\n            AIRTEMP: 'airtemp',\n            HUMIDITY: 'humidity',\n            RADIATION: 'radiation',\n            PRESSURE: 'pressure',\n            WATERTEMP: 'watertemp'\n        })\n\n        .constant('PEFTSS', {\n            FRAME: 'peftss',\n            SALINITY: 'salinity',\n            WATERTEMP: 'watertemp',\n            FLUO: 'fluo',\n            CONDUCT: 'conduct',\n            SIGMAT: 'sigmat'\n        })\n\n        .constant('PEFAUM', {\n            FRAME: 'pefaum',\n            TURBIDITYL: 'turbidityL',\n            TURBIDITYH: 'turbitidyH',\n            OBSL: 'obsL',\n            OBSH: 'obsH',\n            SALINITY: 'salinity',\n            CHLOROPHYLL: 'chlorophyll',\n            BLUEALGAE: 'bluealgae',\n            CDOM: 'cdom',\n            PH: 'ph',\n            FLUORESCENCE: 'fluorescence',\n            PCO2: 'pco2',\n            PAR: 'par'\n        })\n\n        ;\n\n})();\n\n(function () {\n    'use strict';\n    var TAG = \"[index.bootstrap.js] \";\n\n    /**---------------- APPLICATION BOOTSTRAP  ----------------**/\n\n    /* Get paramerters from the backend before the application launching. */\n    console.log(TAG + \"start... get(/frontend/parameters)...\");\n    $.get(\"/frontend/parameters\", function (data) {\n\n        /* Set constants with the received parameters */\n        console.log(TAG + \"Parameters received and put in constants...\");\n        console.log(TAG + \"View list lenght: \" + data.viewList.length);\n        angular.module('tsa.bootstrap', [])\n            .constant('APP_PROPERTIES', data)\n            .constant('DATA_ACCESS', {\n                'NAVIGATION': data.dataAccessLists.navigation,\n                'WEATHER': data.dataAccessLists.weather,\n                'THERMOSAL': data.dataAccessLists.thermosal\n            })\n            .constant('SHIP_ID', data.shipId)\n            .constant('STOMP_URL', data.hasOwnProperty('brokerIP') ? 'ws://' + data.brokerIP : getDefaultUrl('ws', '/ws'))\n            .constant('MD_ADDONS_URL', data.hasOwnProperty('mdAddonsURL') ? data.mdAddonsURL : '/md-addons')\n            .constant('JANUS_SERVER_URL', data.hasOwnProperty('janusServerUrl') ? data.janusServerUrl : getDefaultUrl('ws', '/janus/ws'))\n            .constant('ENABLE_VIDEOCALL', data.hasOwnProperty('enableVideoCall') ? JSON.parse(data.enableVideoCall) : true)\n            .constant('GEOMOD_SERVER_ADDRESS', \n                data.hasOwnProperty('geomodServerAddress') ? \n                    data.geomodServerAddress : \n                    '/gis/geomod')\n            .constant('QGIS_URL', \n                data.hasOwnProperty('qgisUrl') ? \n                    data.qgisUrl : \n                    '/gis/qgis')\n            .constant('QGIS_MISSION_NAME', data.qgisMissionName)\n            .constant('DEFAULT_DASHBOARD', data.defaultDashboard)\n            .constant('DEFAULT_STATIC_GRID', data.defaultStaticGrid)\n            .constant('VIEW_LIST', data.viewList)\n            .constant('VIDEO_PARAMS', data.video)\n            .constant('SHOW_EXTRACTION', data.hasOwnProperty('showExtraction') ? JSON.parse(data.showExtraction) : true)\n            .constant('SHOW_STATICGRID', data.hasOwnProperty('showStaticGrid') ? JSON.parse(data.showStaticGrid) : true)\n            .constant('SHOW_TRACKING', data.hasOwnProperty('showTracking') ? JSON.parse(data.showTracking) : true)\n            .constant('ENABLE_CHAT', data.hasOwnProperty('enableChat') ? JSON.parse(data.enableChat) : true)\n            .constant('MAP_BACKGROUND', data.hasOwnProperty('mapBackground') ? data.mapBackground : 'GEOMOD')\n            .constant('ARCHIVES_REST_API', {\n                DATA: data.hasOwnProperty('databaseIP') ?\n                    'http://' + data.databaseIP + '/api/archives/table' :\n                    '/api/archives/table',\n                DEVICES: data.hasOwnProperty('databaseIP') ?\n                    'http://' + data.databaseIP + '/api/archives/devices' :\n                    '/api/archives/devices'\n            });\n\n        /* Manual bootstrap (replace \"ng-app\") */\n        angular.element(document).ready(function () {\n            console.log(TAG + \"Launch the application: angular.bootstrap(...)\");\n            angular.bootstrap(document, ['tsa']);\n        });\n\n    })\n    .fail(function (error) { /*Load error module if the request has failed */\n        console.error(TAG + \"Error : frontend parameters loading failed!\");\n        console.error(error);\n        angular.module(['error']).constant('ERROR', error);\n        angular.bootstrap(document, ['error']);\n    });\n\n    function getDefaultUrl(protocol, path) {\n        var res;\n        if(window.location.protocol === 'http:')\n        \tres = protocol + '://' + window.location.host + path;\n        else\n            res = protocol + 's://' + window.location.host + path;\n        console.log('url : ' + res);\n        return res;\n    }\n\n\n})();\n\n(function () {\n    'use strict';\n    angular\n        .module('tsa')\n        .config(function ($mdThemingProvider) {\n            //Ifremer colors\n            //bleu0: 062240\n            //bleu1: 093564\n            //bleu2: 1A75AE\n            //bleu3: 2C97CB\n            //jaune: feed01\n\n            // Ifremer palette\n            $mdThemingProvider.definePalette('ifremerPalette', {\n                '50': 'D50000',\n                '100': 'D50000',\n                '200': 'D50000',\n                '300': '2C97CB',//hue-1 -> bleu3\n                '400': 'D50000',\n                '500': '1A75AE',//default -> bleu2\n                '600': '1A75AE',//'e53935',\n                '700': 'D50000',\n                '800': '093564',//hue-2 ->bleu1\n                '900': 'D50000',\n                'A100': '062240',//hue-3 // accent - 2 -> bleu0\n                'A200': '1A75AE',// accent - 1\n                'A400': '1A75AE',// accent - 3\n                'A700': '1A75AE',// accent - 4\n                'contrastDefaultColor': 'light',    // whether, by default, text (contrast)\n                                                    // on this palette should be dark or light\n                'contrastDarkColors': ['50', '100', //hues which contrast should be 'dark' by default\n                    '200', '300', '400', 'A100'],\n                'contrastLightColors': undefined    // could also specify this if default was 'dark'\n            });\n\n            $mdThemingProvider.theme('default')\n                .primaryPalette('ifremerPalette')\n                .accentPalette('ifremerPalette');\n\n            $mdThemingProvider.theme('day')\n                .primaryPalette('ifremerPalette')\n                .accentPalette('ifremerPalette');// define a color intention called black\n\n            $mdThemingProvider.theme('night')\n                .primaryPalette('ifremerPalette')\n                .accentPalette('ifremerPalette')  // define a color intention called white\n                .dark();\n\n            // This is the absolutely vital part, without this, changes will not cascade down through the DOM.\n            $mdThemingProvider.alwaysWatchTheme(true);\n        })\n        //-----------------  Internationalization  -------------------\n        //To have warnings in console regarding forgottenID\n        //.config(function ($translateProvider) {\n        //    $translateProvider.useMissingTranslationHandlerLog();\n        //})\n        //Asynchronous loading for the translations\n        .config(function ($translateProvider) {\n            $translateProvider.useStaticFilesLoader({\n                prefix: 'resources/locale-',// path to translations files\n                suffix: '.json'// suffix, currently- extension of the translations\n            });\n\n            $translateProvider.preferredLanguage('fr_FR');// is applied on first load\n            $translateProvider.fallbackLanguage('en_US');// is applied on first load\n           // $translateProvider.useLocalStorage();// saves selected language to localStorage TODO: resolve synchronization issues\n        })\n        //direction of where to load the $locale settings files for angular-dynamic-locale:\n        .config(function (tmhDynamicLocaleProvider) {\n            tmhDynamicLocaleProvider.localeLocationPattern('../locales/angular-locale_{{locale}}.js');\n        });\n})();\n\n(function () {\n    'use strict';\n\n    angular\n        .module('tsa')\n        //-----------------  Internationalization  ------------------\n        .constant('LOCALES', {\n            'locales': {\n                'en_US': {id: 'en_US', name: 'English', img: 'resources/images/flag_en.svg'},\n                'fr_FR': {id: 'fr_FR', name: 'Franais', img: 'resources/images/flag_fr.svg'}\n            },\n            'preferredLocale': 'fr_FR'\n        })\n        //-----------------  Authorities  -------------------\n        .constant('AUTHORITIES', {\n            ADMIN: 'ROLE_ADMIN',\n            MASTER: 'ROLE_MASTER',\n            SDIV: 'ROLE_SDIV',\n            USER: 'ROLE_USER',\n            VIDEOCALL: 'ROLE_VIDEOCALL'\n        })\n\n    //-----------------  STOMP constants  -------------------\n    // .constant('STOMP_URL', 'ws://' + location.hostname + ':61614')\n    //.constant('STOMP_URL', 'ws://' + 'localhost' + ':61614')\n    //.constant('GEOMOD_SERVER_ADDRESS', 'http://134.246.151.159:8080/MARINE_OWS_SERVER/wms')\n    //.constant('QGIS_URL', 'http://134.246.151.135:9999/wms/')\n    //.constant('QGIS_MISSION_NAME', 'PELGAS2017_Thalassa')\n    .constant('TOPICS', {\n      LOG: '/topic/log.json',\n      STATUS: '/topic/status.json',\n      CONFIG: '/topic/configuration.json',\n      DEVICES: '/topic/devices.json'\n    })\n\n    //-----------------  REST API URL  -------------------\n    .constant('REST_API', {\n      ARCHIVE_DATA: '/api/archives/table', //'http://134.246.151.40:8080/api/archives/table',\n      ARCHIVE_DEVICES: '/api/archives/devices',//'http://134.246.151.40:8080/api/archives/devices',\n      CHANNEL: '/api/channels',\n      CONFIGURATION: '/api/admin/configurations', // @deprecated\n      DRIVER: '/api/drivers',\n      DRIVER_PREVIEW: '/api/drivers/preview',\n      DEVICE: '/api/devices',\n      DESCRIPTION: '/api/descriptions',\n      FRONT_END_PARAMETERS: '/frontend/parameters',\n      LOGIN: '/login',\n      LOGOUT: '/logout',\n      MISSION: '/api/admin/mission',\n      USER: '/api/user',\n      USER_CONFIG: '/user/config/',\n      CASINO: '/api/casino',\n      QGIS: '/api/qgis/projects/project',\n      CHAT: '/api/chatMessages'\n    });\n})();\n\n/***\n * Main controller (controller for index.html)\n */\n(function () {\n    'use strict';\n    angular.module('tsa').controller('IndexController',\n        function IndexController(themeService) {\n            var vm = this;\n            vm.theme = themeService.getTheme();\n        });\n})();\n\n/***\n * Controller used if the \"tsa\" module could not be loaded (controller for index.html)\n */\n(function () {\n    'use strict';\n    angular.module('error', []).controller('IndexController',\n        function IndexController(ERROR) {\n            var vm = this;\n            vm.isErrorModule = true;\n            vm.error = ERROR;\n        });\n})();\n\n(function () {\n    'use strict';\n\n    angular\n        .module('tsa')\n        .config(routerConfig);\n\n    /** @ngInject */\n    function routerConfig($stateProvider, $urlRouterProvider) {\n        console.log(\"ROUTE PROVIDER\");\n        $stateProvider\n            .state('acquisition', {\n                url: '/acquisition',\n                templateUrl: 'app/pages/acquisition/acquisition.html',\n                controller: 'acquisitionController',\n                controllerAs: 'ctrl'\n            })\n            .state('dashboard', {\n                url: '/dashboard',\n                templateUrl: 'app/pages/dashboard/dashboard.html',\n                controller: 'dashboardController',\n                controllerAs: 'ctrl'\n            })\n            .state('tracking', {\n                url: '/tracking',\n                templateUrl: 'app/pages/tracking/tracking.html',\n                controller: 'trackingController',\n                controllerAs: 'ctrl'\n            })\n            .state('device', {\n                url: '/acquisition/device?:id',\n                templateUrl: 'app/pages/acquisition/addDevice/editDevice.html',\n                controller: 'editDeviceController',\n                controllerAs: 'ctrl',\n                params:{\n                    id:undefined\n                }\n            })\n            .state('login', {\n                url: '/login?:next&:authority',\n                templateUrl: 'app/pages/login/login.html',\n                controller: 'loginController',\n                controllerAs: 'ctrl',\n                params:{\n                    next: undefined,\n                    authority: undefined,\n                    nextParams: undefined\n                }\n            })\n            .state('dataAccess', {\n                url: '/dataAccess',\n                templateUrl: 'app/pages/dataAccess/dataAccess.html',\n                controller: 'dataAccessController',\n                controllerAs: 'ctrl'\n            })\n            .state('static', {\n                url: '/static',\n                templateUrl: 'app/pages/staticGrid/staticGrid.html',\n                controller: 'staticGridController',\n                controllerAs: 'ctrl'\n            })\n            .state('welcome', {\n                url: '/welcome',\n                templateUrl: 'app/pages/welcome/welcome.html',\n                controller: 'welcomeController',\n                controllerAs: 'ctrl'\n            });\n\n        //Default page\n            $urlRouterProvider.otherwise('/welcome');\n    }\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('tsa')\n    .run(['$log', function($log) {\n        $log.getInstance = function(context) {\n            return {\n                log   : enhanceLogging($log.log, context),\n                info  : enhanceLogging($log.info, context),\n                warn  : enhanceLogging($log.warn, context),\n                debug : enhanceLogging($log.debug, context),\n                error : enhanceLogging($log.error, context)\n            };\n        };\n\n        function enhanceLogging(loggingFunc, context) {\n            return function() {\n                var modifiedArguments = [].slice.call(arguments);\n                modifiedArguments.unshift('[' + context + '] ');\n                loggingFunc.apply(null, modifiedArguments);\n            };\n        }\n    }])\n\n})();\n\n/***\n * AcquisitionController: controller of the acquisition view, manages devices (status, frame number, file stats...) and\n * logs.\n */\n(function () {\n    'use strict';\n    angular\n        .module('tsa.pages.acquisition')\n        .controller('acquisitionController', AcquisitionController);\n\n    /** @ngInject */\n    function AcquisitionController(acquisitionService,\n                                   AUTHORITIES,\n                                   dialogService,\n                                   $interval,\n                                   restService,\n                                   $scope,\n                                   statusService,\n                                   stompService,\n                                   TOPICS,\n                                   userService) {\n\n        /** Authentication **/\n        if (!userService.checkAuthority(AUTHORITIES.USER))\n            return;\n\n        /** Log tag **/\n        var TAG = '[acquisitionController] ';\n\n        /***\n         * Item: represents a device, its files stats and its frame number.\n         */\n        function Item(device) {\n            var self = this;\n            this.device = device;\n            this.files = undefined;\n            this.framesNumber = {};\n            this.frameNumber = undefined;\n            this.lastTimeStamp = 0;\n            this.isSelected = false;\n            this.isReceivingJSON = false;\n            this.status = vm.STATUS.UNDEFINED;\n        }\n\n        /**-------------------- PROPERTIES ----------------**/\n        var deviceListListener;\n        var deviceJSONListener;\n        var logListener;\n        var statusListener;\n        var deviceListener;\n        var intervalPromise;\n        var selectedItem;\n        var textArea = undefined;\n        var logs = [];\n        var alertLogs = [];\n\n        /** Model - view properties **/\n        var vm = this;\n        vm.itemList = [];\n        vm.console = \"\";\n        vm.serverTime = \"\";\n        vm.availableSpace = \"\";\n        vm.consoleViews = {\n            LOGS: 'logs',\n            ALERTS: 'alerts',\n            FRAMES: 'frames'\n        };\n        vm.consoleView = vm.consoleViews.LOGS;\n        vm.orderDevice = 'device.name';\n\n\n        /** Status enumerator **/\n        vm.STATUS = {\n            OK: {text: 'Ok', color: '#8BC34A', show: true},\n            NO_DATA: {text: 'Data missing', color: '#1a75ad', show: true},\n            TIME_OUT: {text: 'Time out', color: '#F44336', show: true},\n            OUT_OF_RANGE: {text: 'Out of range', color: '#ff702e', show: true},\n            UNDEFINED: {text: 'Undefined', color: 'grey', show: true}\n        };\n\n        vm.displayMode = 'list'; //'grid';\n\n        /**-------------------- PRIVATE METHODS ----------------**/\n\n        /***\n         * Refresh the item list with a specified device list.\n         * Item: a device and its properties: status, frame number, files...\n         */\n        var refreshItemList = function refreshItemList(deviceList) {\n            //Step 1: remove item which are obsolete\n            var itemToDelete = [];\n            angular.forEach(vm.itemList, function (item) {\n                var itemDeviceExists = false;\n                angular.forEach(deviceList, function (device) {\n                    if (device.id === item.device.id && device.isEnabled)\n                        itemDeviceExists = true; //the device exists and is enabled\n                });\n                if (!itemDeviceExists) {\n                    itemToDelete.push(item);\n                }\n            });\n            angular.forEach(itemToDelete, function (item) {\n                item.device.unsubscribeToJSONData(item.JSONDataListener);\n                vm.itemList.splice(vm.itemList.indexOf(item), 1);\n            });\n\n\n            //Step 2: add a new item for each new device found.\n            angular.forEach(deviceList, function (device) {\n                var itemAlreadyExists = false;\n                angular.forEach(vm.itemList, function (item) {\n                    if (device.id === item.device.id)\n                        itemAlreadyExists = true;\n                });\n                if (!itemAlreadyExists && device.isEnabled) //If the device is not already in the list and is enabled\n                    vm.itemList.push(new Item(device)); // ---> add the device in the list\n            })\n        };\n\n        /***\n         * Get a formatted string representation of a raw capacity.\n         */\n        var formatCapacity = function formatCapacity(rawCapacity) {\n            if (rawCapacity < 1024) return rawCapacity + \" o\";\n            if (rawCapacity < 1024 * 1024) return (rawCapacity / 1024).toFixed(2) + \" Ko\";\n            if (rawCapacity < 1024 * 1024 * 1024) return (rawCapacity / (1024 * 1024)).toFixed(2) + \" Mo\";\n            if (rawCapacity < 1024 * 1024 * 1024 * 1024) return (rawCapacity / (1024 * 1024 * 1024)).toFixed(2) + \" Go\";\n            if (rawCapacity < 1024 * 1024 * 1024 * 1024 * 1024) return (rawCapacity / (1024 * 1024 * 1024 * 1024)).toFixed(2) + \" To\";\n        };\n\n        /***\n         * Parse a status message (received with the topic: status.json)\n         */\n        vm.parseStatusMessage = function parseStatusMessage(message) {\n            var status = JSON.parse(message.data.body);\n            if (status !== 'undefined') {\n\n                //var data = new Date(status.time);\n                //vm.serverTime = status.time;\n                vm.availableSpace = 'Available space: ' + formatCapacity(status.usableSpace) + '/' + formatCapacity(status.totalSpace);\n\n                angular.forEach(status.devFileStats, function (deviceFileStat, deviceFileStatId) {\n                    angular.forEach(vm.itemList, function (item) {\n                        if (item.device.id === deviceFileStatId) {\n                            item.files = deviceFileStat;\n                            angular.forEach(item.files, function (file) {\n                                file.filesizeFormated = formatCapacity(file.filesize);\n                            })\n                        }\n                    })\n                });\n            }\n        };\n\n        /***\n         * Parse a log message (received with the topic: log.json)\n         */\n        vm.parseLogMessage = function parseLogMessage(message) {\n            var log = JSON.parse(message.data.body).message;\n            var level = log.replace(/^[^\\s]+\\s+(\\w+)\\s.*$/, \"$1\");\n\n            if (level === 'ALERT')\n                vm.addConsoleMsg(log, level);\n            else vm.addConsoleMsg(log, vm.consoleViews.LOGS);\n        };\n\n        vm.setItemStatus = function (status) {\n            if (status.toUpperCase() == 'OK') {\n                return vm.STATUS.OK;\n            } else if (status.toUpperCase() == 'NO_DATA') {\n                return vm.STATUS.NO_DATA;\n            } else if (status.toUpperCase() == 'TIME_OUT') {\n                return vm.STATUS.TIME_OUT;\n            } else if (status.toUpperCase() == 'OUT_OF_RANGE') {\n                return vm.STATUS.OUT_OF_RANGE;\n            }\n        }\n\n        /***\n         * Parse a heartbeat message (received with the topic: heartbeat)\n         */\n        vm.parseDevicesMessage = function parseDevicesMessage(message) {\n            var devices = JSON.parse(message.data.body);\n\n            angular.forEach(vm.itemList, function (item) {\n                angular.forEach(devices, function (device) {\n                    if (item.device.id === device.deviceId) {\n                        item.frameNumber = device.sequenceNumber;\n                        item.lastTimeStamp = device.lastTimeStamp;\n                        item.status = vm.setItemStatus(device.status);\n                    }\n                })\n            });\n        };\n\n        /***\n         * Add a new line in the console\n         */\n        vm.addConsoleMsg = function addConsoleMsg(msg, level) {\n            switch (level) {\n                case vm.consoleViews.LOGS:\n                    logs.push(msg);\n                    break;\n                case vm.consoleViews.ALERTS:\n                    logs.push(msg);\n                    alertLogs.push(msg);\n                    break;\n            }\n\n            if (level && vm.consoleView != level)\n                return;\n\n            vm.console += msg + \"\\n\";\n            if (vm.console.length > 50000)\n                vm.console = vm.console.substring(vm.console.length / 3);\n            if (textArea !== undefined)\n                textArea.scrollTop = textArea.scrollHeight;\n        };\n\n\n        /**-------------------- PUBLIC METHODS ----------------**/\n\n        /**\n         * Init function, called when the view is created.\n         */\n        vm.init = function init() {\n            console.debug(TAG + ' init() called');\n            vm.serverTime = statusService.getServerTime();\n\n            //Register for topic log\n            logListener = stompService.registerForTopic(TOPICS.LOG);\n            logListener.promise.then({}, {}, vm.parseLogMessage);\n\n            //Subscribe to 'Status' messages\n            statusListener = stompService.registerForTopic(TOPICS.STATUS);\n            statusListener.promise.then({}, {}, function (msg) {\n                vm.parseStatusMessage(msg);\n            });\n\n            //Subscribe to 'Heartbeat' messages and launch the heartbeat watchdog\n            deviceListener = stompService.registerForTopic(TOPICS.DEVICES);\n            deviceListener.promise.then({}, {}, function (msg) {\n                vm.parseDevicesMessage(msg);\n            });\n\n            //Watch device list\n            refreshItemList(acquisitionService.getDeviceList());\n            deviceListListener = acquisitionService.registerForDeviceList();\n            deviceListListener.promise.then({}, {}, refreshItemList);\n\n            //Get the text area (console)\n            textArea = document.getElementById('acquisition-textarea');\n        };\n\n        /**\n         * Destroy function, called when the view is destroyed: closes the used resources.\n         */\n        $scope.$on(\"$destroy\", function onDestroy() {\n            console.debug(TAG + '$onDestroy');\n\n            angular.forEach(vm.itemList, function (item) {\n                item.device.unsubscribeToJSONData(item.JSONDataListener);\n            });\n            stompService.unregisterForTopic(TOPICS.LOG, logListener);\n            stompService.unregisterForTopic(TOPICS.STATUS, statusListener);\n            acquisitionService.unregisterForDeviceList(deviceListListener);\n\n            stompService.unregisterForTopic(TOPICS.DEVICES, statusListener);\n            if (intervalPromise !== undefined)\n                $interval.cancel(intervalPromise);\n\n            if (selectedItem !== undefined && deviceJSONListener !== undefined)\n                selectedItem.device.unsubscribeToJSONData(deviceJSONListener);\n        });\n\n        /**\n         * Method called when an item (=device) is selected in the list.\n         */\n        vm.selectItem = function selectItem(newSelectedItem) {\n            if (selectedItem !== undefined && deviceJSONListener !== undefined) {\n                selectedItem.device.unsubscribeToJSONData(deviceJSONListener);\n                selectedItem.isSelected = false;\n            }\n            if (selectedItem === newSelectedItem) {\n                selectedItem = undefined;\n                return;\n            }\n            selectedItem = newSelectedItem;\n            selectedItem.isSelected = true;\n\n            deviceJSONListener = selectedItem.device.subscribeToJSONData();\n            if (vm.consoleView === vm.consoleViews.FRAMES)\n                vm.console = \"\";\n            deviceJSONListener.promise.then({}, {}, function (msg) {\n                vm.addConsoleMsg(msg.data.body, vm.consoleViews.FRAMES);\n            });\n\n        };\n\n        /**\n         * Remove the selected device\n         */\n        vm.removeItem = function removeItem(item) {\n            dialogService.showValidation('Delete device', 'Are you sure you want to remove ' + item.device.name + '?')\n                .then(\n                    function () {\n                        restService.deleteDevice(item.device.id).then(function () {\n                            console.debug(TAG + ' item' + item.device.id + ' has been removed');\n                        });\n                    });\n        };\n\n        /**\n         * Method called when a new console tab is selected.\n         */\n        vm.changeConsole = function changeConsole(value) {\n            vm.console = \"\";\n            vm.consoleView = value;\n\n            var logsToDisplay = [];\n            switch (vm.consoleView) {\n                case vm.consoleViews.LOGS:\n                    logsToDisplay = logs;\n                    break;\n                case vm.consoleViews.ALERTS:\n                    logsToDisplay = alertLogs;\n                    break;\n            }\n\n            angular.forEach(logsToDisplay, function (log) {\n                vm.addConsoleMsg(log);\n            });\n        };\n\n\n    }\n})();\n\n\n/***\n * Dashboard controller: manage the dashboard view\n */\n(function () {\n    'use strict';\n    angular\n        .module('tsa.pages.dashboard')\n        .controller('dashboardController', DashboardController);\n\n    /** Dashboard view controller */\n    function DashboardController($filter, $rootScope, dashboardService, userService, dialogService) {\n\n        /**------------------------------ PROPERTIES -----------------------------**/\n\n        var vm = this;\n        vm.currentDashboard = dashboardService.getCurrentDashboard();\n        vm.dashboardService = dashboardService;\n        vm.userService = userService;\n\n        /** Dashboard properties **/\n        vm.showDashboardSelection = false;\n        vm.dashboardListPerso = dashboardService.getDashboardListPerso();\n        //vm.dashboardListShared = dashboardService.getDashboardListShared();\n        vm.selectedDashboard = dashboardService.getCurrentDashboard();\n\n        vm.gridsterOpts = {\n            columns: 12,\n            draggable: {\n                enabled: true, // whether dragging items is supported\n                handle: '.tsa-toolbar,.tsa-toolbar *,.tsa-debug *'// optional selector for drag handle\n            },\n            isMobile: true, // stacks the grid items if true\n            rowHeight: 50 //use to prevent scrollbar bug\n\n\n            /* ----------------  AVAILABLES GRIDSTER OPTIONS  ----------------------\n\n            columns: 6, // the width of the grid, in columns\n            pushing: true, // whether to push other items out of the way on move or resize\n            floating: true, // whether to automatically float items up so they stack (you can temporarily disable if you are adding unsorted items with ng-repeat)\n            swapping: false, // whether or not to have items of the same size switch places instead of pushing down if they are the same size\n            width: 'auto', // can be an integer or 'auto'. 'auto' scales gridster to be the full width of its containing element\n            colWidth: 'auto', // can be an integer or 'auto'.  'auto' uses the pixel width of the element divided by 'columns'\n            rowHeight: 'match', // can be an integer or 'match'.  Match uses the colWidth, giving you square widgets.\n            margins: [10, 10], // the pixel distance between each widget\n            outerMargin: true, // whether margins apply to outer edges of the grid\n            isMobile: false, // stacks the grid items if true\n            mobileBreakPoint: 600, // if the screen is not wider that this, remove the grid layout and stack the items\n            mobileModeEnabled: true, // whether or not to toggle mobile mode when screen width is less than mobileBreakPoint\n            minColumns: 1, // the minimum columns the grid must have\n            minRows: 2, // the minimum height of the grid, in rows\n            maxRows: 100,\n            defaultSizeX: 2, // the default width of a gridster item, if not specifed\n            defaultSizeY: 1, // the default height of a gridster item, if not specified\n            minSizeX: 1, // minimum column width of an item\n            maxSizeX: null, // maximum column width of an item\n            minSizeY: 1, // minumum row height of an item\n            maxSizeY: null, // maximum row height of an item\n            resizable: {\n                enabled: true,\n                handles: ['n', 'e', 's', 'w', 'ne', 'se', 'sw', 'nw'],\n                start: function(event, $element, widget) {}, // optional callback fired when resize is started,\n                resize: function(event, $element, widget) {}, // optional callback fired when item is resized,\n                stop: function(event, $element, widget) {} // optional callback fired when item is finished resizing\n            },\n            draggable: {\n                enabled: true, // whether dragging items is supported\n                handle: '.my-class', // optional selector for drag handle\n                start: function(event, $element, widget) {}, // optional callback fired when drag is started,\n                drag: function(event, $element, widget) {}, // optional callback fired when item is moved,\n                stop: function(event, $element, widget) {} // optional callback fired when item is finished dragging\n            }*/\n        };\n\n\n        /**------------------------------ VIEW-MODEL METHODS -----------------------------**/\n\n        vm.deleteEnabled = function deleteEnabled() {\n            return angular.isDefined(userService.getCurrentUser())  &&  angular.isDefined(vm.dashboardListPerso[vm.currentDashboard.title]);\n        };\n\n        /** Save callback **/\n        vm.showSaveDialog = function showSaveDialog() {\n            /** Save the current dashboard with the defined title **/\n            function saveDashboard(title) {\n                var currentUser = userService.getCurrentUser();\n                if (currentUser == undefined) {\n                    dialogService.showDialog($filter('translate')(\"pages.dashboard.connection-needed-title\"), $filter('translate')(\"pages.dashboard.connection-needed-msg\"));\n                    return;\n                }\n                currentUser.saveDashboard(title, dashboardService.getCurrentDashboard().itemList).then(\n                    function resolved() {\n                        dialogService.showToast($filter('translate')(\"pages.dashboard.dashboard-saved\") + \": \" + title);\n                    },\n                    function rejected() {\n                        dialogService.showDialog($filter('translate')(\"pages.dashboard.dashboard-saving-fail\"));\n                    });\n            }\n\n            var title = vm.selectedDashboard.title != 'pages.dashboard.new-dashboard' ? vm.selectedDashboard.title : '';\n\n            dialogService.showSaveDashboard(title).then(function (title) {\n                if (vm.dashboardListPerso[title] !== undefined) {\n                    dialogService.showValidation($filter('translate')(\"pages.dashboard.save-dashboard-title\"),\n                        title + \": \" + $filter('translate')(\"pages.dashboard.dashboard-exists\")).then(function () {\n                            saveDashboard(title);\n                        });\n                }\n                else {\n                    saveDashboard(title);\n                }\n            });\n        };\n\n        /** Delete callback **/\n        vm.showDeleteDialog = function showDeleteDialog() {\n            dialogService.showValidation($filter('translate')(\"pages.dashboard.remove-dashboard-title\"),\n                $filter('translate')(\"pages.dashboard.remove-dashboard-msg\"),\n                $filter('translate')(\"pages.dashboard.delete\"))\n                .then(function () {\n                    userService.getCurrentUser().removeDashboard(dashboardService.getCurrentDashboard().title)\n                        .then(\n                        function resolved() {\n                            dialogService.showToast($filter('translate')(\"pages.dashboard.dashboard-removed\"));\n                        },\n                        function rejected(error) {\n                            dialogService.showDialog($filter('translate')(\"pages.dashboard.dashboard-removed-fail\") + \": \" + error);\n                        }\n                        );\n                });\n        }\n    }\n})();\n\n/**\n * Dashboard service: manage the dashboard model.\n */\n(function () {\n    'use strict';\n    angular.module(\"tsa.pages.dashboard\").factory(\"dashboardService\", function (dialogService, DEFAULT_DASHBOARD, $filter) {\n\n        /**------------------------------ CLASS ----------------------------------**/\n\n        /* Item: a dashboard element */\n        function Item(sizeX, sizeY, type, config) {\n            this.id = getAvailableId();\n            this.sizeX = sizeX;\n            this.sizeY = sizeY;\n            this.row = getFirstFreeRow();\n            this.col = 0; // default column\n            this.type = type;\n            this.config = config;\n        }\n\n        /**------------------------------ PROPERTIES ----------------------------------**/\n\n        /* Default dashboard */\n        var defaultDashboard = angular.isDefined(DEFAULT_DASHBOARD) ? DEFAULT_DASHBOARD : [];\n\n        /* Example of dashboard configuration:\n        { \"id\": 1, \"sizeX\": 6, \"sizeY\": 9, \"row\": 0, \"col\": 0, \"type\": \"Navigation\", \"config\": { \"deviceId\": \"TL_SHIPNAV\" } },\n        { \"id\": 2, \"sizeX\": 6, \"sizeY\": 9, \"row\": 0, \"col\": 6, \"type\": \"Map\", \"config\": { \"title\": \"Navigation\", \"mode\": \"navigation\", \"deviceId\": \"TL_SHIPNAV\", \"shipnavDeviceId\": \"TL_SHIPNAV\", \"waypointsDeviceId\": \"TL_WAYPOINTS\", \"weatherDeviceId\": \"TL_BATOS\" } },\n        { \"id\": 4, \"sizeX\": 6, \"sizeY\": 9, \"row\": 9, \"col\": 0, \"type\": \"Weather\", \"config\": { \"deviceId\": \"TL_BATOS\", \"navId\": \"TL_SHIPNAV\" } },\n        {\n            \"id\": 3, \"sizeX\": 6, \"sizeY\": 9, \"row\": 9, \"col\": 6, \"type\": \"Generic\", config: {\n                title: 'Thermosalinometer',\n                deviceId: 'TL_SBE', //device ID displayed into the card toolbar\n                icon: 'opacity', //icon displayed into the card toolbar\n                dataList: [{ name: 'Tank temperature', deviceId: 'TL_SBE', frameId: 'hydrology', dataId: 'temp', format: '%.3f', units: 'C' },\n                { name: 'Temperature', deviceId: 'TL_SBE', frameId: 'hydrology', dataId: 'intaketemp', format: '%.3f', units: 'C' },\n                { name: 'Salinity', deviceId: 'TL_SBE', frameId: 'hydrology', dataId: 'salinity', format: '%.3f', units: 'PSU' },\n                { name: 'Anomaly', deviceId: 'TL_SBE', frameId: 'hydrology', dataId: 'density', format: '%.3f', units: 'kg/m' },\n                { name: 'Sound speed', deviceId: 'TL_SBE', frameId: 'hydrology', dataId: 'sndspeed', format: '%.1f', units: 'm/s' },\n                { name: 'Conductivity', deviceId: 'TL_SBE', frameId: 'hydrology', dataId: 'conductivity', format: '%.2f', units: 'S/m' },\n                { name: 'Fluorometry', deviceId: 'FLUO001', frameId: 'fluo', dataId: 'fluo', format: '%.3f', units: 'ug/l' },\n                { name: 'Flow', deviceId: 'FLOW001', frameId: 'flow', dataId: 'flow', format: '%.2f', units: 'l/mn' }]\n            }\n        }];*/\n\n        /* Personal dashboard list */\n        var dashboardListPerso = { \"Default\": defaultDashboard };\n\n        /* Shared dashboard list: TODO: functionality not yet defined  */\n        /* var dashboardListShared = {};*/\n\n        /* Current dashboard (displayed whithin the dashboard page) */\n        var currentDashboard = { title: \"Default\", itemList: DEFAULT_DASHBOARD };\n\n        /**------------------------------ PRIVATES METHODS ----------------------------------**/\n\n        /** Get an id that is not already used by an item **/\n        function getAvailableId() {\n            var id = 0;\n            var availableIdFound = false;\n            while (!availableIdFound) {\n                id++;\n                availableIdFound = true;\n                //If an item has already the id: availableIdFound = false, else true;\n                angular.forEach(currentDashboard.itemList, function (item) {\n                    if (item.id == id)\n                        availableIdFound = false;\n                });\n            }\n            return id;\n        }\n\n        /** Get the last row  */\n        function getFirstFreeRow() {\n            var firstFreeRow = 1;\n            angular.forEach(currentDashboard.itemList, function (item) {\n                if (item.row + item.sizeY + 1 > firstFreeRow)\n                    firstFreeRow = item.row + item.sizeY + 1;\n            });\n            return firstFreeRow;\n        }\n\n        /** Update a dashboard list with a new dashboard list\n         * (replace the object properties instead of replace the object itself, useful to preserve data binding) **/\n        function updateDashboardList(oldDashboardList, newDashboardList) {\n            angular.forEach(oldDashboardList, function (value, key) {\n                delete oldDashboardList[key];\n            });\n            angular.forEach(newDashboardList, function (itemList, title) {\n                oldDashboardList[title] = itemList;\n            });\n        }\n\n        /**--------------------------------- PUBLIC METHODS -----------------------------------**/\n\n        return {\n\n            /** Get the current dashboard (the one which will be displayed) **/\n            getCurrentDashboard: function getCurrenDashboard() {\n                return currentDashboard;\n            },\n\n            /** Set the current dashboard **/\n            setCurrentDashboard: function setCurrentDashboard(title, itemList) {\n                currentDashboard.title = title;\n                currentDashboard.itemList = itemList;\n            },\n\n            /** Get the dashboard list **/\n            getDashboardListPerso: function getDashboardListPerso() {\n                return dashboardListPerso;\n            },\n\n            /** Get the dashboard list **\n            getDashboardListShared: function getDashboardList() {\n                return dashboardListShared;\n            },*/\n\n            /** Set the personal dashboard list **/\n            setPersoDashboardList: function setPersoDashboardList(newDashboardList) {\n                updateDashboardList(dashboardListPerso, newDashboardList);\n            },\n\n            /** Set the shared dashboard list **\n            setSharedDashboardList: function setSharedDashboardList(newDashboardList) {\n                updateDashboardList(dashboardListShared, newDashboardList);\n            },/\n\n            /** Create a new dashboard **/\n            switchToNewDashboard: function switchToNewDashboard() {\n                currentDashboard.title = \"pages.dashboard.new-dashboard\";\n                currentDashboard.itemList = [];\n            },\n\n            /** Show the add item dialog **/\n            showAddItem: function showAddItem() {\n                var self = this;\n                dialogService.showSelectView().then(function (response) {\n                    if(response.view === 'Video Call' && self.findVideoCall()) {\n                        dialogService.showToast($filter('translate')(\"views.video-call.duplicate.message\"));\n                    } else {\n                        currentDashboard.itemList.push(new Item(6, 8, response.view, response.config));\n                    }\n                });\n            },\n\n            findVideoCall: function findVideoCall() {\n                var found = currentDashboard.itemList.find(\n                    function(item) {\n                        return item.type === 'Video Call';\n                    }\n                );\n                return found;\n            },\n\n            addVideoCallIfNeeded: function addVideoCallIfNeeded() {\n                if(!this.findVideoCall()) {\n                    currentDashboard.itemList.push(new Item(6, 8,  'Video Call', {}));\n                }\n            },\n\n            /** Remove an item **/\n            removeItem: function removeItem(id) {\n                angular.forEach(currentDashboard.itemList, function (item, index) {\n                    if (item.id == id)\n                        currentDashboard.itemList.splice(index, 1);\n                })\n            }\n        }\n    });\n})\n    ();\n\n/**  Data access page controller */\n(function () {\n    'use strict';\n    angular\n        .module('tsa.pages.dataAccess')\n        .controller('dataAccessController', dataAccessController);\n\n    function dataAccessController($filter, $log, $http, $window, archiveService, dialogService, userService, AUTHORITIES, Blob, FileSaver) {\n\n        /** Authorisation checking **/\n        if (!userService.checkAuthority(AUTHORITIES.MASTER))\n            return;\n\n        /**---------------- PROPERTIES ----------------**/\n        var vm = this;\n        vm.logger = $log.getInstance(\"data-access-page\");\n        vm.currentMode = \"simple\";\n\n        /**---------------- METHODS ----------------**/\n\n        /**  Send the request to retrieve the archived data\n         *   @param format: json, csv or netcdf\n         */\n        vm.sendRequest = function sendRequest(format) {\n            if (vm.researchInProgress || vm.csvInProgress || vm.netcdfInProgress)\n                return;\n\n            // Step 1: get inputs from the nested components\n            var dateRange = vm.getDateRange();\n            var params = vm.getParams();\n            var variableList = vm.getVariableList();\n\n            if(variableList.length < 1)\n                return;\n\n            // Step 2: define the request\n            function request() {\n                switch (format) {\n                    case 'json': vm.researchInProgress = true; break;\n                    case 'csv': vm.csvInProgress = true; break;\n                    case 'netcdf': vm.netcdfInProgress = true; break;\n                }\n                archiveService.getData(format,\n                    variableList,\n                    dateRange.start,\n                    dateRange.end,\n                    params.maxValues,\n                    params.timeStampingStrategy,\n                    params.intervalOrRef,\n                    params.intervalStampFraction)\n                    .then(\n                    function (response) {\n                        switch (format) {\n                            case 'json':\n                                vm.researchInProgress = false;\n\n                                dialogService.showToast(response.data.length + \" \" + $filter('translate')(\"pages.data-access.frames-received\"));\n                                vm.results = response.data;\n                                break;\n                            case 'csv':\n                                vm.csvInProgress = false;\n                                var data = new Blob([response.data], { type: \"text/csv\" });\n                                FileSaver.saveAs(data, \"table.csv\");\n                                break;\n                            case 'netcdf':\n                                vm.netcdfInProgress = false;\n                                var data = new Blob([response.data], { type: \"application/octet-stream\" });\n                                FileSaver.saveAs(data, \"table.nc\");\n                                break;\n                        }\n                    },\n                    function (error) {\n                        switch (format) {\n                            case 'json': vm.researchInProgress = false; break;\n                            case 'csv': vm.csvInProgress = false; break;\n                            case 'netcdf': vm.netcdfInProgress = false; break;\n                        }\n                        dialogService.showDialog($filter('translate')(\"pages.data-access.error\"), $filter('translate')(\"pages.data-access.error-request-msg\"));\n                        vm.logger.error(angular.isDefined(error.data) ? error.data : angular.isDefined(error.message) ? error.message : 'no message found');\n                    });\n            }\n\n            // Step 3: check params and send the request\n            var dataRequested = (dateRange.end - dateRange.start) / (params.intervalOrRef * 1000);\n            vm.logger.debug(\"Number of data requested: \" + dataRequested);\n            if (dataRequested > params.maxValues) {\n                dialogService.showValidation(\n                    $filter('translate')(\"pages.data-access.warning\"),\n                    $filter('translate')(\"pages.data-access.warning-msg\"),\n                    $filter('translate')(\"pages.data-access.continue\"),\n                    $filter('translate')(\"pages.data-access.cancel\"))\n                    .then(request);\n            }\n            else request();\n        }\n    }\n})();\n\n/***\n * Login page controller\n */\n(function () {\n    'use strict';\n    angular\n        .module('tsa.pages.login')\n        .controller('loginController', loginController);\n\n    function loginController($filter, $log, $rootScope, $scope, $state, $stateParams, userService, dialogService) {\n        var vm = this;\n        vm.logger = $log.getInstance(\"loggin-page\");\n        vm.connectionInProgress = false;\n        vm.logger.log('Authentication, with authority type \"' + $stateParams.authority + '\", is required to access the ' + $stateParams.next + ' page.');\n\n        // Check if there is not already a user connected\n        if (userService.getCurrentUser() != undefined && userService.getCurrentUser().hasAuthority($stateParams.authority))\n            goToNextPage();\n\n        /** Navigate to the next page **/\n        function goToNextPage() {\n            if ($stateParams.next != undefined)\n                $state.go($stateParams.next, $stateParams.nextParams);\n        }\n\n        /** Listen to user connection **/\n        var deregistrationFunction = $rootScope.$on('current-user-changed', function () {\n            if (userService.getCurrentUser() != undefined)\n                goToNextPage();\n        });\n\n        /** Click on login button **/\n        vm.connection = function connection() {\n            if (vm.login !== undefined) {\n                vm.connectionInProgress = true;\n                userService.login(vm.login, vm.password).then(\n                    function () {\n                        vm.connectionInProgress = false;\n                        goToNextPage();\n                    },\n                    function (error) {\n                        vm.connectionInProgress = false;\n                        dialogService.showDialog($filter('translate')(\"components.sidenav.connection-error\"));\n                        vm.logger.error('Authentication error: ' + error.status + ': ' + error.statusText);\n                    });\n            }\n        };\n\n        vm.onKeyPressed = function onKeyPressed(keyEvent) {\n            if (keyEvent.which === 13)\n                vm.connection();\n        };\n\n        $scope.$on(\"$destroy\", function () {\n            deregistrationFunction();\n        })\n    }\n})();\n\n/***\n * Static grid controller: manages the display of a card grid, or a single card.\n */\n(function () {\n    'use strict';\n\n    angular.module('tsa.pages.staticGrid', []) //module declaration \n        .controller('staticGridController', StaticGridController);\n\n    /** @ngInject */\n    function StaticGridController($filter, $log, $scope, staticGridService, userService) {\n\n        /**------------------------------ PROPERTIES -----------------------------**/\n        var vm = this;\n        var logger = $log.getInstance(\"staticGridController\");\n        vm.flex = 100; //Flex value (define size properties): single mode -> 100; multiple mode -> 50\n        vm.cards = staticGridService.getCards();\n        vm.userService = userService;\n        vm.currentNavItemId = staticGridService.getSelectedCardId();\n        vm.service = staticGridService;\n\n        /**------------------------------ PROPERTIES -----------------------------**/\n\n        vm.showRow = function showRow(index) {\n            if (staticGridService.isSingleMode()) {\n                return vm.cards[index][0].id === staticGridService.getSelectedCardId()\n                    || vm.cards[index][1].id === staticGridService.getSelectedCardId()\n                    || vm.cards[index][2].id === staticGridService.getSelectedCardId()\n            }\n            else return true;\n        };\n\n        vm.showCard = function showCard(item) {\n            vm.currentNavItemId = staticGridService.getSelectedCardId(); //update the nav bar\n            switch (staticGridService.getViewMode()) {\n                case staticGridService.MODES.SINGLE:\n                    vm.flex = 100;\n                    return item.id === staticGridService.getSelectedCardId();\n                case staticGridService.MODES.MULTIPLE_4:\n                    vm.flex = 50;\n                    return item.id != vm.cards[0][2].id && item.id != vm.cards[1][2].id;\n                case staticGridService.MODES.MULTIPLE_6:\n                    vm.flex = 33;\n                    return true;\n            }\n        };\n\n        /** Change the card displayed in the single view **/\n        vm.selectCard = function selectCard(rowIndex, index) {\n            staticGridService.setSelectedCardId(vm.cards[rowIndex][index].id);\n        };\n\n        /** Save the static view configuration (autosave) **/\n        $scope.$watch(function () {\n            return {\n                cards: staticGridService.getCards(),\n                mode: staticGridService.getViewMode(),\n                selectedCard: staticGridService.getSelectedCardId()\n            }\n        }, function () {\n            if (angular.isDefined(userService.getCurrentUser())) {\n                userService.getCurrentUser().saveStaticGrid().then(\n                    function success() { logger.info(\"Static grid configuration saved\") },\n                    function error(error) { logger.error('Error: ' + error); });\n            }\n        }, true);\n\n        /** Solution to fix the following bug: when a card title is changed, the 'ink bar' (bottom bar under the selected\n         * button) is not correctly resized. Solution: force a call to the '_updateInkBarStyles' (navBar.js from angular\n         * material sources) with a set of the 'mdSelectedNavItem' parameter ( = 'currentNavItemId' in our context).\n         * Todo: find a better solution to fix this bug\n         **/\n        $scope.$watch(function () { return vm.cards; },\n            function () { vm.currentNavItemId = {}; },\n            true);\n    }\n})();\n\n/**\n * RestService: angular service used to manage the web service requests sent to the acquisition server.\n */\n(function () {\n    'use strict';\n    angular.module(\"tsa.pages.staticGrid\")\n        .factory(\"staticGridService\", function (DEFAULT_STATIC_GRID) {\n\n            var MODES = { SINGLE: 'single', MULTIPLE_4: 'multiple-4', MULTIPLE_6: 'multiple-6' };\n\n            var mode = MODES.MULTIPLE_4;\n\n            var cards = angular.isDefined(DEFAULT_STATIC_GRID) ? DEFAULT_STATIC_GRID : [[\n                { id: 'Card1', type: 'Graphics' },\n                { id: 'Card2', type: 'Numerical' },\n                { id: 'Card5', type: 'Devices' }\n            ], [\n                { id: 'Card3', type: 'Empty' },\n                { id: 'Card4', type: 'Empty' },\n                { id: 'Card6', type: 'Empty' }]\n            ];\n\n            var selectedCardId = cards[0][0].id;\n\n            /** Service API **/\n            return {\n                /** VIEW MODE **/\n                MODES: MODES,\n\n                findVideoCall: function findVideoCall() {\n                    var found = cards[0].find(\n                        function(item) {\n                            return item.type === 'Video Call';\n                        });\n                    found = found || cards[1].find(\n                        function(item) {\n                            return item.type === 'Video Call';\n                        });\n                    return found;\n                },\n\n                addVideoCallIfNeeded: function addVideoCallIfNeeded() {\n                    if(!this.findVideoCall()) {\n                        cards[0][0].type = 'Video Call';\n                    }\n                },\n\n                changeViewMode: function changeViewMode() {\n                    switch (mode) {\n                        case MODES.SINGLE: mode = MODES.MULTIPLE_4; break;\n                        case MODES.MULTIPLE_4: mode = MODES.MULTIPLE_6; break;\n                        case MODES.MULTIPLE_6: mode = MODES.SINGLE; break;\n                    }\n                },\n\n                getViewMode: function getViewMode() {\n                    return mode;\n                },\n\n                setViewMode: function setViewMode(newMode) {\n                    mode = newMode;\n                },\n\n                isSingleMode: function isSingleMode() {\n                    return mode === MODES.SINGLE;\n                },\n\n                /** CARDS **/\n\n                getCards: function getCards() {\n                    return cards;\n                },\n\n                setCards: function setCards(newCards) {\n                    //the object 'cards' is not directly replaced by 'newCards' with an assignation to preserve the\n                    //data binding with the staticGrid controller.\n                    cards[0] = newCards[0];\n                    cards[1] = newCards[1];\n                },\n\n                getSelectedCardId: function getSelectedCardId() {\n                    return selectedCardId;\n                },\n\n                setSelectedCardId: function setSelectedCardId(id) {\n                    selectedCardId = id;\n                }\n\n            }\n        });\n})();\n\n/***\n * Dashboard controller: manage the dashboard view\n */\n(function () {\n    'use strict';\n    angular\n        .module('tsa.pages.tracking')\n        .controller('trackingController', TrackingController);\n\n    /** Dashboard view controller */\n    function TrackingController($filter, $rootScope, userService, dialogService) {\n\n        /**------------------------------ PROPERTIES -----------------------------**/\n\n        var vm = this;\n        vm.userService = userService;\n        vm.cardId=\"1\";\n        vm.config = {\n            \"type\": \"Map\",\n            \"frameId\": \"shipnav\",\n            \"deviceId\": \"TL_SHIPNAV\",\n            \"weatherId\": \"TL_WEATHER\",\n            \"ship\": {\"length\": 107.6, \"beam\": 20, \"xOffset\": 10, \"yOffset\": 50, \"lengthVector\": 15}\n        };\n    }\n})();\n\n(function () {\n  'use strict';\n  angular.module(\"tsa.pages.welcome\",[])\n      .controller('welcomeController', WelcomeController);\n\n    /** @ngInject */\n    function WelcomeController(SHIP_ID, SHOW_EXTRACTION) {\n        var vm = this;\n        vm.ship = SHIP_ID;\n        vm.showExtraction = SHOW_EXTRACTION;\n    }\n\n})();\n\n(function () {\n    'use strict';\n\n    /** Component **/\n    angular.module('tsa.components.card',[]).component('tsaCard', {\n        templateUrl: \"app/components/card/card.html\",\n        controllerAs: \"ctrl\",\n        controller: cardController,\n        bindings: {\n            type: '=',\n            deviceId: '=',\n            config: '=',\n            cardId: '@',\n            titleValue: \"=\",\n            icon: '='\n        }\n    });\n\n    /** Controller **/\n    function cardController($timeout, dialogService) {\n        var vm = this;\n\n        vm.setType = function setType(newView) {\n            //tips to ensure that the displayed component is reloaded even if only the config changes (and not the type)\n            vm.type = null;\n            $timeout(function(){\n                vm.type = newView.view;\n                vm.config = newView.config;\n                vm.titleValue = newView.title;\n                vm.icon = newView.icon;\n            },10)\n        };\n\n        /** Show the 'Change view' dialog and manage the selection **/\n        vm.showChangeViewDialog = function showChangeViewDialog() {\n            dialogService.showSelectView().then(vm.setType);\n        };\n    }\n\n})();\n\n(function () {\n    'use strict';\n    angular.module('tsa.components.console')\n        .component('tsaConsole', {\n            templateUrl: \"app/components/console/console.html\",\n            controller: consoleController,\n            controllerAs: \"ctrl\",\n            bindings: {\n                container: '<'\n            }\n        });\n\n\n    /**\n     * Controller for the dataView component which displays a data and its current value.\n     */\n    function consoleController() {\n\n        var TAG = '[ConsoleController] ';\n        var vm = this;\n        var textArea;\n        var logs = [];\n        var alertLogs = [];\n\n        vm.consoleViews = {\n            LOGS: 'logs',\n            ALERTS: 'alerts',\n            FRAMES: 'frames'\n        };\n        vm.consoleView = vm.consoleViews.LOGS;\n\n\n        vm.$onInit = function () {\n            textArea = document.getElementById('acquisition-textarea');\n            vm.container.addConsole(this);\n        };\n\n\n\n        vm.addText = function addText(msg, level) {\n            console.log(TAG + 'CONSOLE ADD TEXT:' + msg);\n\n            switch (level) {\n                case vm.consoleViews.LOGS:\n                    logs.push(msg);\n                    break;\n                case vm.consoleViews.ALERTS:\n                    logs.push(msg);\n                    alertLogs.push(msg);\n                    break;\n            }\n\n            if (level && vm.consoleView != level)\n                return;\n\n            vm.console += msg + \"\\n\";\n            if (vm.console.length > 50000)\n                vm.console = vm.console.substring(vm.console.length / 3);\n            if (textArea !== undefined)\n                textArea.scrollTop = textArea.scrollHeight;\n\n        };\n\n        /**\n         * Method called when a new console tab is selected.\n         */\n        vm.changeConsole = function changeConsole(value) {\n            vm.console = \"\";\n            vm.consoleView = value;\n\n            var logsToDisplay = [];\n            switch (vm.consoleView) {\n                case vm.consoleViews.LOGS:\n                    logsToDisplay = logs;\n                    break;\n                case vm.consoleViews.ALERTS:\n                    logsToDisplay = alertLogs;\n                    break;\n            }\n\n            angular.forEach(logsToDisplay, function (log) {\n                vm.addText(log);\n            });\n        };\n\n        /**\n         * Called whenever one-way bindings (dataId, frameId, deviceId) are updated.\n         * Used for initialization.\n         */\n        /*        vm.$onChanges = function () {\n         };*/\n\n        /**\n         * Called when the view is destroyed.\n         */\n        /*    vm.$onDestroy = function onDestroy() {\n         }*/\n    }\n})();\n\n\n(function () {\n    'use strict';\n\n    /** Component **/\n    angular.module('tsa.components.dataView', [])\n        .component('tsaDataView', {\n            templateUrl: \"app/components/dataView/dataView.html\",\n            controller: dataViewController,\n            controllerAs: \"ctrl\",\n            bindings: {\n                dataId: '<data', //!\\ Warning: do not specify a property that could create conflicts with the global html5 property: 'data-*' /!\\\n                frameId: '<',\n                deviceId: '<',\n                optTitle: '@',\n                optSubtitle: '<',\n                optValue: '<',\n                onUpdateTitle: '&',\n                titleDisabled: '<',\n                showSubtitle: '<',\n                abs: '<',\n                onOff: '<',\n                multiplier: '<',\n                redGreen: '<',\n                alertValue: '<',\n                format: '@',\n                units: '@'\n            }\n        });\n\n    /** Controller **/\n    function dataViewController(acquisitionService, formatterService, statusService, $interval) {\n        var vm = this;\n\n        /**------------------------------ PROPERTIES -------------------------------**/\n\n        /** Properties **/\n        var watchdogInterval;\n        var lastTimestamp;\n        var dataListener;\n        var missingValueReceived;\n\n        /** View properties */\n        vm.title = '';\n        vm.subtitle = '';\n        vm.value = '-';\n        vm.dataMissing = false;\n        vm.frontColor = '';\n\n        /**-------------------------- INITIALIZATION / DESTROY METHODS -------------------------**/\n\n        /** Init function: launch the watchdog to check data reception **/\n        vm.$onInit = function () {\n            watchdogInterval = $interval(watchdog, 500);\n        };\n\n        /** OnChanges: Called whenever one-way bindings (dataId, frameId, deviceId, optValue...) are updated. */\n        vm.$onChanges = function (changesObj) {\n\n            // Case 1: dataId, frameId and deviceId are specified\n            if (changesObj['dataId'] || changesObj['frameId'] || changesObj['deviceId']) {\n                unregister(); //unregister for previous data\n                register();\n            }\n\n            //Case 2: value and title are directly specified in parameters\n            if (changesObj['optValue']) {\n            \tif(angular.isDefined(changesObj['optValue'].currentValue)) {\n                    updateValue(vm.optValue);\n            \t} else {\n            \t\tvm.value = '';\n            \t}\n            }\n            if (changesObj['optTitle'] && angular.isDefined(changesObj['optTitle'].currentValue))\n                vm.title = vm.optTitle;\n            if (changesObj['optSubtitle'] && angular.isDefined(changesObj['optSubtitle'].currentValue))\n                vm.subtitle = vm.optSubtitle;\n        };\n\n        /** Called when the view is destroyed. */\n        vm.$onDestroy = function onDestroy() {\n            unregister();\n            $interval.cancel(watchdogInterval);\n        };\n\n        /**--------------------------  METHODS -------------------------**/\n\n        /** Register for the selected data **/\n        function register() {\n            if (angular.isDefined(vm.dataId) && angular.isDefined(vm.frameId) && angular.isDefined(vm.deviceId)) {\n                vm.device = acquisitionService.registerForDevice(vm.deviceId);\n                updateTitle();\n                dataListener = vm.device.registerForData(vm.frameId, vm.dataId);\n                dataListener.promise.then({}, {},\n                    function callback(result) {\n                        lastTimestamp = result.timestamp;\n                        updateTitle();\n                        updateValue(result.value);\n                    });\n            }\n            else {\n                updateTitle();\n            }\n        }\n\n        /** Unregister for the data, and reset fields **/\n        function unregister() {\n            if (vm.device != undefined && dataListener != undefined)\n                vm.device.unregisterForData(dataListener);\n            vm.device = undefined;\n            vm.title = vm.subtitle = '';\n            vm.subtitle = '';\n            vm.value = '';\n            vm.dataMissing = false;\n            missingValueReceived = undefined;\n        }\n\n\n        /** Update value  */\n        function updateValue(newValue) {\n            var desc = getDataDescription();\n\n            // Get units and format (component parameters are used in priority)\n            var units = angular.isDefined(vm.units) ? vm.units : angular.isDefined(desc) ? desc.shortUnits : undefined;\n            var format = angular.isDefined(vm.format) ? vm.format : angular.isDefined(desc) ? desc.cFormat : undefined;\n\n            // Force the format for coordinates and time values\n            if (vm.dataId == 'lat' || vm.dataId == 'long' || vm.dataId == 'time')\n                format = vm.dataId;\n\n            // Set value\n            vm.value = getFormattedValue(newValue, format, units, vm.multiplier, vm.abs, vm.onOff);\n\n            // Determinate if the value == \"missingValue\"\n            missingValueReceived = (angular.isDefined(desc) && angular.isDefined(desc.missingValue)) ? newValue == desc.missingValue : false;\n\n            if(!missingValueReceived && vm.redGreen) {\n                vm.frontColor = '';\n                if(Math.abs(Math.round(newValue))>0) {\n                    if(newValue > 0) {\n                        vm.frontColor = 'green';\n                    } else {\n                        vm.frontColor = 'red';\n                    }\n                }\n            }\n\n            if  (vm.alertValue && newValue < vm.alertValue) {\n                vm.frontColor = 'alert';\n            } else {\n                vm.frontColor = '';\n            }\n        }\n\n        /** Update title and subtitle */\n        function updateTitle() {\n            var desc = getDataDescription();\n            vm.title = (vm.optTitle && vm.optTitle != '') ? vm.optTitle : angular.isDefined(desc) ? desc.longName : vm.dataId;\n            if (angular.isDefined(vm.deviceId) + angular.isDefined(vm.frameId))\n                vm.subtitle = vm.deviceId + ' - ' + vm.frameId;\n            else if (angular.isDefined(vm.optSubtitle)) {\n                vm.subtitle = vm.optSubtitle;\n            }\n        }\n\n        /* Get the data description (provided by REST service)*/\n        function getDataDescription() {\n            if (angular.isUndefined(vm.device)\n                || angular.isUndefined(vm.device.frameList)\n                || angular.isUndefined(vm.device.frameList[vm.frameId])\n                || angular.isUndefined(vm.device.frameList[vm.frameId][vm.dataId]))\n                return undefined;\n            return vm.device.frameList[vm.frameId][vm.dataId];\n        }\n\n        /** Get the value formatted and with units **/\n        function getFormattedValue(value, format, units, multiplier, abs, onOff) {\n\n            if (Array.isArray(value))   // Display the length if the value is an array\n                return value.length + (value.length > 0 ? ' values' : 'value');\n\n            if (angular.isDefined(multiplier)) // Apply multiplier\n                value *= multiplier;\n\n            if (angular.isDefined(abs)) // Get absolute value\n                value = Math.abs(value);\n\n            if(angular.isDefined(onOff) && onOff) {\n                value = value > 0 ? 'On' : 'Off';\n            } else {\n                if (angular.isDefined(format)) { //Apply format\n                    switch (format) {\n                        case 'excelDate': value = formatterService.parseExcelDateDefaultToString(value, 'UTC'); break;\n                        case 'excelDateNoSec': value = formatterService.parseExcelDateNoSecToString(value, 'UTC'); break;\n                        case 'excelDateNoSecTZ': value = formatterService.parseExcelDateNoSecToString(value, statusService.getLocalTimeZoneOffset()); break;\n                        case 'lat': value = formatterService.parseLatToString(value); break;\n                        case 'long': value = formatterService.parseLongToString(value); break;\n                        case 'qualityFbx': value = formatterService.parseQualityFbxToString(value); break;\n                        case 'marineDistance': (Math.abs(value)<1852) ? units=\"m\" : units=\"nm\";\n                            value = formatterService.parseMarineDistance(value);\n                            value = sprintf(\"%.1f\", value); break;\n                        case 'time': value = formatterService.parseTimeToString(value); break;\n                        default:\n                            value = sprintf(format, value);\n                            break;\n                    }\n                }\n\n                if (angular.isDefined(units)) //Add units\n                    value += ' ' + units;\n            }\n            return value;\n        }\n\n        /** Watch the data reception **/\n        function watchdog() {\n            var currentDate = statusService.getServerTime().time;\n            vm.dataMissing = angular.isDefined(vm.device) &&\n                ((angular.isUndefined(lastTimestamp) || currentDate - lastTimestamp > 5 * vm.device.periodList[vm.frameId] && vm.optValue == undefined)\n                    || missingValueReceived);\n        }\n\n    }\n})();\n\n(function () {\n    'use strict';\n\n    /** Component **/\n    angular.module('tsa.components.doubleDataView', [])\n        .component('tsaDoubleDataView', {\n            templateUrl: \"app/components/doubleDataView/doubleDataView.html\",\n            controller: doubleDataViewController,\n            controllerAs: \"ctrl\",\n            bindings: {\n                title: '@',\n                dataId1: '<data1', //!\\ Warning: do not specify a property that could create conflicts with the global html5 property: 'data-*' /!\\\n                frameId1: '<',\n                deviceId1: '<',\n                dataId2: '<data2', //!\\ Warning: do not specify a property that could create conflicts with the global html5 property: 'data-*' /!\\\n                frameId2: '<',\n                deviceId2: '<',\n                format1: '@',\n                format2: '@',\n                optValue1: '<',\n                optValue2: '<'\n            }\n        });\n\n    /** Controller **/\n    function doubleDataViewController() {\n        var vm = this;\n    }\n})();\n\n\n(function () {\n    'use strict';\n\n    /** Component **/\n    angular.module('tsa.components.navbar', [])\n        .component('tsaNavbar', {\n            templateUrl: \"app/components/navbar/navbar.html\",\n            controller: navbarController,\n            controllerAs: \"navbar\"\n        })\n        .controller('TimePopupPanelCtrl', TimePopupPanelCtrl);\n\n    /** Controller **/\n    function navbarController($location, $window, $rootScope, $translate, $mdSidenav, $scope,\n        AUTHORITIES, dialogService, localeService, statusService, userService, themeService,\n                              stompService, messagingService, $interval, $mdPanel, ENABLE_CHAT,\n                              ENABLE_VIDEOCALL, videoCallService) {\n\n\n        $rootScope.$on('$translateChangeSuccess', function (event, data) {// ON LANGUAGE CHANGED\n            vm.currentLocaleImg = localeService.getCurrentLocale().img;\n        });\n\n        //init messaging service and set interval for getting the last message\n        if(ENABLE_CHAT)\n            $interval(messagingService.getLastMessage,10000);\n\n        if(ENABLE_VIDEOCALL)\n            videoCallService.init();\n\n        /**------------------------------ PROPERTIES -----------------------------**/\n        var vm = this;\n\n        vm._mdPanel = $mdPanel;\n        vm.ENABLE_CHAT = ENABLE_CHAT;\n\n        /** Locale properties **/\n        vm.locales = localeService.getLocaleList();\n\n        /**------------------------------ METHODS -----------------------------**/\n\n        /** Init function **/\n        vm.$onInit = function init() {\n            vm.serverTime = statusService.getServerTime();\n            vm.statusService = statusService;\n            vm.theme = themeService.getTheme();\n            vm.currentLocaleImg = localeService.getCurrentLocale().img;\n            vm.currentUserProvider = userService.getCurrentUserProvider();\n            vm.connected = stompService.isConnected() && statusService.isConnected();\n        };\n\n        vm.openSidenav = function () {\n            $mdSidenav('left').toggle();\n        };\n\n        vm.changeDayMode = function changeDayMode() {\n            if (vm.theme.id === themeService.THEME.DAY.id) {\n                themeService.setTheme(themeService.THEME.NIGHT);\n            }\n            else {\n                themeService.setTheme(themeService.THEME.DAY);\n            }\n\n            if (angular.isDefined(userService.getCurrentUser()))\n                userService.getCurrentUser().saveTheme(vm.theme);\n        };\n\n        vm.changeLocale = function changeLocale(locale) {\n            localeService.setCurrentLocale(locale);\n            if (angular.isDefined(userService.getCurrentUser()))\n                userService.getCurrentUser().saveLanguage(locale.id);\n        };\n\n        vm.isWelcomePage = function isWelcomePage() {\n            return $location.path() === '/welcome';\n        };\n\n        vm.goToHelpPage = function goToHelpPage() {\n            $window.open('/online-help-' + $translate.use() + '.html', '_blank');\n            //$window.open('/online-help-' + $scope.locale + '.html', '_blank');\n        };\n\n        //the message window is available only through an admin connection or by password defined in MessagingAccess service\n        vm.openMessagingWindow = function openMessagingWindow() {\n            //check if user is login\n            if (angular.isDefined(userService.getCurrentUser())){\n                var user=userService.getCurrentUser();\n                //check if the user has admin role\n                if (user.hasAuthority(AUTHORITIES.ADMIN)===true){\n                    dialogService.showMessaging();\n                } else{\n                    dialogService.showMessagingAccess();\n                }\n            } else {\n                dialogService.showMessagingAccess();\n            }\n        };\n\n        vm.isSDIVUserAndStaticView = function isSDIVUserAndStaticView() {\n            if (angular.isDefined(userService.getCurrentUser()) && $location.path() === '/static')\n                return userService.getCurrentUser().hasAuthority(AUTHORITIES.SDIV);\n            else return false;\n        };\n\n        vm.showTimes = function(ev) {\n            var position = this._mdPanel.newPanelPosition()\n            .relativeTo('.show-time-button')\n            .addPanelPosition(this._mdPanel.xPosition.ALIGN_START, this._mdPanel.yPosition.BELOW);\n\n            var times = [\n                { name:'Mtropole', tz: 'Europe/Paris' },\n                { name: 'Noumea', tz: 'Pacific/Noumea'},\n                { name: 'La Runion', tz: 'Indian/Reunion'},\n                { name: 'Tahiti', tz: 'Pacific/Tahiti'},\n                { name: 'Martinique', tz: 'America/Martinique'},\n                { name: 'Saint Pierre et Miquelon', tz: 'America/Miquelon'},\n                { name: 'Guyanne', tz: 'America/Guyana'}\n            ];\n\n            var config = {\n                attachTo: angular.element(document.body),\n                controller: TimePopupPanelCtrl,\n                controllerAs: 'ctrl',\n                template:\n                    '<div class=\"navbar-time-popup tzp\" ' +\n                    '     role=\"listbox\">' +\n                    '  <div class=\"\" ng-if=\"ctrl.statusService.getLocalTimeZoneOffset()\" ' +\n                    '       role=\"option\">' +\n                    '    {{ ctrl.serverTime.time | date: \\\"HH:mm\\\" : ctrl.statusService.getLocalTimeZoneOffset() }} - Local' +\n                    '  </div> '  +\n                    '  <div class=\"\" ' +\n                    '       role=\"option\" ' +\n                    '       ng-repeat=\"time in ctrl.times\"> ' +\n                    '    {{ ctrl.changeTimezone(ctrl.serverTime.time, time.tz) | date: \\\"HH:mm\\\" }} - {{ time.name }}' +\n                    '  </div>' +\n                    '</div>',\n                panelClass: 'navbar-time-popup',\n                position: position,\n                locals: {\n                    'times': times,\n                    'serverTime': this.serverTime,\n                    'statusService': this.statusService,\n                    'changeTimezone': this.changeTimezone\n                },\n                openFrom: ev,\n                clickOutsideToClose: true,\n                escapeToClose: true,\n                focusOnOpen: false,\n                zIndex: 2\n            };\n\n            this._mdPanel.open(config);\n        };\n    }\n\n    function TimePopupPanelCtrl(mdPanelRef, statusService) {\n        this._mdPanelRef = mdPanelRef;\n        this.serverTime = statusService.getServerTime();\n        this.statusService = statusService;\n\n        this.changeTimezone = function(time,iana) {\n            var date = new Date();\n            date.setTime(time);\n\n            // suppose the date is 12:00 UTC\n            var invdate = new Date(date.toLocaleString('en-US', {\n               timeZone: iana\n            }));\n\n            // then invdate will be 07:00 in Toronto\n            // and the diff is 5 hours\n            var diff = time - invdate.getTime();\n\n            // so 12:00 in Toronto is 17:00 UTC\n            return time - diff;\n        }\n\n    }\n\n    TimePopupPanelCtrl.prototype.closeDialog = function() {\n        var panelRef = this._mdPanelRef;\n\n        panelRef && panelRef.close().then(function() {\n          angular.element(document.querySelector('.show-time-button')).focus();\n          panelRef.destroy();\n        });\n    };\n\n})();\n\n(function () {\n    'use strict';\n\n    /** Component **/\n    angular.module('tsa.components.settingsButton', [])\n        .component('tsaSettingsButton', {\n            templateUrl: \"app/components/settingsButton/settingsButton.html\",\n            controller: settingsButtonController,\n            controllerAs: \"ctrl\",\n            bindings: {\n                cardId: '@',\n                onChangeView: '&',\n                validCloseTitle: '@',\n                validCloseMsg: '@'\n            }\n        });\n\n    /** Controller **/\n    function settingsButtonController(dashboardService, staticGridService, dialogService, $location, $filter) {\n        var vm = this;\n\n        /** Show the 'Change view' dialog and manage the selection **/\n        vm.showChangeViewDialog = function showChangeViewDialog() {\n\n            dialogService.showSelectView().then(function (response) {\n                if(response.view === 'Video Call' && staticGridService.findVideoCall()) {\n                    dialogService.showToast($filter('translate')(\"views.video-call.duplicate.message\"));\n                } else {\n                    console.debug('[SettingsButton] --> vm.onChangeView: type = ' + response.view + ' ; deviceId = ' + response.deviceId);\n                    vm.onChangeView({type: response});\n                }\n            });\n        };\n\n        /** Click on the delete button **/\n        vm.deleteClick = function deleteClick() {\n            if (vm.cardId !== undefined) {\n                if (vm.validCloseTitle !== undefined && vm.validCloseTitle !== '') {\n                    dialogService.showValidation(\n                        vm.validCloseTitle,\n                        vm.validCloseMsg)\n                        .then(\n                            function accept() {\n                                dashboardService.removeItem(vm.cardId);\n                            },\n                            function decline() {\n                                // do nothing\n                            }\n                        );\n                } else {\n                    dashboardService.removeItem(vm.cardId);\n                }\n            }\n        };\n\n        /** Check if the current page is '/static' **/\n        vm.isStaticPage = function isStaticPage() {\n            return $location.path() == '/static';\n        };\n    }\n})();\n\n\n(function () {\n    'use strict';\n\n    /** Component: left side navigation bar **/\n    angular.module('tsa.components.sidenav', [])\n        .component('tsaSidenav', {\n            templateUrl: \"app/components/sidenav/sidenav.html\",\n            controller: sidenavController,\n            controllerAs: \"ctrl\"\n        });\n\n    /** Controller **/\n    function sidenavController($filter, $location, $mdSidenav, $rootScope, $scope, dialogService, userService,\n        SHOW_EXTRACTION, SHOW_STATICGRID, SHOW_TRACKING) {\n        var TAG = \"[sidenavController] \";\n\n        /**-------------------- View-model properties ----------------**/\n        var vm = this;\n        vm.connectionInProgress = false;\n        vm.isConnected = false;\n\n        vm.routeList = [];\n\n        var routeIndex = 0;\n\n        if(SHOW_STATICGRID) {\n            vm.routeList.push({ title: \"static-grid.title\", sref: \"static\", icon: \"border_all\", isSelected: true });\n            vm.staticgrid_index = routeIndex++;\n        }\n\n        vm.routeList.push({ title: \"dashboard.title\", sref: \"dashboard\", icon: \"dashboard\", isSelected: false });\n        vm.dashboard_index = routeIndex++;\n\n        if(SHOW_TRACKING) {\n            vm.routeList.push({ title: \"tracking.title\", sref: \"tracking\", icon: \"developer_board\", isSelected: false });\n            vm.tracking_index = routeIndex++;\n        }\n\n        vm.routeList.push({ title: \"acquisition.title\", sref: \"acquisition\", icon: \"settings_input_component\", isSelected: false });\n        vm.acquisition_index = routeIndex++;\n\n        if(SHOW_EXTRACTION) {\n            vm.routeList.push({ title: \"data-access.title\", sref: \"dataAccess\", icon: \"file_download\", isSelected: false });\n            vm.dataaccess_index = routeIndex++;\n        }\n\n        /**-------------------- Private methods ----------------**/\n        function refreshButtonList() {\n            //Set the button list depending on the state\n            angular.forEach(vm.routeList, function (route) {\n                route.isSelected = false;\n            });\n            switch ($location.path()) {\n                case \"/static\":\n                    vm.routeList[vm.staticgrid_index].isSelected = true;\n                    break;\n                case \"/dashboard\":\n                    vm.routeList[vm.dashboard_index].isSelected = true;\n                    break;\n                case \"/tracking\":\n                    vm.routeList[vm.tracking_index].isSelected = true;\n                    break;\n                case \"/acquisition\":\n                    vm.routeList[vm.acquisition_index].isSelected = true;\n                    break;\n                case \"/dataAccess\":\n                    vm.routeList[vm.dataaccess_index].isSelected = true;\n                    break;\n            }\n        }\n\n        function getCurrentUser() {\n            if (userService.getCurrentUser() != undefined) {\n                vm.connectionInProgress = false;\n                vm.isConnected = true;\n                vm.currentUser = userService.getCurrentUser();\n            }\n        }\n\n        $scope.$on('$locationChangeSuccess', function () {\n            refreshButtonList();\n        });\n\n        $rootScope.$on('current-user-changed', function () {\n            getCurrentUser();\n        });\n\n        /**-------------------- View-model methods ----------------**/\n\n        /**\n         * Initialization function\n         */\n        vm.$onInit = function () {\n            refreshButtonList();\n            getCurrentUser();\n        };\n\n        /**\n         * Connection: called when the user try to log in.\n         */\n        vm.connection = function connection() {\n            if (vm.login !== undefined) {\n                vm.connectionInProgress = true;\n                userService.login(vm.login, vm.password).then(\n                    function () {\n                        console.debug(TAG + 'successful connection');\n                        vm.connectionInProgress = false;\n                        vm.isConnected = true;\n                        vm.currentUser = userService.getCurrentUser();\n                    },\n                    function (error) {\n                        console.error(TAG + $filter('translate')(\"components.sidenav.connection-error\") + ': ' + error.status + ': ' + error.statusText);\n                        dialogService.showDialog($filter('translate')(\"components.sidenav.connection-error\"));\n                        vm.connectionInProgress = false;\n                    });\n            }\n        };\n\n        vm.disconnection = function disconnection() {\n            userService.logout();\n            vm.isConnected = false;\n            vm.login = '';\n            vm.password = '';\n            vm.currentUser = undefined;\n        };\n\n        vm.closeSidenav = function closeSidenav() {\n            $mdSidenav('left').close();\n        };\n\n        /** Check press on the enter key **/\n        vm.onKeyPressed = function onKeyPressed(keyEvent) {\n            if (keyEvent.which === 13)\n                vm.connection();\n        };\n    }\n})();\n\n/** # QGIS SERVICE\n *\n * Provides methods to retrieve qgis data.\n */\n(function () {\n    'use strict';\n    angular.module(\"tsa.services\").factory(\"qgisService\", QGISService);\n\n    function QGISService($q, $log, restService) {\n\n        var getCapabilities = function() {\n            return restService.getQGISCapabilities().then(function(response) {\n                return response.data;\n            });\n        };\n\n        var pushQGISProject = function(file) {\n            return restService.updateQGISProject(file).then(function(response) {\n                console.log(response);\n            });\n        };\n\n\n        return {\n            getCapabilities: getCapabilities,\n            pushQGISProject: pushQGISProject\n        };\n    }\n\n})();\n\n/** # ACQUISITION SERVICE\n\nThis service manages the connection with the server and the device list.\nAfter a registration to a device, it's possible to register for the reception of its frames/data.\n\n## EXAMPLES\n\n### Register for a specific device\n```javascript\nvar device = acquisitionService.registerForDevice(DEVICE_ID);\n```\n\n### Listen a specific data\n\n```javascript\n//STEP 1: register for data\nvar deferred = device.registerForData(this.frameId, this.dataId);\n\n//STEP 2: get the received values (attach a callback to the deferred object's promise)\ndeferred.promise.then({}, {},\n    function callback(data) {\n        console.log(\"Data : timestamp = \" + data.timestamp + \", value = \" + data.value);\n    });\n\n//STEP 3: when the data is no longer listened, don't forget the unregistration!\ndevice.unregisterForData(deferred);\n```\n\n### Listen a specific frame\n\n```javascript\n//STEP 1: register for frame\nvar deferred = device.registerForFrame(this.frameId);\n\n//STEP 2: get the received values (attach a callback to the deferred object's promise)\ndeferred.promise.then({}, {},\n    function callback(frame) {\n        var timestamp = frame.timestamp;\n        var data1 = frame.value[DATA_ID_1];\n        var data2 = frame.value[DATA_ID_2];\n        var data3 = frame.value[DATA_ID_3];\n    });\n\n//STEP 3: when the frame is no longer listened, don't forget the unregistration!\ndevice.unregisterForFrame(deferred);\n```\n\n */\n(function () {\n    'use strict';\n    angular.module(\"tsa.services\").factory(\"acquisitionService\", AcquisitionService);\n\n    function AcquisitionService($q, $interval, $log, stompService, restService, TOPICS, Device) {\n        var logger = $log.getInstance(\"acquisitionService\");\n\n        /*!------------------------------  PROPERTIES  -------------------------------**/\n        var deviceList = {};\n        var deviceListListeners = [];\n        var lastConfMsgTimestamp = undefined;\n\n        /*!------------------------------ PRIVATE METHODS -------------------------------**/\n\n        /* Initialisation function **/\n        (function init() {\n            logger.debug(\"init...\");\n            //Config message watch dog: disable devices if the configuration message is no longer received\n            $interval(function () {\n                if (angular.isDefined(lastConfMsgTimestamp) && new Date().getTime() - lastConfMsgTimestamp > 60000) {\n                    angular.forEach(deviceList, function (device) {\n                        device.setEnable(false);\n                    });\n                }\n            }, 1000);\n            //Start the stomp service\n            stompService.start();\n            stompService.registerForTopic(TOPICS.CONFIG).promise.then({}, {}, configurationCallback);\n        })();\n\n\n        /*! Get the device with the specified Id, if it does not exist: create it **/\n        function getOrCreateDevice(deviceId) {\n            if (deviceList[deviceId] === undefined) {\n                deviceList[deviceId] = new Device(deviceId);\n                notifyDeviceListChanges();\n            }\n            return deviceList[deviceId];\n        }\n\n        /*! Configuration callback: executed when a configuration message is received,\n         * refresh the devices with the received information. **/\n        function configurationCallback(message) {\n            logger.debug(\"configuration message received\");\n            lastConfMsgTimestamp = new Date().getTime();\n            var deviceConfigList = JSON.parse(message.data.body);\n            if (angular.isDefined(deviceConfigList) && deviceConfigList != null) {\n\n                //For each device into the config message, the corresponding device is updated.\n                angular.forEach(deviceConfigList, function (deviceConfig) {\n                    {\n                        //Get or create a device\n                        var device = getOrCreateDevice(deviceConfig.deviceId);\n                        //Set the device properties\n                        device.name = deviceConfig.name;\n\n                        //Get frame descriptions\n                        //TODO: manage the case where the frame descriptions change (remove the obsolete frames, update them if needed...)\n                        angular.forEach(deviceConfig.frames, function (frame) {\n                            if (device.frameList[frame.name] == undefined) {\n                                device.frameList[frame.name] = {};\n                                restService.getDescription(frame.name).then(function (frame) {\n                                    device.periodList[frame.name] = frame.period * 1000;\n                                    angular.forEach(frame.data, function (d) {\n                                        // Get description for data found in the received device config.\n                                        device.frameList[frame.name][d.name] = d;\n                                    })\n                                })\n                            }\n                        });\n                        //The device is present in the config message:\n                        device.isInConfigMsg = true;\n                    }\n                });\n\n                //disable the devices if they are not in the config message\n                angular.forEach(deviceList, function (device) {\n                    device.setEnable(device.isInConfigMsg);\n                    if (!device.isInConfigMsg && device.listenerCount < 1)\n                        delete deviceList[device.id];\n                    else delete device.isInConfigMsg;\n                });\n                notifyDeviceListChanges();\n            }\n        }\n\n        /*! Notify listeners about topic list changes **/\n        function notifyDeviceListChanges() {\n            angular.forEach(deviceListListeners, function (listener) {\n                listener.notify(deviceList);\n            });\n        }\n\n        /*!------------------------------ PUBLIC METHODS -------------------------------**/\n        /* ## PUBLIC METHODS */\n        return {\n\n            /**Get the devices managed by the service. */\n            getDeviceList: function getDeviceList() {\n                return deviceList;\n            },\n\n            /**Get enable devices (=received in the configuration message) */\n            getEnabledDeviceList: function getEnabledDeviceList() {\n                var enabledDeviceList = {};\n                angular.forEach(deviceList, function (device, deviceId) {\n                    if (device.isEnabled)\n                        enabledDeviceList[deviceId] = device;\n                });\n                return enabledDeviceList;\n            },\n\n            /** Registration for device list modifications.\n            *@returns {deferred} object with promise which will be notified when device list modification occurs\n            */\n            registerForDeviceList: function registerForDeviceList() {\n                var deferred = $q.defer();\n                deviceListListeners.push(deferred);\n                return deferred;\n            },\n\n            /** Unregistration for device list modifications.\n             *@param {deferred} deferred object provided during the registration\n             */\n            unregisterForDeviceList: function unregisterForDeviceList(deferred) {\n                angular.forEach(deviceListListeners, function (listener) {\n                    if (Object.is(listener, deferred)) {\n                        deferred.resolve();\n                        deviceListListeners.splice(deviceListListeners.indexOf(listener), 1);\n                    }\n                });\n            },\n\n            /** Registration for device: get or create the device if it'doesn't exist.\n            *@param {string} deviceId unique device id\n            *@return {Device} device object\n            */\n            registerForDevice: function registerForDevice(deviceId) {\n                var device = getOrCreateDevice(deviceId);\n                device.listenerCount++;\n                return device;\n            },\n\n            /** Unregistration for device\n            *@param {string} deviceId\n            */\n            unregisterForDevice: function unregisterForDevice(deviceId) {\n                if (angular.isDefined(deviceList[deviceId]))\n                    deviceList[deviceId].listeners--;\n            }\n        };\n    }\n})();\n\n/** # ACQUISITION BUFFER SERVICE\n *\n * This service records and stores data in buffers.\n * >Avoid to use directly this service, use the acquisitionService, and the Device class methods (recordData, getData...)\n */\n(function () {\n  'use strict';\n\n  angular.module(\"tsa.services\")\n    .factory(\"acquisitionBufferService\", function ($log, $q, archiveService, statusService) {\n      var logger = $log.getInstance(\"acquisitionBufferService\");\n\n      var defaultMaxSamples = 1200;\n      var dataList = {};\n\n      /*! -------------------------- FRAME ----------------------------*/\n      /*! Object with a timestamp and a value.                         */\n      function Frame(timestamp, value) {\n        this.timestamp = timestamp;\n        this.value = Array.isArray(value) ? value.length : parseFloat(value);\n      }\n\n      /*! ------------------------ BUFFER -----------------------------*/\n      /*! Object which manages a list of frame.                        */\n      function Buffer(scaleInSec, maxSamples, device, frameId, dataId) {\n        // buffer configurations\n        this.scale = scaleInSec * 1000;\n        this.maxSamples = maxSamples;\n        this.bufferPeriod = this.scale / maxSamples;\n        this.device = device;\n        this.frameId = frameId;\n        this.dataId = dataId;\n\n        // frame list\n        this.frames = [];\n        this.lastFrame = undefined;\n      }\n\n      /*! Add new frame **/\n      Buffer.prototype.addFrame = function addFrame(timestamp, value, isInRealTime) {\n        var self = this;\n        var currentFrame = new Frame(timestamp, value);\n        var lastFrameStored = self.frames[self.frames.length - 1];\n\n        if (lastFrameStored === undefined) {\n          self.frames.push(currentFrame);\n        }\n        else {\n          // remove frames which are outside the scale (*1.5)\n          angular.forEach(self.frames, function (frame, key) {\n            if ((currentFrame.timestamp - frame.timestamp) > (1.5 * self.scale)) {\n              self.frames.splice(key, 1);\n            }\n          }, self);\n\n          // Add a new frame if it necessary (it depends of the period defined by the scale and the maxSamples of the buffer)\n          if ((currentFrame.timestamp - lastFrameStored.timestamp) >= self.bufferPeriod) {\n\n            // if no frame has been received since five device period, add a null frame to represent the missing data\n            if (isInRealTime && ((currentFrame.timestamp - self.lastFrame.timestamp) > 5 * self.device.period)) {\n              self.frames.push(new Frame(timestamp, null));\n              //console.error(\"MISSING VALUE ADDED!\")\n            }\n\n            self.frames.push(currentFrame);\n\n            while (self.frames.length > self.maxSamples)\n              self.frames = self.frames.slice(1);\n          }\n        }\n        self.lastFrame = currentFrame;\n      };\n\n      /*! Send a request to get the archived frames */\n      Buffer.prototype.loadArchivedFrames = function loadArchivedFrames() {\n        var self = this;\n        var startDate = statusService.getServerTime().time - self.scale;\n        var endDate = angular.isDefined(self.frames[0]) ? self.frames[0].timestamp : statusService.getServerTime().time;\n\n        if (self.loadArchivedFramesExecuted || startDate >= endDate)\n          return $q.reject('Load archived data is useless, buffer is already full or the request has already been sent!');\n        self.loadArchivedFramesExecuted = true;\n\n        var period = (self.bufferPeriod < self.device.period) ? self.device.period : ((self.bufferPeriod > 1000) ? self.bufferPeriod : 1000);\n        var resultPromise = archiveService.getDataSimple(self.dataId, self.frameId, self.device.id, startDate, endDate, self.maxSamples, period/1000);\n        resultPromise.then(\n          function successCallback(result) {\n            if (result.data != undefined && result.data.length > 0) {\n              var oldBufferDescription = self.getStringDetails();\n              var tmpFrames = self.frames;\n              self.frames = [];\n              self.lastFrame = undefined;\n\n              //Add archived frames\n              angular.forEach(result.data, function (data) {\n                self.addFrame(data.time, data[self.device.id + '!' + self.frameId + '!' + self.dataId]);\n              }, self);\n\n              //Add frames which was already in the buffer before the loading of archived data\n              angular.forEach(tmpFrames, function (data) {\n                self.addFrame(data.timestamp, data.value);\n              }, self);\n\n              logger.debug(\"\\nDATA RECEIVED: \" + result.data.length + \" data; first: \" + new Date(result.data[0].time).toUTCString() + \"; last: \" + new Date(result.data[result.data.length - 1].time).toUTCString()\n                + \"\\nBUFFER BEFORE: \" + oldBufferDescription\n                + \"\\nBUFFER AFTER: \" + self.getStringDetails());\n            }\n            else logger.error('no result found');\n          });\n\n        return resultPromise;\n      };\n\n      /*! Get a description of the buffer */\n      Buffer.prototype.getStringDetails = function getStringDetails() {\n        if (this.frames.length > 0) {\n          var startFrameTimestamp = new Date(this.frames[0].timestamp);\n          var startFrameHours = startFrameTimestamp.getUTCHours() + ':' + startFrameTimestamp.getUTCMinutes() + ':' + startFrameTimestamp.getUTCSeconds();\n\n          var endFrameTimestamp = new Date(this.frames[this.frames.length - 1].timestamp);\n          var endFrameHours = endFrameTimestamp.getUTCHours() + ':' + endFrameTimestamp.getUTCMinutes() + ':' + endFrameTimestamp.getUTCSeconds();\n        }\n\n        return \"Buffer \" + this.scale / 1000 + \" sec: frames = \" + this.frames.length + \"; first = \" + startFrameHours + \"; last = \" + endFrameHours;\n      };\n\n\n      /*! -------------------------- DATA -----------------------------*/\n      /*! Manages a buffer list.                                       */\n      function Data(device, frameId, dataId) {\n        // properties\n        var self = this;\n        this.device = device;\n        this.frameId = frameId;\n        this.dataId = dataId;\n        this.deferred = device.registerForData(this.frameId, this.dataId);\n        this.listenerCount = 0;\n\n        // buffer list\n        this.buffers = {\n          bufferOneMinute: new Buffer(60, defaultMaxSamples, device, frameId, dataId),\n          bufferFiveMinutes: new Buffer(300, defaultMaxSamples, device, frameId, dataId),\n          bufferThirtyMinutes: new Buffer(1800, defaultMaxSamples, device, frameId, dataId),\n          bufferOneHour: new Buffer(3600, defaultMaxSamples, device, frameId, dataId),\n          bufferThreeHours: new Buffer(10800, defaultMaxSamples, device, frameId, dataId),\n          bufferSixHours: new Buffer(21600, defaultMaxSamples, device, frameId, dataId),\n          bufferTwelveHours: new Buffer(43200, defaultMaxSamples, device, frameId, dataId),\n          bufferOneDay: new Buffer(86400, defaultMaxSamples, device, frameId, dataId)\n        };\n\n        // set the callback that will be called when a new frame is received\n        this.deferred.promise.then({}, {}, function (frame) {\n          angular.forEach(self.buffers, function (buffer) {\n            buffer.addFrame(frame.timestamp, frame.value, true);\n          })\n        });\n      }\n\n      /*! delete the data */\n      Data.prototype.delete = function () {\n        this.device.unregisterForData(this.deferred);\n        delete dataList[this.device.id + '!' + this.frameId + '!' + this.dataId];\n      };\n\n      /*! ------------------- PUBLIC METHODS -------------------*/\n      /*## PUBLIC METHODS*/\n      return {\n        /** Launch the record of a specified data.\n        * @param {device} device\n        * @param {string} frameId\n        * @param {string} dataId\n        *\n        *\n        *### Example:\n        *```javascript\n        *var device = acquisitionService.registerForDevice(DEVICE_ID);\n        *acquisitionBufferService.recordData(device, FRAME_ID, DATA_ID);\n        *```\n        */\n        recordData: function (device, frameId, dataId) {\n          var id = device.id + '!' + frameId + '!' + dataId;\n          if (dataList[id] === undefined) {\n            dataList[id] = new Data(device, frameId, dataId);\n          }\n          dataList[id].listenerCount++;\n          logger.debug('record data: ' + id + ' (listeners: ' + dataList[id].listenerCount + ')');\n        },\n\n        /** Get the recorded data values.\n        * @param {device} deviceId\n        * @param {string} frameId\n        * @param {string} dataId\n        * @return {object} an object with buffers which contain the recorded data\n        *\n        *\n        *### Example:\n        *```javascript\n        *var data = acquisitionBufferService.getData(device, FRAME_ID, DATA_ID);\n        *angular.forEach(data.buffers[bufferOneMinute].frames, function (frame) {\n        *    console.log( Frame: timestamp= frame.timestamp, value= frame.value);\n        *})\n        *```\n        */\n        getData: function getData(deviceId, frameId, dataId) {\n          return dataList[deviceId + '!' + frameId + '!' + dataId];\n        },\n\n        /** Stop the record of a specified data.\n        * @param {device} device\n        * @param {string} frameId\n        * @param {string} dataId\n        * @param {boolean} force: if true the data is removed from the service, even if there is other listeners\n        *\n        *\n        *### Example:\n        *```javascript\n        *acquisitionBufferService.stopRecordData(DEVICE_ID, FRAME_ID, DATA_ID);\n        *```\n        */\n        stopRecordData: function stopRecordData(deviceId, frameId, dataId, force) {\n          var data = dataList[deviceId + '!' + frameId + '!' + dataId];\n          logger.debug('stop record data: ' + dataId + \" (listeners: \" + data.listenerCount + ')');\n          if (data !== undefined) {\n            data.listenerCount--;\n            if (data.listenerCount < 1 || force) {\n              data.delete();\n              logger.debug('data removed: ' + dataId);\n            }\n          }\n        },\n\n        /** Get the list of data managed by the service.\n        * @return {map} map of the data being recorded, the key is the id: device.id + '!' + frameId + '!' + dataId\n        */\n        getDataList: function getDataList() {\n          return dataList;\n        }\n\n      }\n    });\n})();\n\n/** # ARCHIVE SERVICE\n *\n * Provides methods to retrieve archived data.\n */\n(function () {\n  'use strict';\n  angular.module(\"tsa.services\").factory(\"archiveService\", archiveService);\n\n  function archiveService($log, $q, restService, statusService) {\n    var logger = $log.getInstance(\"archiveService\");\n\n    /* Default values */\n    var DEFAULT = {\n      MAX_NUM_VALUES: 500,\n      STRATEGY: 'resampling',\n      RESAMPLE_INTERVAL: 1,\n      INTERVAL_STAMP_FRATION: 1,\n      REFERENCE: 1,\n      AGGREGATE: 'RAW'\n    };\n\n    function logRequestSending(requestBody) {\n      // Log request\n      logger.debug(\"archive request sending: \" + requestBody.request.length\n        + \" variable(s), from \" + new Date(requestBody.starttime).toUTCString()\n        + \" to \" + new Date(requestBody.endtime).toUTCString()\n        + \" with strategy: \" + angular.toJson(requestBody.timestampingstrategy)\n        + \"; max values: \" + requestBody.numvalues);\n    }\n\n    /* Variable constructor */\n    function Variable(dataId, frameId, deviceId, aggregate, columnName, units, min, max, defaultValue) {\n      this.varid = deviceId + '!' + frameId + '!' + dataId;\n      this.aggregate = angular.isUndefined(aggregate) ? DEFAULT.AGGREGATE : aggregate;\n      this.colname = columnName !== undefined ? columnName : this.varid;\n      this.units = units;\n      this.min = min;\n      this.max = max;\n      this.default = defaultValue;\n    }\n\n    /*! Provides request body */\n    function buildRequestBody(dataList, startDate, endDate, maxValues, strategy, referenceOrResampleInterval, intervalStampFraction) {\n      // Request body object\n      var requestBody = {\n        tablename: 'table',\n        request: dataList,\n        starttime: startDate,\n        endtime: endDate,\n        numvalues: angular.isDefined(maxValues) ? maxValues : DEFAULT.MAX_NUM_VALUES\n      };\n\n      // Time stamping strategy\n      if (angular.isUndefined(strategy))\n        strategy = DEFAULT.STRATEGY;\n\n      if (strategy == 'resampling') {\n        requestBody.timestampingstrategy = {\n          resampling: {\n            resampleinterval: angular.isDefined(referenceOrResampleInterval) ? referenceOrResampleInterval : DEFAULT.RESAMPLE_INTERVAL,\n            intervalstampfraction: angular.isDefined(intervalStampFraction) ? intervalStampFraction : DEFAULT.INTERVAL_STAMP_FRATION\n          }\n        };\n      }\n      else if (strategy == 'reference') {\n        requestBody.timestampingstrategy = {\n          reference: angular.isDefined(referenceOrResampleInterval) ? referenceOrResampleInterval : DEFAULT.REFERENCE\n        };\n      }\n      return requestBody;\n    }\n\n    /*! Send request to get the archived data.\n        Optional parameters are replaced by their default values if they are not specified.\n        Return a promise.\n        dataList = list of Variable objects\n        !! Date in UTC format !! */\n    function getData(format, dataList, startDate, endDate, maxNumValues, strategy, referenceOrResampleInterval, intervalStampFraction) {\n\n      //Check format\n      if (format != \"json\" && format != \"csv\" && format != \"netcdf\") {\n        logger.error(\"Format '\" + format + \"' not recognized\");\n        return $q.reject({ message: \"Format '\" + format + \"' not recognized\" });\n      }\n\n      var requestBody = buildRequestBody(dataList, startDate, endDate, maxNumValues, strategy, referenceOrResampleInterval, intervalStampFraction);\n      logRequestSending(requestBody);\n\n      // Send request\n      var request = restService.getArchiveData(format, angular.toJson(requestBody));\n\n      // Log result\n      request.then(\n        function (response) {\n          logger.debug(\"--> response: \" + response.data.length + \" data received\");\n        },\n        function (error) {\n          if (error.data !== undefined)\n            logger.error('--> error: ' + angular.toJson(error.data));\n          if (error.data != null && error.data.message !== undefined)\n            logger.error('--> error: ' + error.data.message);\n        });\n\n      return request;\n    }\n\n    /*! Simple method to retrieve data */\n    function getDataSimple(dataId, frameId, deviceId, start, end, maxNumValues, interval) {\n      var variableList = [new Variable(dataId, frameId, deviceId)];\n      return getData('json',variableList, start, end, maxNumValues, 'resampling', interval);\n    }\n\n    /* ## PUBLIC METHODS */\n    return {\n\n      /** Variable constructor\n      *@method new Variable\n      *\n      *@param {string} dataId\n      *@param {string} frameId\n      *@param {string} deviceId\n      *@param {string} aggregate selected aggregate algorithm (optional)\n      *@param {string} columnName name of the column corresponding to the data in the request result (optional)\n      *@param {string} units (optional)\n      *@param min (optional)\n      *@param max (optional)\n      *@param defaultValue (optional)\n      *\n      *@return Variable object.\n      *\n      *\n      *### Example:\n      *     var myVariable = new archiveService.Variable('watertemp', 'weather', 'BATOS001');\n      */\n      Variable: Variable,\n\n      /**\n      *Sends an archive request to retrieve data\n      *@method getData\n      *\n      *@param {string} format\n      *@param {array} dataList\n      *@param {date} startDate\n      *@param {date} endDate\n      *@param {int} maxNumValues\n      *@param {string} strategy\n      *@param {string} referenceOrResampleInterval\n      *@param {string} intervalStampFraction\n      *\n      *@return promise (will be resolved if the request succeeded, rejected if it failed)\n      */\n      getData: getData,\n\n      /** Simple method to retrieve data\n      *@method getDataSimple\n      *\n      *@param {string} dataId\n      *@param {string} frameId\n      *@param {string} deviceId\n      *@param {date} start date\n      *@param {data} end date\n      *@param {int} maxNumValues maximum number of values\n      *@param {int} interval\n      *\n      *@return promise (will be resolved if the request succeeded, rejected if it failed)\n      */\n      getDataSimple: getDataSimple\n    }\n  }\n\n})();\n\n/**\n# DEVICE\n\nA device is a representation of a sensor managed by the TECHSAS server.\n\nThe device class provides methods to monitor the device'status and listen/record its data/frames.\n\nTo instantiate a device object, declare the dependence to the device factory and call:\n\n```javascript\nvar device = new Device(deviceId);\n```\n\n> Device objects are managed by the acquisition service. If a device is needed, use the acquisition service method\nto get it:\n\n```javascript\nvar device = acquisitionService.registerForDevice(deviceId);\n```\n\n## EXAMPLES\n\n### Listen a specific data of the device\n\n```javascript\n//STEP 1: register for data\nvar deferred = device.registerForData(FRAME_ID, DATA_ID);\n\n//STEP 2: get the received values (attach a callback to the deferred object's promise)\ndeferred.promise.then({}, {},\n    function callback(data) {\n        console.log(\"Data : timestamp = \" + data.timestamp + \", value = \" + data.value);\n    });\n\n//STEP 3: when the data is no longer listened, don't forget the unregistration!\ndevice.unregisterForData(deferred);\n```\n\n### Listen a specific frame of the device\n\n```javascript\n//STEP 1: register for frame\nvar deferred = device.registerForFrame(FRAME_ID);\n\n//STEP 2: get the received values (attach a callback to the deferred object's promise)\ndeferred.promise.then({}, {},\n    function callback(frame) {\n        var timestamp = frame.timestamp;\n        var data1 = frame.value[DATA_ID_1];\n        var data2 = frame.value[DATA_ID_2];\n        var data3 = frame.value[DATA_ID_3];\n    });\n\n//STEP 3: when the frame is no longer listened, don't forget the unregistration!\ndevice.unregisterForFrame(deferred);\n```\n\n### Record a data and get buffers where received values have been stored\n\n```javascript\n//STEP 1: start the record\nvar deferred = device.recordData(FRAME_ID,DATA_ID);\n\n//STEP 2: get buffers\nvar data = device.getData(FRAME_ID, DATA_ID);\nangular.forEach(data.buffers[bufferOneMinute].frames, function (frame) {\n    console.log( Frame: timestamp= frame.timestamp, value= frame.value);\n})\n\n//STEP 3: when the record is no longer necessary, stop it!\ndevice.stopRecordData(FRAME_ID, DATA_ID);\n```\n\n\n## PROPERTIES\nName | Description\n------------ | -------------\nid | unique id\nname | device name\njsonDataTopic | web socket topic used to get json messages\nperiod | device period (ms)\nframeList | frameList\nisEnabled | device status\n\n*/\n(function () {\n    'use strict';\n    angular.module(\"tsa.services\").factory(\"Device\", DeviceFactory);\n    function DeviceFactory($q, $log, stompService, acquisitionBufferService) {\n\n        /*! Device object **/\n        function Device(id) {\n            this.logger = $log.getInstance('Device ' + id);\n            //Properties\n            this.id = id;\n            this.name = id;\n            this.jsonDataTopic = '/topic/' + id + '.json';\n            this.periodList = {}; // contains periods by frame\n            this.frameList = {}; // contains data descriptions:  var dataDescription = frameList[vm.frameId][vm.dataId];\n            this.isEnabled = false;\n            //Listeners\n            this.listenerCount = 0;\n            this.statusDeferred = $q.defer();\n            this.dataListenerList = [];\n            this.frameListenerList = [];\n            this.jsonDataMsgListener = undefined;\n\n            // hack for wind speed anemometer on pp\n            this.hackWindSpeed = id !== undefined ? id.startsWith('PP_ANEMOMETER') : false;\n        }\n\n        /* ## METHODS */\n\n        /** Set the device's status.\n        * @param {boolean} newStatus\n        */\n        Device.prototype.setEnable = function setEnable(newStatus) {\n            if (this.isEnabled != newStatus) {\n                this.isEnabled = newStatus;\n                this.statusDeferred.notify(this.isEnabled);\n            }\n        };\n\n        /*! If needed, start the listening of the JSON message.\n        * Subscribe to JSON data, and notify the suitable promises when a data is found in JSON Message.\n        */\n        Device.prototype.startJSONMessageListening = function startJSONMessageListening() {\n            if (this.dataListenerList.length === 0 && this.frameListenerList.length === 0)\n            {\n                var self = this; //Used to prevent context issues inside methods called by promises\n                this.jsonDataMsgListener = this.subscribeToJSONData();\n                this.jsonDataMsgListener.promise.then({}, {},\n                    //Parse the JSON message, and notify the suitable data promises (data promises are returned when registerForData() is called)\n                    function parseDataJSONMessage(jSONMessage) {\n                        var frame = JSON.parse(jSONMessage.data.body);\n                        var frameId = frame.name;\n                        var dataList = frame.data;\n                        var timestamp = frame.acquisitionTime;\n\n                        var frameWithDataAsKey = {};\n                        angular.forEach(dataList, function (data){\n                            frameWithDataAsKey[data.name] = data.samples;\n                        });\n                        // hack wind speed\n                        if(self.hackWindSpeed && (frameId == 'weather')) {\n                            frameWithDataAsKey['relairspeed'][0] = frameWithDataAsKey['relairspeed'][0]/0.51444;\n                        } \n\n                        //Notify frame listeners\n                        angular.forEach(self.frameListenerList, function (listener) {\n                            if (listener.id === frameId) {\n                                listener.deferred.notify({ value: frameWithDataAsKey, timestamp: timestamp })\n                            }\n                        });\n\n                        //Notify data listeners\n                        angular.forEach(dataList, function (data) {\n                            angular.forEach(self.dataListenerList, function (listener) {\n                                if (listener.id === frameId + '!' + data.name) {\n//                                    if(this.hackWindSpeed && (frameId == 'weather') && (data.name == 'relairspeed')) {\n//                                      listener.deferred.notify({ value:  data.samples[0]/0,514444, timestamp: timestamp });\n//                                    } else {\n                                        listener.deferred.notify({ value:  data.samples.length > 1 ? data.samples : data.samples[0], timestamp: timestamp });\n//                                    }\n                                }\n                            })\n                        });\n                    });\n            }\n        };\n\n        /*! If there is no more listener, stop the listening of the JSON message. */\n        Device.prototype.stopJSONMessageListening = function stopJSONMessageListening() {\n            if (this.dataListenerList.length === 0 && this.frameListenerList.length === 0) {\n                this.logger.debug(\"no more data listener -> unsubscribeToJSONData(this.jsonDataMsgListener)\");\n                this.unsubscribeToJSONData(this.jsonDataMsgListener);\n            }\n        };\n\n        /** Register to be notified when the device'status change.\n        *@return {promise} promise which will be notified when the status change.\n        */\n        Device.prototype.registerForStatus = function registerForStatus() {\n            return this.statusDeferred.promise;\n        };\n\n        /** Register for a specific data.\n         *@param {string} frameId\n         *@param {string} dataId\n         *@return {deferred} object with promise that will be notified when a new value for the specified data is received.\n         */\n        Device.prototype.registerForData = function registerForData(frameId, dataId) {\n            this.startJSONMessageListening();\n            // create a new deferred object\n            var id = frameId + '!' + dataId;\n            var deferred = $q.defer();\n            this.dataListenerList.push({ id: id, deferred: deferred });\n            this.logger.debug(\"register for data : \" + this.id + \"!\" + frameId + \"!\" + dataId + \" (data listeners for this device: \" + this.dataListenerList.length + \")\");\n            return deferred;\n        };\n\n        /** Unregister for data.\n         *@param {deferred} object provided during the registration\n         */\n        Device.prototype.unregisterForData = function unregisterForData(deferred) {\n            //Find the listener object, resolve his deferred object and remove it from the list.\n            angular.forEach(this.dataListenerList, function (listener) {\n                if (Object.is(listener.deferred, deferred)) {\n                    deferred.resolve();\n                    this.dataListenerList.splice(this.dataListenerList.indexOf(listener), 1);\n                    this.logger.debug(\"data listener removed (id = \" + listener.id + \"), remaining: \" + this.dataListenerList.length);\n                }\n            }, this);\n            this.stopJSONMessageListening();\n        };\n\n        /** Register for a specific frame.\n         *@param {string} frameId\n         *@return {deferred} object with promise which will be notified when a new frame is received\n         */\n        Device.prototype.registerForFrame = function registerForFrame(frameId) {\n            this.startJSONMessageListening();\n            // create a new deferred object\n            var id = frameId;\n            var deferred = $q.defer();\n            this.frameListenerList.push({ id: id, deferred: deferred });\n            this.logger.debug(\"register for frame : \" + this.id + \"!\" + frameId + \" (frame listeners for this device: \" + this.frameListenerList.length + \")\");\n            return deferred;\n        };\n\n        /** Unregister for frame.\n         *@param {deferred} object provided during the registration\n         */\n        Device.prototype.unregisterForFrame = function unregisterForFrame(deferred) {\n            //Find the listener object, resolve his deferred object and remove it from the list.\n            angular.forEach(this.frameListenerList, function (listener) {\n                if (Object.is(listener.deferred, deferred)) {\n                    deferred.resolve();\n                    this.frameListenerList.splice(this.frameListenerList.indexOf(listener), 1);\n                    this.logger.debug(\"frame listener removed (id = \" + listener.id + \"), remaining: \" + this.frameListenerList.length);\n                }\n            }, this);\n            this.stopJSONMessageListening();\n        };\n\n        /** Start record data.\n         *@param {string} frameId\n         *@param {string} dataId\n         */\n        Device.prototype.recordData = function recordData(frameId, dataId) {\n            acquisitionBufferService.recordData(this, frameId, dataId);\n        };\n        /** Stop record data.\n        * @param {string} frameId\n        * @param {string} dataId\n        * @param {boolean} force: if true the data is removed from the service, even if there is other listeners\n        */\n        Device.prototype.stopRecordData = function stopRecordData(frameId, dataId, force) {\n            acquisitionBufferService.stopRecordData(this.id, frameId, dataId, force);\n        };\n\n        /** Get buffers of a recorded data.\n        * @param {string} frameId\n        * @param {string} dataId\n        * @return {object} an object with buffers which contain the recorded data\n        */\n        Device.prototype.getData = function getData(frameId, dataId) {\n            return acquisitionBufferService.getData(this.id, frameId, dataId);\n        };\n\n        /** Subscribe to web sockets.\n        *@return {deferred} object with promise which will be notified when a new data value is received\n        */\n        Device.prototype.subscribeToJSONData = function subscribeToJSONData() {\n            return stompService.registerForTopic(this.jsonDataTopic);\n        };\n        /** Unsubscribe to web sockets.\n        *@param {deferred} object provided during the registration\n        */\n        Device.prototype.unsubscribeToJSONData = function unsubscribeToJSONData(deferred, force) {\n            stompService.unregisterForTopic(this.jsonDataTopic, deferred, force);\n        };\n\n        return Device;\n    }\n})();\n\n/** # REST SERVICE\n\nThis service provides the web service requests sent to the acquisition server.\n\nPublic methods return promise object, if the request succeeded the promise will be resolved, else it will be rejected\nwith an error message.\n\nSee documentation about promise: https://docs.angularjs.org/api/ng/service/$q\n\n## EXAMPLES\n\n### Generic call\n```javascript\nrestService.MY_REQUEST(...).then(\n    function successCallback(data){\n        console.log(\"My request succeeded!\");\n    },\n    function errorCallback(error){\n        console.log(\"My request failed: \" + error);\n};\n```\n### With 'getDescription(name)'\n```javascript\nrestService.getDescription(frameName).then(\n      function successCallback(frame) {\n           angular.forEach(frame.broadcasts, function (data) {\n               // Get description for data found in the received device config.\n               if (deviceConfig.frameNames[frame.name].indexOf(data.name) > -1)\n                   device.frameList[frame.name][data.name] = data;\n})\n```\n */\n(function () {\n    'use strict';\n    angular.module(\"tsa.services\")\n        .factory(\"restService\", function ($resource, $http, $httpParamSerializerJQLike, $q, REST_API, ARCHIVES_REST_API, $cookies, QGIS_URL, QGIS_MISSION_NAME) {\n\n            /*! REST resources **/\n            var Channel = $resource(REST_API.CHANNEL + '/:channelId', null, { 'update': { method: 'PUT' } });\n            var Configuration = $resource(REST_API.CONFIGURATION);\n            var Driver = $resource(REST_API.DRIVER);\n            var DriverPreview = $resource(REST_API.DRIVER_PREVIEW);\n            var Device = $resource(REST_API.DEVICE + '/:deviceId', null, { 'update': { method: 'PUT' } });\n            var Description = $resource(REST_API.DESCRIPTION + '/:descriptionName');\n            var User = $resource(REST_API.USER + '/:login', null, { 'update': { method: 'PUT' } });\n            var Chat = $resource(REST_API.CHAT);\n            var ChatLast = $resource(REST_API.CHAT + '/chatMessage');\n\n            /** Stack of request */\n            var requestStack = [];\n            var currentRequest = undefined;\n            var requestId = 0;\n\n            function pushRequest(request) {\n                request.id = requestId++;\n                //requestStack.push(request);\n                requestStack.unshift(request);\n                if (!angular.isDefined(currentRequest))\n                    executeNextRequest();\n            }\n\n            function executeNextRequest() {\n                currentRequest = requestStack.shift();\n                if (angular.isDefined(currentRequest))\n                    currentRequest.call().then(executeNextRequest, executeNextRequest);\n            }\n\n            function cancelRequest(id) {\n                angular.forEach(requestStack, function (request, key) {\n                    if (request.id === id)\n                        requestStack.splice(key, 1);\n                });\n            }\n\n            /*## PUBLIC METHODS */\n            return {\n\n                /*! Get the request stack **/\n                getRequestStack: function getRequestStack() {\n                    return requestStack;\n                },\n                getCurrentRequest: function getCurrentRequest() {\n                    return currentRequest;\n                },\n                cancelRequest: cancelRequest,\n\n                /*### ARCHIVES\n                *- **getArchiveData(format, requestBody)**: get the archived data (format: 'json', 'csv', or 'netcdf').\n                *- **getArchiveDevices()**: get the archive device list. */\n                /*!*/\n                getArchiveData: function getArchiveData(format, requestBody) {\n                    var deferred = $q.defer();\n                    function getArchiveDataRequest() {\n                        var result = $http.post(ARCHIVES_REST_API.DATA,\n                            requestBody, {\n                                'headers': {\n                                    'Accept': 'application/json',\n                                    'Content-Type': 'application/json'\n                                },\n                                params: { 'format': format }\n                            });\n                        result.then(function (resultData) { deferred.resolve(resultData); }, function (error) { deferred.reject(error); });\n                        return result;\n                    }\n\n                    var varID = JSON.parse(requestBody).request.length > 0 ? JSON.parse(requestBody).request[0].varid : 'empty list!';\n                    var duration = (JSON.parse(requestBody).endtime - JSON.parse(requestBody).starttime) / 1000;\n                    getArchiveDataRequest.description = \"variable = \" + varID + \";   duration = \" + duration + \" sec\";\n                    pushRequest(getArchiveDataRequest);\n                    return deferred.promise;\n                },\n                getArchiveAllData: function getArchiveAllData(deviceId, startDate, endDate) {\n                    var deferred = $q.defer();\n                    $http.get(ARCHIVES_REST_API.DEVICES + \"/\" + deviceId + \"/framesData?startDate=\" + startDate +  \"&endDate=\" + endDate ).then(function (resultData) {\n                        deferred.resolve(resultData);\n                        },\n                        function (error) {\n                        deferred.reject(error);\n                    });\n                    return  deferred.promise;\n                },\n                getArchiveDevices: function getArchiveDevices() {\n                    var deferred = $q.defer();\n                    var deviceList = {};\n                    //Step 1: get device list\n                    $http.get(ARCHIVES_REST_API.DEVICES).then(function (result) {\n                        angular.forEach(result.data, function (deviceId) {\n                            var device = { id: deviceId, name: deviceId, frameList: {} };\n                            //Step 2: get frames\n                            $http.get(ARCHIVES_REST_API.DEVICES + \"/\" + deviceId + \"/frames\").then(function (result) {\n                                angular.forEach(result.data, function (frame) {\n                                    device.frameList[frame.name] = {};\n                                    //Step 3: add data\n                                    angular.forEach(frame.data, function (data) {\n                                        device.frameList[frame.name][data.name] = data;\n                                    });\n                                });\n                            }, function (error) { deferred.reject(error); });\n                            deviceList[deviceId] = device;\n                        });\n                        deferred.resolve(deviceList);\n                    }, function (error) { deferred.reject(error); });\n                    return deferred.promise;\n                },\n\n                /*### CHANNELS\n                *- **getChannels()**: get the channel list.\n                *- **putChannel(id, url)**: create a new channel. */\n                /*!*/\n                getChannels: function getChannels() {\n                    return Channel.query().$promise;\n                },\n                putChannel: function putChannel(id, url) {\n                    return Channel.update({ channelId: id }, { 'channelId': id, 'url': url }).$promise;\n                },\n\n                /*### CONFIGURATION\n                *- **getConfiguration()**: get the configuration. */\n                /*!*/\n                /**\n                 @deprecated\n                */\n                getConfiguration: function getConfiguration() {\n                    return Configuration.get().$promise;\n                },\n\n                /*### DRIVERS\n                *- **getDrivers()**: get all the converters.\n                *- **postDriversPreview(requestBody)**: get converter preview. */\n                /*!*/\n                getDrivers: function getDrivers() {\n                    return Driver.query().$promise;\n                },\n                postDriversPreview: function postDriversPreview(requestBody) {\n                    return $http.post(REST_API.DRIVERSPREVIEW,\n                        requestBody, {\n                            'headers': {\n                                'Accept': 'application/json',\n                                'Content-Type': 'application/json'\n                            }\n                        }\n                    );\n                },\n\n                /*### DESCRIPTION\n                *- **getDescriptions()**: get all the descriptions.\n                *- **getDescription(name)**: get a specific description. */\n                /*!*/\n                getDescriptions: function getDescriptions() {\n                    return Description.query().$promise;\n                },\n                getDescription: function getDescription(name) {\n                    return Description.get({ descriptionName: name }).$promise;\n                },\n\n                /*### DEVICE\n                *- **getDevices()**: get all the devices.\n                *- **getDevice(id)**: get a specific device.\n                *- **putDevice(id, device)**: create or update a device.\n                *- **deleteDevice(id)**: delete a device. */\n                /*!*/\n                getDevices: function getDevices() {\n                    return Device.query().$promise;\n                },\n                getDevice: function getDevice(id) {\n                    return Device.get({ deviceId: id }).$promise;\n                },\n                putDevice: function putDevice(id, device) {\n                    return Device.save(device).$promise;\n                },\n                deleteDevice: function deleteDevice(id) {\n                    return Device.delete({ deviceId: id }).$promise;\n                },\n\n                /*### FRONT END PARAMETERS\n                *- **getFrontEndParameters()**: get front end parameters defined in the back-end side\n                */\n                /*!*/\n                getFrontEndParameters: function getFrontEndParameters(){\n                      return $http.get(REST_API.FRONT_END_PARAMETERS);\n                },\n\n                /*### MISSION\n                *- **getMission()**: get the current mission.\n                *- **setMission(mission)**: set the current mission. */\n                /*! (Resource not used because the retrieved data type is 'text plain') */\n                getMission: function getMission() {\n                    return $http.get(REST_API.MISSION, { headers: { 'accept': 'text/plain' } });\n                },\n                setMission: function setMission(mission) {\n                    return $http.put(REST_API.MISSION, mission);\n                },\n\n                /*### USER\n                *- **login(loginName, password)**: login (if success, X-CRSF-TOKEN is automatically set in the next request headers).\n                *- **logout()**: logout\n                *- **getCurrentUser()**: get the current user (the user is found with the CSRF Token previously received).\n                *- **saveUserConfig(loginName, config)**: save the user configuration.  */\n                /*!*/\n                login: function login(name, psw) {\n                    return $http.post(\n                        REST_API.LOGIN,\n                        $httpParamSerializerJQLike({ username: name, password: psw }),\n                        {\n                            headers: { \"Content-Type\": \"application/x-www-form-urlencoded\" }\n                        });\n                },\n                logout: function logout() {\n                    return $http.post(REST_API.LOGOUT);\n                },\n                getCurrentUser: function getCurrentUser() {\n                    return $http.get(REST_API.USER);\n                },\n                saveUserConfig: function saveUserConfig(login, config) {\n                    return $http.put(\n                        REST_API.USER_CONFIG + login,\n                        config,\n                        {\n                            headers: { \"Content-Type\": \"application/json\" }\n                        });\n                },\n                /*### CASINO\n                 *- **casinoConnexion(url, login, password)**: connexion to casino server\n                 *- **getCasinoCruises()**: Get all casino cruises\n                 *- **getCasinoCurrentCruise()**: Get casino current cruise (if define in Casino+ AcquisitionServer else in Database)\n                 *- **getCasinoDevices()**: Get all casino devices\n                 *- **getCasinoActions()**: Get all casino actions\n                 *- **getCasinoEvents(cruise, device, action)**: get events corresponding to a cruise, a device and an action\n                 *- **getCasinoCruiseEvents()**: Get last <limit> events except ACQAUTO corresponding to a cruise\n                 *- **getCasinoCruiseDevices()**: Get all devices corresponding to a cruise\n                 *- **getCasinoDeviceActions()**: Get all actions corresponding to a device\n                 *- **getCasinoLastOperationId()**: Get last operation corresponding to a prefix (OperationPrefix of cruise + device code)\n                 *- **getCasinoLastCuiseEventId()**: get the last casino event on a cruise\n                 *- **getCasinoNearestCruiseEvent()**: get nearest event from new one on a cruise (to get lat/long)\n                 *- **copyCasinoEventParameters()**: copy casino event parameters from nearest event\n                 *- **postCasinoCruiseEvents()**: post new casino event on a cruise\n                 */\n                casinoConnexion: function(url, login, password) {\n                    return $http.post(\n                        REST_API.CASINO + '/database',\n                        { url: url, user: login, pwd: password }\n                    );\n                },\n                getCasinoCruises: function() {\n                    return $http.get(REST_API.CASINO + '/cruises', { headers: {database: localStorage.getItem('databaseToken')}});\n                },\n                getCasinoCurrentCruise: function() {\n                    return $http.get(REST_API.CASINO + '/cruises/current', {headers: {database: localStorage.getItem('databaseToken')}});\n                },\n                getCasinoDevices: function() {\n                    return $http.get(REST_API.CASINO + '/devices', { headers: {database: localStorage.getItem('databaseToken')}});\n                },\n                getCasinoActions: function() {\n                    return $http.get(REST_API.CASINO + '/actions', { headers: {database: localStorage.getItem('databaseToken')}});\n                },\n                getCasinoEvents: function(cruise, device, action) {\n                    var options = {\n                        headers: {database: localStorage.getItem('databaseToken')},\n                        params: { 'ActionCode': action }\n                    };\n                    return $http.get(REST_API.CASINO + '/cruises/' + cruise + '/devices/' + device + '/events', options);\n                },\n                getCasinoCruiseEvents: function(cruise, limit, isDate) {\n                    var options = {\n                        headers: {database: localStorage.getItem('databaseToken')},\n                        params: {}\n                    };\n                    if (limit !== null) options.params['limit'] = limit;\n                    if (isDate !== null) options.params['isDate'] = isDate;\n                    return $http.get(REST_API.CASINO + '/cruises/' + cruise  + '/events', options);\n                },\n                getCasinoCruiseDevices: function(cruise) {\n                    var options = {\n                        headers: {database: localStorage.getItem('databaseToken')}\n                    };\n                    return $http.get(REST_API.CASINO + '/cruises/' + cruise  + '/devices', options);\n                },\n                getCasinoDeviceActions: function(cruise, deviceId) {\n                    var options = {\n                        headers: {database: localStorage.getItem('databaseToken')}\n                    };\n                    return $http.get(REST_API.CASINO + '/cruises/' + cruise  + '/devices/' + deviceId + '/actions', options);\n                },\n                getCasinoLastOperationId: function (cruise, prefix) {\n                    var options = {\n                        headers: {database: localStorage.getItem('databaseToken')},\n                        params: { 'prefix': prefix }\n                    };\n                    return $http.get(REST_API.CASINO + '/cruises/' + cruise  + '/events/OPE', options);\n                },\n                postCasinoCruiseEvent: function(cruise, requestBody) {\n                    var options = {\n                        headers: {database: localStorage.getItem('databaseToken')}\n                    };\n                    return $http.post(REST_API.CASINO + '/cruises/' + cruise  + '/events',requestBody, options);\n                },\n\n                /*### QGIS\n                 *- **getQGISCapabilities()**: Get QGIS capabilities\n                 */\n                getQGISCapabilities: function() {\n                    var options = {\n                        headers: { 'Content-type': 'application/xml' },\n                        params: {\n                            'SERVICE': 'WMS',\n                            'VERSION': '1.3.0',\n                            'REQUEST': 'GetCapabilities'\n                        }\n                    };\n                    return $http.get(QGIS_URL + QGIS_MISSION_NAME, options);\n                },\n                updateQGISProject: function(file) {\n                    file = file.replace('data:application/x-zip-compressed;base64,', '', file);\n                    return $http.put(REST_API.QGIS, {zip: file});\n                },\n\n                /*### CHAT\n                *- **fonction()**: description\n                 */\n                getLastMessages: function getLastMessages (){\n                    return Chat.query().$promise;\n                },\n\n                sendMessage: function sendMessage (msg){\n                    return Chat.save(msg).$promise;\n                },\n\n                getLastMessage: function getLastMessage () {\n                    return ChatLast.get().$promise;\n                }\n            };\n    });\n})();\n\n\n/** # STATUS SERVICE\n\nThis service provides an object with the following properties:\n\nProperty | Description\n------------ | -------------\ntime | a number representing the milliseconds elapsed between 1 January 1970 00:00:00 UTC and the server time.\ntimeOffset | offset between server time and universal time given with ```new Date().getTime();```.\n\n## EXAMPLE\n\n```javascript\nvar currentServerDate = new Date(statusService.getServerTime().time);\n```\n */\n(function () {\n    'use strict';\n    angular.module(\"tsa.services\").factory(\"statusService\", statusService);\n\n    function statusService(stompService, $interval, TOPICS) {\n        var serverTime = {};\n        var lastTimeReceive = {};\n        var localTimeZoneOffset = undefined;\n        var isConnected = {flag: false};\n        serverTime.time = new Date().getTime();\n        lastTimeReceive.time = new Date().getTime();\n        serverTime.timeOffset = 0;\n        stompService.start();\n        stompService.registerForTopic(TOPICS.STATUS).promise.then({},\n            function statusRejected() {\n                isConnected.flag = false;\n            },\n            function statusCallback(message) {\n                var status = JSON.parse(message.data.body);\n                serverTime.timeOffset = status.time - new Date().getTime();\n                localTimeZoneOffset = status.localTimeZoneOffset;\n                isConnected.flag = true;\n                lastTimeReceive.time = new Date().getTime();\n            });\n\n        /*! Update the server time (get the current time and apply the suitable offset **/\n        $interval(function () {\n            serverTime.time = new Date(new Date().getTime() + serverTime.timeOffset).getTime();\n        }, 100);\n\n        /*! Update the server time (get the current time and apply the suitable offset **/\n        $interval(function () {\n            if ((new Date().getTime() - lastTimeReceive.time) > 5000) {\n                isConnected.flag = false;\n            }\n        }, 10000);\n\n        /* ## PUBLIC METHODS */\n        return {\n            /* Get server time object.\n            * @return {object} with two properties: time and time offset.\n            */\n            getServerTime: function getServerTime() {\n                return serverTime;\n            },\n\n            /* Get local timezone offset.\n            * @return {string} with time offset eg '+0100' or '-0930' or undefined\n            */\n           getLocalTimeZoneOffset: function getLocalTimeZoneOffset() {\n                return localTimeZoneOffset;\n            },\n\n            /* Get the connection status.\n             * @return {boolean} connection status\n             */\n            isConnected: function getIsConnected() {\n                return isConnected;\n            },\n        };\n    }\n})();\n\n/** # STOMP SERVICE\n *\n * This service manages the web socket connections with the acquisition server,\n * based on the STOMP protocol (use of the [STOMP.js library](http://jmesnil.net/stomp-websocket/doc/)).\n */\n(function () {\n    'use strict';\n    angular.module(\"tsa.services\").factory(\"stompService\", function ($q, $log, STOMP_URL, themeService,\n                                                                     userService,dialogService) {\n        var logger = $log.getInstance(\"stompService\");\n\n        /*! Topic class\n         * subscription : stomp object used to manage the subscription\n         * deferred: \"deferred\" object used to notify listeners when a message is received, or\n         * when the subscription is ended. (listener shall be linked to the 'promise' object with the method: '.then()')\n         */\n        function Topic(id) {\n            this.id = id;\n            this.subscription = undefined;\n            this.listeners = [];\n        }\n\n        /*!------------------------------ PROPERTIES -------------------------------**/\n\n        // stomp client properties\n        var stompClient;\n        var connectionCallback;\n        var connectionErrorCallbackList = [];\n        var topicList = {};\n        var isConnected = {flag: false};\n\n        // topic list listeners (deferred objects) : notify the topic list modifications\n        var topicListListener = $q.defer();\n        var errorListener = $q.defer();\n\n        /*!------------------------------ PRIVATE METHODS -------------------------------**/\n\n        /*! Connection to the brokerUrl */\n        var connect = function () {\n\n            var headers = {\n                login: '',\n                passcode: ''\n            };\n\n            stompClient = Stomp.client(STOMP_URL);\n            stompClient.debug = null; //remove stomp log\n            stompClient.heartbeat.outgoing = 10000;\t// heartbeats to the server\n            stompClient.heartbeat.incoming = 10000; // receive heartbeats\n            stompClient.connect(headers, connectionSuccessCallback, connectionFailureCallback);\n            logger.debug(\"connection to: \" + STOMP_URL);\n        };\n\n        /*! Subscribe to a new topic */\n        var subscribe = function (topic) {\n            if (stompClient !== undefined && isConnected.flag) {\n                //Link a callback with the topic's deferred property, this callback is called when a message is received.\n                var callback = function (data) {\n                    angular.forEach(topic.listeners, function (deferred) {\n                        deferred.notify({ topic: topic.id, data: data });\n                    });\n                };\n                //Subscription\n                topic.subscription = stompClient.subscribe(topic.id, callback);\n                logger.debug(\"subscription for the topic: \" + topic.id);\n            }\n        };\n\n        /*!  Add a new topic and try a subscription. */\n        var addTopic = function (topicId) {\n            topicList[topicId] = new Topic(topicId);\n            subscribe(topicList[topicId]);\n            notifyTopicListChanges();\n        };\n\n        /*! Notify listeners about topic list changes */\n        var notifyTopicListChanges = function () {\n            topicListListener.notify(topicList);\n        };\n\n\n        /*! Connection callbacks **/\n        // Callback on the connection successful and subscribe to the configuration topic\n        var connectionSuccessCallback = function () {\n            isConnected.flag = true;\n            //At connection, subscribe to the registred topics\n            for (var topic in topicList) {\n                subscribe(topicList[topic]);\n            }\n            //Notify connection state listeners\n            connectionCallback.resolve();\n        };\n\n        // Callback when an error occurs on the connection\n        var connectionFailureCallback = function (errorMessage) {\n            logger.error(' (' + (new Date()).toTimeString() + \") failure callback: \" + errorMessage);\n            connectionCallback.reject(errorMessage);\n            errorListener.notify(errorMessage);\n            isConnected.flag = false;\n\n            userService.currentUser = undefined;\n\n            //Add reconnection\n            logger.error(' (' + (new Date()).toTimeString() + \") reconnection: \");\n            setTimeout(connect, 10000);\n        };\n\n        /*!------------------------------ PUBLIC METHODS -------------------------------**/\n        /* ## Public methods */\n        return {\n\n            /** Start the stomp service, if the service is not already launched, a new stomp client is started\n             * and a subscription is done for each topic in topicList.\n             * @return {promise} promise object 'resolved' if the connection is successful, or 'rejected' if an error occurs.\n             */\n            start: function start() {\n                // verify if the connection promise is not resolved which means that the connection is in progress.\n                var connectionInProgress = (connectionCallback === undefined) ? false : (connectionCallback.promise.$$state.status === 0);\n                if (!isConnected.flag && !connectionInProgress) {\n                    logger.debug(\"start...\");\n                    connectionCallback = $q.defer();\n                    connect();\n                }\n                return connectionCallback.promise;\n            },\n\n            /* Stop the service: disconnect the stomp client, and remove it. */\n            stop: function stop() {\n                if (isConnected.flag) {\n                    stompClient.disconnect();\n                    stompClient = undefined;\n                    isConnected.flag = false;\n                    connectionErrorCallbackList = [];\n                    logger.debug(\"stop.\");\n                }\n                else logger.error(TAG)\n            },\n\n            /* Get the connection status.\n             * @return {boolean} connection status\n             */\n            isConnected: function getIsConnected() {\n                return isConnected;\n            },\n\n            /** Register for error.\n             * @return {Promise} \"notified\" when an error occurs.\n             */\n            registerForError: function registerForError() {\n                return errorListener.promise;\n            },\n\n            /** Register for topic list changes.\n             * @return {Promise} \"notified\" when changes occur in the topic list.\n             */\n            registerForTopicList: function registerForTopicList() {\n                return topicListListener.promise;\n            },\n\n            /** Return the topic list.\n             * @return {topicList} list of topics\n             */\n            getTopicList: function getTopicList() {\n                return topicList;\n            },\n\n            /** Register for a specified topic, if the topic does not already exist, a new topic is added\n             * in the list and a subscription is done.\n             * @param {string} topicId\n             * @returns {promise} \"notified\" when a message is received, and 'resolved' when the connection\n             * is closed.\n             */\n            registerForTopic: function registerForTopic(topicId) {\n                if (topicList[topicId] === undefined)\n                    addTopic(topicId);\n                var deferred = $q.defer();\n                topicList[topicId].listeners.push(deferred);\n                logger.debug(\"new listener registered for topic: \" + topicId + \" (total: \" + topicList[topicId].listeners.length + \")\");\n                notifyTopicListChanges();\n                return deferred;\n            },\n\n            /**Unregister for a specified topic: the topic's promise is resolved, and the topic is\n             * removed from the list.\n             * @param {string} topicId\n             * @param {boolean} force if true, the unsubscription will be forced.\n             */\n            unregisterForTopic: function unregisterForTopic(topicId, deferred, force) {\n                if (topicList[topicId] !== undefined) {\n                    var topic = topicList[topicId];\n                    if (deferred !== null && topic.listeners.indexOf(deferred) > -1) {\n                        deferred.resolve();\n                        topic.listeners.splice(topic.listeners.indexOf(deferred), 1);\n                        logger.debug(\"unregister for topic: \" + topicId + \" (listeners: \" + topic.listeners.length + \")\");\n                    }\n                    if (force === true)\n                        topic.listeners = [];\n\n                    if (topic.listeners.length === 0 && topic.subscription !== undefined) { //If there is no more listener, close the connection\n                        topic.subscription.unsubscribe();\n                        delete topicList[topicId];\n                        logger.debug(\"topic subscription closed and topic removed: \" + topicId);\n                        notifyTopicListChanges();\n                    }\n                }\n            },\n\n            /**Send a message to a specified topic\n            * @param {string} topicId\n            * @param {string} message to send\n            */\n            sendMessage: function sendMessage(topicId, msg) {\n                if (stompClient !== undefined && isConnected.flag) {\n                    stompClient.send(topicId, {}, msg);\n                }\n            }\n\n        };\n    });\n})\n    ();\n\n/** # CASINO SERVICE\n *\n * Provides methods to retrieve casino data.\n */\n(function () {\n    'use strict';\n    angular.module(\"tsa.services\").factory(\"casinoService\", CasinoService);\n\n    function CasinoService(restService) {\n\n        /* ---------------------------------------------------------\n         * Utils function\n         * ---------------------------------------------------------\n         */\n\n        var connect = function(url, login, password) {\n            localStorage.removeItem('databaseToken');\n            localStorage.removeItem('selectedCruises');\n            localStorage.removeItem('selectedDevices');\n            return restService.casinoConnexion(url, login, password).then(function(response) {\n                localStorage.setItem('databaseToken', response.headers('database'));\n            });\n        };\n\n        /* ---------------------------------------------------------\n         * Cruises function\n         * ---------------------------------------------------------\n         */\n\n\n        var getCruises = function() {\n            return restService.getCasinoCruises().then(function(response) {\n                return response.data;\n            });\n        };\n\n        var getCurrentCruise = function() {\n            return restService.getCasinoCurrentCruise().then(function(response) {\n                return response.data;\n            });\n        };\n\n        var setSelectCruises = function(selectedCruises) {\n            localStorage.setItem('selectedCruises', JSON.stringify(selectedCruises));\n        };\n\n        var getSelectCruises = function() {\n            return JSON.parse(localStorage.getItem('selectedCruises'));\n        };\n\n        /* ---------------------------------------------------------\n         * Devices function\n         * ---------------------------------------------------------\n         */\n\n        var getCasinoDevices = function(withActions, selectedActions) {\n            return restService.getCasinoDevices().then(function(response) {\n                return response.data;\n            })\n            .then(function(devices) {\n                if (withActions) {\n                    return getCasinoActions().then(function(actions) {\n                        return devices.map(function(device) {\n                            device.actions = actions.filter(function(action) {\n                                var isSameDevice = action.DeviceId === device.DeviceId;\n                                var isSelectedAction = true;\n                                if (selectedActions && selectedActions.length !== 0) {\n                                    isSelectedAction = selectedActions.indexOf(action.ActionCode) !== -1;\n                                }\n                                return isSameDevice && isSelectedAction;\n                            });\n                            return device;\n                        })\n                        .filter(function(device) { return device.actions.length !== 0; });\n                    });\n                } else {\n                    return devices;\n                }\n            });\n        };\n\n        var setSelectDevices = function(selectedDevices) {\n            localStorage.setItem('selectedDevices', JSON.stringify(selectedDevices));\n        };\n\n        var getSelectDevices = function() {\n            return JSON.parse(localStorage.getItem('selectedDevices'));\n        };\n\n        /* ---------------------------------------------------------\n         * Actions function\n         * ---------------------------------------------------------\n         */\n\n        var getCasinoActions = function() {\n            return restService.getCasinoActions().then(function(response) {\n                return response.data;\n            });\n        };\n\n        /* ---------------------------------------------------------\n         * Events function\n         * ---------------------------------------------------------\n         */\n\n        var getEvents = function(cruise, device, action) {\n            return restService.getCasinoEvents(cruise, device, action).then(function(response) {\n                return response.data;\n            });\n        };\n\n        var getCruiseEvents = function(cruise, limit, isDate) {\n            return restService.getCasinoCruiseEvents(cruise, limit, isDate).then(function(response) {\n                return response.data;\n            });\n        };\n\n        var getCruiseDevices = function(cruise) {\n            return restService.getCasinoCruiseDevices(cruise).then(function(response) {\n                return response.data;\n            });\n        };\n\n        var getDeviceActions = function(cruise, deviceId) {\n            return restService.getCasinoDeviceActions(cruise, deviceId).then(function(response) {\n                return response.data;\n            });\n        };\n\n        var getLastOperationId = function(cruise, prefix) {\n            return restService.getCasinoLastOperationId(cruise, prefix).then(function(response) {\n                return response.data;\n            });\n        };\n\n        var postCruiseEvent = function(cruise, requestBody) {\n            return restService.postCasinoCruiseEvent(cruise, requestBody).then(function(response) {\n                return response.data;\n            });\n        };\n\n\n\n\n        return {\n            connect: connect,\n            getCruises: getCruises,\n            getCurrentCruise: getCurrentCruise,\n            setSelectCruises: setSelectCruises,\n            getSelectCruises: getSelectCruises,\n            getCasinoDevices: getCasinoDevices,\n            setSelectDevices: setSelectDevices,\n            getSelectDevices: getSelectDevices,\n            getCasinoActions: getCasinoActions,\n            getEvents: getEvents,\n            getCruiseEvents: getCruiseEvents,\n            getCruiseDevices: getCruiseDevices,\n            getDeviceActions: getDeviceActions,\n            getLastOperationId: getLastOperationId,\n            postCruiseEvent: postCruiseEvent\n        };\n    }\n\n})();\n\n(function () {\n    'use strict';\n    angular.module(\"tsa.services\").factory(\"CasinoEvent\", CasinoEventFactory);\n\n    function CasinoEventFactory($log) {\n\n        /*! CasinoEvent object **/\n        function CasinoEvent() {\n            this.init();\n        }\n\n        /* ## METHODS */\n        CasinoEvent.prototype.init = function init() {\n            this.cruiseEventId = 0;\n            this.eventDate = \"\";\n            this.latitude = 999;\n            this.longitude = 999;\n            this.type = \"\";\n            this.observation = \"\";\n            this.initPhase();\n            this.initOperation();\n            this.initHalieutic();\n        };\n\n        CasinoEvent.prototype.initPhase = function initPhase() {\n            this.phaseFullName = \"\";\n            this.phaseType = \"\";\n        };\n\n        CasinoEvent.prototype.initAction = function initAction() {\n            this.actionFullName = \"\";\n            this.actionCode = \"\";\n        };\n\n        CasinoEvent.prototype.initDevice = function initDevice() {\n            this.initAction();\n            this.deviceFullName = \"\";\n            this.deviceCode = \"\";\n        };\n\n        CasinoEvent.prototype.initOperation = function initOperation() {\n            this.operationId = \"\";\n            this.initDevice();\n        };\n\n        CasinoEvent.prototype.initHalieutic = function initHalieutic() {\n            this.field1 = \"\"; // (Halieutic) Station number\n            this.field2 = \"\"; // (Halieutic) Strate\n        };\n\n        CasinoEvent.prototype.cleanByType = function cleanByType() {\n            switch (this.type) {\n                case \"OBS\":\n                    this.initPhase();\n                    this.initOperation();\n                    break;\n                case \"PHA\":\n                    this.initOperation();\n                    this.initHalieutic();\n                    break;\n                case \"OPE\":\n                    this.initPhase();\n                    break;\n                default:\n                    break;\n            }\n        };\n\n        return CasinoEvent;\n    }\n})();\n\n(function () {\n    'use strict';\n    angular.module(\"tsa.services\").factory(\"CasinoOperationId\", CasinoOperationIdFactory);\n\n    function CasinoOperationIdFactory($log) {\n\n        /*! CasinoEvent object **/\n        function CasinoOperationId() {\n            this.init();\n        }\n        var self = this;\n\n        /* ## METHODS */\n        CasinoOperationId.prototype.init = function init() {\n            this.custom = \"\";\n            this.number = 1;\n        };\n\n        CasinoOperationId.prototype.updatePrefix = function updatePrefix(operationPrefix, deviceCode) {\n            this.prefix = operationPrefix + deviceCode;\n        };\n\n        CasinoOperationId.prototype.updateNumber = function updateNumber(lastOperationId, prefix) {\n            var lastNumber = 0;\n            this.number = 1;\n            if (lastOperationId) {\n                var lastNumber = 0;\n                var res = lastOperationId.split('-');\n                if (res.length > 1) {\n                    lastNumber = res[res.length - 1];\n                } else {\n                    lastNumber = lastOperationId.replace(prefix, \"\");\n                }\n                this.number = Number(lastNumber) + 1;\n            }\n        };\n\n        CasinoOperationId.prototype.getStringOperationId = function getStringOperationId() {\n            var operationId = this.prefix;\n            if (this.custom != \"\") {\n                operationId +=  '-' + this.custom + '-';\n            }\n            operationId += this.number;\n            return operationId;\n        };\n\n        return CasinoOperationId;\n    }\n})();\n\n/**\n * Dialog service: provides methods for display messages and dialog boxes.\n */\n(function () {\n  'use strict';\n  angular.module(\"tsa.services.dialog\")\n    .factory(\"dialogService\", function ($mdDialog, $mdToast, $filter) {\n      return {\n\n        /** Show a dialog with title and text */\n        showDialog: function (title, msg) {\n          $mdDialog.show(\n            $mdDialog.alert()\n              .parent(angular.element(document.querySelector('#popupContainer')))\n              .clickOutsideToClose(true)\n              .title(title)\n              .textContent(msg)\n              .ariaLabel('Alert Dialog Demo')\n              .ok('ok')\n          );\n        },\n\n        /** Show a message in a toast */\n        showToast: function (msg) {\n          $mdToast.show(\n            $mdToast.simple()\n              .textContent(msg)\n              .hideDelay(3000)\n              .position('bottom right')\n          );\n        },\n\n          /** Show a message in a toast for new message incoming */\n          showToastChat: function (msg) {\n              $mdToast.show(\n                  $mdToast.simple()\n                      .textContent(msg)\n                      .hideDelay(0)\n                      .position('bottom right')\n                      .action('ok')\n              );\n          },\n\n        /** Show a dialog for the selection of a view */\n        showSelectView: function showSelectView() {\n          return $mdDialog.show({\n            controller: 'viewSelectionController',\n            controllerAs: 'ctrl',\n            templateUrl: 'app/services/dialog/viewSelection/viewSelection.html',\n            clickOutsideToClose: false\n          });\n        },\n\n        /** Show a dialog which enables a data selection */\n        showSelectData: function showSelectData(deviceList) {\n          return $mdDialog.show({\n            controller: 'dataSelectionController',\n            controllerAs: 'ctrl',\n            templateUrl: 'app/services/dialog/dataSelection/dataSelection.html',\n            clickOutsideToClose: true,\n            locals: { deviceList: deviceList }\n          })\n        },\n\n          /** Show a dialog in order to access to showMessaging when no user profile filled */\n          showMessagingAccess: function showMessaging () {\n              return $mdDialog.show({\n                  controller: 'messagingAccessController',\n                  controllerAs: 'ctrl',\n                  templateUrl: 'app/services/dialog/messagingAccess/messagingAccess.html',\n                  clickOutsideToClose: true,\n                  locals: {}\n              })\n          },\n\n        /** Show a dialog for typing a message */\n        showMessaging: function showMessaging() {\n          return $mdDialog.show({\n            controller: 'messagingController',\n            controllerAs: 'ctrl',\n            templateUrl: 'app/services/dialog/messaging/messaging.html',\n            clickOutsideToClose: true,\n            locals: {}\n          })\n        },\n\n        /** Show a dialog which enables a data selection */\n        showSelectDateRange: function showSelectDateRange(startDate, endDate) {\n          return $mdDialog.show({\n            controller: 'dateRangeSelectionController',\n            controllerAs: 'ctrl',\n            templateUrl: 'app/services/dialog/dateRangeSelection/dateRangeSelection.html',\n            clickOutsideToClose: true,\n            locals: { startDate: startDate, endDate: endDate }\n          })\n        },\n\n\n        /** Show a dialog to save the current dashboard\n         * @param title: predefined title\n         */\n        showSaveDashboard: function showSaveDashboard(title) {\n          return $mdDialog.show({\n            controller: 'saveDashboardController',\n            controllerAs: 'ctrl',\n            templateUrl: 'app/services/dialog/saveDashboard/saveDashboard.html',\n            clickOutsideToClose: true,\n            locals: { title: title }\n          });\n        },\n\n        /** Show a validation dialog, used to get a validation from the user*/\n        showValidation: function showValidation(title, msg, msgOk, msgCancel) {\n          if (angular.isUndefined(msgOk))\n            msgOk = $filter('translate')(\"yes\");\n          if (angular.isUndefined(msgCancel))\n            msgCancel = $filter('translate')(\"cancel\");\n\n          return $mdDialog.show({\n            controller: 'validationController',\n            controllerAs: 'ctrl',\n            templateUrl: 'app/services/dialog/validation/validation.html',\n            clickOutsideToClose: true,\n            locals: { title: title, msg: msg, msgOk: msgOk, msgCancel: msgCancel }\n          });\n        }\n\n      }\n    }\n    );\n})();\n\n/**\n# USER\n\nA user object is a representation of an user account.\n\nIt contains information about the user (login, name...) and provides methods to save applications settings (for example\na dashboard, or the configuration of the static view...).\n\n> User objects are managed by the user service.\n\nTo instantiate a user object, declare the dependence to the user factory and call:\n\n```javascript\nvar user = new User(login, name, type, config);\n```\n\n## EXAMPLE\n\n### Method to save a user setting ('MY_CONFIG')\n\n```javascript\nfunction saveMY_CONFIG(configToSave){\n\n    //STEP 0: save the old configuration, if the save request fails it's could be interesting to restore the previous state.\n    var oldConfig = user.config.MY_CONFIG;\n\n    //STEP 1: update the user 'config' property\n    user.config.MY_CONFIG = configToSave;\n\n    //STEP 2: send the request to save the current configuration\n    var requestResult = user.saveConfig();\n\n    //STEP 3: manage the request result\n    requestResult.then(\n                function success() {\n                    console.log(\"The user configuration has been correctly saved!\");\n                },\n                function error() {\n                    console.error(\"The request has failed!\");\n                    user.config.MY_CONFIG = oldConfig; //Restore the previous state!\n                });\n\n    return requestResult; //return the requestResult (promise object)\n}\n```\n\n## PROPERTIES\nName | Description\n------------ | -------------\nlogin | user login\nname | user name\ntype | list of authorities owned by the user\nconfig | application configuration parameters\n\n## METHODS\n\n*/\n(function () {\n    'use strict';\n    angular.module(\"tsa.services\").factory(\"User\", UserFactory);\n    function UserFactory($q, $log, dashboardService, restService, staticGridService) {\n\n        var logger = $log.getInstance(\"userFactory\");\n\n        /*! Constructor */\n        function User(login, name, roles, config) {\n            this.login = login;\n            this.name = name;\n            this.roles = roles;\n            this.config = config;\n        }\n\n        /** Check if the user has the specified authority\n         * @param {string} authority\n         * @return {boolean} result: true if the user has the specified authority\n         */\n        User.prototype.hasAuthority = function hasAuthority(authority) {\n            return this.roles.indexOf(authority) != -1\n        };\n\n        /** Send the request to save the user config\n         * @return {promise} request result\n         */\n        User.prototype.saveConfig = function saveConfig() {\n            var user = this;\n            var resultPromise = restService.saveUserConfig(user.login, angular.toJson(user.config));\n            resultPromise.then(\n                function () {//success\n                    logger.debug(user.login + ' configuration saved');\n                },\n                function () {//error\n                    logger.error('configuration save error')\n                });\n            return resultPromise;\n        };\n\n        /** Save the selected language\n         * @param {string} language\n         */\n        User.prototype.saveLanguage = function saveLanguage(language) {\n            this.config.language = language;\n            this.saveConfig().then(function () { logger.debug(\"Language saved: \" + language); });\n        };\n\n        /** Save the selected theme (day or night) */\n        User.prototype.saveTheme = function saveTheme(theme){\n            this.config.theme = theme;\n            this.saveConfig().then(function () { logger.debug(\"Theme saved: \" + theme); });\n        }\n\n        /** Save a dashboard in the current user config field\n         * @param {string} title\n         * @param {array} itemList dashboard's items\n         * @return {promise} request result\n         */\n        User.prototype.saveDashboard = function saveDashboard(title, itemList) {\n            var user = this;\n            if (user.config.dashboardList == undefined)\n                user.config.dashboardList = {};\n\n            var oldDashboard = user.config.dashboardList[title];\n            user.config.dashboardList[title] = itemList;\n\n            var resultPromise = user.saveConfig();\n            resultPromise.then(\n                function () {//Success -> refresh the dashboard list\n                    //refreshDashboardList();\n                    dashboardService.setPersoDashboardList(angular.copy(user.config.dashboardList));\n                    dashboardService.setCurrentDashboard(title, itemList);\n                },\n                function () {//Fail --> return the the old dashboard\n                    if (oldDashboard != undefined)\n                        user.config.dashboardList[title] = oldDashboard;\n                    else delete user.config.dashboardList[title];\n                });\n            return resultPromise;\n        };\n\n        /** Remove a dashboard from the current user config field\n         * @param {string} title\n         * @return {promise} request result\n         */\n        User.prototype.removeDashboard = function removeDashboard(title) {\n            var user = this;\n\n            var oldDashboard = user.config.dashboardList[title];\n            delete user.config.dashboardList[title];\n\n            var resultPromise = user.saveConfig();\n            resultPromise.then(\n                function () {//Success -> refresh the dashboard list\n                    //refreshDashboardList();\n                    dashboardService.setPersoDashboardList(angular.copy(user.config.dashboardList));\n                    dashboardService.switchToNewDashboard();\n                },\n                function () { //Fail --> reset the the old dashboard\n                    user.config.dashboardList[title] = oldDashboard;\n                });\n            return resultPromise;\n        };\n\n        /** Save the static grid configuration in the current user config field\n         * @return {promise} request result\n         */\n        User.prototype.saveStaticGrid = function saveStaticGrid() {\n            var user = this;\n\n            var oldStaticGridConfig = user.config.staticGrid;\n            user.config.staticGrid = {\n                cards: staticGridService.getCards(),\n                mode: staticGridService.getViewMode(),\n                selectedCard: staticGridService.getSelectedCardId()\n            };\n\n            var resultPromise = user.saveConfig();\n            //If the save request fails, reset the previous config\n            resultPromise.then({},\n                function () {\n                    user.config.staticGrid = oldStaticGridConfig;\n                });\n            return resultPromise;\n        };\n\n        return User;\n    }\n})();\n\n/** # USER SERVICE\n\nUser service: this service manages the current user and provides login/logout methods.\n*/\n(function () {\n    'use strict';\n    angular.module(\"tsa.services\").factory(\"userService\", UserService);\n\n    function UserService($cookies, $filter, $http, $location, $log, $q, $rootScope, $state, AUTHORITIES,\n        dashboardService, dialogService, localeService, restService, staticGridService, themeService, User) {\n\n        var logger = $log.getInstance(\"userService\");\n        var currentUser;\n        var currentUserProvider = {\n            currentUser: undefined\n        };\n\n        /*! PRIVATE METHODS */\n\n        /*! Initialisation method: called when the service is launch, retrieve current user from cookies */\n        (function init() {\n            var token = $cookies.get('XSRF-TOKEN');\n            if (token != undefined) {\n                getUserFromServer().then({}, function error() {\n                    // console.log('toto');\n                    dialogService.showToast($filter('translate')(\"toast.user-disconnected\"));\n                    // $cookies.remove('XSRF-TOKEN');\n                });\n            }\n        })();\n\n        /*! Current user setter; load the user config */\n        function setCurrentUser(user) {\n            currentUser = user;\n            currentUserProvider.currentUser = currentUser;\n            if (currentUser != undefined) {\n                //Load dashboard\n                if (angular.isDefined(user.config) && angular.isDefined(user.config.dashboardList))\n                    dashboardService.setPersoDashboardList(angular.copy(user.config.dashboardList));\n                else dashboardService.setPersoDashboardList([]);\n                //todo: restore the dashboard previously selected\n                if (currentUser.config.dashboardList != null) {\n                    var dash = Object.keys(currentUser.config.dashboardList)[0];\n                    if (dash != null)\n                        dashboardService.setCurrentDashboard(dash, currentUser.config.dashboardList[dash]);\n                }\n                //Load static grid\n                if (currentUser.config.staticGrid != null) {\n                    if (currentUser.config.staticGrid.cards != null)\n                        staticGridService.setCards(currentUser.config.staticGrid.cards);\n                    if (currentUser.config.staticGrid.mode != null)\n                        staticGridService.setViewMode(currentUser.config.staticGrid.mode);\n                    if (currentUser.config.staticGrid.selectedCard != null)\n                        staticGridService.setSelectedCardId(currentUser.config.staticGrid.selectedCard);\n                }\n                //Load language\n                if (angular.isDefined(currentUser.config.language)\n                    && angular.isDefined(localeService.getLocaleList()[currentUser.config.language]))\n                    localeService.setCurrentLocale(localeService.getLocaleList()[currentUser.config.language]);\n                //Load theme\n                if (angular.isDefined(currentUser.config.theme))\n                    themeService.setTheme(currentUser.config.theme);\n\n                logger.debug('user config loaded: ' + currentUser.name);\n\n                //If the user has the authority \"SDIV\", the static page is displayed\n                if (currentUser.hasAuthority(AUTHORITIES.SDIV))\n                    $location.path('/static');\n            }\n            $rootScope.$emit('current-user-changed');\n        }\n\n        /*! Retrieve the current user from the server with the request '/api/user'\n         * (the user is found with the CSRF Token retrieved with the login request) */\n        function getUserFromServer() {\n            var resultPromise = restService.getCurrentUser();\n            resultPromise.then(\n                function success(response) {\n                    var user = response.data;\n                    if (user) {\n                        var config = user.config != null ? angular.fromJson(user.config) : {};\n                        setCurrentUser(new User(user.login, user.name, user.roles, config));\n                        dialogService.showToast($filter('translate')(\"toast.successfull-connection\") + currentUser.name);\n                        logger.debug('successful /api/user request, user retrieved: ' + currentUser.name);\n                    } else {\n                        logger.debug('current user not found (/api/user request error)');\n                    }\n                },\n                function error() {\n                    logger.debug('current user not found (/api/user request error)');\n                }\n            );\n            return resultPromise;\n        }\n\n        /* ## PUBLIC METHODS */\n        return {\n\n            /** Provide access to the current user */\n            currentUser: currentUser,\n\n            /** Connection to the backend, recovery of the user properties.\n             * @param {string} username\n             * @param {string} password\n             * @return {promise} request result\n             */\n            login: function login(username, password) {\n                var deferred = $q.defer();\n                restService.login(username, password).then(\n                    function success(response) {\n                        logger.debug('successful login');\n                        // authenticated, use provided CSRF token for subsequent requests\n                        getUserFromServer().then(\n                            function success(response) {\n                                deferred.resolve(response);\n                            },\n                            function error(response) {\n                                deferred.reject(response);\n                            }\n                        );\n                    },\n                    function error(response) {\n                        logger.error('login error');\n                        deferred.reject(response);\n                    }\n                );\n                return deferred.promise;\n            },\n\n            /** Disconnect the current user. */\n            logout: function logout() {\n                restService.logout();\n                setCurrentUser(undefined);\n                dialogService.showToast($filter('translate')('toast.user-disconnection'));\n            },\n\n            /** Return the current user.\n             * @return {user} current user\n             */\n            getCurrentUser: function getCurrentUser() {\n                return currentUser;\n            },\n\n            /** Return a provider for the current user (simple object which contains a reference to \"currentUser\",\n             * useful to keep a binding between ui components and the currentUser variable, else when the currentUser is reset,\n             * the ui components have to recall the getter to have the new instance. Use this provider allows to avoid this.) */\n            getCurrentUserProvider: function getCurrentUserProvider() {\n                return currentUserProvider;\n            },\n\n            /** Check is the current user has the specified authority.\n             * @param {string} authority\n             * @return {boolean} result: true if the user owns the specified authority\n             */\n            checkAuthority: function checkAuthority(authority) {\n                if (currentUser == undefined || !currentUser.hasAuthority(authority)) {\n                    logger.log('user not authorized, redirecting to the login page!');\n                    $state.go('login', { authority: authority, next: $state.current.name, nextParams: $state.params });\n                    return false;\n                }\n                return true;\n            }\n        }\n    }\n\n})\n    ();\n\n/** easelJsUtils : this service provides basic graphics shape to use with EaselJs */\n(function () {\n    'use strict';\n    angular.module(\"tsa.services\").factory(\"easelJsUtils\", easelJsUtilsService);\n\n\tvar Shape = createjs.Shape;\n\tvar Container = createjs.Container;\n\t\n\tfunction easelJsUtilsService() {\n\n\t    return {\n\t\t\tcreateBackRudder: function createBackRudder(color) {\n\t\t\t\tvar backRudderShape = new Shape();\n\t\t\t\tvar rudderRadius = 100;\n\t\t\t\tvar sqrt = rudderRadius/Math.sqrt(2);\n\t\t\t\tbackRudderShape.graphics\n\t\t\t\t\t.beginStroke(color).setStrokeStyle(2,\"square\")\n\t\t\t\t\t.moveTo(0, 0).lineTo(sqrt, 0+sqrt)\n\t\t\t\t\t.arc(0, 0, rudderRadius, Math.PI/4, Math.PI/2 - 4*Math.PI/180)\n\t\t\t\t\t.endStroke()\n\t\t\t\t\t.beginStroke(color).setStrokeStyle(2,\"square\")\n\t\t\t\t\t.arc(0, 0, rudderRadius, Math.PI/2 + 4*Math.PI/180, 3*Math.PI/4)\n\t\t\t\t\t.moveTo(-sqrt, sqrt).lineTo(0, 0)\n\t\t\t\t\t.endStroke();\n\n\t\t\t\treturn backRudderShape;\n\t\t\t},\n\t\n\t\t\tcreateRudder: function createRudder(color) {\n\t\t\t\tvar rudderShape = new Shape();\n\n\t\t\t\tvar rudderRadius = 100;\n\t\t\t\tvar m = 7;\n\t\t\t\tvar w = 7;\n\t\t\t\tvar hw = w/2;\n\t\t\t\t\n\t\t\t\trudderShape.graphics\n\t\t\t\t\t.beginStroke(color).setStrokeStyle(2,\"square\")\n\t\t\t\t\t.moveTo(hw, m)\n\t\t\t\t\t.lineTo(hw, rudderRadius-m)\n\t\t\t\t\t.lineTo(-hw, rudderRadius-m)\n\t\t\t\t\t.lineTo(-hw, m)\n\t\t\t\t\t.lineTo(hw, m)\n\t\t\t\t\t.endStroke();\n\t\t\t\t\n\t\t\t\treturn rudderShape;\n\t\t\t},\n\t\t\t\n\t\t\tcreateBackGauge: function createBackGauge(backgroundColor) {\n\t\t\t\tvar backGaugeShape = new Shape();\n\t\t\t\tvar width = 50;\n\t\t\t\tvar height = 10;\n\t\t\t\t\n\t\t\t\tbackGaugeShape.graphics.beginFill(backgroundColor).drawRect(-50, -10, 100, 20).endFill();\n\t\t\t\treturn backGaugeShape;\n\t\t\t},\n\t\t\t\n\t\t\tcreateGaugge: function createGaugge(tickColor, zeroColor, value, plusColor, minusColor) {\n\t\t\t\tvar gaugeShape = new Shape();\n\t\t\t\t\n\t\t\t\tvar color = value > 0 ? plusColor : minusColor;\n\t\t\t\tif(Math.abs(value)>0)\n\t\t\t\t\tgaugeShape.graphics.beginFill(color).drawRect( 0, -10, value/2, 20).endFill();\n\n\t\t\t\tgaugeShape.graphics\n\t    \t\t.beginStroke(tickColor).setStrokeStyle(0.6)\n\t    \t\t.moveTo(-25, -10)\n\t    \t\t.lineTo(-25, 10)\n\t    \t\t.endStroke();\n\t    \t\n\t\t\t\tgaugeShape.graphics\n\t    \t\t.beginStroke(tickColor).setStrokeStyle(0.6)\n\t    \t\t.moveTo(25, -10)\n\t    \t\t.lineTo(25, 10)\n\t    \t\t.endStroke();\n\t    \t\n\t\t\t\tgaugeShape.graphics\n\t    \t\t.beginStroke(zeroColor).setStrokeStyle(0.6)\n\t    \t\t.moveTo(0, -10)\n\t    \t\t.lineTo(0, 10)\n\t    \t\t.endStroke();\n\t\t    \t\n\t\t\t\treturn gaugeShape;\n\t\t\t},\n\n\t\t\tcreateVessel: function createVessel(color) {\n\t\t\t\tvar vesselShape = new Shape();\n\t\t\t\t\n\t\t\t\tvar vesselHeight=100;\n\t\t\t\tvar vesselWidth=100;\n\n\t\t\t\tvesselShape.graphics.beginStroke(color).setStrokeStyle(1);\n\n\t\t\t\tvar cp1 = 20;\n\t\t\t\tvar cp2 = 20;\n\n\t\t\t\tvar hw = vesselWidth/2;\n\t\t\t\tvar hh = vesselHeight/2;\n\t\t\t\tvar ch = 15*hh/50;\n\t\t\t\tvar ccp1 = cp1*hw/50;\n\t\t\t\tvar ccp2 = cp2*hh/50;\n\n\t\t\t\tvesselShape.graphics\n\t\t\t\t.moveTo(-hw, -ch)\n\t\t\t\t.lineTo(-hw, hh)\n\t\t\t\t.lineTo(hw, hh)\n\t\t\t\t.lineTo(hw, -ch)\n\t\t\t\t.bezierCurveTo(hw, -ch-ccp2, ccp1, -hh, 0, -hh)\n\t\t\t\t.bezierCurveTo(-ccp1, -hh, -hw, -ch-ccp2, -hw, -ch);\n\n\t\t\t\treturn vesselShape;\t\t\t\n\t\t\t},\n\n\t\t\tcreateArrow: function createArrow(color, value) {\n\t\t\t\tvar arrowShape = new Shape();\n\t\t\t\t\n\t\t\t\tvar arrowHeight=100;\n\t\t\t\tvar arrowlWidth=100;\n\n\t\t\t\tarrowShape.graphics.beginStroke(color).setStrokeStyle(4);\n\n\t\t\t\tvar arrowShift = 10;\n\t\t\t\t\n\t\t\t\tarrowShape.graphics\n\t\t\t\t\t.moveTo(0, 0)\n\t\t\t\t\t.lineTo(0, -value)\n\t\t\t\t\t.moveTo(arrowShift, -value+arrowShift)\n\t\t\t\t\t.lineTo(0, -value)\n\t\t\t\t\t.moveTo(-arrowShift, -value+arrowShift)\n\t\t\t\t\t.lineTo(0, -value);\n\t\t\t\t\n\t\t\t\treturn arrowShape;\n\t\t\t}\n\t\t\t\n    \t};\n\t}\n}());\n\n/** formatterService: provides method to format values */\n(function () {\n    'use strict';\n    angular.module(\"tsa.services\").factory(\"formatterService\", formatterService);\n\n    function formatterService($filter) {\n\n        function parseExcelDateToString(excelDate, format, tz){\n            return $filter('date')(new Date((excelDate - (25569))*86400*1000), format, tz);\n        }\n\n        /* PUBLIC API */\n        return {\n\n            parseLatToString: function parseLatToString(lat) {\n                if (angular.isUndefined(lat))\n                    return \"\";\n                var direction = lat > 0 ? 'N' : 'S';\n                var degrees = sprintf(\"%02d\", Math.abs(lat));\n                var minutes = sprintf(\"%06.3f\", Math.abs(lat) % 1 * 60);\n                return degrees + \"\" + minutes + \"\" + direction;\n            },\n\n            parseLongToString: function parseLongToString(long) {\n                if (angular.isUndefined(long))\n                    return \"\";\n                var direction = long > 0 ? 'E' : 'W';\n                var degrees = sprintf(\"%03d\", Math.abs(long));\n                var minutes = sprintf(\"%06.3f\", Math.abs(long) % 1 * 60);\n                return degrees + \"\" + minutes + \"\" + direction;\n            },\n\n            parseTimeToString: function parseTimeToString(time){\n                return $filter('date')(new Date(time), \"dd/MM/yy HH:mm:ss\", \"+0\");\n            },\n\n            parseExcelDateDefaultToString: function parseExcelDateDefaultToString(excelDate, tz){\n                return parseExcelDateToString(excelDate, \"dd/MM/yy HH:mm:ss\", tz);\n            },\n            parseExcelDateNoSecToString: function parseExcelDateNoSecToString(excelDate, tz){\n                return parseExcelDateToString(excelDate, \"dd/MM/yy HH:mm\", tz);\n            },\n            parseMarineDistance: function parseMarineDistance(dist){\n                return (Math.abs(dist) < 1852) ? dist : dist/1852;\n            },\n            parseQualityFbxToString: function parseQualityFbxToString(quality){\n                var res = \"\";\n                quality = parseInt(quality);\n                switch(quality) {\n                    case 0: res = \"operating\";\n                              break;\n                    case 1: res = \"washing\";\n                        break;\n                    case 2: res = \"waiting fresh water\";\n                        break;\n                    case 3: res = \"service\";\n                        break;\n                    case 8: res = \"cycle completed\";\n                        break;\n                    case 9: res = \"error\";\n                        break;\n                    default : res = \"undefined\";\n                }\n                return res;\n            }\n\n        };\n    }\n})();\n\n/** graphUtilsService : this service provides useful methods for the view containing a graph (chart.js) */\n(function () {\n    'use strict';\n    angular.module(\"tsa.services\").factory(\"graphUtils\", graphUtilsService);\n\n    function graphUtilsService(themeService) {\n\n        /** Generate the chart options */\n        function getChartOptions(stepSize, fill) {\n            return {\n                animation: false,\n                maintainAspectRatio: false,\n                legend: { display: false },\n                tooltips: { enabled: false },\n                elements: {\n                    line: {\n                        borderWidth: 2,\n                        fill: fill,\n                        tension: 0\n                    },\n                    point: { radius: 0 }\n                },\n                scales: {\n                    xAxes: [{\n                        type: \"linear\",\n                        gridLines: {\n                            zeroLineColor: \"#9E9E9E\",\n                            color: themeService.getTheme().gridLinesColor\n                        },\n                        afterBuildTicks: function (scale) {\n                            angular.forEach(scale.ticks, function (tick, index) {\n                                if (index !== 0 && stepSize != undefined)\n                                    scale.ticks[index] -= tick % stepSize;\n                            })\n                        },\n                        ticks: {\n                            maxRotation: 0,\n                            fixedStepSize: stepSize,\n                            callback: function (value, index, values) {\n                                if (index === 0)\n                                    return \"\";\n                                var d = new Date(value);\n\n                                if (values[values.length - 1] - values[0] > (25 * 60 * 60 * 1000))\n                                    return  [d.getUTCHours() + \"h\" + d.getUTCMinutes(),  d.getUTCDate() + \"/\" + d.getUTCMonth() + \"/\" + d.getUTCFullYear()];\n\n                                var label = d.getUTCHours() + \"h\";  //Hours\n                                if (d.getUTCMinutes() < 10)         //Minutes\n                                    label += 0;\n                                label += d.getUTCMinutes();\n                                if (d.getUTCSeconds() !== 0)        //Seconds\n                                    label += \":\" + d.getUTCSeconds();\n                                return label;\n                            }\n                        }\n                    }]\n                }\n            }\n        }\n\n        /* PUBLIC API */\n        return {\n\n            /** Graphics scales */\n            scales: {\n                \"1 min\": { scale: 60000, stepSize: 15000, bufferId: 'bufferOneMinute' },\n                \"5 min\": { scale: 300000, stepSize: 60000, bufferId: 'bufferFiveMinutes' },\n                \"30 min\": { scale: 1800000, stepSize: 300000, bufferId: 'bufferThirtyMinutes' },\n                \"1h\": { scale: 3600000, stepSize: 600000, bufferId: 'bufferOneHour' },\n                \"3h\": { scale: 10800000, stepSize: 1800000, bufferId: 'bufferThreeHours' },\n                \"6h\": { scale: 21600000, stepSize: 3600000, bufferId: 'bufferSixHours' },\n                \"12h\": { scale: 43200000, stepSize: 7200000, bufferId: 'bufferTwelveHours' },\n                \"24h\": { scale: 86400000, stepSize: 14400000, bufferId: 'bufferOneDay' }\n            },\n\n            /** Generate the chart options\n            * @param stepSize\n            * @param fill\n            */\n            getChartOptions: getChartOptions\n\n\n        };\n    }\n})();\n\n/** localeService : provides methods to select the application'language \n/* To see: https://scotch.io/tutorials/internationalization-of-angularjs-applications */\n(function () {\n    'use strict';\n    angular.module('tsa.services').service('localeService', LocaleService);\n\n    function LocaleService($translate, LOCALES, $rootScope, tmhDynamicLocale) {\n\n        // EVENTS TODO: Useful ? \n        // on successful applying translations by angular-translate\n        $rootScope.$on('$translateChangeSuccess', function (event, data) {\n            document.documentElement.setAttribute('lang', data.language);// sets \"lang\" attribute to html\n\n            // asking angular-dynamic-locale to load and apply proper AngularJS $locale setting\n            tmhDynamicLocale.set(data.language.toLowerCase().replace(/_/g, '-'));\n        });\n\n        return {\n            /* Get the current locale (=language used) */\n            getCurrentLocale: function () {\n                return $translate.proposedLanguage() ? LOCALES.locales[$translate.proposedLanguage()] : LOCALES.locales[LOCALES.preferredLocale];\n            },\n\n            /* Get the locale list */\n            getLocaleList: function () { return LOCALES.locales; },\n\n            /* Set the current locale */\n            setCurrentLocale: function (locale) { $translate.use(locale.id); },\n        }\n    }\n})();\n\n/**\n * ThemeService: angular service used to manage the theme\n */\n(function () {\n    'use strict';\n    angular.module(\"tsa.services\")\n        .factory(\"themeService\", function ($log, $rootScope) {\n            /** PROPERTIES */\n            var logger = $log.getInstance(\"themeService\");\n            var THEME = {\n                DAY: {id: \"day\", icon:\"wb_sunny\", gridLinesColor: \"#E0E0E0\"},\n                NIGHT: {id: \"night\", icon: \"brightness_3\", gridLinesColor: \"#424242\"}\n            };\n            var currentTheme = angular.copy(THEME.DAY);\n\n            /** PUBLIC API */\n            return {\n                // Theme enum\n                THEME: THEME,\n                // Getter\n                getTheme: function getTheme() {\n                    return currentTheme;\n                },\n                // Setter\n                setTheme: function setTheme(newTheme) {\n                    currentTheme.id = newTheme.id;\n                    currentTheme.icon = newTheme.icon;\n                    currentTheme.gridLinesColor = newTheme.gridLinesColor;\n                    logger.log(\"theme changed to \"+ newTheme.id);\n                    this.notify();\n                },\n\n                subscribe: function subscribe(scope, callback, callOnSubscribe) {\n                \tif (typeof callOnSubscribe === 'undefined') { callOnSubscribe = true; }\n\n                    var handler = $rootScope.$on('changeTheme-themeService-event', callback);\n                    if(callOnSubscribe) callback(null, currentTheme);\n                    scope.$on('$destroy', handler);\n                },\n\n                notify: function notify() {\n                    $rootScope.$emit('changeTheme-themeService-event', currentTheme);\n                }\n\n            }\n        });\n})();\n\n(function () {\n  'use strict';\n  angular.module(\"tsa.services.filters\",[]);\n\n  /**\n   * Filter used to sort device/data lists by alphabetic order.\n   */\n  angular\n    .module('tsa.services.filters')\n    .filter('orderObjectBy', function () {\n      return function (items, field, reverse) {\n        var filtered = [];\n        angular.forEach(items, function (item) {\n          filtered.push(item);\n        });\n        filtered.sort(function (a, b) {\n          return (a[field] > b[field]) ? 1 : ((a[field] < b[field]) ? -1 : 0);\n        });\n        if (reverse) filtered.reverse();\n        return filtered;\n      };\n    })\n    .filter('marineDistance', function () {\n      return function (distance) {\n        var res = '';\n        if(distance >= 1852) {\n          res = sprintf('%.1f nm', distance/1852);\n        } else {\n          res = sprintf('%.1f m', distance);\n        }\n        return res;\n      };\n    })\n    .filter('timeInHoursMins', function () {\n      return function (time) {\n        var timeInMinutes = Math.round(time/60000.0);\n        var minutes = timeInMinutes%60;\n        var hours = Math.round((timeInMinutes - minutes)/60);\n        return sprintf('%02d:%02d', hours, minutes);\n      };\n    });\n})();\n\n/**\n * videoCallService: angular service used to manage video calls\n *\n * var server = \"ws://\" + window.location.hostname + \":8188\";\n *\n * var server = null;\n * if(window.location.protocol === 'http:')\n *     server = \"http://\" + window.location.hostname + \":8088/janus\";\n * else\n *     server = \"https://\" + window.location.hostname + \":8089/janus\";\n *\n *\n * debug chrome :\n * --unsafely-treat-insecure-origin-as-secure=\"http://localhost:8000\" --use-fake-device-for-media-stream\n * --unsafely-treat-insecure-origin-as-secure=\"http://134.246.151.113:8000\" --use-fake-device-for-media-stream\n * host :\n * --unsafely-treat-insecure-origin-as-secure=\"http://192.168.229.128:8000\" http://192.168.229.128:8000/videocalltest.html\n * vm : http://localhost:3000/#/dashboard\n * --use-fake-device-for-media-stream --unsafely-treat-insecure-origin-as-secure=\"http://192.168.229.1:3000\" http://192.168.229.1:3000/#/dashboard\n *\n *\n * janus :\n * cd /usr/local/janus/bin/; ./janus\n * cd /usr/local/janus/share/janus/demos/; python -m SimpleHTTPServer 8000\n *\n * debug firefox :\n *  profile.setPreference('media.navigator.streams.fake', true);\n *\n */\n(function () {\n\t'use strict';\n\tangular.module(\"tsa.services\")\n        .factory(\"videoCallService\", function ($log, $rootScope, $filter, $location, $mdDialog, $interval,\n            dialogService, dashboardService, staticGridService, userService, AUTHORITIES, JANUS_SERVER_URL) {\n\t\t\t/** PROPERTIES */\n\t\t\tvar logger = $log.getInstance(\"videoCallService\");\n\t\t\tvar server = JANUS_SERVER_URL;\n\t\t\tvar debug = ['error', 'warn'];\n\t\t\tvar janus = undefined;\n\t\t\tvar videocall = undefined;\n            var pollUsers = undefined;\n            var opaqueId = \"videocalltest-\"+Janus.randomString(12);\n\n            var localvideo = undefined;\n            var remotevideo = undefined;\n\n            var videoCallState = {\n                state: 0,\n                userList: [],\n                currentUser: undefined\n            }\n\n\t\t\tfunction checkUser() {\n                videoCallState.currentUser = userService.getCurrentUser();\n\t\t\t\tif(angular.isDefined(videoCallState.currentUser) && videoCallState.currentUser.hasAuthority(AUTHORITIES.VIDEOCALL)) {\n\t\t\t\t\tstartJanus();\n\t\t\t\t} else {\n\t\t\t\t\tstopJanus();\n                }\n\t\t\t}\n\n\t\t\tfunction startJanus() {\n\t\t\t\t// Initialize the library (console debug enabled)\n\t\t\t\tJanus.init({debug: debug, callback: function() {\n\t\t\t\t\tif(!Janus.isWebrtcSupported()) {\n\t\t\t\t\t\tlogger.error(\"No WebRTC support...\");\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\t// Create session\n\t\t\t\t\tjanus = new Janus({\n\t\t\t\t\t\tserver: server,\n\t\t\t\t\t\tsuccess: function() {\n\t\t\t\t\t\t\t// Attach to echo test plugin\n\t\t\t\t\t\t\tjanus.attach({\n\t\t\t\t\t\t\t\tplugin: \"janus.plugin.videocall\",\n\t\t\t\t\t\t\t\topaqueId: opaqueId,\n\t\t\t\t\t\t\t\tsuccess: function(pluginHandle) {\n\t\t\t\t\t\t\t\t\tvideocall = pluginHandle;\n\t\t\t\t\t\t\t\t\tJanus.log(\"Plugin attached! (\" + videocall.getPlugin() + \", id=\" + videocall.getId() + \")\");\n\n\t\t\t\t\t\t\t\t\tregisterUsername(videoCallState.currentUser.login);\n                                    videoCallState.state = 1;\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\terror: function(error) {\n\t\t\t\t\t\t\t\t\tJanus.error(\"  -- Error attaching plugin...\", error);\n\t\t\t\t\t\t\t\t\t// bootbox.alert(\"  -- Error attaching plugin... \" + error);\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tconsentDialog: function(on) {\n\t\t\t\t\t\t\t\t\tJanus.debug(\"Consent dialog should be \" + (on ? \"on\" : \"off\") + \" now\");\n\t\t\t\t\t\t\t\t\tif(on) {\n\t\t\t\t\t\t\t\t\t\t// Darken screen and show hint\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t// Restore screen\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tmediaState: function(medium, on) {\n\t\t\t\t\t\t\t\t\tJanus.log(\"Janus \" + (on ? \"started\" : \"stopped\") + \" receiving our \" + medium);\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\twebrtcState: function(on) {\n\t\t\t\t\t\t\t\t\tJanus.log(\"Janus says our WebRTC PeerConnection is \" + (on ? \"up\" : \"down\") + \" now\");\n                                    videoCallState.state = 3;\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tonmessage: function(msg, jsep) {\n\t\t\t\t\t\t\t\t\tJanus.debug(\" ::: Got a message :::\");\n\t\t\t\t\t\t\t\t\tJanus.debug(msg);\n\t\t\t\t\t\t\t\t\tvar result = msg[\"result\"];\n\t\t\t\t\t\t\t\t\tif(result !== null && result !== undefined) {\n\t\t\t\t\t\t\t\t\t\tif(result[\"list\"] !== undefined && result[\"list\"] !== null) {\n\t\t\t\t\t\t\t\t\t\t\tvar list = result[\"list\"];\n\t\t\t\t\t\t\t\t\t\t\tJanus.debug(\"Got a list of registered peers:\");\n\t\t\t\t\t\t\t\t\t\t\tJanus.debug(list);\n\t\t\t\t\t\t\t\t\t\t\tvideoCallState.userList.length = 0;\n\t\t\t\t\t\t\t\t\t\t\tfor(var mp in list) {\n\t\t\t\t\t\t\t\t\t\t\t\tvar login = list[mp];\n\t\t\t\t\t\t\t\t\t\t\t\tJanus.debug(\"  >> [\" + list[mp] + \"]\");\n\t\t\t\t\t\t\t\t\t\t\t\tif(videoCallState.currentUser && (videoCallState.currentUser.login != login)) {\n\t\t\t\t\t\t\t\t\t\t\t\t\tvideoCallState.userList.push(list[mp]);\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t} else if(result[\"event\"] !== undefined && result[\"event\"] !== null) {\n\t\t\t\t\t\t\t\t\t\t\tvar event = result[\"event\"];\n\t\t\t\t\t\t\t\t\t\t\tif(event === 'registered') {\n\t\t\t\t\t\t\t\t\t\t\t\tmyusername = result[\"username\"];\n\t\t\t\t\t\t\t\t\t\t\t\tJanus.log(\"Successfully registered as \" + myusername + \"!\");\n\t\t\t\t\t\t\t\t\t\t//\t\tvideocall.send({\"message\": { \"request\": \"list\" }});\n\t\t\t\t\t\t\t\t\t\t\t} else if(event === 'calling') {\n\t\t\t\t\t\t\t\t\t\t\t\tJanus.log(\"Waiting for the peer to answer...\");\n\t\t\t\t\t\t\t\t\t\t\t\t// TODO Any ringtone?\n\t\t\t\t\t\t\t\t\t\t\t\t// bootbox.alert(\"Waiting for the peer to answer...\");\n\t\t\t\t\t\t\t\t\t\t\t} else if(event === 'incomingcall') {\n\t\t\t\t\t\t\t\t\t\t\t\tJanus.log(\"Incoming call from \" + result[\"username\"] + \"!\");\n                                                yourusername = result[\"username\"];\n                                                var ringtone = document.getElementById(\"ringtone\");\n                                                ringtone.play();\n                                                dialogService.showValidation(\n                                                    $filter('translate')(\"views.video-call.incomingCall.title\"),\n                                                    $filter('translate')(\"views.video-call.incomingCall.message\") +\n                                                        yourusername,\n                                                    $filter('translate')(\"views.video-call.incomingCall.accept\"),\n                                                    $filter('translate')(\"views.video-call.incomingCall.decline\")).then(\n                                                        function accept() {\n                                                            ringtone.pause();\n                                                            findOrOpenVideoCall();\n                                                            videocall.createAnswer(\n                                                                {\n                                                                    jsep: jsep,\n                                                                    // No media provided: by default, it's sendrecv for audio and video\n                                                                    media: { data: false },\t// Let's negotiate data channels as well\n                                                                    // If you want to test simulcasting (Chrome and Firefox only), then\n                                                                    // pass a ?simulcast=true when opening this demo page: it will turn\n                                                                    // the following 'simulcast' property to pass to janus.js to true\n                                                                    simulcast: false,\n                                                                    success: function(jsep) {\n                                                                        Janus.debug(\"Got SDP!\");\n                                                                        Janus.debug(jsep);\n                                                                        var body = { \"request\": \"accept\" };\n                                                                        videocall.send({\"message\": body, \"jsep\": jsep});\n                                                                    },\n                                                                    error: function(error) {\n                                                                        Janus.error(\"WebRTC error:\", error);\n                                                                    }\n                                                                });\n                                                        },\n                                                        function decline() {\n                                                            ringtone.pause();\n                                                            doHangup();\n                                                        }\n                                                    );\n\t\t\t\t\t\t\t\t\t\t\t} else if(event === 'accepted') {\n\t\t\t\t\t\t\t\t\t\t\t\tvar peer = result[\"username\"];\n\t\t\t\t\t\t\t\t\t\t\t\tif(peer === null || peer === undefined) {\n\t\t\t\t\t\t\t\t\t\t\t\t\tJanus.log(\"Call started!\");\n\t\t\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\t\t\tJanus.log(peer + \" accepted the call!\");\n\t\t\t\t\t\t\t\t\t\t\t\t\tyourusername = peer;\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t// Video call can start\n\t\t\t\t\t\t\t\t\t\t\t\tif(jsep)\n\t\t\t\t\t\t\t\t\t\t\t\t\tvideocall.handleRemoteJsep({jsep: jsep});\n                                            } else if(event === 'update') {\n\t\t\t\t\t\t\t\t\t\t\t\t// An 'update' event may be used to provide renegotiation attempts\n\t\t\t\t\t\t\t\t\t\t\t\tif(jsep) {\n\t\t\t\t\t\t\t\t\t\t\t\t\tif(jsep.type === \"answer\") {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tvideocall.handleRemoteJsep({jsep: jsep});\n\t\t\t\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tvideocall.createAnswer({\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tjsep: jsep,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tmedia: { data: false },\t// Let's negotiate data channels as well\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsuccess: function(jsep) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tJanus.debug(\"Got SDP!\");\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tJanus.debug(jsep);\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvar body = { \"request\": \"set\" };\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvideocall.send({\"message\": body, \"jsep\": jsep});\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\terror: function(error) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tJanus.error(\"WebRTC error:\", error);\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t// bootbox.alert(\"WebRTC error... \" + JSON.stringify(error));\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t} else if(event === 'hangup') {\n\t\t\t\t\t\t\t\t\t\t\t\tJanus.log(\"Call hung up by \" + result[\"username\"] + \" (\" + result[\"reason\"] + \")!\");\n\t\t\t\t\t\t\t\t\t\t\t\t// Reset status\n                                                // bootbox.hideAll();\n                                                videoCallState.state = 1;\n\t\t\t\t\t\t\t\t\t\t\t\tvideocall.hangup();\n\t\t\t\t\t\t\t\t\t\t\t} else if(event === \"simulcast\") {\n\t\t\t\t\t\t\t\t\t\t\t\t// Is simulcast in place?\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t// FIXME Error?\n\t\t\t\t\t\t\t\t\t\tvar error = msg[\"error\"];\n\t\t\t\t\t\t\t\t\t\tlogger.error(error);\n\t\t\t\t\t\t\t\t\t\t// TODO Reset status\n\t\t\t\t\t\t\t\t\t\tvideocall.hangup();\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tonlocalstream: function(stream) {\n\t\t\t\t\t\t\t\t\tJanus.debug(\" ::: Got a local stream :::\");\n\t\t\t\t\t\t\t\t\tJanus.debug(stream);\n\t\t\t\t\t\t\t\t\tJanus.attachMediaStream(localvideo, stream);\n\t\t\t\t\t\t\t\t\t// $(\"#myvideo\").get(0).muted = \"muted\";\n\t\t\t\t\t\t\t\t\tif(videocall.webrtcStuff.pc.iceConnectionState !== \"completed\" &&\n\t\t\t\t\t\t\t\t\t\t\tvideocall.webrtcStuff.pc.iceConnectionState !== \"connected\") {\n\t\t\t\t\t\t\t\t\t\t// $(\"#videoleft\").parent().block({\n\t\t\t\t\t\t\t\t\t\t// \tmessage: '<b>Publishing...</b>',\n\t\t\t\t\t\t\t\t\t\t// \tcss: {\n\t\t\t\t\t\t\t\t\t\t// \t\tborder: 'none',\n\t\t\t\t\t\t\t\t\t\t// \t\tbackgroundColor: 'transparent',\n\t\t\t\t\t\t\t\t\t\t// \t\tcolor: 'white'\n\t\t\t\t\t\t\t\t\t\t// \t}\n\t\t\t\t\t\t\t\t\t\t// });\n\t\t\t\t\t\t\t\t\t\t// No remote video yet\n\t\t\t\t\t\t\t\t\t\t// $('#videoright').append('<video class=\"rounded centered\" id=\"waitingvideo\" width=320 height=240 />');\n\t\t\t\t\t\t\t\t\t\t// if(spinner == null) {\n\t\t\t\t\t\t\t\t\t\t// \tvar target = document.getElementById('videoright');\n\t\t\t\t\t\t\t\t\t\t// \tspinner = new Spinner({top:100}).spin(target);\n\t\t\t\t\t\t\t\t\t\t// } else {\n\t\t\t\t\t\t\t\t\t\t// \tspinner.spin();\n\t\t\t\t\t\t\t\t\t\t// }\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tvar videoTracks = stream.getVideoTracks();\n\t\t\t\t\t\t\t\t\tif(videoTracks === null || videoTracks === undefined || videoTracks.length === 0) {\n\t\t\t\t\t\t\t\t\t\t// No webcam\n\t\t\t\t\t\t\t\t\t\t// $('#myvideo').hide();\n\t\t\t\t\t\t\t\t\t\t// if($('#videoleft .no-video-container').length === 0) {\n\t\t\t\t\t\t\t\t\t\t// \t$('#videoleft').append(\n\t\t\t\t\t\t\t\t\t\t// \t\t'<div class=\"no-video-container\">' +\n\t\t\t\t\t\t\t\t\t\t// \t\t\t'<i class=\"fa fa-video-camera fa-5 no-video-icon\"></i>' +\n\t\t\t\t\t\t\t\t\t\t// \t\t\t'<span class=\"no-video-text\">No webcam available</span>' +\n\t\t\t\t\t\t\t\t\t\t// \t\t'</div>');\n\t\t\t\t\t\t\t\t\t\t// }\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t// $('#videoleft .no-video-container').remove();\n\t\t\t\t\t\t\t\t\t\t// $('#myvideo').removeClass('hide').show();\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tonremotestream: function(stream) {\n\t\t\t\t\t\t\t\t\tJanus.debug(\" ::: Got a remote stream :::\");\n\t\t\t\t\t\t\t\t\tJanus.debug(stream);\n\t\t\t\t\t\t\t\t\t// var addButtons = false;\n\t\t\t\t\t\t\t\t\t// if($('#remotevideo').length === 0) {\n\t\t\t\t\t\t\t\t\t// \taddButtons = true;\n\t\t\t\t\t\t\t\t\t// \t$('#videoright').append('<video class=\"rounded centered hide\" id=\"remotevideo\" width=320 height=240 autoplay playsinline/>');\n\t\t\t\t\t\t\t\t\t// \t// Show the video, hide the spinner and show the resolution when we get a playing event\n\t\t\t\t\t\t\t\t\t// \t$(\"#remotevideo\").bind(\"playing\", function () {\n\t\t\t\t\t\t\t\t\t// \t\t$('#waitingvideo').remove();\n\t\t\t\t\t\t\t\t\t// \t\tif(this.videoWidth)\n\t\t\t\t\t\t\t\t\t// \t\t\t$('#remotevideo').removeClass('hide').show();\n\t\t\t\t\t\t\t\t\t// \t\tif(spinner !== null && spinner !== undefined)\n\t\t\t\t\t\t\t\t\t// \t\t\tspinner.stop();\n\t\t\t\t\t\t\t\t\t// \t\tspinner = null;\n\t\t\t\t\t\t\t\t\t// \t\tvar width = this.videoWidth;\n\t\t\t\t\t\t\t\t\t// \t\tvar height = this.videoHeight;\n\t\t\t\t\t\t\t\t\t// \t\t$('#curres').removeClass('hide').text(width+'x'+height).show();\n\t\t\t\t\t\t\t\t\t// \t});\n\t\t\t\t\t\t\t\t\t// \t$('#callee').removeClass('hide').html(yourusername).show();\n\t\t\t\t\t\t\t\t\t// }\n\t\t\t\t\t\t\t\t\t// Janus.attachMediaStream($('#remotevideo').get(0), stream);\n    \t\t\t\t\t\t\t\tJanus.attachMediaStream(remotevideo, stream);\n                                    // var videoTracks = stream.getVideoTracks();\n\t\t\t\t\t\t\t\t\t// if(videoTracks === null || videoTracks === undefined || videoTracks.length === 0) {\n\t\t\t\t\t\t\t\t\t// \t// No remote video\n\t\t\t\t\t\t\t\t\t// \t$('#remotevideo').hide();\n\t\t\t\t\t\t\t\t\t// \tif($('#videoright .no-video-container').length === 0) {\n\t\t\t\t\t\t\t\t\t// \t\t$('#videoright').append(\n\t\t\t\t\t\t\t\t\t// \t\t\t'<div class=\"no-video-container\">' +\n\t\t\t\t\t\t\t\t\t// \t\t\t\t'<i class=\"fa fa-video-camera fa-5 no-video-icon\"></i>' +\n\t\t\t\t\t\t\t\t\t// \t\t\t\t'<span class=\"no-video-text\">No remote video available</span>' +\n\t\t\t\t\t\t\t\t\t// \t\t\t'</div>');\n\t\t\t\t\t\t\t\t\t// \t}\n\t\t\t\t\t\t\t\t\t// } else {\n\t\t\t\t\t\t\t\t\t// \t$('#videoright .no-video-container').remove();\n\t\t\t\t\t\t\t\t\t// \t$('#remotevideo').removeClass('hide').show();\n\t\t\t\t\t\t\t\t\t// }\n\t\t\t\t\t\t\t\t\t// if(!addButtons)\n\t\t\t\t\t\t\t\t\t// \treturn;\n\t\t\t\t\t\t\t\t\t// // Enable audio/video buttons and bitrate limiter\n\t\t\t\t\t\t\t\t\t// audioenabled = true;\n\t\t\t\t\t\t\t\t\t// videoenabled = true;\n\t\t\t\t\t\t\t\t\t// $('#toggleaudio').html(\"Disable audio\").removeClass(\"btn-success\").addClass(\"btn-danger\")\n\t\t\t\t\t\t\t\t\t// \t\t.unbind('click').removeAttr('disabled').click(\n\t\t\t\t\t\t\t\t\t// \tfunction() {\n\t\t\t\t\t\t\t\t\t// \t\taudioenabled = !audioenabled;\n\t\t\t\t\t\t\t\t\t// \t\tif(audioenabled)\n\t\t\t\t\t\t\t\t\t// \t\t\t$('#toggleaudio').html(\"Disable audio\").removeClass(\"btn-success\").addClass(\"btn-danger\");\n\t\t\t\t\t\t\t\t\t// \t\telse\n\t\t\t\t\t\t\t\t\t// \t\t\t$('#toggleaudio').html(\"Enable audio\").removeClass(\"btn-danger\").addClass(\"btn-success\");\n\t\t\t\t\t\t\t\t\t// \t\tvideocall.send({\"message\": { \"request\": \"set\", \"audio\": audioenabled }});\n\t\t\t\t\t\t\t\t\t// \t});\n\t\t\t\t\t\t\t\t\t// $('#togglevideo').html(\"Disable video\").removeClass(\"btn-success\").addClass(\"btn-danger\")\n\t\t\t\t\t\t\t\t\t// \t\t.unbind('click').removeAttr('disabled').click(\n\t\t\t\t\t\t\t\t\t// \tfunction() {\n\t\t\t\t\t\t\t\t\t// \t\tvideoenabled = !videoenabled;\n\t\t\t\t\t\t\t\t\t// \t\tif(videoenabled)\n\t\t\t\t\t\t\t\t\t// \t\t\t$('#togglevideo').html(\"Disable video\").removeClass(\"btn-success\").addClass(\"btn-danger\");\n\t\t\t\t\t\t\t\t\t// \t\telse\n\t\t\t\t\t\t\t\t\t// \t\t\t$('#togglevideo').html(\"Enable video\").removeClass(\"btn-danger\").addClass(\"btn-success\");\n\t\t\t\t\t\t\t\t\t// \t\tvideocall.send({\"message\": { \"request\": \"set\", \"video\": videoenabled }});\n\t\t\t\t\t\t\t\t\t// \t});\n\t\t\t\t\t\t\t\t\t// $('#toggleaudio').parent().removeClass('hide').show();\n\t\t\t\t\t\t\t\t\t// $('#bitrateset').html(\"Bandwidth\");\n\t\t\t\t\t\t\t\t\t// $('#bitrate a').unbind('click').removeAttr('disabled').click(function() {\n\t\t\t\t\t\t\t\t\t// \tvar id = $(this).attr(\"id\");\n\t\t\t\t\t\t\t\t\t// \tvar bitrate = parseInt(id)*1000;\n\t\t\t\t\t\t\t\t\t// \tif(bitrate === 0) {\n\t\t\t\t\t\t\t\t\t// \t\tJanus.log(\"Not limiting bandwidth via REMB\");\n\t\t\t\t\t\t\t\t\t// \t} else {\n\t\t\t\t\t\t\t\t\t// \t\tJanus.log(\"Capping bandwidth to \" + bitrate + \" via REMB\");\n\t\t\t\t\t\t\t\t\t// \t}\n\t\t\t\t\t\t\t\t\t// \t$('#bitrateset').html($(this).html()).parent().removeClass('open');\n\t\t\t\t\t\t\t\t\t// \tvideocall.send({\"message\": { \"request\": \"set\", \"bitrate\": bitrate }});\n\t\t\t\t\t\t\t\t\t// \treturn false;\n\t\t\t\t\t\t\t\t\t// });\n\t\t\t\t\t\t\t\t\t// if(Janus.webRTCAdapter.browserDetails.browser === \"chrome\" || Janus.webRTCAdapter.browserDetails.browser === \"firefox\" ||\n\t\t\t\t\t\t\t\t\t// \t\tJanus.webRTCAdapter.browserDetails.browser === \"safari\") {\n\t\t\t\t\t\t\t\t\t// \t$('#curbitrate').removeClass('hide').show();\n\t\t\t\t\t\t\t\t\t// \tbitrateTimer = setInterval(function() {\n\t\t\t\t\t\t\t\t\t// \t\t// Display updated bitrate, if supported\n\t\t\t\t\t\t\t\t\t// \t\tvar bitrate = videocall.getBitrate();\n\t\t\t\t\t\t\t\t\t// \t\t$('#curbitrate').text(bitrate);\n\t\t\t\t\t\t\t\t\t// \t\t// Check if the resolution changed too\n\t\t\t\t\t\t\t\t\t// \t\tvar width = $(\"#remotevideo\").get(0).videoWidth;\n\t\t\t\t\t\t\t\t\t// \t\tvar height = $(\"#remotevideo\").get(0).videoHeight;\n\t\t\t\t\t\t\t\t\t// \t\tif(width > 0 && height > 0)\n\t\t\t\t\t\t\t\t\t// \t\t\t$('#curres').removeClass('hide').text(width+'x'+height).show();\n\t\t\t\t\t\t\t\t\t// \t}, 1000);\n\t\t\t\t\t\t\t\t\t// }\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tondataopen: function(data) {\n\t\t\t\t\t\t\t\t\tJanus.log(\"The DataChannel is available!\");\n\t\t\t\t\t\t\t\t\t// $('#videos').removeClass('hide').show();\n\t\t\t\t\t\t\t\t\t// $('#datasend').removeAttr('disabled');\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tondata: function(data) {\n\t\t\t\t\t\t\t\t\tJanus.debug(\"We got data from the DataChannel! \" + data);\n\t\t\t\t\t\t\t\t\t// $('#datarecv').val(data);\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\toncleanup: function() {\n                                    Janus.log(\" ::: Got a cleanup notification :::\");\n                                    console.log(\"et moi ?\");\n                                    $mdDialog.cancel();\n                                    videoCallState.state = 1;\n\t\t\t\t\t\t\t\t\tyourusername = null;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t},\n\t\t\t\t\t\terror: function(error) {\n\t\t\t\t\t\t\tJanus.error(error);\n\t\t\t\t\t\t\t// bootbox.alert(error, function() {\n\t\t\t\t\t\t\t// \twindow.location.reload();\n\t\t\t\t\t\t\t// });\n\t\t\t\t\t\t},\n\t\t\t\t\t\tdestroyed: function() {\n\t\t\t\t\t\t\tif(pollUsers) {\n\t\t\t\t\t\t\t\tclearInterval(pollUsers);\n\t\t\t\t\t\t\t\tpollUsers = undefined;\n\t\t\t\t\t\t\t}\n                            videoCallState.userList.length = 0;\n                            videoCallState.state = 0;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}});\n\t\t\t}\n\n\t\t\tfunction stopJanus() {\n\t\t\t\tif(janus) {\n\t\t\t\t\tjanus.destroy();\n\t\t\t\t\tjanus = undefined;\n\t\t\t\t}\n            }\n\n            function findOrOpenVideoCall() {\n                if ($location.path() == '/static') {\n                    staticGridService.addVideoCallIfNeeded();\n                } else if($location.path() == '/dashboard') {\n                    // dashboard\n                    dashboardService.addVideoCallIfNeeded();\n                }\n            }\n\n\t\t\tfunction registerUsername(username) {\n\t\t\t\tvar register = { \"request\": \"register\", \"username\": username };\n\t\t\t\tvideocall.send({\"message\": register});\n\t\t\t}\n\n\t\t\tfunction doCall(username) {\n\t\t\t\t// Call someone\n\t\t\t\tvideocall.createOffer({\n\t\t\t\t\t// By default, it's sendrecv for audio and video...\n\t\t\t\t\tmedia: { data: false },\t// ... let's negotiate data channels as well\n\t\t\t\t\t// If you want to test simulcasting (Chrome and Firefox only), then\n\t\t\t\t\t// pass a ?simulcast=true when opening this demo page: it will turn\n\t\t\t\t\t// the following 'simulcast' property to pass to janus.js to true\n\t\t\t\t\tsimulcast: false,\n\t\t\t\t\tsuccess: function(jsep) {\n\t\t\t\t\t\tJanus.debug(\"Got SDP!\");\n\t\t\t\t\t\tJanus.debug(jsep);\n\t\t\t\t\t\tvar body = { \"request\": \"call\", \"username\": username };\n\t\t\t\t\t\tvideocall.send({\"message\": body, \"jsep\": jsep});\n\t\t\t\t\t},\n\t\t\t\t\terror: function(error) {\n\t\t\t\t\t\tJanus.error(\"WebRTC error...\", error);\n\t\t\t\t\t\t// bootbox.alert(\"WebRTC error... \" + error);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tfunction doHangup() {\n\t\t\t\tvar hangup = { \"request\": \"hangup\" };\n\t\t\t\tvideocall.send({\"message\": hangup});\n                videocall.hangup();\n                yourusername = null;\n\t\t\t}\n\n\n\t\t\t/** PUBLIC API */\n\t\t\treturn {\n\n\t\t\t\tinit: function init() {\n\t\t\t\t\t$rootScope.$on('current-user-changed', function () {\n\t\t\t\t\t\tcheckUser();\n\t\t\t\t\t});\n                    checkUser();\n\n                    $interval(function () {\n                        if(videoCallState.state >=1) {\n                            videocall.send({\"message\": { \"request\": \"list\" }});\n                        }\n                    }, 5000);\n                },\n\n                setVideo: function setVideo(lvideo, rvideo) {\n                    localvideo = lvideo;\n                    remotevideo = rvideo;\n                },\n\n\t\t\t\tgetVideoCallState: function getVideoCallState() {\n\t\t\t\t\treturn videoCallState;\n\t\t\t\t},\n\n\t\t\t\tvideoCall: function videoCall(username) {\n                    videoCallState.state = 2;\n                    doCall(username);\n                },\n\n                hangup: function hangup() {\n                    doHangup();\n                    videoCallState.state = 1;\n                },\n\n                enableVideo: function enableVideo( enabled) {\n                    videocall.send({\"message\": { \"request\": \"set\", \"video\": enabled }});\n                },\n\n                enableAudio: function enableAudio( enabled) {\n                    videocall.send({\"message\": { \"request\": \"set\", \"audio\": enabled }});\n                }\n\t\t\t}\n\t\t});\n})();\n\n/**\n * ThemeService: angular service used to manage the theme\n */\n(function () {\n    'use strict';\n    angular.module(\"tsa.services\")\n        .factory(\"videoStreamingService\", function ($log, $rootScope, VIDEO_PARAMS, JANUS_SERVER_URL) {\n            /** PROPERTIES */\n            var logger = $log.getInstance(\"videoStreamingService\");\n\n\t\t\tvar server = JANUS_SERVER_URL;\n\t\t\tconsole.log('janus server ' + server);\n\t\t\t/** PUBLIC API */\n            return {\n\n            \tstartJanus: function startJanus(successCallback, videoElm) {\n            \t\t// Initialize the library (all console debuggers enabled)\n            \t\tJanus.init({debug: ['error', 'warn'], callback: function() {\n            \t\t\t// Create session\n            \t\t\tvar opaqueId = \"streamingtest-\"+Janus.randomString(12);\n            \t\t\tvar janus = null;\n            \t\t\tjanus = new Janus(\n            \t\t\t\t{\n            \t\t\t\t\tserver: server,\n            \t\t\t\t\tsuccess: function() {\n            \t\t\t\t\t\t// Attach to streaming plugin\n            \t\t\t\t\t\tjanus.attach(\n            \t\t\t\t\t\t\t{\n            \t\t\t\t\t\t\t\tplugin: \"janus.plugin.streaming\",\n            \t\t\t\t\t\t\t\topaqueId: opaqueId,\n            \t\t\t\t\t\t\t\tsuccess: function(pluginHandle) {\n            \t\t\t\t\t\t\t\t\tvar streaming = pluginHandle;\n            \t\t\t\t\t\t\t\t\tJanus.log(\"Plugin attached! (\" + streaming.getPlugin() + \", id=\" + streaming.getId() + \")\");\n            \t\t\t\t\t\t\t\t\tjanus.mystreaming = streaming;\n\n            \t\t\t\t\t\t\t\t\tsuccessCallback(janus);\n            \t\t\t\t\t\t\t\t},\n            \t\t\t\t\t\t\t\terror: function(error) {\n            \t\t\t\t\t\t\t\t\tJanus.error(\"  -- Error attaching plugin... \", error);\n            \t\t\t\t\t\t\t\t},\n            \t\t\t\t\t\t\t\tonmessage: function(msg, jsep) {\n            \t\t\t\t\t\t\t\t\tJanus.debug(\" ::: Got a message :::\");\n            \t\t\t\t\t\t\t\t\tJanus.debug(msg);\n            \t\t\t\t\t\t\t\t\tvar result = msg[\"result\"];\n            \t\t\t\t\t\t\t\t\tif(result !== null && result !== undefined) {\n            \t\t\t\t\t\t\t\t\t\tif(result[\"status\"] !== undefined && result[\"status\"] !== null) {\n            \t\t\t\t\t\t\t\t\t\t\tvar status = result[\"status\"];\n            \t\t\t\t\t\t\t\t\t\t\tif(status === 'starting')\n            \t\t\t\t\t\t\t\t\t\t\t\t$('#status').removeClass('hide').text(\"Starting, please wait...\").show();\n            \t\t\t\t\t\t\t\t\t\t\telse if(status === 'started')\n            \t\t\t\t\t\t\t\t\t\t\t\t$('#status').removeClass('hide').text(\"Started\").show();\n            \t\t\t\t\t\t\t\t\t\t\telse if(status === 'stopped')\n            \t\t\t\t\t\t\t\t\t\t\t\tstopStream();\n            \t\t\t\t\t\t\t\t\t\t} else if(msg[\"streaming\"] === \"event\") {\n            \t\t\t\t\t\t\t\t\t\t\t// Is simulcast in place?\n            \t\t\t\t\t\t\t\t\t\t}\n            \t\t\t\t\t\t\t\t\t} else if(msg[\"error\"] !== undefined && msg[\"error\"] !== null) {\n\t\t\t\t\t\t\t\t\t\t\t\t\tconsole.log('on passe bien ici !');\n            \t\t\t\t\t\t\t\t\t\tconsole.log(msg[\"error\"]);\n\t\t\t\t\t\t\t\t\t\t\t\t\tstopStream();\n\t\t\t\t\t\t\t\t\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tconsole.log('start stream !!');\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tstartStream();\n\t\t\t\t\t\t\t\t\t\t\t\t\t}, 5000);\n            \t\t\t\t\t\t\t\t\t\treturn;\n            \t\t\t\t\t\t\t\t\t}\n            \t\t\t\t\t\t\t\t\tif(jsep !== undefined && jsep !== null) {\n            \t\t\t\t\t\t\t\t\t\tJanus.debug(\"Handling SDP as well...\");\n            \t\t\t\t\t\t\t\t\t\tJanus.debug(jsep);\n            \t\t\t\t\t\t\t\t\t\tvar streaming = janus.mystreaming;\n            \t\t\t\t\t\t\t\t\t\t// Offer from the plugin, let's answer\n            \t\t\t\t\t\t\t\t\t\tstreaming.createAnswer(\n            \t\t\t\t\t\t\t\t\t\t\t{\n            \t\t\t\t\t\t\t\t\t\t\t\tjsep: jsep,\n            \t\t\t\t\t\t\t\t\t\t\t\tmedia: { audioSend: false, videoSend: false },\t// We want recvonly audio/video\n            \t\t\t\t\t\t\t\t\t\t\t\tsuccess: function(jsep) {\n            \t\t\t\t\t\t\t\t\t\t\t\t\tJanus.debug(\"Got SDP!\");\n            \t\t\t\t\t\t\t\t\t\t\t\t\tJanus.debug(jsep);\n            \t\t\t\t\t\t\t\t\t\t\t\t\tvar body = { \"request\": \"start\" };\n            \t\t\t\t\t\t\t\t\t\t\t\t\tstreaming.send({\"message\": body, \"jsep\": jsep});\n            \t\t\t\t\t\t\t\t\t\t\t\t},\n            \t\t\t\t\t\t\t\t\t\t\t\terror: function(error) {\n            \t\t\t\t\t\t\t\t\t\t\t\t\tJanus.error(\"WebRTC error:\", error);\n            \t\t\t\t\t\t\t\t\t\t\t\t}\n            \t\t\t\t\t\t\t\t\t\t\t});\n            \t\t\t\t\t\t\t\t\t}\n            \t\t\t\t\t\t\t\t},\n            \t\t\t\t\t\t\t\tonremotestream: function(stream) {\n            \t\t\t\t\t\t\t\t\tJanus.debug(\" ::: Got a remote stream :::\");\n            \t\t\t\t\t\t\t\t\tJanus.debug(stream);\n            \t\t\t\t\t\t\t\t\t// TODO unbind remote video first ?\n\n            \t\t\t\t\t\t\t\t\tJanus.attachMediaStream(videoElm, stream);\n            \t\t\t\t\t\t\t\t\tvar videoTracks = stream.getVideoTracks();\n            \t\t\t\t\t\t\t\t\tif(videoTracks === null || videoTracks === undefined || videoTracks.length === 0) {\n            \t\t\t\t\t\t\t\t\t\t// No remote video\n            \t\t\t\t\t\t\t\t\t\tconsole.log(\"No remote video !\");\n            \t\t\t\t\t\t\t\t\t}\n            \t\t\t\t\t\t\t\t},\n            \t\t\t\t\t\t\t\toncleanup: function() {\n            \t\t\t\t\t\t\t\t\tJanus.log(\" ::: Got a cleanup notification :::\");\n            \t\t\t\t\t\t\t\t}\n            \t\t\t\t\t\t\t});\n            \t\t\t\t\t},\n            \t\t\t\t\terror: function(error) {\n\t\t\t\t\t\t\t\t\tconsole.log('ici');\n\t\t\t\t\t\t\t\t\tJanus.error(error);\n            \t\t\t\t\t},\n            \t\t\t\t\tdestroyed: function() {\n            \t\t\t\t\t\tJanus.log(\"Destroyed\");\n            \t\t\t\t\t}\n            \t\t\t\t});\n            \t\t}});\n            \t},\n\n            \tstopJanus: function stopJanus(janus) {\n            \t\tjanus.destroy();\n            \t},\n\n            \tstartStream: function startStream(janus, selectedStream) {\n            \t\tvar streaming = janus.mystreaming;\n            \t\tJanus.log(\"Selected video id #\" + selectedStream);\n            \t\tif(selectedStream === undefined || selectedStream === null) {\n            \t\t\tconsole.log(\"No stream selected\");\n            \t\t\treturn;\n            \t\t}\n            \t\tvar body = { \"request\": \"watch\", id: parseInt(selectedStream) };\n            \t\tstreaming.send({\"message\": body});\n            \t},\n\n            \tstopStream: function stopStream(janus) {\n            \t\tvar streaming = janus.mystreaming;\n            \t\tvar body = { \"request\": \"stop\" };\n            \t\tstreaming.send({\"message\": body});\n            \t\tstreaming.hangup();\n            \t}\n\n            }\n        });\n})();\n\n// We make use of this 'server' variable to provide the address of the\n// REST Janus API. By default, in this example we assume that Janus is\n// co-located with the web server hosting the HTML pages but listening\n// on a different port (8088, the default for HTTP in Janus), which is\n// why we make use of the 'window.location.hostname' base address. Since\n// Janus can also do HTTPS, and considering we don't really want to make\n// use of HTTP for Janus if your demos are served on HTTPS, we also rely\n// on the 'window.location.protocol' prefix to build the variable, in\n// particular to also change the port used to contact Janus (8088 for\n// HTTP and 8089 for HTTPS, if enabled).\n// In case you place Janus behind an Apache frontend (as we did on the\n// online demos at http://janus.conf.meetecho.com) you can just use a\n// relative path for the variable, e.g.:\n//\n// \t\tvar server = \"/janus\";\n//\n// which will take care of this on its own.\n//\n//\n// If you want to use the WebSockets frontend to Janus, instead, you'll\n// have to pass a different kind of address, e.g.:\n//\n// \t\tvar server = \"ws://\" + window.location.hostname + \":8188\";\n//\n// Of course this assumes that support for WebSockets has been built in\n// when compiling the server. WebSockets support has not been tested\n// as much as the REST API, so handle with care!\n//\n//\n// If you have multiple options available, and want to let the library\n// autodetect the best way to contact your server (or pool of servers),\n// you can also pass an array of servers, e.g., to provide alternative\n// means of access (e.g., try WebSockets first and, if that fails, fall\n// back to plain HTTP) or just have failover servers:\n//\n//\t\tvar server = [\n//\t\t\t\"ws://\" + window.location.hostname + \":8188\",\n//\t\t\t\"/janus\"\n//\t\t];\n//\n// This will tell the library to try connecting to each of the servers\n// in the presented order. The first working server will be used for\n// the whole session.\n//\nvar server = null;\nif(window.location.protocol === 'http:')\n\tserver = \"http://\" + window.location.hostname + \":8088/janus\";\nelse\n\tserver = \"https://\" + window.location.hostname + \":8089/janus\";\n\nvar janus = null;\nvar videocall = null;\nvar opaqueId = \"videocalltest-\"+Janus.randomString(12);\n\nvar bitrateTimer = null;\nvar spinner = null;\n\nvar audioenabled = false;\nvar videoenabled = false;\n\nvar myusername = null;\nvar yourusername = null;\n\nvar doSimulcast = (getQueryStringValue(\"simulcast\") === \"yes\" || getQueryStringValue(\"simulcast\") === \"true\");\nvar doSimulcast2 = (getQueryStringValue(\"simulcast2\") === \"yes\" || getQueryStringValue(\"simulcast2\") === \"true\");\nvar simulcastStarted = false;\n\n$(document).ready(function() {\n\t// Initialize the library (console debug enabled)\n\tJanus.init({debug: true, callback: function() {\n\t\t// Use a button to start the demo\n\t\t$('#start').one('click', function() {\n\t\t\t$(this).attr('disabled', true).unbind('click');\n\t\t\t// Make sure the browser supports WebRTC\n\t\t\tif(!Janus.isWebrtcSupported()) {\n\t\t\t\tbootbox.alert(\"No WebRTC support... \");\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t// Create session\n\t\t\tjanus = new Janus(\n\t\t\t\t{\n\t\t\t\t\tserver: server,\n\t\t\t\t\tsuccess: function() {\n\t\t\t\t\t\t// Attach to echo test plugin\n\t\t\t\t\t\tjanus.attach(\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tplugin: \"janus.plugin.videocall\",\n\t\t\t\t\t\t\t\topaqueId: opaqueId,\n\t\t\t\t\t\t\t\tsuccess: function(pluginHandle) {\n\t\t\t\t\t\t\t\t\t$('#details').remove();\n\t\t\t\t\t\t\t\t\tvideocall = pluginHandle;\n\t\t\t\t\t\t\t\t\tJanus.log(\"Plugin attached! (\" + videocall.getPlugin() + \", id=\" + videocall.getId() + \")\");\n\t\t\t\t\t\t\t\t\t// Prepare the username registration\n\t\t\t\t\t\t\t\t\t$('#videocall').removeClass('hide').show();\n\t\t\t\t\t\t\t\t\t$('#login').removeClass('hide').show();\n\t\t\t\t\t\t\t\t\t$('#registernow').removeClass('hide').show();\n\t\t\t\t\t\t\t\t\t$('#register').click(registerUsername);\n\t\t\t\t\t\t\t\t\t$('#username').focus();\n\t\t\t\t\t\t\t\t\t$('#start').removeAttr('disabled').html(\"Stop\")\n\t\t\t\t\t\t\t\t\t\t.click(function() {\n\t\t\t\t\t\t\t\t\t\t\t$(this).attr('disabled', true);\n\t\t\t\t\t\t\t\t\t\t\tjanus.destroy();\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\terror: function(error) {\n\t\t\t\t\t\t\t\t\tJanus.error(\"  -- Error attaching plugin...\", error);\n\t\t\t\t\t\t\t\t\tbootbox.alert(\"  -- Error attaching plugin... \" + error);\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tconsentDialog: function(on) {\n\t\t\t\t\t\t\t\t\tJanus.debug(\"Consent dialog should be \" + (on ? \"on\" : \"off\") + \" now\");\n\t\t\t\t\t\t\t\t\tif(on) {\n\t\t\t\t\t\t\t\t\t\t// Darken screen and show hint\n\t\t\t\t\t\t\t\t\t\t$.blockUI({\n\t\t\t\t\t\t\t\t\t\t\tmessage: '<div><img src=\"up_arrow.png\"/></div>',\n\t\t\t\t\t\t\t\t\t\t\tcss: {\n\t\t\t\t\t\t\t\t\t\t\t\tborder: 'none',\n\t\t\t\t\t\t\t\t\t\t\t\tpadding: '15px',\n\t\t\t\t\t\t\t\t\t\t\t\tbackgroundColor: 'transparent',\n\t\t\t\t\t\t\t\t\t\t\t\tcolor: '#aaa',\n\t\t\t\t\t\t\t\t\t\t\t\ttop: '10px',\n\t\t\t\t\t\t\t\t\t\t\t\tleft: (navigator.mozGetUserMedia ? '-100px' : '300px')\n\t\t\t\t\t\t\t\t\t\t\t} });\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t// Restore screen\n\t\t\t\t\t\t\t\t\t\t$.unblockUI();\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tmediaState: function(medium, on) {\n\t\t\t\t\t\t\t\t\tJanus.log(\"Janus \" + (on ? \"started\" : \"stopped\") + \" receiving our \" + medium);\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\twebrtcState: function(on) {\n\t\t\t\t\t\t\t\t\tJanus.log(\"Janus says our WebRTC PeerConnection is \" + (on ? \"up\" : \"down\") + \" now\");\n\t\t\t\t\t\t\t\t\t$(\"#videoleft\").parent().unblock();\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tonmessage: function(msg, jsep) {\n\t\t\t\t\t\t\t\t\tJanus.debug(\" ::: Got a message :::\");\n\t\t\t\t\t\t\t\t\tJanus.debug(msg);\n\t\t\t\t\t\t\t\t\tvar result = msg[\"result\"];\n\t\t\t\t\t\t\t\t\tif(result !== null && result !== undefined) {\n\t\t\t\t\t\t\t\t\t\tif(result[\"list\"] !== undefined && result[\"list\"] !== null) {\n\t\t\t\t\t\t\t\t\t\t\tvar list = result[\"list\"];\n\t\t\t\t\t\t\t\t\t\t\tJanus.debug(\"Got a list of registered peers:\");\n\t\t\t\t\t\t\t\t\t\t\tJanus.debug(list);\n\t\t\t\t\t\t\t\t\t\t\tfor(var mp in list) {\n\t\t\t\t\t\t\t\t\t\t\t\tJanus.debug(\"  >> [\" + list[mp] + \"]\");\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t} else if(result[\"event\"] !== undefined && result[\"event\"] !== null) {\n\t\t\t\t\t\t\t\t\t\t\tvar event = result[\"event\"];\n\t\t\t\t\t\t\t\t\t\t\tif(event === 'registered') {\n\t\t\t\t\t\t\t\t\t\t\t\tmyusername = result[\"username\"];\n\t\t\t\t\t\t\t\t\t\t\t\tJanus.log(\"Successfully registered as \" + myusername + \"!\");\n\t\t\t\t\t\t\t\t\t\t\t\t$('#youok').removeClass('hide').show().html(\"Registered as '\" + myusername + \"'\");\n\t\t\t\t\t\t\t\t\t\t\t\t// Get a list of available peers, just for fun\n\t\t\t\t\t\t\t\t\t\t\t\tvideocall.send({\"message\": { \"request\": \"list\" }});\n\t\t\t\t\t\t\t\t\t\t\t\t// TODO Enable buttons to call now\n\t\t\t\t\t\t\t\t\t\t\t\t$('#phone').removeClass('hide').show();\n\t\t\t\t\t\t\t\t\t\t\t\t$('#call').unbind('click').click(doCall);\n\t\t\t\t\t\t\t\t\t\t\t\t$('#peer').focus();\n\t\t\t\t\t\t\t\t\t\t\t} else if(event === 'calling') {\n\t\t\t\t\t\t\t\t\t\t\t\tJanus.log(\"Waiting for the peer to answer...\");\n\t\t\t\t\t\t\t\t\t\t\t\t// TODO Any ringtone?\n\t\t\t\t\t\t\t\t\t\t\t\tbootbox.alert(\"Waiting for the peer to answer...\");\n\t\t\t\t\t\t\t\t\t\t\t} else if(event === 'incomingcall') {\n\t\t\t\t\t\t\t\t\t\t\t\tJanus.log(\"Incoming call from \" + result[\"username\"] + \"!\");\n\t\t\t\t\t\t\t\t\t\t\t\tyourusername = result[\"username\"];\n\t\t\t\t\t\t\t\t\t\t\t\t// Notify user\n\t\t\t\t\t\t\t\t\t\t\t\tbootbox.hideAll();\n\t\t\t\t\t\t\t\t\t\t\t\tincoming = bootbox.dialog({\n\t\t\t\t\t\t\t\t\t\t\t\t\tmessage: \"Incoming call from \" + yourusername + \"!\",\n\t\t\t\t\t\t\t\t\t\t\t\t\ttitle: \"Incoming call\",\n\t\t\t\t\t\t\t\t\t\t\t\t\tcloseButton: false,\n\t\t\t\t\t\t\t\t\t\t\t\t\tbuttons: {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tsuccess: {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tlabel: \"Answer\",\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName: \"btn-success\",\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcallback: function() {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tincoming = null;\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t$('#peer').val(result[\"username\"]).attr('disabled', true);\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvideocall.createAnswer(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tjsep: jsep,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t// No media provided: by default, it's sendrecv for audio and video\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tmedia: { data: true },\t// Let's negotiate data channels as well\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t// If you want to test simulcasting (Chrome and Firefox only), then\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t// pass a ?simulcast=true when opening this demo page: it will turn\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t// the following 'simulcast' property to pass to janus.js to true\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsimulcast: doSimulcast,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsuccess: function(jsep) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tJanus.debug(\"Got SDP!\");\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tJanus.debug(jsep);\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvar body = { \"request\": \"accept\" };\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvideocall.send({\"message\": body, \"jsep\": jsep});\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t$('#peer').attr('disabled', true);\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t$('#call').removeAttr('disabled').html('Hangup')\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.removeClass(\"btn-success\").addClass(\"btn-danger\")\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.unbind('click').click(doHangup);\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\terror: function(error) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tJanus.error(\"WebRTC error:\", error);\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tbootbox.alert(\"WebRTC error... \" + JSON.stringify(error));\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tdanger: {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tlabel: \"Decline\",\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName: \"btn-danger\",\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcallback: function() {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdoHangup();\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\t\t} else if(event === 'accepted') {\n\t\t\t\t\t\t\t\t\t\t\t\tbootbox.hideAll();\n\t\t\t\t\t\t\t\t\t\t\t\tvar peer = result[\"username\"];\n\t\t\t\t\t\t\t\t\t\t\t\tif(peer === null || peer === undefined) {\n\t\t\t\t\t\t\t\t\t\t\t\t\tJanus.log(\"Call started!\");\n\t\t\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\t\t\tJanus.log(peer + \" accepted the call!\");\n\t\t\t\t\t\t\t\t\t\t\t\t\tyourusername = peer;\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t// Video call can start\n\t\t\t\t\t\t\t\t\t\t\t\tif(jsep)\n\t\t\t\t\t\t\t\t\t\t\t\t\tvideocall.handleRemoteJsep({jsep: jsep});\n\t\t\t\t\t\t\t\t\t\t\t\t$('#call').removeAttr('disabled').html('Hangup')\n\t\t\t\t\t\t\t\t\t\t\t\t\t.removeClass(\"btn-success\").addClass(\"btn-danger\")\n\t\t\t\t\t\t\t\t\t\t\t\t\t.unbind('click').click(doHangup);\n\t\t\t\t\t\t\t\t\t\t\t} else if(event === 'update') {\n\t\t\t\t\t\t\t\t\t\t\t\t// An 'update' event may be used to provide renegotiation attempts\n\t\t\t\t\t\t\t\t\t\t\t\tif(jsep) {\n\t\t\t\t\t\t\t\t\t\t\t\t\tif(jsep.type === \"answer\") {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tvideocall.handleRemoteJsep({jsep: jsep});\n\t\t\t\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tvideocall.createAnswer(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tjsep: jsep,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tmedia: { data: true },\t// Let's negotiate data channels as well\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsuccess: function(jsep) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tJanus.debug(\"Got SDP!\");\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tJanus.debug(jsep);\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvar body = { \"request\": \"set\" };\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvideocall.send({\"message\": body, \"jsep\": jsep});\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\terror: function(error) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tJanus.error(\"WebRTC error:\", error);\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tbootbox.alert(\"WebRTC error... \" + JSON.stringify(error));\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t} else if(event === 'hangup') {\n\t\t\t\t\t\t\t\t\t\t\t\tJanus.log(\"Call hung up by \" + result[\"username\"] + \" (\" + result[\"reason\"] + \")!\");\n\t\t\t\t\t\t\t\t\t\t\t\t// Reset status\n\t\t\t\t\t\t\t\t\t\t\t\tbootbox.hideAll();\n\t\t\t\t\t\t\t\t\t\t\t\tvideocall.hangup();\n\t\t\t\t\t\t\t\t\t\t\t\tif(spinner !== null && spinner !== undefined)\n\t\t\t\t\t\t\t\t\t\t\t\t\tspinner.stop();\n\t\t\t\t\t\t\t\t\t\t\t\t$('#waitingvideo').remove();\n\t\t\t\t\t\t\t\t\t\t\t\t$('#videos').hide();\n\t\t\t\t\t\t\t\t\t\t\t\t$('#peer').removeAttr('disabled').val('');\n\t\t\t\t\t\t\t\t\t\t\t\t$('#call').removeAttr('disabled').html('Call')\n\t\t\t\t\t\t\t\t\t\t\t\t\t.removeClass(\"btn-danger\").addClass(\"btn-success\")\n\t\t\t\t\t\t\t\t\t\t\t\t\t.unbind('click').click(doCall);\n\t\t\t\t\t\t\t\t\t\t\t\t$('#toggleaudio').attr('disabled', true);\n\t\t\t\t\t\t\t\t\t\t\t\t$('#togglevideo').attr('disabled', true);\n\t\t\t\t\t\t\t\t\t\t\t\t$('#bitrate').attr('disabled', true);\n\t\t\t\t\t\t\t\t\t\t\t\t$('#curbitrate').hide();\n\t\t\t\t\t\t\t\t\t\t\t\t$('#curres').hide();\n\t\t\t\t\t\t\t\t\t\t\t} else if(event === \"simulcast\") {\n\t\t\t\t\t\t\t\t\t\t\t\t// Is simulcast in place?\n\t\t\t\t\t\t\t\t\t\t\t\tvar substream = result[\"substream\"];\n\t\t\t\t\t\t\t\t\t\t\t\tvar temporal = result[\"temporal\"];\n\t\t\t\t\t\t\t\t\t\t\t\tif((substream !== null && substream !== undefined) || (temporal !== null && temporal !== undefined)) {\n\t\t\t\t\t\t\t\t\t\t\t\t\tif(!simulcastStarted) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tsimulcastStarted = true;\n\t\t\t\t\t\t\t\t\t\t\t\t\t\taddSimulcastButtons(result[\"videocodec\"] === \"vp8\" || result[\"videocodec\"] === \"h264\");\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t// We just received notice that there's been a switch, update the buttons\n\t\t\t\t\t\t\t\t\t\t\t\t\tupdateSimulcastButtons(substream, temporal);\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t// FIXME Error?\n\t\t\t\t\t\t\t\t\t\tvar error = msg[\"error\"];\n\t\t\t\t\t\t\t\t\t\tbootbox.alert(error);\n\t\t\t\t\t\t\t\t\t\tif(error.indexOf(\"already taken\") > 0) {\n\t\t\t\t\t\t\t\t\t\t\t// FIXME Use status codes...\n\t\t\t\t\t\t\t\t\t\t\t$('#username').removeAttr('disabled').val(\"\");\n\t\t\t\t\t\t\t\t\t\t\t$('#register').removeAttr('disabled').unbind('click').click(registerUsername);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t// TODO Reset status\n\t\t\t\t\t\t\t\t\t\tvideocall.hangup();\n\t\t\t\t\t\t\t\t\t\tif(spinner !== null && spinner !== undefined)\n\t\t\t\t\t\t\t\t\t\t\tspinner.stop();\n\t\t\t\t\t\t\t\t\t\t$('#waitingvideo').remove();\n\t\t\t\t\t\t\t\t\t\t$('#videos').hide();\n\t\t\t\t\t\t\t\t\t\t$('#peer').removeAttr('disabled').val('');\n\t\t\t\t\t\t\t\t\t\t$('#call').removeAttr('disabled').html('Call')\n\t\t\t\t\t\t\t\t\t\t\t.removeClass(\"btn-danger\").addClass(\"btn-success\")\n\t\t\t\t\t\t\t\t\t\t\t.unbind('click').click(doCall);\n\t\t\t\t\t\t\t\t\t\t$('#toggleaudio').attr('disabled', true);\n\t\t\t\t\t\t\t\t\t\t$('#togglevideo').attr('disabled', true);\n\t\t\t\t\t\t\t\t\t\t$('#bitrate').attr('disabled', true);\n\t\t\t\t\t\t\t\t\t\t$('#curbitrate').hide();\n\t\t\t\t\t\t\t\t\t\t$('#curres').hide();\n\t\t\t\t\t\t\t\t\t\tif(bitrateTimer !== null && bitrateTimer !== null)\n\t\t\t\t\t\t\t\t\t\t\tclearInterval(bitrateTimer);\n\t\t\t\t\t\t\t\t\t\tbitrateTimer = null;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tonlocalstream: function(stream) {\n\t\t\t\t\t\t\t\t\tJanus.debug(\" ::: Got a local stream :::\");\n\t\t\t\t\t\t\t\t\tJanus.debug(stream);\n\t\t\t\t\t\t\t\t\t$('#videos').removeClass('hide').show();\n\t\t\t\t\t\t\t\t\tif($('#myvideo').length === 0)\n\t\t\t\t\t\t\t\t\t\t$('#videoleft').append('<video class=\"rounded centered\" id=\"myvideo\" width=320 height=240 autoplay playsinline muted=\"muted\"/>');\n\t\t\t\t\t\t\t\t\tJanus.attachMediaStream($('#myvideo').get(0), stream);\n\t\t\t\t\t\t\t\t\t$(\"#myvideo\").get(0).muted = \"muted\";\n\t\t\t\t\t\t\t\t\tif(videocall.webrtcStuff.pc.iceConnectionState !== \"completed\" &&\n\t\t\t\t\t\t\t\t\t\t\tvideocall.webrtcStuff.pc.iceConnectionState !== \"connected\") {\n\t\t\t\t\t\t\t\t\t\t$(\"#videoleft\").parent().block({\n\t\t\t\t\t\t\t\t\t\t\tmessage: '<b>Publishing...</b>',\n\t\t\t\t\t\t\t\t\t\t\tcss: {\n\t\t\t\t\t\t\t\t\t\t\t\tborder: 'none',\n\t\t\t\t\t\t\t\t\t\t\t\tbackgroundColor: 'transparent',\n\t\t\t\t\t\t\t\t\t\t\t\tcolor: 'white'\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\t// No remote video yet\n\t\t\t\t\t\t\t\t\t\t$('#videoright').append('<video class=\"rounded centered\" id=\"waitingvideo\" width=320 height=240 />');\n\t\t\t\t\t\t\t\t\t\tif(spinner == null) {\n\t\t\t\t\t\t\t\t\t\t\tvar target = document.getElementById('videoright');\n\t\t\t\t\t\t\t\t\t\t\tspinner = new Spinner({top:100}).spin(target);\n\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\tspinner.spin();\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tvar videoTracks = stream.getVideoTracks();\n\t\t\t\t\t\t\t\t\tif(videoTracks === null || videoTracks === undefined || videoTracks.length === 0) {\n\t\t\t\t\t\t\t\t\t\t// No webcam\n\t\t\t\t\t\t\t\t\t\t$('#myvideo').hide();\n\t\t\t\t\t\t\t\t\t\tif($('#videoleft .no-video-container').length === 0) {\n\t\t\t\t\t\t\t\t\t\t\t$('#videoleft').append(\n\t\t\t\t\t\t\t\t\t\t\t\t'<div class=\"no-video-container\">' +\n\t\t\t\t\t\t\t\t\t\t\t\t\t'<i class=\"fa fa-video-camera fa-5 no-video-icon\"></i>' +\n\t\t\t\t\t\t\t\t\t\t\t\t\t'<span class=\"no-video-text\">No webcam available</span>' +\n\t\t\t\t\t\t\t\t\t\t\t\t'</div>');\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t$('#videoleft .no-video-container').remove();\n\t\t\t\t\t\t\t\t\t\t$('#myvideo').removeClass('hide').show();\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tonremotestream: function(stream) {\n\t\t\t\t\t\t\t\t\tJanus.debug(\" ::: Got a remote stream :::\");\n\t\t\t\t\t\t\t\t\tJanus.debug(stream);\n\t\t\t\t\t\t\t\t\tvar addButtons = false;\n\t\t\t\t\t\t\t\t\tif($('#remotevideo').length === 0) {\n\t\t\t\t\t\t\t\t\t\taddButtons = true;\n\t\t\t\t\t\t\t\t\t\t$('#videoright').append('<video class=\"rounded centered hide\" id=\"remotevideo\" width=320 height=240 autoplay playsinline/>');\n\t\t\t\t\t\t\t\t\t\t// Show the video, hide the spinner and show the resolution when we get a playing event\n\t\t\t\t\t\t\t\t\t\t$(\"#remotevideo\").bind(\"playing\", function () {\n\t\t\t\t\t\t\t\t\t\t\t$('#waitingvideo').remove();\n\t\t\t\t\t\t\t\t\t\t\tif(this.videoWidth)\n\t\t\t\t\t\t\t\t\t\t\t\t$('#remotevideo').removeClass('hide').show();\n\t\t\t\t\t\t\t\t\t\t\tif(spinner !== null && spinner !== undefined)\n\t\t\t\t\t\t\t\t\t\t\t\tspinner.stop();\n\t\t\t\t\t\t\t\t\t\t\tspinner = null;\n\t\t\t\t\t\t\t\t\t\t\tvar width = this.videoWidth;\n\t\t\t\t\t\t\t\t\t\t\tvar height = this.videoHeight;\n\t\t\t\t\t\t\t\t\t\t\t$('#curres').removeClass('hide').text(width+'x'+height).show();\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\t$('#callee').removeClass('hide').html(yourusername).show();\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tJanus.attachMediaStream($('#remotevideo').get(0), stream);\n\t\t\t\t\t\t\t\t\tvar videoTracks = stream.getVideoTracks();\n\t\t\t\t\t\t\t\t\tif(videoTracks === null || videoTracks === undefined || videoTracks.length === 0) {\n\t\t\t\t\t\t\t\t\t\t// No remote video\n\t\t\t\t\t\t\t\t\t\t$('#remotevideo').hide();\n\t\t\t\t\t\t\t\t\t\tif($('#videoright .no-video-container').length === 0) {\n\t\t\t\t\t\t\t\t\t\t\t$('#videoright').append(\n\t\t\t\t\t\t\t\t\t\t\t\t'<div class=\"no-video-container\">' +\n\t\t\t\t\t\t\t\t\t\t\t\t\t'<i class=\"fa fa-video-camera fa-5 no-video-icon\"></i>' +\n\t\t\t\t\t\t\t\t\t\t\t\t\t'<span class=\"no-video-text\">No remote video available</span>' +\n\t\t\t\t\t\t\t\t\t\t\t\t'</div>');\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t$('#videoright .no-video-container').remove();\n\t\t\t\t\t\t\t\t\t\t$('#remotevideo').removeClass('hide').show();\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tif(!addButtons)\n\t\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t\t// Enable audio/video buttons and bitrate limiter\n\t\t\t\t\t\t\t\t\taudioenabled = true;\n\t\t\t\t\t\t\t\t\tvideoenabled = true;\n\t\t\t\t\t\t\t\t\t$('#toggleaudio').html(\"Disable audio\").removeClass(\"btn-success\").addClass(\"btn-danger\")\n\t\t\t\t\t\t\t\t\t\t\t.unbind('click').removeAttr('disabled').click(\n\t\t\t\t\t\t\t\t\t\tfunction() {\n\t\t\t\t\t\t\t\t\t\t\taudioenabled = !audioenabled;\n\t\t\t\t\t\t\t\t\t\t\tif(audioenabled)\n\t\t\t\t\t\t\t\t\t\t\t\t$('#toggleaudio').html(\"Disable audio\").removeClass(\"btn-success\").addClass(\"btn-danger\");\n\t\t\t\t\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\t\t\t\t\t$('#toggleaudio').html(\"Enable audio\").removeClass(\"btn-danger\").addClass(\"btn-success\");\n\t\t\t\t\t\t\t\t\t\t\tvideocall.send({\"message\": { \"request\": \"set\", \"audio\": audioenabled }});\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t$('#togglevideo').html(\"Disable video\").removeClass(\"btn-success\").addClass(\"btn-danger\")\n\t\t\t\t\t\t\t\t\t\t\t.unbind('click').removeAttr('disabled').click(\n\t\t\t\t\t\t\t\t\t\tfunction() {\n\t\t\t\t\t\t\t\t\t\t\tvideoenabled = !videoenabled;\n\t\t\t\t\t\t\t\t\t\t\tif(videoenabled)\n\t\t\t\t\t\t\t\t\t\t\t\t$('#togglevideo').html(\"Disable video\").removeClass(\"btn-success\").addClass(\"btn-danger\");\n\t\t\t\t\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\t\t\t\t\t$('#togglevideo').html(\"Enable video\").removeClass(\"btn-danger\").addClass(\"btn-success\");\n\t\t\t\t\t\t\t\t\t\t\tvideocall.send({\"message\": { \"request\": \"set\", \"video\": videoenabled }});\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t$('#toggleaudio').parent().removeClass('hide').show();\n\t\t\t\t\t\t\t\t\t$('#bitrateset').html(\"Bandwidth\");\n\t\t\t\t\t\t\t\t\t$('#bitrate a').unbind('click').removeAttr('disabled').click(function() {\n\t\t\t\t\t\t\t\t\t\tvar id = $(this).attr(\"id\");\n\t\t\t\t\t\t\t\t\t\tvar bitrate = parseInt(id)*1000;\n\t\t\t\t\t\t\t\t\t\tif(bitrate === 0) {\n\t\t\t\t\t\t\t\t\t\t\tJanus.log(\"Not limiting bandwidth via REMB\");\n\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\tJanus.log(\"Capping bandwidth to \" + bitrate + \" via REMB\");\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t$('#bitrateset').html($(this).html()).parent().removeClass('open');\n\t\t\t\t\t\t\t\t\t\tvideocall.send({\"message\": { \"request\": \"set\", \"bitrate\": bitrate }});\n\t\t\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\tif(Janus.webRTCAdapter.browserDetails.browser === \"chrome\" || Janus.webRTCAdapter.browserDetails.browser === \"firefox\" ||\n\t\t\t\t\t\t\t\t\t\t\tJanus.webRTCAdapter.browserDetails.browser === \"safari\") {\n\t\t\t\t\t\t\t\t\t\t$('#curbitrate').removeClass('hide').show();\n\t\t\t\t\t\t\t\t\t\tbitrateTimer = setInterval(function() {\n\t\t\t\t\t\t\t\t\t\t\t// Display updated bitrate, if supported\n\t\t\t\t\t\t\t\t\t\t\tvar bitrate = videocall.getBitrate();\n\t\t\t\t\t\t\t\t\t\t\t$('#curbitrate').text(bitrate);\n\t\t\t\t\t\t\t\t\t\t\t// Check if the resolution changed too\n\t\t\t\t\t\t\t\t\t\t\tvar width = $(\"#remotevideo\").get(0).videoWidth;\n\t\t\t\t\t\t\t\t\t\t\tvar height = $(\"#remotevideo\").get(0).videoHeight;\n\t\t\t\t\t\t\t\t\t\t\tif(width > 0 && height > 0)\n\t\t\t\t\t\t\t\t\t\t\t\t$('#curres').removeClass('hide').text(width+'x'+height).show();\n\t\t\t\t\t\t\t\t\t\t}, 1000);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tondataopen: function(data) {\n\t\t\t\t\t\t\t\t\tJanus.log(\"The DataChannel is available!\");\n\t\t\t\t\t\t\t\t\t$('#videos').removeClass('hide').show();\n\t\t\t\t\t\t\t\t\t$('#datasend').removeAttr('disabled');\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tondata: function(data) {\n\t\t\t\t\t\t\t\t\tJanus.debug(\"We got data from the DataChannel! \" + data);\n\t\t\t\t\t\t\t\t\t$('#datarecv').val(data);\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\toncleanup: function() {\n\t\t\t\t\t\t\t\t\tJanus.log(\" ::: Got a cleanup notification :::\");\n\t\t\t\t\t\t\t\t\t$('#myvideo').remove();\n\t\t\t\t\t\t\t\t\t$('#remotevideo').remove();\n\t\t\t\t\t\t\t\t\t$(\"#videoleft\").parent().unblock();\n\t\t\t\t\t\t\t\t\t$('.no-video-container').remove();\n\t\t\t\t\t\t\t\t\t$('#callee').empty().hide();\n\t\t\t\t\t\t\t\t\tyourusername = null;\n\t\t\t\t\t\t\t\t\t$('#curbitrate').hide();\n\t\t\t\t\t\t\t\t\t$('#curres').hide();\n\t\t\t\t\t\t\t\t\t$('#videos').hide();\n\t\t\t\t\t\t\t\t\t$('#toggleaudio').attr('disabled', true);\n\t\t\t\t\t\t\t\t\t$('#togglevideo').attr('disabled', true);\n\t\t\t\t\t\t\t\t\t$('#bitrate').attr('disabled', true);\n\t\t\t\t\t\t\t\t\t$('#curbitrate').hide();\n\t\t\t\t\t\t\t\t\t$('#curres').hide();\n\t\t\t\t\t\t\t\t\tif(bitrateTimer !== null && bitrateTimer !== null)\n\t\t\t\t\t\t\t\t\t\tclearInterval(bitrateTimer);\n\t\t\t\t\t\t\t\t\tbitrateTimer = null;\n\t\t\t\t\t\t\t\t\t$('#waitingvideo').remove();\n\t\t\t\t\t\t\t\t\t$('#videos').hide();\n\t\t\t\t\t\t\t\t\tsimulcastStarted = false;\n\t\t\t\t\t\t\t\t\t$('#simulcast').remove();\n\t\t\t\t\t\t\t\t\t$('#peer').removeAttr('disabled').val('');\n\t\t\t\t\t\t\t\t\t$('#call').removeAttr('disabled').html('Call')\n\t\t\t\t\t\t\t\t\t\t.removeClass(\"btn-danger\").addClass(\"btn-success\")\n\t\t\t\t\t\t\t\t\t\t.unbind('click').click(doCall);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t},\n\t\t\t\t\terror: function(error) {\n\t\t\t\t\t\tJanus.error(error);\n\t\t\t\t\t\tbootbox.alert(error, function() {\n\t\t\t\t\t\t\twindow.location.reload();\n\t\t\t\t\t\t});\n\t\t\t\t\t},\n\t\t\t\t\tdestroyed: function() {\n\t\t\t\t\t\twindow.location.reload();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t});\n\t}});\n});\n\nfunction checkEnter(field, event) {\n\tvar theCode = event.keyCode ? event.keyCode : event.which ? event.which : event.charCode;\n\tif(theCode == 13) {\n\t\tif(field.id == 'username')\n\t\t\tregisterUsername();\n\t\telse if(field.id == 'peer')\n\t\t\tdoCall();\n\t\telse if(field.id == 'datasend')\n\t\t\tsendData();\n\t\treturn false;\n\t} else {\n\t\treturn true;\n\t}\n}\n\nfunction registerUsername() {\n\t// Try a registration\n\t$('#username').attr('disabled', true);\n\t$('#register').attr('disabled', true).unbind('click');\n\tvar username = $('#username').val();\n\tif(username === \"\") {\n\t\tbootbox.alert(\"Insert a username to register (e.g., pippo)\");\n\t\t$('#username').removeAttr('disabled');\n\t\t$('#register').removeAttr('disabled').click(registerUsername);\n\t\treturn;\n\t}\n\tif(/[^a-zA-Z0-9]/.test(username)) {\n\t\tbootbox.alert('Input is not alphanumeric');\n\t\t$('#username').removeAttr('disabled').val(\"\");\n\t\t$('#register').removeAttr('disabled').click(registerUsername);\n\t\treturn;\n\t}\n\tvar register = { \"request\": \"register\", \"username\": username };\n\tvideocall.send({\"message\": register});\n}\n\nfunction doCall() {\n\t// Call someone\n\t$('#peer').attr('disabled', true);\n\t$('#call').attr('disabled', true).unbind('click');\n\tvar username = $('#peer').val();\n\tif(username === \"\") {\n\t\tbootbox.alert(\"Insert a username to call (e.g., pluto)\");\n\t\t$('#peer').removeAttr('disabled');\n\t\t$('#call').removeAttr('disabled').click(doCall);\n\t\treturn;\n\t}\n\tif(/[^a-zA-Z0-9]/.test(username)) {\n\t\tbootbox.alert('Input is not alphanumeric');\n\t\t$('#peer').removeAttr('disabled').val(\"\");\n\t\t$('#call').removeAttr('disabled').click(doCall);\n\t\treturn;\n\t}\n\t// Call this user\n\tvideocall.createOffer(\n\t\t{\n\t\t\t// By default, it's sendrecv for audio and video...\n\t\t\tmedia: { data: true },\t// ... let's negotiate data channels as well\n\t\t\t// If you want to test simulcasting (Chrome and Firefox only), then\n\t\t\t// pass a ?simulcast=true when opening this demo page: it will turn\n\t\t\t// the following 'simulcast' property to pass to janus.js to true\n\t\t\tsimulcast: doSimulcast,\n\t\t\tsuccess: function(jsep) {\n\t\t\t\tJanus.debug(\"Got SDP!\");\n\t\t\t\tJanus.debug(jsep);\n\t\t\t\tvar body = { \"request\": \"call\", \"username\": $('#peer').val() };\n\t\t\t\tvideocall.send({\"message\": body, \"jsep\": jsep});\n\t\t\t},\n\t\t\terror: function(error) {\n\t\t\t\tJanus.error(\"WebRTC error...\", error);\n\t\t\t\tbootbox.alert(\"WebRTC error... \" + error);\n\t\t\t}\n\t\t});\n}\n\nfunction doHangup() {\n\t// Hangup a call\n\t$('#call').attr('disabled', true).unbind('click');\n\tvar hangup = { \"request\": \"hangup\" };\n\tvideocall.send({\"message\": hangup});\n\tvideocall.hangup();\n\tyourusername = null;\n}\n\nfunction sendData() {\n\tvar data = $('#datasend').val();\n\tif(data === \"\") {\n\t\tbootbox.alert('Insert a message to send on the DataChannel to your peer');\n\t\treturn;\n\t}\n\tvideocall.data({\n\t\ttext: data,\n\t\terror: function(reason) { bootbox.alert(reason); },\n\t\tsuccess: function() { $('#datasend').val(''); },\n\t});\n}\n\n// Helper to parse query string\nfunction getQueryStringValue(name) {\n\tname = name.replace(/[\\[]/, \"\\\\[\").replace(/[\\]]/, \"\\\\]\");\n\tvar regex = new RegExp(\"[\\\\?&]\" + name + \"=([^&#]*)\"),\n\t\tresults = regex.exec(location.search);\n\treturn results === null ? \"\" : decodeURIComponent(results[1].replace(/\\+/g, \" \"));\n}\n\n// Helpers to create Simulcast-related UI, if enabled\nfunction addSimulcastButtons(temporal) {\n\t$('#curres').parent().append(\n\t\t'<div id=\"simulcast\" class=\"btn-group-vertical btn-group-vertical-xs pull-right\">' +\n\t\t'\t<div class\"row\">' +\n\t\t'\t\t<div class=\"btn-group btn-group-xs\" style=\"width: 100%\">' +\n\t\t'\t\t\t<button id=\"sl-2\" type=\"button\" class=\"btn btn-primary\" data-toggle=\"tooltip\" title=\"Switch to higher quality\" style=\"width: 33%\">SL 2</button>' +\n\t\t'\t\t\t<button id=\"sl-1\" type=\"button\" class=\"btn btn-primary\" data-toggle=\"tooltip\" title=\"Switch to normal quality\" style=\"width: 33%\">SL 1</button>' +\n\t\t'\t\t\t<button id=\"sl-0\" type=\"button\" class=\"btn btn-primary\" data-toggle=\"tooltip\" title=\"Switch to lower quality\" style=\"width: 34%\">SL 0</button>' +\n\t\t'\t\t</div>' +\n\t\t'\t</div>' +\n\t\t'\t<div class\"row\">' +\n\t\t'\t\t<div class=\"btn-group btn-group-xs hide\" style=\"width: 100%\">' +\n\t\t'\t\t\t<button id=\"tl-2\" type=\"button\" class=\"btn btn-primary\" data-toggle=\"tooltip\" title=\"Cap to temporal layer 2\" style=\"width: 34%\">TL 2</button>' +\n\t\t'\t\t\t<button id=\"tl-1\" type=\"button\" class=\"btn btn-primary\" data-toggle=\"tooltip\" title=\"Cap to temporal layer 1\" style=\"width: 33%\">TL 1</button>' +\n\t\t'\t\t\t<button id=\"tl-0\" type=\"button\" class=\"btn btn-primary\" data-toggle=\"tooltip\" title=\"Cap to temporal layer 0\" style=\"width: 33%\">TL 0</button>' +\n\t\t'\t\t</div>' +\n\t\t'\t</div>' +\n\t\t'</div>');\n\t// Enable the simulcast selection buttons\n\t$('#sl-0').removeClass('btn-primary btn-success').addClass('btn-primary')\n\t\t.unbind('click').click(function() {\n\t\t\ttoastr.info(\"Switching simulcast substream, wait for it... (lower quality)\", null, {timeOut: 2000});\n\t\t\tif(!$('#sl-2').hasClass('btn-success'))\n\t\t\t\t$('#sl-2').removeClass('btn-primary btn-info').addClass('btn-primary');\n\t\t\tif(!$('#sl-1').hasClass('btn-success'))\n\t\t\t\t$('#sl-1').removeClass('btn-primary btn-info').addClass('btn-primary');\n\t\t\t$('#sl-0').removeClass('btn-primary btn-info btn-success').addClass('btn-info');\n\t\t\tvideocall.send({message: { request: \"set\", substream: 0 }});\n\t\t});\n\t$('#sl-1').removeClass('btn-primary btn-success').addClass('btn-primary')\n\t\t.unbind('click').click(function() {\n\t\t\ttoastr.info(\"Switching simulcast substream, wait for it... (normal quality)\", null, {timeOut: 2000});\n\t\t\tif(!$('#sl-2').hasClass('btn-success'))\n\t\t\t\t$('#sl-2').removeClass('btn-primary btn-info').addClass('btn-primary');\n\t\t\t$('#sl-1').removeClass('btn-primary btn-info btn-success').addClass('btn-info');\n\t\t\tif(!$('#sl-0').hasClass('btn-success'))\n\t\t\t\t$('#sl-0').removeClass('btn-primary btn-info').addClass('btn-primary');\n\t\t\tvideocall.send({message: { request: \"set\", substream: 1 }});\n\t\t});\n\t$('#sl-2').removeClass('btn-primary btn-success').addClass('btn-primary')\n\t\t.unbind('click').click(function() {\n\t\t\ttoastr.info(\"Switching simulcast substream, wait for it... (higher quality)\", null, {timeOut: 2000});\n\t\t\t$('#sl-2').removeClass('btn-primary btn-info btn-success').addClass('btn-info');\n\t\t\tif(!$('#sl-1').hasClass('btn-success'))\n\t\t\t\t$('#sl-1').removeClass('btn-primary btn-info').addClass('btn-primary');\n\t\t\tif(!$('#sl-0').hasClass('btn-success'))\n\t\t\t\t$('#sl-0').removeClass('btn-primary btn-info').addClass('btn-primary');\n\t\t\tvideocall.send({message: { request: \"set\", substream: 2 }});\n\t\t});\n\tif(!temporal)\t// No temporal layer support\n\t\treturn;\n\t$('#tl-0').parent().removeClass('hide');\n\t$('#tl-0').removeClass('btn-primary btn-success').addClass('btn-primary')\n\t\t.unbind('click').click(function() {\n\t\t\ttoastr.info(\"Capping simulcast temporal layer, wait for it... (lowest FPS)\", null, {timeOut: 2000});\n\t\t\tif(!$('#tl-2').hasClass('btn-success'))\n\t\t\t\t$('#tl-2').removeClass('btn-primary btn-info').addClass('btn-primary');\n\t\t\tif(!$('#tl-1').hasClass('btn-success'))\n\t\t\t\t$('#tl-1').removeClass('btn-primary btn-info').addClass('btn-primary');\n\t\t\t$('#tl-0').removeClass('btn-primary btn-info btn-success').addClass('btn-info');\n\t\t\tvideocall.send({message: { request: \"set\", temporal: 0 }});\n\t\t});\n\t$('#tl-1').removeClass('btn-primary btn-success').addClass('btn-primary')\n\t\t.unbind('click').click(function() {\n\t\t\ttoastr.info(\"Capping simulcast temporal layer, wait for it... (medium FPS)\", null, {timeOut: 2000});\n\t\t\tif(!$('#tl-2').hasClass('btn-success'))\n\t\t\t\t$('#tl-2').removeClass('btn-primary btn-info').addClass('btn-primary');\n\t\t\t$('#tl-1').removeClass('btn-primary btn-info').addClass('btn-info');\n\t\t\tif(!$('#tl-0').hasClass('btn-success'))\n\t\t\t\t$('#tl-0').removeClass('btn-primary btn-info').addClass('btn-primary');\n\t\t\tvideocall.send({message: { request: \"set\", temporal: 1 }});\n\t\t});\n\t$('#tl-2').removeClass('btn-primary btn-success').addClass('btn-primary')\n\t\t.unbind('click').click(function() {\n\t\t\ttoastr.info(\"Capping simulcast temporal layer, wait for it... (highest FPS)\", null, {timeOut: 2000});\n\t\t\t$('#tl-2').removeClass('btn-primary btn-info btn-success').addClass('btn-info');\n\t\t\tif(!$('#tl-1').hasClass('btn-success'))\n\t\t\t\t$('#tl-1').removeClass('btn-primary btn-info').addClass('btn-primary');\n\t\t\tif(!$('#tl-0').hasClass('btn-success'))\n\t\t\t\t$('#tl-0').removeClass('btn-primary btn-info').addClass('btn-primary');\n\t\t\tvideocall.send({message: { request: \"set\", temporal: 2 }});\n\t\t});\n}\n\nfunction updateSimulcastButtons(substream, temporal) {\n\t// Check the substream\n\tif(substream === 0) {\n\t\ttoastr.success(\"Switched simulcast substream! (lower quality)\", null, {timeOut: 2000});\n\t\t$('#sl-2').removeClass('btn-primary btn-success').addClass('btn-primary');\n\t\t$('#sl-1').removeClass('btn-primary btn-success').addClass('btn-primary');\n\t\t$('#sl-0').removeClass('btn-primary btn-info btn-success').addClass('btn-success');\n\t} else if(substream === 1) {\n\t\ttoastr.success(\"Switched simulcast substream! (normal quality)\", null, {timeOut: 2000});\n\t\t$('#sl-2').removeClass('btn-primary btn-success').addClass('btn-primary');\n\t\t$('#sl-1').removeClass('btn-primary btn-info btn-success').addClass('btn-success');\n\t\t$('#sl-0').removeClass('btn-primary btn-success').addClass('btn-primary');\n\t} else if(substream === 2) {\n\t\ttoastr.success(\"Switched simulcast substream! (higher quality)\", null, {timeOut: 2000});\n\t\t$('#sl-2').removeClass('btn-primary btn-info btn-success').addClass('btn-success');\n\t\t$('#sl-1').removeClass('btn-primary btn-success').addClass('btn-primary');\n\t\t$('#sl-0').removeClass('btn-primary btn-success').addClass('btn-primary');\n\t}\n\t// Check the temporal layer\n\tif(temporal === 0) {\n\t\ttoastr.success(\"Capped simulcast temporal layer! (lowest FPS)\", null, {timeOut: 2000});\n\t\t$('#tl-2').removeClass('btn-primary btn-success').addClass('btn-primary');\n\t\t$('#tl-1').removeClass('btn-primary btn-success').addClass('btn-primary');\n\t\t$('#tl-0').removeClass('btn-primary btn-info btn-success').addClass('btn-success');\n\t} else if(temporal === 1) {\n\t\ttoastr.success(\"Capped simulcast temporal layer! (medium FPS)\", null, {timeOut: 2000});\n\t\t$('#tl-2').removeClass('btn-primary btn-success').addClass('btn-primary');\n\t\t$('#tl-1').removeClass('btn-primary btn-info btn-success').addClass('btn-success');\n\t\t$('#tl-0').removeClass('btn-primary btn-success').addClass('btn-primary');\n\t} else if(temporal === 2) {\n\t\ttoastr.success(\"Capped simulcast temporal layer! (highest FPS)\", null, {timeOut: 2000});\n\t\t$('#tl-2').removeClass('btn-primary btn-info btn-success').addClass('btn-success');\n\t\t$('#tl-1').removeClass('btn-primary btn-success').addClass('btn-primary');\n\t\t$('#tl-0').removeClass('btn-primary btn-success').addClass('btn-primary');\n\t}\n}\n\n/**\n * ViewProvider: service used to generate the TECHSAS views provided by the view selection dialog.\n * A view is composed of: a title, a type, an icon and a configuration. The service provides a list of views.\n */\n(function () {\n    'use strict';\n    angular.module(\"tsa.services\").service(\"viewProvider\", viewProvider);\n\n    /* To add a new type of view : add a line in the constant: \"TSA_VIEW_LIST\"\n     *\n     * After to add a new instance of a view : add a line in the viewList retrieved with the configuration service\n     */\n\n    function viewProvider($location, $timeout, acquisitionService, VIDEO_PARAMS, userService, VIEW_LIST) {\n\n    \tvar mosaicRefreshInterval = 2000;\n    \tvar mosaicSize = 16;\n\n    \tvar mosaicArg = 0;\n        var videoItemList = [];\n        var mosaicList = [];\n        var indexSelectedTab = 0;\n\n        /**\n         * AVAILABLE VIEWS (titles and icons are defined in resources/locale-*.json files)\n         */\n        var viewProperties = {\n\n            // ------------------------------------- MISCELLANEOUS VIEWS ------------------------------------\n            'Devices': { title: 'views.devices.title', icon: 'views.devices.icon', category: 'dialog.view-selection.tabs.miscellaneous' },\n            'Graphics': { title: 'views.graphics.title', icon: 'views.graphics.icon', category: 'dialog.view-selection.tabs.miscellaneous' },\n            'Numerical': { title: 'views.numerical.title', icon: 'views.numerical.icon', category: 'dialog.view-selection.tabs.miscellaneous' },\n            'Empty': { title: 'views.empty.title', icon: 'views.empty.icon', category: 'dialog.view-selection.tabs.miscellaneous' },\n            'Ephemeride': { title: 'views.ephemeride.title', icon: 'views.ephemeride.icon', category: 'dialog.view-selection.tabs.miscellaneous' },\n            'Generic': { title: 'views.generic.title', icon: 'views.generic.icon', category: 'dialog.view-selection.tabs.miscellaneous' },\n            'Message': { title: 'views.message.title', icon: 'views.message.icon', category: 'dialog.view-selection.tabs.miscellaneous' },\n            'Casino': { title: 'views.casino.title', icon: 'views.casino.icon', category: 'dialog.view-selection.tabs.miscellaneous' },\n            'Casino - Add event': { title: 'views.casino.add-event.title', icon: 'views.casino.add-event.icon', category: 'dialog.view-selection.tabs.miscellaneous' },\n            'EFPos': { title: 'views.pefpos.title', icon: 'views.pefpos.icon', category: 'dialog.view-selection.tabs.miscellaneous' },\n            'EFMet': { title: 'views.pefmet.title', icon: 'views.pefmet.icon', category: 'dialog.view-selection.tabs.miscellaneous' },\n            'EFTss': { title: 'views.peftss.title', icon: 'views.peftss.icon', category: 'dialog.view-selection.tabs.miscellaneous' },\n            'EFAum': { title: 'views.pefaum.title', icon: 'views.pefaum.icon', category: 'dialog.view-selection.tabs.miscellaneous' },\n            'Video Call': { title: 'views.video-call.title', icon: 'video', category: 'dialog.view-selection.tabs.miscellaneous' },\n            'Menu': { title: 'views.menu.title', icon: 'views.menu.icon', category: 'dialog.view-selection.tabs.miscellaneous' },\n\n            // ------------------------------------- NAVIGATION VIEWS ------------------------------------\n            'Attitude': { title: 'views.attitude.title', icon: 'views.attitude.icon', category: 'dialog.view-selection.tabs.navigation' },\n            'GPS': { title: 'views.gps.title', icon: 'views.gps.icon', category: 'dialog.view-selection.tabs.navigation' },\n            'Landing At': { title: 'views.landing.title', icon: 'views.landing.icon', category: 'dialog.view-selection.tabs.navigation' },\n            'Navigation': { title: 'views.navigation.title', icon: 'views.navigation.icon', category: 'dialog.view-selection.tabs.navigation' },\n            'Map': { title: 'views.map.title', icon: 'views.map.icon', category: 'dialog.view-selection.tabs.navigation' },\n            'Mobile': { title: 'views.mobile.title', icon: 'views.mobile.icon', category: 'dialog.view-selection.tabs.navigation' },\n            'Station': { title: 'views.station.title', icon: 'views.station.icon', category: 'dialog.view-selection.tabs.navigation' },\n            'Route': { title: 'views.route.title',  icon: 'views.route.icon', category: 'dialog.view-selection.tabs.navigation' },\n\n            // ------------------------------------- SCIENTIFIC VIEWS ------------------------------------\n            'ADCP': { title: 'views.adcp.title', icon: 'views.adcp.icon', category: 'dialog.view-selection.tabs.scientific' },\n            'Anemometer': { title: 'views.anemometer.title', icon: 'views.anemometer.icon', category: 'dialog.view-selection.tabs.scientific' },\n            'Flow': { title: 'views.flow.title', icon: 'views.flow.icon', category: 'dialog.view-selection.tabs.scientific' },\n            'Depth': { title: 'views.depth.title', icon: 'views.depth.icon', category: 'dialog.view-selection.tabs.scientific' },\n            'Ferrybox science': {title: 'views.ferrybox-science.title', icon: 'views.ferrybox-science.icon', category: 'dialog.view-selection.tabs.scientific' },\n            'Ferrybox fluo': {title: 'views.ferrybox-fluo.title', icon: 'views.ferrybox-fluo.icon', category: 'dialog.view-selection.tabs.scientific' },\n            'Gravimeter': {title: 'views.gravimeter.title', icon: 'views.gravimeter.icon', category: 'dialog.view-selection.tabs.scientific' },\n            'Kss31': {title: 'views.kss31.title', icon: 'views.kss31.icon', category: 'dialog.view-selection.tabs.scientific' },\n            'Magnetometer': {title: 'views.magnetometer.title', icon: 'views.magnetometer.icon', category: 'dialog.view-selection.tabs.scientific' },\n            'Weather': { title: 'views.weather.title', icon: 'views.weather.icon', category: 'dialog.view-selection.tabs.scientific' },\n            'Hull sound speed': { title: 'views.hullsoundspeed.title', icon: 'views.hullsoundspeed.icon', category: 'dialog.view-selection.tabs.scientific' },\n            'Haul composition': { title: 'views.haul-composition.title', icon: 'views.haul-composition.icon', category: 'dialog.view-selection.tabs.scientific' },\n            'Species': { title: 'views.species.title', icon: 'views.species.icon', category: 'dialog.view-selection.tabs.scientific' },\n            'Multibeam': { title: 'views.multibeam.title', icon: 'views.multibeam.icon', category: 'dialog.view-selection.tabs.scientific' },\n            'Thermometer': { title: 'views.thermometer.title', icon: 'views.thermometer.icon', category: 'dialog.view-selection.tabs.scientific' },\n            'Thermosal': { title: 'views.thermosal.title', icon: 'views.thermosal.icon', category: 'dialog.view-selection.tabs.scientific' },\n\n            // ------------------------------------- TECHNIC VIEWS ------------------------------------\n            'Ferrybox technic': {title: 'views.ferrybox-technic.title', icon: 'views.ferrybox-technic.icon', category: 'dialog.view-selection.tabs.technic' },\n            'Trawl': { title: 'views.trawl.title', icon: 'views.trawl.icon', category: 'dialog.view-selection.tabs.technic' },\n            'Trawling': { title: 'views.trawling.title', icon: 'views.trawling.icon', category: 'dialog.view-selection.tabs.technic' },\n            'Funes winch': { title: 'views.funes-winch.title', icon: 'views.funes-winch.icon', category: 'dialog.view-selection.tabs.technic' },\n            'Winch': { title: 'views.winch.title', icon: 'views.winch.icon', category: 'dialog.view-selection.tabs.technic' },\n            'Winch Info': { title: 'views.winch-info.title', icon: 'views.winch-info.icon', category: 'dialog.view-selection.tabs.technic' },\n            'Propulsion Tl': { title: 'views.propulsion.title', icon: 'views.propulsion.icon', category: 'dialog.view-selection.tabs.technic' },\n            'Propulsion At': { title: 'views.propulsion.title', icon: 'views.propulsion.icon', category: 'dialog.view-selection.tabs.technic' },\n            'Propulsion Pp': { title: 'views.propulsion.title', icon: 'views.propulsion.icon', category: 'dialog.view-selection.tabs.technic' },\n            'Winch Alarm Pp': { title: 'views.winchAlarmPp.title', icon: 'views.winchAlarmPp.icon', category: 'dialog.view-selection.tabs.technic' },\n            'Kley state': { title: 'views.kley-state.title', icon: 'views.kley-state.icon', category: 'dialog.view-selection.tabs.technic' },\n\n            // ------------------------------------- DEBUG VIEWS ------------------------------------\n            'Debug': { title: 'views.debug.title', icon: 'views.debug.icon', category: 'dialog.view-selection.tabs.debug' }\n            /*Todo: driver preview, thermo config (SeabirdConfig), Propulsion, suivi/route */\n        };\n\n        /**------------------------------ PRIVATE METHODS -------------------------------**/\n\n        /** Provide a video view  */\n        function getVideoView(title, url, vlcUrl, janusStreamIndex, mosaicUrl, mosaicIndex) {\n            var videoItem = {\n                title: 'Video',\n                type: 'Video',\n                icon: 'video',\n                imageBackground: {\n                    'background-image': \"url('\" + VIDEO_PARAMS.baseUrl + mosaicUrl + \"')\",\n                    'background-size': mosaicSize + \"00% 100%\"\n                },\n                imageCSSClass: \"channel\" + (mosaicIndex + 1),\n                config: { deviceId: title, url: url, vlcUrl: vlcUrl, janusStreamIndex: janusStreamIndex },\n                rowspan: 3\n            };\n            videoItemList.push(videoItem);\n            return videoItem;\n        }\n\n        /** Loop to refresh the video previews */\n        var refreshEnabled = false;\n        function refreshVideoMosaic() {\n            if (videoItemList.length == 0) {\n                refreshEnabled = false;\n                return;\n            }\n            refreshEnabled = true;\n\n            mosaicArg = (new Date()).getTime();\n\n           $timeout(function () {\n          \tangular.forEach(videoItemList, function (videoItem, key) {\n          \t\tif(key< VIDEO_PARAMS.list.length) {\n\t          \t\tvar url = \"url('\" + VIDEO_PARAMS.baseUrl + VIDEO_PARAMS.list[key].mosaic + \"?\" + mosaicArg + \"')\";\n\t          \t\tvideoItem.imageBackground['background-image'] = url;\n          \t\t}\n          \t});\n          \trefreshVideoMosaic();\n          }, mosaicRefreshInterval);\n        }\n\n\n        /**------------------------------ PUBLIC SERVICE API -------------------------------**/\n\n        this.getBackupCss = function getBackupCss(index) {\n        \treturn { 'background-image': \"url('\" +VIDEO_PARAMS.baseUrl + mosaicList[index] + \"?\" + mosaicArg + \"')\" };\n        };\n\n        this.stopRefreshMosaic = function stopRefreshMosaic() {\n            videoItemList = [];\n        };\n\n        /** Return the view list **/\n        this.getViewList = function getViewList() {\n            var viewList = { \"dialog.view-selection.tabs.miscellaneous\": [], \"dialog.view-selection.tabs.navigation\": [], \"dialog.view-selection.tabs.scientific\": [], \"dialog.view-selection.tabs.technic\": [], \"dialog.view-selection.tabs.video\": [], \"dialog.view-selection.tabs.debug\": [] };\n            var deviceList = acquisitionService.getDeviceList();\n            var currentUser = userService.getCurrentUser();\n\n            // Add view items in the view list\n            angular.forEach(VIEW_LIST, function (definedView) {\n                var viewInfo = viewProperties[definedView.type];\n\n                if (angular.isUndefined(viewInfo) // Check if view info is defined\n                    || (definedView.type === 'Empty' && $location.path() != '/static')  // If empty view: check the page is static grid\n                    || (angular.isDefined(definedView.role) && (angular.isUndefined(currentUser) || !currentUser.hasAuthority(definedView.role))))// Check role\n                    return;\n\n                var viewItem = {\n                    type: definedView.type,\n                    title: angular.isDefined(definedView.title) ? definedView.title : viewInfo.title,\n                    icon: angular.isDefined(definedView.icon) ? definedView.icon : viewInfo.icon,\n                    config: angular.isDefined(definedView.config) ? definedView.config : {}\n                };\n\n                if (definedView.type == 'Generic') { // for generic views: title, icon and deviceId are pushed in the config\n                    viewItem.config.title = definedView.title;\n                    viewItem.config.icon = definedView.icon;\n                    viewItem.config.deviceId = definedView.devicePattern;\n                }\n\n                if (angular.isDefined(definedView.navId)) {// add navId in config if needed\n                    viewItem.config.navId = definedView.navId;\n                }\n\n                if (angular.isDefined(definedView.weatherId)) // add weatherId in config if needed\n                    viewItem.config.weatherId = definedView.weatherId;\n\n                // If the field 'frameName' is set, add a view item for each suitable device found in the device list\n                if (angular.isDefined(definedView.frameName)) {\n                    var pattern = angular.isDefined(definedView.devicePattern) ? definedView.devicePattern : \"\\w*\";\n                    var re = new RegExp(pattern);\n                    angular.forEach(deviceList, function (device) {\n                        if (re.test(device.id) && angular.isDefined(device.frameList[definedView.frameName])) {\n                            // Creation of new item based on viewItem to unable several item with the same frame\n                            // angular.copy : if not using it, we change the reference object instead of create a new one\n                            var newViewItem = {};\n                            angular.copy(viewItem, newViewItem);\n                            newViewItem.config.deviceId = device.id;\n                            newViewItem.config.frameId = definedView.frameName;\n                            viewList[angular.isDefined(definedView.category) ? definedView.category : viewInfo.category].push(newViewItem);\n                        }\n                    });\n                    if (definedView.frameName === \"TEST\") { //TODO: for debug, to remove\n                        viewItem.config.deviceId = \"TEST\";\n                        viewItem.config.frameId = definedView.frameName;\n                        viewList[angular.isDefined(definedView.category) ? definedView.category : viewInfo.category].push(viewItem);\n                    }\n                } else {\n                    viewList[angular.isDefined(definedView.category) ? definedView.category : viewInfo.category].push(viewItem);\n                }\n            });\n\n            //Add video views\n            videoItemList = [];\n            angular.forEach(VIDEO_PARAMS.list, function (video, key) {\n                viewList[\"dialog.view-selection.tabs.video\"].push(getVideoView(\n                \tvideo.title, video.url, video.vlcUrl,  video.janusStreamIndex,\n                \tvideo.mosaic, video.mosaicIndex));\n            });\n            if (!refreshEnabled) {\n            \trefreshVideoMosaic();\n            }\n\n            mosaicList = [];\n        \tangular.forEach(VIDEO_PARAMS.list, function (video, key) {\n        \t\tif(!mosaicList.includes(video.mosaic)) {\n        \t\t\tmosaicList.push(video.mosaic)\n        \t\t}\n        \t});\n\n            return viewList;\n        };\n\n        this.getMosaicList = function getViewList() {\n        \treturn mosaicList;\n        }\n    }\n})();\n\n(function () {\n    'use strict';\n\n    /** ADCP component declaration **/\n    (function () {\n        'use strict';\n        angular.module('tsa.tsaViews.adcp', []).component('tsaAdcp', {\n            templateUrl: \"app/tsa-views/adcp/adcp.html\",\n            controllerAs: \"ctrl\",\n            controller: adcpController,\n            bindings: {\n                config: '=',\n                cardId: '@',\n                onChangeCardType: '&'\n            }\n        });\n    })();\n\n    /** ADCP controller */\n    function adcpController($interval, $timeout, $scope, $log, ADCP, acquisitionService, statusService, themeService) {\n        var vm = this;\n        vm.logger = $log.getInstance(\"ADCP-tsa-view\");\n\n        /**------------------------------ PROPERTIES -------------------------------**/\n\n        vm.canvasId1 = \"canvas-winch-1-\" + vm.cardId;\n        vm.canvasId2 = \"canvas-winch-2-\" + vm.cardId;\n        vm.dataMissing = true;\n        vm.dateContent = \"no data\";\n        vm.dateColor = \"#BDBDBD\";\n        var lastFrameTimestamp;\n        var canvas1;\n        var canvas2;\n        var intervalPromise;\n        var timeoutPromise;\n        var chartColor = 'rgb(26, 117, 174)';\n        var frameListener;\n        var frameId;\n\n        /** Chart properties **/\n        var chart1 = undefined;\n        var chart2 = undefined;\n        var chartData1 = {\n            datasets: [{\n                label: \"Data 1\",\n                xAxisID: \"x-axis-1\",\n                yAxisID: \"y-axis-1\",\n                borderColor: chartColor,\n                data: []\n            }]\n        };\n\n        var chartData2 = {\n            datasets: [{\n                label: \"Data 1\",\n                xAxisID: \"x-axis-1\",\n                yAxisID: \"y-axis-1\",\n                borderColor: chartColor,\n                data: []\n            }]\n        };\n\n        var chartOptions = {\n            animation: false,\n            maintainAspectRatio: false,\n            legend: {\n                display: false\n            },\n            tooltips: {\n                enabled: false\n            },\n            elements: {\n                line: {\n                    borderWidth: 2,\n                    fill: false,\n                    tension: 0\n                },\n                point: {\n                    radius: 2,\n                    borderWidth: 2\n                }\n            },\n            scales: {\n                xAxes: [{\n                    type: \"linear\",\n                    gridLines: {\n                        zeroLineColor: \"#9E9E9E\",\n                        color: \"#BDBDBD\"\n                    }\n                }],\n                yAxes: [\n                    {\n                        id: \"y-axis-1\",\n                        position: \"left\",\n                        type: \"linear\", // only linear but allow scale type registration. This allows extensions to exist solely for log scale for instance\n                        display: true,\n                        scaleLabel: {\n                            display: false,\n                            fontColor: 'rgb(33,150,243)',\n                            labelString: 'Data 1'\n                        },\n                        gridLines: {\n                            zeroLineColor: \"#9E9E9E\",\n                            color: \"#BDBDBD\"\n                        },\n                        ticks: {\n                            beginAtZero: true,\n                            suggestedMax: 0,\n                            suggestedMin: -10\n                        }\n                    }]\n            }\n        };\n\n        /**------------------------------ INITIALIZATION / DESTROY METHODS -------------------------------**/\n\n        /** Initialization function **/\n        vm.$onInit = function init() {\n            if (angular.isUndefined(this.config) || angular.isUndefined(this.config.deviceId) || angular.isUndefined(this.config.frameId)) {\n                vm.logger.error('config and/or deviceId and/or frameId not defined!');\n                return;\n            }\n\n            vm.deviceId = this.config.deviceId;\n            frameId = this.config.frameId;\n\n            //Wait the canvas creation, and then create the chart...\n            timeoutPromise = $timeout(function () {\n                createChart();\n                initDataListener();\n                initDataWatcher();\n                initThemeWatcher();\n            }, 500);\n        };\n\n        /** Destroy function **/\n        vm.$onDestroy = function () {\n            if (angular.isDefined(frameListener))\n                acquisitionService.registerForDevice(vm.deviceId).unregisterForFrame(frameListener);\n            if (angular.isDefined(timeoutPromise))\n                $timeout.cancel(timeoutPromise);\n            if (angular.isDefined(intervalPromise))\n                $interval.cancel(intervalPromise);\n        };\n\n        /**------------------------------ PRIVATE METHODS -------------------------------**/\n\n        /** Redraw the chart **/\n        function createChart() {\n            if (chart1 !== undefined)\n                chart1.destroy();\n\n            if (chart2 !== undefined)\n                chart2.destroy();\n\n            canvas1 = document.getElementById(vm.canvasId1);\n            if (canvas1 != undefined)\n                chart1 = Chart.Scatter(canvas1, { data: chartData1, options: chartOptions });\n\n\n            canvas2 = document.getElementById(vm.canvasId2);\n            if (canvas2 != undefined)\n                chart2 = Chart.Scatter(canvas2, { data: chartData2, options: chartOptions });\n\n        }\n\n        /** Initialize the data listener **/\n        function initDataListener() {\n            var device = acquisitionService.registerForDevice(vm.deviceId);\n            frameListener = device.registerForFrame(frameId);\n            frameListener.promise.then({}, {}, function (frame) {\n                if (vm.dataMissing) {\n                    vm.dataMissing = false;\n                    chartData1.datasets[0].borderColor = chartColor;\n                    chartData2.datasets[0].borderColor = chartColor;\n                }\n                lastFrameTimestamp = frame.timestamp;\n\n                vm.dateContent = lastFrameTimestamp;\n                vm.dateColor = \"rgb(26, 117, 174)\";\n\n                var length = frame.value[ADCP.BIN_LENGTH];\n                var sounding = frame.value[ADCP.SOUNDING];\n\n\n                var i = 0;\n                var dataDescription = device.frameList[frameId][ADCP.EW_VEL];\n                var missingValue = dataDescription.missingValue;\n                chartData1.datasets[0].data = [];\n                angular.forEach(frame.value[ADCP.EW_VEL], function (value) {\n                    if (sounding <= 0 || i * length < sounding){\n                        if(value == missingValue) // the line is interrupted if a missing value appears\n                            value = null;\n                        chartData1.datasets[0].data.push({ x: parseFloat(value), y: - i * length });\n                    }\n                    i++;\n                });\n                chart1.update();\n\n                i = 0;\n                dataDescription = device.frameList[frameId][ADCP.NS_VEL];\n                missingValue = dataDescription.missingValue;\n                chartData2.datasets[0].data = [];\n                angular.forEach(frame.value[ADCP.NS_VEL], function (value) {\n                    if (sounding <= 0 || i * length < sounding){\n                        if(value == missingValue)\n                            value = null;\n                        chartData2.datasets[0].data.push({ x: parseFloat(value), y: - i * length });\n                    }\n                    i++;\n                });\n                chart2.update();\n            });\n\n        }\n\n        /** Check the data reception **/\n        function initDataWatcher() {\n            intervalPromise = $interval(function () {\n                var devicePeriod = acquisitionService.registerForDevice(vm.deviceId).periodList[frameId];\n                if (angular.isUndefined(devicePeriod))\n                    devicePeriod = 1000;\n                if (angular.isDefined(lastFrameTimestamp) &&\n                    statusService.getServerTime().time - lastFrameTimestamp > 5 * devicePeriod) {\n                    vm.dataMissing = true;\n                    vm.dateContent = \"no data\";\n                    vm.dateColor = \"#BDBDBD\";\n                    chartData1.datasets[0].borderColor = \"#BDBDBD\";\n                    chartData2.datasets[0].borderColor = \"#BDBDBD\";\n                    chart1.update();\n                    chart2.update();\n                }\n            }, 1000);\n        }\n\n        /** Change gridLinesColor of Graph on every change of service variable  **/\n        function initThemeWatcher() {\n        \tthemeService.subscribe($scope, function(event, theme) {\n                chartOptions.scales.xAxes[0].gridLines.color = theme.gridLinesColor;\n                chartOptions.scales.yAxes[0].gridLines.color = theme.gridLinesColor;\n                createChart();\n        \t});\n        }\n    }\n})();\n\n/*\n * Traverse tribord\n *\n * DA 1 max 800kW\n * DA 3 max 1200kW\n *\n * Traverse bbord\n * DA 2 max 1200kW\n * DA 4 max 800kW\n */\n\n(function () {\n    'use strict';\n\n    /** Propulsion component **/\n    angular.module('tsa.tsaViews.atpropulsion', []).component('tsaAtPropulsion', {\n        templateUrl: \"app/tsa-views/atpropulsion/atpropulsion.html\",\n        controllerAs: \"ctrl\",\n        controller: atPropulsionController,\n        bindings: {\n            config: '=',\n            cardId: '@',\n            onChangeCardType: '&'\n        }\n    });\n\n    /** Propulsion controller **/\n    function atPropulsionController(acquisitionService, $timeout, $scope, easelJsUtils, themeService) {\n        var vm = this;\n        var TAG = '[atPropulsionController] ';\n\n        /**------------------------------ PROPERTIES -------------------------------**/\n\n        //Canvas\n        vm.canvasId = \"canvas-atpropulsion-\" + vm.cardId;\n\n        var canvas;\n        var stage;\n        var backContainer;\n        var frontContainer;\n\n        var canvasWidth;\n        var canvasHeight;\n\n        vm.readyToDraw = false;\n\n        vm.colors = {\n        \tbackground: '#CCCCCC',\n        \tzero: '#EE2222',\n        \ttick: '#888888',\n        \trudder: '#000000',\n        \tgreen: '#11CC11',\n        \tred: '#EE2222',\n        \tforward: '#1111DD',\n        \tbackward: '#000000',\n        \tfunkyBackground: '#F3BF52'\n        };\n\n        vm.themeChanged = function themeChanded(event, theme) {\n        \tconsole.log(\"propulsion themechanged\");\n        };\n\n        themeService.subscribe($scope, vm.themeChanged);\n\n        /**------------------------------ METHODS -------------------------------**/\n\n        /** Initialization function **/\n        vm.$onInit = function init() {\n\n            console.log(TAG + '$onInit: deviceId = ' + (this.config ? this.config.deviceId : 'config undefined'));\n\n            if (this.config == undefined || this.config.deviceId == undefined) {\n                console.error(TAG + 'device Id not found!');\n                return;\n            }\n\n            vm.deviceId = this.config.deviceId; //Component parameter (mandatory)\n            vm.device = acquisitionService.registerForDevice(vm.deviceId);\n\n            vm.frameId = 'atpropulsion';\n\n            //Create object to add x and y properties\n            vm.frontTrans = { id: 'fronttrans' };\n            vm.frontPropAngle= { id: 'frontpropangle' };\n            vm.mainLeft = { id: 'mainleft' };\n            vm.mainRight = { id: 'mainright' };\n            vm.angle = {id: 'angle' };\n            vm.fontsize = 1;\n\n            vm.frameListener = acquisitionService.registerForDevice(vm.deviceId).registerForFrame(vm.frameId);\n            vm.frameListener.promise.then({}, {}, function (frame) {\n            \tvm.frontTrans.value = frame.value[vm.frontTrans.id];\n            \tvm.frontPropAngle.value = frame.value[vm.frontPropAngle.id];\n            \tvm.mainLeft.value = frame.value[vm.mainLeft.id];\n                vm.mainRight.value = frame.value[vm.mainRight.id];\n            \tvm.angle.value = frame.value[vm.angle.id];\n\n            \tif(vm.readyToDraw) {\n                    updateFrontContainer();\n            \t\tstage.update();\n            \t}\n            });\n\n            $timeout(function () {\n                initCanvas();\n                vm.readyToDraw = true;\n            }, 500);\n\n        };\n\n        /** Destroy function: remove the data listeners */\n        vm.$onDestroy = function destroy() {\n            if (angular.isDefined(vm.frameListener))\n                acquisitionService.registerForDevice(vm.deviceId).unregisterForFrame(vm.frameListener);\n        };\n\n        /**Initialize the canvas **/\n        function initCanvas() {\n            canvas = document.getElementById(vm.canvasId);\n            if (canvas != null) {\n                stage = new createjs.Stage(canvas);\n\n                backContainer = new createjs.Container();\n                frontContainer = new createjs.Container();\n\n                stage.addChild(backContainer, frontContainer);\n\n                $scope.$watch(function () {\n                    return canvas.offsetHeight\n                }, function () {\n                    updateCanvasSize();\n                });\n                $scope.$watch(function () {\n                    return canvas.offsetWidth\n                }, function () {\n                    updateCanvasSize();\n                });\n                updateCanvasSize();\n            }\n        }\n\n        /** Create the stage if needed, reset the canvas and redraw all the shapes **/\n        function updateCanvasSize() {\n            if (canvas != null) {\n                canvasWidth = canvas.offsetWidth;\n                canvasHeight = canvas.offsetHeight;\n\n                //Canvas size properties setting\n                canvas.setAttribute('width', canvasWidth);\n                canvas.setAttribute('height', canvasHeight);\n\n                angular.element(canvas).parent().find(\"tsa-data-view .value\").css({\n                \t\"font-size\": \"\"+canvasHeight/200+\"em\"\n        \t\t});\n\n                angular.element(canvas).parent().find(\"tsa-data-view\").css({\n                \t\"width\": \"\"+Math.round(canvasHeight/3)+\"px !important\",\n                \t\"max-width\": \"\"+Math.round(canvasHeight/3)+\"px\",\n                \t\"background-color\": \"green\"\n                });\n\n                stage.x = canvasWidth/2;\n                stage.y = canvasHeight/2;\n            \tvar scale = canvasHeight/100;\n            \tstage.scaleX = stage.scaleY = scale;\n\n                updateBackContainer();\n                backContainer.cache(-canvasWidth/2, -canvasHeight/2, canvasWidth, canvasHeight, scale);\n                updateFrontContainer();\n                updateLabels();\n\n                stage.update();\n            }\n        }\n\n\n        function updateBackContainer() {\n        \tbackContainer.removeAllChildren();\n\n            var vesselShape = easelJsUtils.createVessel(vm.colors.tick);\n            vesselShape.scaleX = 0.6;\n            vesselShape.scaleY = 0.95;\n\n            var backRudderShape =  easelJsUtils.createBackRudder(vm.colors.background);\n            backRudderShape.y = 25;\n            backRudderShape.scaleX = backRudderShape.scaleY = 18/100;\n\n            var rearPropBackGaugeShape = easelJsUtils.createBackGauge(vm.colors.background);\n            rearPropBackGaugeShape.y = 18;\n            rearPropBackGaugeShape.scaleX = 0.4;\n            rearPropBackGaugeShape.scaleY = 0.3;\n\n\t\t\tvar frontPropBackGaugeShape = easelJsUtils.createBackGauge(vm.colors.background);\n\t\t\tfrontPropBackGaugeShape.y = -38;\n\t\t\tfrontPropBackGaugeShape.scaleX = 0.4;\n\t\t\tfrontPropBackGaugeShape.scaleY = 0.3;\n\n\t\t\tvar mainBackGaugeShape = easelJsUtils.createBackGauge(vm.colors.background);\n\t\t\tmainBackGaugeShape.y = -10;\n\t\t\tmainBackGaugeShape.scaleX = 0.4;\n\t\t\tmainBackGaugeShape.scaleY = 0.3;\n\t\t\tmainBackGaugeShape.rotation = 270;\n\n            backContainer.addChild(vesselShape, backRudderShape, rearPropBackGaugeShape, frontPropBackGaugeShape, mainBackGaugeShape);\n        }\n\n        function updateFrontContainer() {\n        \tfrontContainer.removeAllChildren();\n\n            var rudderColor = vm.colors.rudder;\n\t\t\tif(Math.abs(Math.round(vm.angle.value))>0) {\n\t\t\t\trudderColor = vm.angle.value > 0 ? vm.colors.red : vm.colors.green;\n\t\t\t}\n\n            var rudderShape = easelJsUtils.createRudder(rudderColor);\n            rudderShape.y = 25;\n            rudderShape.scaleX = rudderShape.scaleY = 18/100;\n            rudderShape.rotation = vm.angle.value;\n\n\n            var rearPropGaugeShape = easelJsUtils.createGaugge(vm.colors.tick, vm.colors.zero,\n            \t\tvm.frontPropAngle.value, vm.colors.green, vm.colors.red);\n            rearPropGaugeShape.y = 18;\n            rearPropGaugeShape.scaleX = 0.4;\n            rearPropGaugeShape.scaleY = 0.3;\n\n\n            var frontPropGaugeShape = easelJsUtils.createGaugge(vm.colors.tick, vm.colors.zero,\n            \t\tvm.frontTrans.value, vm.colors.green, vm.colors.red);\n            frontPropGaugeShape.y = -38;\n            frontPropGaugeShape.scaleX = 0.4;\n            frontPropGaugeShape.scaleY = 0.3;\n\n            var mainLeftGaugeShape = easelJsUtils.createGaugge(vm.colors.tick, vm.colors.zero,\n            \t\tvm.mainLeft.value*100/150, vm.colors.forward, vm.colors.backward);\n            mainLeftGaugeShape.y = -10;\n            mainLeftGaugeShape.scaleX = 0.4;\n            mainLeftGaugeShape.scaleY = 0.3;\n            mainLeftGaugeShape.rotation = 270;\n\n            frontContainer.addChild(rudderShape, rearPropGaugeShape, frontPropGaugeShape, mainLeftGaugeShape);\n        }\n\n\n        function updateLabels() {\n            canvasWidth = canvas.offsetWidth;\n            canvasHeight = canvas.offsetHeight;\n\n            var delta = canvasHeight*5/100;\n\n            vm.frontTrans.x = canvasWidth/2 + canvasHeight*25/100;\n            vm.frontTrans.y = canvasHeight*(50 - 38)/100 - delta;\n\n/*\n            vm.rearTrans.x = vm.frontTrans.x;\n            vm.rearTrans.y = canvasHeight*(50 + 18)/100 - delta;\n*/\n\n            vm.mainLeft.x = vm.frontTrans.x;\n            vm.mainLeft.y = canvasHeight*(50 - 10)/100 - delta;\n\n            vm.angle.x = vm.frontTrans.x;\n            vm.angle.y = canvasHeight*(50 + 32)/100 - delta;\n        }\n    }\n})();\n\n(function () {\n    'use strict';\n\n    /** Component declaration **/\n    angular.module('tsa.tsaViews.attitude', []).component('tsaAttitude', {\n        templateUrl: \"app/tsa-views/attitude/attitude.html\",\n        controllerAs: \"ctrl\",\n        controller: attitudeController,\n        bindings: {\n            config: '=',\n            cardId: '@',\n            onChangeCardType: '&'\n        }\n    });\n\n    /** Component controller */\n    function attitudeController($log, ATTITUDE, acquisitionService) {\n\n        /**------------------------------ PROPERTIES -----------------------------**/\n        var vm = this;\n        var frameListener;\n        vm.logger = $log.getInstance(\"Attitude-tsa-view\");\n\n        /**------------------------------- METHODS -------------------------------**/\n\n        /** Initialization function **/\n        vm.$onInit = function init() {\n            if (angular.isUndefined(this.config) || angular.isUndefined(this.config.deviceId) || angular.isUndefined(this.config.frameId)) {\n                vm.logger.error('config and/or deviceId and/or frameId not defined!');\n                return;\n            }\n\n            vm.deviceId = this.config.deviceId;\n            vm.frameId = this.config.frameId;\n\n            vm.heading = ATTITUDE.HEADING;\n            vm.roll = ATTITUDE.ROLL;\n            vm.pitch = ATTITUDE.PITCH;\n            vm.heave = ATTITUDE.HEAVE;\n\n            frameListener = acquisitionService.registerForDevice(vm.deviceId).registerForFrame(vm.frameId);\n            frameListener.promise.then({}, {}, function (receivedFrame) {\n                parseAttitudeFrame(receivedFrame.value);\n            });\n        };\n\n        /** Destroy function **/\n        vm.$onDestroy = function onDestroy() {\n            if (angular.isDefined(frameListener)) {\n                acquisitionService.registerForDevice(vm.deviceId).unregisterForFrame(frameListener);\n            }\n        };\n\n\n        /** Called when a frame has been received **/\n        function parseAttitudeFrame(frame) {\n            var roll = frame[ATTITUDE.ROLL];\n            var pitch = frame[ATTITUDE.PITCH];\n\n            if (angular.isUndefined(vm.list) || vm.list < -90) {\n                vm.list = roll;\n                vm.trim = pitch;\n            }\n            else {\n                vm.list = 0.999167 * vm.list + 0.000833 * roll;\n                vm.trim = 0.999167 * vm.trim + 0.000833 * pitch;\n            }\n        }\n    }\n})();\n\n(function () {\n    'use strict';\n\n    /** Casino component declaration **/\n    angular.module('tsa.tsaViews.casino', []).component('tsaCasino', {\n        templateUrl: \"app/tsa-views/casino/casino.html\",\n        controllerAs: \"ctrl\",\n        controller: casinoController,\n        bindings: {\n            config: '=',\n            cardId: '@',\n            onChangeCardType: '&'\n        }\n    });\n\n    /** Casino controller */\n    function casinoController($log, $interval, $rootScope, $scope, casinoService) {\n        var vm = this;\n\n        /**-------------------- PROPERTIES ----------------**/\n        var intervalPromise;\n\n        vm.logger = $log.getInstance(\"casino-tsa-view\");\n        vm.casinoLoading = false;\n        vm.casinoErrorConnect;\n        vm.casinoErrorLoad;\n\n        vm.selectedCruise;\n        vm.eventsListToDisplay = [];\n        vm.period = \"24\";\n\n        /**-------------------- PUBLIC METHODS ----------------**/\n        vm.casinoCanConnect = function () {\n            return !vm.config.connectionParams ||\n                !vm.config.connectionParams.url.trim() ||\n                !vm.config.connectionParams.login.trim() ||\n                !vm.config.connectionParams.password.trim() ||\n                vm.casinoLoading;\n        };\n\n        vm.casinoConnection = function () {\n            vm.casinoLoading = true;\n            casinoService.connect(vm.config.connectionParams.url, vm.config.connectionParams.login, vm.config.connectionParams.password)\n                .then(function () {\n                    vm.casinoErrorConnect = false;\n                    vm.refreshCruise(true);\n                })\n        };\n\n        vm.refreshCruise = function(sendEvent) {\n            vm.selectedCruise = undefined;\n            casinoService.getCurrentCruise()\n                .then(function(currentCruise) {\n                    vm.casinoLoading = false;\n                    if (currentCruise && currentCruise.length === 1) {\n                        vm.casinoErrorLoad = false;\n                        vm.selectedCruise = currentCruise[0];\n                        vm.updateEventsTable();\n                    } else {\n                        vm.casinoErrorLoad = true;\n                    }\n                })\n                .catch(function () {\n                    vm.casinoErrorConnect = true;\n                    vm.casinoLoading = false;\n                });\n        };\n\n        vm.updateEventsTable = function() {\n            var isDateParam = \"false\";\n            var limitParam = vm.config.limit;\n            if (parseInt(vm.period) > 0) {\n                isDateParam = \"true\";\n                limitParam = vm.period;\n            }\n            casinoService.getCruiseEvents(vm.selectedCruise.FullName, limitParam, isDateParam)\n                .then(function(data) {\n                    vm.eventsListToDisplay = data;\n                })\n        };\n\n        /**\n         * Init function\n         */\n        vm.$onInit = function init() {\n            // Database connection\n            vm.casinoConnection();\n\n            // refresh eventsListToDisplay\n            intervalPromise = $interval(function () {\n                if (angular.isDefined(vm.selectedCruise)) {\n                    vm.updateEventsTable();\n                }\n            }, 8000);\n        };\n\n        /**\n         * Destroy function\n         */\n        vm.$onDestroy = function onDestroy() {\n            if (angular.isDefined(intervalPromise))\n                $interval.cancel(intervalPromise);\n        };\n    }\n})();\n\n(function () {\n    'use strict';\n\n    /** Casino component declaration **/\n    angular.module('tsa.tsaViews.casinoAddEvent', []).component('tsaCasinoAddEvent', {\n        templateUrl: \"app/tsa-views/casino/casinoAddEvent.html\",\n        controllerAs: \"ctrl\",\n        controller: casinoAddEventController,\n        bindings: {\n            config: '=',\n            cardId: '@',\n            onChangeCardType: '&'\n        }\n    });\n\n    /** Casino controller */\n    function casinoAddEventController($log, $rootScope, $scope, $filter, dialogService, casinoService, CasinoEvent, CasinoOperationId) {\n        var vm = this;\n\n        /**-------------------- PROPERTIES ----------------**/\n        vm.logger = $log.getInstance(\"casino-tsa-view\");\n        vm.casinoLoading = false;\n        vm.casinoErrorConnect;\n        vm.casinoErrorLoad;\n        vm.error;\n\n        vm.isFollow = false;\n        vm.validExitTitle = undefined;\n        vm.validExitMsg = undefined;\n\n        vm.selectedCruise;\n        vm.casinoEvent = new CasinoEvent();\n        vm.operationId = new CasinoOperationId();\n        vm.deviceId;\n        vm.listCasinoDevices = undefined;\n        vm.listDeviceActions = undefined;\n\n        vm.eventTypeEnum = {\n            PHA: \"PHA\",\n            OPE: \"OPE\",\n            OBS: \"OBS\"\n        };\n\n        vm.phaseTypeEnum = {\n            PROFIL: \"PROFIL\",\n            STATION: \"STATION\",\n            TRANSIT: \"TRANSIT\",\n            GIRATION: \"GIRATION\",\n            ESCALE: \"ESCALE\"\n        };\n\n        /**-------------------- PUBLIC METHODS ----------------**/\n        vm.casinoCanConnect = function () {\n            return !vm.config.connectionParams ||\n                !vm.config.connectionParams.url.trim() ||\n                !vm.config.connectionParams.login.trim() ||\n                !vm.config.connectionParams.password.trim() ||\n                vm.casinoLoading;\n        };\n\n        vm.casinoConnection = function () {\n            vm.casinoLoading = true;\n            casinoService.connect(vm.config.connectionParams.url, vm.config.connectionParams.login, vm.config.connectionParams.password)\n                .then(function () {\n                    vm.refreshCruise(true);\n                })\n        };\n\n        vm.initErrors = function(){\n            vm.casinoErrorConnect = false;\n            vm.casinoErrorLoad = false;\n            vm.error = undefined;\n        };\n\n        vm.onResetClick = function() {\n            if (vm.isFollow) {\n                dialogService.showValidation(\n                    vm.validExitTitle,\n                    vm.validExitMsg)\n                    .then(\n                        function accept() {\n                            vm.onResetForm();\n                        },\n                        function decline() {\n                            // do nothing\n                        }\n                    );\n            } else {\n                vm.onResetForm();\n            }\n        };\n\n        vm.onResetForm = function() {\n            vm.isFollow = false;\n            vm.updateValidExit();\n            vm.initErrors();\n            vm.listDeviceActions = undefined;\n            vm.casinoEvent.init();\n            vm.operationId.init();\n            vm.updatePrefixOperation();\n        };\n\n        vm.onSubmit = function() {\n            vm.initErrors();\n            if (vm.selectedCruise) {\n                // Clean casinoEvent object\n                vm.casinoEvent.operationId = vm.operationId.getStringOperationId();\n                vm.casinoEvent.cleanByType();\n\n                var date = new Date();\n                vm.casinoEvent.eventDate = date.toISOString();\n\n                // create New CasinoEvent\n                casinoService.postCruiseEvent(vm.selectedCruise.FullName, vm.casinoEvent)\n                    .then(function(data) {\n                        var followIdx = vm.checkFollow();\n                        if (followIdx > -1) {\n                            vm.updateAction(vm.listDeviceActions[followIdx]);\n                            vm.isFollow = true;\n                            vm.updateValidExit();\n                        } else {\n                            // clear form\n                            vm.onResetForm();\n                        }\n                    })\n                    .catch(function (error){\n                        if (error.status === 400) {\n                            vm.error = error.data;\n                        } else {\n                            vm.casinoErrorConnect = true;\n                        }\n                    });\n            }\n        };\n\n        vm.checkFollow = function() {\n            var followIdx = -1;\n            if (vm.casinoEvent.type === 'OPE' && vm.listDeviceActions) {\n                var idx = vm.getActionIdx(vm.casinoEvent.actionCode);\n                if ((idx > -1) && (idx < vm.listDeviceActions.length -1)) {\n                    // not the last\n                    followIdx = idx+1;\n                }\n            }\n            return followIdx;\n        };\n\n        vm.getActionIdx = function(actionCode) {\n            if (actionCode && vm.listDeviceActions) {\n                for (var i=0; i<vm.listDeviceActions.length; i++) {\n                    if(vm.listDeviceActions[i].code === actionCode) {\n                        return i;\n                    }\n                }\n            }\n            return -1;\n        };\n\n        vm.refreshCruise = function(sendEvent) {\n            // init form\n            vm.onResetForm();\n            casinoService.getCurrentCruise()\n                .then(function(currentCruise) {\n                    vm.casinoLoading = false;\n                    if (currentCruise && currentCruise.length === 1) {\n                        vm.selectedCruise = currentCruise[0];\n                        vm.updateCruise();\n                    } else {\n                        vm.casinoErrorLoad = true;\n                    }\n                })\n                .catch(function () {\n                    vm.casinoErrorConnect = true;\n                    vm.casinoLoading = false;\n                });\n        };\n\n        vm.updateCruise = function() {\n            vm.updateListCasinoDevices();\n            vm.updatePrefixOperation();\n        };\n\n        vm.updatePrefixOperation = function() {\n            vm.operationId.prefix = '';\n            if (vm.selectedCruise) {\n                vm.operationId.updatePrefix(vm.selectedCruise.OperationPrefix, vm.casinoEvent.deviceCode);\n                vm.updateNumberOperation();\n            }\n        };\n\n        vm.updateNumberOperation = function() {\n            vm.operationId.updateNumber(undefined);\n            if (vm.selectedCruise && vm.operationId.prefix != '' && vm.casinoEvent.deviceCode != \"\"){\n                casinoService.getLastOperationId(vm.selectedCruise.FullName, vm.operationId.prefix)\n                    .then(function(data) {\n                        if (data && data.length === 1) {\n                            vm.operationId.updateNumber(data[0].OperationId, vm.operationId.prefix);\n                        }\n                    })\n            }\n        };\n\n        vm.updateListCasinoDevices = function() {\n            vm.listCasinoDevices = undefined;\n            vm.listDeviceActions = undefined;\n            vm.casinoEvent.initDevice();\n            if (vm.selectedCruise) {\n                casinoService.getCruiseDevices(vm.selectedCruise.FullName)\n                    .then(function(data) {\n                        vm.listCasinoDevices = data;\n                    })\n            }\n        };\n\n        vm.updateDevice = function(item) {\n            vm.casinoEvent.initDevice();\n            vm.deviceId = undefined;\n            if (item) {\n                vm.deviceId = item.id;\n                vm.casinoEvent.deviceCode = item.code;\n                vm.casinoEvent.deviceFullName = item.name;\n            }\n            vm.updateListDeviceActions();\n            vm.updatePrefixOperation();\n        };\n\n        vm.updateListDeviceActions = function() {\n            vm.listDeviceActions = undefined;\n            if (vm.selectedCruise && vm.deviceId) {\n                casinoService.getDeviceActions(vm.selectedCruise.FullName, vm.deviceId)\n                    .then(function(data) {\n                        vm.listDeviceActions = data;\n                    })\n            }\n        };\n\n        vm.updateAction = function(item) {\n            if (item) {\n                vm.casinoEvent.initAction();\n                vm.casinoEvent.actionCode = item.code;\n                vm.casinoEvent.actionFullName = item.name;\n            }\n        };\n\n        vm.updateValidExit = function() {\n            vm.validExitTitle = undefined;\n            vm.validExitMsg = undefined;\n            if (vm.isFollow) {\n                vm.validExitTitle = $filter('translate')(\"views.casino.add-event.follow-exit.title\");\n                vm.validExitMsg = $filter('translate')(\"views.casino.add-event.follow-exit.message\");\n            }\n        };\n\n        /**\n         * Init function\n         */\n        vm.$onInit = function init() {\n            // Database connection\n            vm.casinoConnection();\n        };\n\n        /**\n         * Destroy function\n         */\n        vm.$onDestroy = function onDestroy() {\n            // nothing to do\n        };\n    }\n})();\n\n(function () {\n    'use strict';\n    angular.module('tsa.tsaViews.debug', []).component('tsaDebug', {\n        templateUrl: \"app/tsa-views/debug/debug.html\",\n        controllerAs: \"ctrl\",\n        controller: debugController,\n        bindings: {\n            onChangeCardType: '&',\n            cardId: '@'\n        }\n    });\n\n    function debugController(acquisitionService, stompService, acquisitionBufferService, dialogService, restService) {\n        var vm = this;\n\n        /**-------------------- PROPERTIES ----------------**/\n        vm.view = 'Devices';\n        //Devices\n        vm.deviceList = {};\n        //Topics\n        vm.topicList = {};\n        vm.stompConsole = \"\";\n        //Topic\n        vm.topiConsole = '';\n        vm.topic = undefined;\n        var currentTopicListener = undefined;\n        vm.currentTopic = undefined;\n        //Buffers\n        vm.bufferDeviceList = {};\n        //Config\n        vm.configId = 'default';\n        //Requests\n        vm.requestStack = undefined;\n        vm.restService = restService;\n\n        /**-------------------- PUBLIC METHODS ----------------**/\n\n        vm.$onInit = function init() {\n            vm.topicList = stompService.getTopicList();\n            vm.deviceList = acquisitionService.getDeviceList();\n            vm.stompService = stompService;\n            vm.bufferDeviceList = acquisitionBufferService.getDataList();\n            vm.requestStack = restService.getRequestStack();\n        };\n\n\n        /**\n         * Destroy function, called when the view is destroyed: closes the used resources.\n         */\n        vm.$onDestroy = function onDestroy() {\n            vm.disconnectTopic();\n        };\n\n\n        vm.startStompService = function startStompService() {\n            stompService.start().then(\n                function () {\n                    dialogService.showToast(\"STOMP connection successful!\");\n                },\n                function (error) {\n                    dialogService.showToast(\"STOMP connection error: \" + error);\n                }\n            );\n        };\n\n        vm.stopStompService = function stopStompService() {\n            stompService.stop();\n        };\n\n\n        vm.connectToTopic = function connectToTopic() {\n            if (vm.topic !== undefined) {\n                vm.currentTopic = '/topic/' + vm.topic;\n                currentTopicListener = stompService.registerForTopic(vm.currentTopic);\n                vm.topicConsole = \"\";\n                currentTopicListener.promise.then({}, {}, function (msg) {\n                    vm.topicConsole = JSON.stringify(msg.data.headers) + \"\\n\" + msg.data.body + \"\\n\" + vm.topicConsole;\n                    if (vm.topicConsole.length > 50000)\n                        vm.topicConsole = vm.topicConsole.substring(vm.topicConsole.length / 3);\n                });\n            }\n        };\n\n        vm.disconnectTopic = function disconnectTopic() {\n            if (currentTopicListener !== undefined && vm.currentTopic !== undefined) {\n                stompService.unregisterForTopic(vm.currentTopic, currentTopicListener);\n                vm.currentTopic = undefined;\n                currentTopicListener = undefined;\n            }\n        };\n\n        vm.clearTopicConsole = function clearTopicConsole() {\n            vm.topicConsole = \"\";\n        };\n\n        vm.cancelRequest = function cancelRequest(request){\n            restService.cancelRequest(request.id);\n\n        };\n    }\n})();\n\n(function () {\n    'use strict';\n\n    /** Depth component declaration **/\n    (function () {\n        'use strict';\n        angular.module('tsa.tsaViews.depth', []).component('tsaDepth', {\n            templateUrl: \"app/tsa-views/depth/depth.html\",\n            controllerAs: \"ctrl\",\n            controller: depthController,\n            bindings: {\n                config: '=',\n                cardId: '@',\n                onChangeCardType: '&'\n            }\n        });\n    })();\n\n    /** Depth controller */\n    function depthController($timeout, $interval, $log, $scope, acquisitionService, NAVIGATION, statusService, themeService, graphUtils) {\n        var vm = this;\n\n        /**------------------------------ PROPERTIES -------------------------------**/\n\n        vm.logger = $log.getInstance(\"depth-tsa-view\");\n        vm.canvasId = \"canvas-depth-\" + vm.cardId;\n        var intervalPromise;\n        var timeoutPromise;\n\n        /**  Time scales **/\n        vm.scales = graphUtils.scales;\n        vm.selectedScale = '1 min';\n        vm.bufferLoading = {};\n\n        /** Chart properties **/\n        var chart = undefined;\n        var chartData = {\n            datasets: [{\n                label: \"Data 1\",\n                xAxisID: \"x-axis-1\",\n                yAxisID: \"y-axis-1\",\n                borderColor: 'rgb(26, 117, 174)',\n                backgroundColor: 'rgba(26, 117, 174, 0.3)',\n                data: []\n            }]\n        };\n\n        /**-------------------------- INITIALIZATION / DESTROY METHODS -------------------------**/\n\n        /** Initialization function **/\n        vm.$onInit = function init() {\n            if (angular.isUndefined(this.config) || angular.isUndefined(this.config.deviceId) || angular.isUndefined(this.config.frameId)) {\n                vm.logger.error('config and/or deviceId and/or frameId not defined!');\n                return;\n            }\n\n            vm.deviceId = this.config.deviceId;\n            vm.frameId = this.config.frameId;\n\n            vm.dataId = NAVIGATION.SOUNDER;\n\n            vm.device = acquisitionService.registerForDevice(vm.deviceId);\n            vm.device.recordData(vm.frameId, vm.dataId);\n\n            if (angular.isDefined(vm.config.scale))\n                vm.selectedScale = vm.config.scale;\n\n            //Wait the canvas creation, and then create the chart\n            timeoutPromise = $timeout(initTimer, 200);\n\n            // Change gridLinesColor of Graph on every change of service variable\n            themeService.subscribe($scope, function(event, theme) {\n        \t\tvm.theme = theme;\n        \t\treloadChart();\n        \t});\n\n        };\n\n        /** Destroy function **/\n        vm.$onDestroy = function () {\n            vm.device.stopRecordData(vm.frameId, vm.dataId);\n            $timeout.cancel(timeoutPromise);\n            if (intervalPromise !== undefined)\n                $interval.cancel(intervalPromise);\n        };\n\n        /**------------------------------ PRIVATE METHODS -------------------------------**/\n\n        /** Generate the chart options */\n        function getChartOptions() {\n            var chartOptions = graphUtils.getChartOptions(vm.scales[vm.selectedScale].stepSize, true);\n            chartOptions.scales.yAxes = [{\n                id: \"y-axis-1\",\n                gridLines: { color: vm.theme.gridLinesColor },\n                ticks: { beginAtZero: true, suggestedMin: -10 }\n            }];\n            return chartOptions;\n        };\n\n        /** Redraw the chart **/\n        function reloadChart() {\n            if (chart !== undefined)\n                chart.destroy();\n            var canvas = document.getElementById(vm.canvasId);\n            if (canvas) {\n                chart = Chart.Scatter(canvas, { data: chartData, options: getChartOptions() });\n                updateGraph();\n            }\n            vm.config.scale = vm.selectedScale;\n        }\n\n        /** Start or update the timer (intervalPromise) */\n        var initTimer = function initTimer() {\n            if (intervalPromise !== undefined)\n                $interval.cancel(intervalPromise);\n\n            //Load archived data\n            if (angular.isDefined(vm.device) && angular.isDefined(vm.device.getData(vm.frameId, vm.dataId))) {\n                var bufferId = vm.scales[vm.selectedScale].bufferId;\n                vm.bufferLoading[vm.selectedScale] = vm.bufferLoading[vm.selectedScale] ? ++vm.bufferLoading[vm.selectedScale] : 1;\n                var selectedScale = vm.selectedScale;\n                var requestCallback = function () {\n                    vm.bufferLoading[selectedScale]--;\n                    if (chart !== undefined)\n                        updateGraph();\n                };\n                vm.device.getData(vm.frameId, vm.dataId).buffers[bufferId].loadArchivedFrames().then(requestCallback, requestCallback);\n            }\n            reloadChart();\n            intervalPromise = $interval(updateGraph, vm.scales[vm.selectedScale].scale / 1000);\n        };\n\n        /** Update the graph with the recorded data, called by the timer (intervalPromise) */\n        function updateGraph() {\n            //Step 1: update X axis\n            var currentDate = statusService.getServerTime().time;\n            chart.options.scales.xAxes[0].ticks.min = (currentDate - vm.scales[vm.selectedScale].scale);\n            chart.options.scales.xAxes[0].ticks.max = currentDate;\n\n            //Step 2: update data\n            var bufferId = vm.scales[vm.selectedScale].bufferId;\n            chartData.datasets[0].data = [];\n            var recordedData = vm.device.getData(vm.frameId, vm.dataId);\n            if (recordedData !== undefined)\n                angular.forEach(recordedData.buffers[bufferId].frames, function (frame) {\n                    chartData.datasets[0].data.push({ x: frame.timestamp, y: -frame.value });\n                });\n\n            chart.update();\n        }\n\n        /** Called when a new X scale is selected */\n        vm.onChangeXScale = initTimer;\n\n    }\n})();\n\n(function () {\n    'use strict';\n\n    /** Component declaration **/\n    angular.module('tsa.tsaViews.devices', []).component('tsaDevices', {\n        templateUrl: \"app/tsa-views/devices/devices.html\",\n        controllerAs: \"ctrl\",\n        controller: devicesController,\n        bindings: {\n            config: '=',\n            cardId: '@',\n            onChangeCardType: '&'\n        }\n    });\n\n    /** Component controller */\n    function devicesController($log, $interval, acquisitionService, statusService) {\n        var vm = this;\n\n        /**------------------------------ PROPERTIES -----------------------------**/\n        var logger = $log.getInstance(\"Device-tsa-view\");\n\n        vm.itemList = [];\n        var deviceListListener;\n        var intervalPromise;\n\n\n        /**------------------------------ Item class -------------------------------**/\n        /*** Item: represents a device, its files stats and its frame number.*/\n        function Item(device) {\n            var self = this;\n            this.device = device;\n            this.lastJSONMessageTime = undefined;\n            this.isReceivingJSON = false;\n\n            //Subscription to JSON data messages\n            this.JSONDataListener = this.device.subscribeToJSONData();\n            if (this.JSONDataListener !== undefined) {\n                this.JSONDataListener.promise.then({}, {}, function (msg) {\n                    self.lastJSONMessageTime = JSON.parse(msg.data.body).acquisitionTime;\n                });\n            }\n            else {\n                console.error(TAG + 'error with the subscription to the JSON topic for the device: ' + device.name);\n            }\n        }\n\n\n        /**---------------------- INITIALIZATION / DESTROY METHODS -------------------**/\n\n        /** Initialization function **/\n        vm.$onInit = function init() {\n            logger.debug('init function');\n\n            //Watch device list\n            refreshItemList(acquisitionService.getDeviceList());\n            deviceListListener = acquisitionService.registerForDeviceList();\n            deviceListListener.promise.then({}, {}, refreshItemList);\n\n            intervalPromise = $interval(watchdog, 1000);\n        };\n\n        /** Destroy function **/\n        vm.$onDestroy = function () {\n            logger.debug('destroy function');\n            angular.forEach(vm.itemList, function (item) {\n                item.device.unsubscribeToJSONData(item.JSONDataListener);\n            });\n            acquisitionService.unregisterForDeviceList(deviceListListener);\n            if (intervalPromise !== undefined)\n                $interval.cancel(intervalPromise);\n        };\n\n        /**--------------------------------- METHODS ----------------------------------**/\n\n        /*** Check the good reception of JSON messages **/\n        function watchdog() {\n            angular.forEach(vm.itemList, function (item) {\n                var currentDate = statusService.getServerTime().time;\n\n                // Get max period\n                var period = 0;\n                angular.forEach(item.device.periodList, function (p) {\n                    period = (period<p) ? p : period;\n                });\n\n                // JSON message reception checking\n                if (item.lastJSONMessageTime !== undefined)\n                    item.isReceivingJSON = (currentDate - item.lastJSONMessageTime) <= (5 * period);\n                else item.isReceivingJSON = false;\n            });\n        }\n\n\n        /** Refresh the item list with a specified device list **/\n        function refreshItemList(deviceList) {\n            //Step 1: remove item which are obsolete\n            var itemToDelete = [];\n            angular.forEach(vm.itemList, function (item) {\n                var itemDeviceExists = false;\n                angular.forEach(deviceList, function (device) {\n                    if (device.id === item.device.id && device.isEnabled)\n                        itemDeviceExists = true; //the device exists and is enabled\n                });\n                if (!itemDeviceExists) {\n                    itemToDelete.push(item);\n                    itemToDelete.push(item);\n                    itemToDelete.push(item);\n                    itemToDelete.push(item);\n                    itemToDelete.push(item);\n                }\n            });\n            angular.forEach(itemToDelete, function (item) {\n                item.device.unsubscribeToJSONData(item.JSONDataListener);\n                vm.itemList.splice(vm.itemList.indexOf(item), 1);\n            });\n\n\n            //Step 2: add a new item for each new device found.\n            angular.forEach(deviceList, function (device) {\n                var itemAlreadyExists = false;\n                angular.forEach(vm.itemList, function (item) {\n                    if (device.id === item.device.id)\n                        itemAlreadyExists = true;\n                });\n                if (!itemAlreadyExists && device.isEnabled) //If the device is not already in the list and is enabled\n                    vm.itemList.push(new Item(device)); // ---> add the device in the list\n            })\n        }\n\n    }\n})();\n\n(function () {\n    'use strict';\n\n    /** Component declaration **/\n    angular.module('tsa.tsaViews.driverPreview', []).component('tsaDriverPreview', {\n        templateUrl: \"app/tsa-views/driverPreview/driverPreview.html\",\n        controllerAs: \"ctrl\",\n        controller: driverPreviewController,\n        bindings: {\n            config: '=',\n            cardId: '@',\n            onChangeCardType: '&'\n        }\n    });\n\n    /** Component controller */\n    function driverPreviewController($log, restService) {\n        var vm = this;\n\n        /**------------------------------ PROPERTIES -----------------------------**/\n        var logger = $log.getInstance(\"driverPreview-tsa-view\");\n        vm.text = \"This is a driverPreview...\";\n        vm.title = \"Driver Preview\";\n        /** Driver list **/\n        vm.driverList = [];\n        restService.getConverters().then(function (result) {\n            vm.driverList = result;\n        });\n        vm.driver = {\n            configuration: {\n                id: \"\",\n                header: \"\",\n                driverClassName: \"\",\n                fields: {},\n                parameters: {\n                    regex: \"\",\n                    separator: \",\"\n                }\n            },\n            message: \"\"\n        };\n        /** Fields **/\n        function Field(name, number) {\n            this.name = name;\n            this.number = number;\n        }\n        vm.fieldList = [];\n\n        /**------------------------------- METHODS -------------------------------**/\n\n        /** Private function **/\n        function privateFct() {\n        }\n\n        vm.addField = function addField() {\n            vm.fieldList.push(new Field());\n        };\n\n        vm.result = function result() {\n            angular.forEach(vm.fieldList, function (field) {\n                vm.driver.configuration.fields[field.name] = field.number;\n            });\n\n            restService.postConvertersPreview(vm.driver).then(function (result) {\n                angular.forEach(result.data, function(value, key) {\n                    angular.forEach(vm.fieldList, function(field) {\n                        if (field.name === key) {\n                            field.result = value;\n                        }\n                    })\n                })\n            });\n        };\n\n        vm.removeField = function removeField(field) {\n            var index = vm.fieldList.indexOf(field);\n            if (index != -1)\n                vm.fieldList.splice(index, 1);\n        };\n\n        /** Initialization function **/\n        vm.$onInit = function init() {\n            logger.debug('init function');\n        };\n\n        /** Destroy function **/\n        vm.$onDestroy = function () {\n            logger.debug('destroy function');\n        };\n\n    }\n})();\n\n(function () {\n    'use strict';\n\n    /** Generic view component **/\n    angular.module('tsa.tsaViews.EFAum',[]).component('tsaEfAum', {\n        templateUrl: \"app/tsa-views/ef-aum/ef-aum.html\",\n        controllerAs: \"ctrl\",\n        controller: genericController,\n        bindings: {\n            config: '=',\n            cardId: '@',\n            onChangeCardType: '&'\n        }\n    });\n\n    /** Generic view controller */\n    function genericController($log, PEFAUM) {\n        var vm = this;\n        vm.logger = $log.getInstance(\"tsa-ef-aum\");\n\n        /** Initialization function */\n        vm.$onInit = function init() {\n            if (angular.isUndefined(vm.config)\n                || angular.isUndefined(vm.config.deviceId)\n                || angular.isUndefined(vm.config.frameId)) {\n                vm.logger.error('deviceId or/and frameId not defined!');\n                return;\n            }\n\n            vm.deviceId = vm.config.deviceId;\n\n            // properties defined in the front-end configuration file (parameter.json)\n            vm.frameId = vm.config.frameId;\n            vm.PEFAUM = PEFAUM;\n        };\n    }\n})();\n\n(function () {\n    'use strict';\n    angular.module('tsa.tsaViews.EFmap', []).component('tsaEfMap', {\n        templateUrl: \"app/tsa-views/ef-map/ef-map.html\",\n        controllerAs: \"ctrl\",\n        controller: efmapController,\n        bindings: {\n            onChangeCardType: '&',\n            cardId: '@',\n            config: '=',\n            mode: '@'\n        }\n    });\n\n    /** Navigation map controller **/\n    function efmapController($log, $scope, $timeout, $interval, formatterService,\n                         /*  $location, $mdToast, $filter, */ themeService,\n                           statusService, GEOMOD_SERVER_ADDRESS, MAP_BACKGROUND) {\n\n        /**-------------------- PROPERTIES ----------------**/\n        var vm = this;\n//        var mapService = MapServiceProvider.getInstance();\n\n        vm.logger = $log.getInstance(\"map-tsa-view\");\n\n        var intervalPromise;\n\n        //Default settings (overridden by user config)\n        vm.traceEnabled = true;\n        vm.autoCenterEnabled = true;\n        vm.gridEnabled = false;\n        vm.bottomBarEnabled = true;\n        vm.trackingEnabled = false;\n\n        vm.mapComponent = undefined;\n\n        // Change the luminosity propert\n        themeService.subscribe($scope, function (event, theme) {\n            vm.theme = theme;\n            if (vm.mapComponent !== undefined) {\n                // force a reload of the style\n                var luminosity;\n                if ( themeService.getTheme().id === themeService.THEME.NIGHT.id) {\n                    luminosity = geolayer.carto.Luminosity.NIGHT;\n                } else {\n                    luminosity = geolayer.carto.Luminosity.DAY;\n                }\n                vm.mapComponent.setLuminosity(luminosity);\n            }\n        }, true);\n\n        /* Device ID */\n        var shipnavDeviceId;\n        var frameNavId;\n\n        /** Map properties **/\n        vm.mapId = \"map-\" + vm.cardId;\n\n        var background = geolayer.carto.BackgroundProviderType[MAP_BACKGROUND];\n        var shipSymbol = geolayer.carto.OwnShipSymbolType.ZOOM;\n\n        //Ship geometry (by default: length/width of the 'pourquoi pas')\n        var shipLength = 29.6;\n        var shipBeam = 10.6;\n        var shipXOffset = 5;\n        var shipYOffset = 15;\n        var lengthVector = 10;\n\n        /** Properties **/\n        var watchdogInterval;\n\n        //Ship movement\n        vm.latitude = undefined;\n        vm.longitude = undefined;\n        vm.heading = undefined;\n        vm.gndcourse = undefined;\n        vm.gndspeed = undefined;\n        vm.surfspeed = undefined;\n        vm.mousePositionControl = undefined;\n        vm.stringMouseLatitude = \"\";\n        vm.stringMouseLongitude = \"\";\n        vm.position = {};\n        vm.positionStation = {};\n\n        //Measure tools\n        vm.measureToolList = ['Free', 'From boat', 'Disabled'];\n        vm.currentMeasureTool = vm.measureToolList[2];\n\n        /**-------------------------- INITIALIZATION / DESTROY METHODS -------------------------**/\n\n        /* Initialisation method */\n        vm.$onInit = function init() {\n            if (angular.isUndefined(this.config) || angular.isUndefined(this.config.deviceId) || angular.isUndefined(this.config.frameId)) {\n                vm.logger.error('config and/or deviceId and/or frameId not defined!');\n                return;\n            }\n\n            vm.deviceId = this.config.deviceId;\n            frameNavId = this.config.frameId;\n            shipnavDeviceId = this.config.deviceId;\n\n            //Ship geometry (by default: length/width of the 'pourquoi pas')\n\n            console.log(this.config.ship);\n            \n            if (angular.isDefined(this.config.ship)) {\n                if (angular.isDefined(this.config.ship.length)) {\n                    shipLength = this.config.ship.length;\n                }\n                if (angular.isDefined(this.config.ship.beam)) {\n                    shipBeam = this.config.ship.beam;\n                }\n                if (angular.isDefined(this.config.ship.xOffset)) {\n                    shipXOffset = this.config.ship.xOffset;\n                }\n                if (angular.isDefined(this.config.ship.yOffset)) {\n                    shipYOffset = this.config.ship.yOffset;\n                }\n                if (angular.isDefined(this.config.ship.lengthVector)) {\n                    lengthVector = this.config.ship.lengthVector;\n//                    mapService.setLengthVector(lengthVector);\n                }\n            }\n            else {\n                vm.logger.error('ship properties not defined!');\n            }\n\n            loadUserConfig();\n            /** Init function: launch the watchdog to check data reception **/\n//            watchdogInterval = $interval(watchdog, 1000);\n\n//            $timeout(initMap, 500); //initialize the map (wait the element creation)\n        };\n\n        /* Destroy function, called when the view is destroyed: closes the used resources. */\n        vm.$onDestroy = function onDestroy() {\n            if (angular.isDefined(intervalPromise))\n                $interval.cancel(intervalPromise);\n            // mapService.destroyDataListener(shipnavDeviceId, waypointsDeviceId,\n            //     weatherDeviceId, aisDeviceId, mobileDeviceId, lestDeviceId, multibeamId);\n            $interval.cancel(watchdog);\n        };\n\n        /**-------------------- PRIVATE METHODS ----------------**/\n        /** Watch the data reception **/\n        function watchdog() {\n            var currentDate = statusService.getServerTime().time;\n            if (currentDate - mapService.getLastMobileTimestamp() > 60000){\n//                mapService.clearMobileArray();\n            }\n        }\n        /** Refresh the map */\n        function renderMap() {\n\n            //Set position\n            vm.mapComponent.setOwnShipData(vm.position.latitude, vm.position.longitude,\n                vm.position.heading, vm.position.surfspeed, vm.position.gndcourse,\n                vm.position.gndspeed, vm.position.lengthVector);\n\n            //Trace\n//            vm.mapComponent.setOwnShipTrace(mapService.getTraceArray());\n\n            if (vm.mapComponent !== undefined) {\n                vm.mapComponent.render();\n            }\n\n        }\n\n        /** Initialize the map **/\n        function initMap() {\n\n            var options = [];\n            options.serverAddress = GEOMOD_SERVER_ADDRESS;\n            options['OSMNightMode'] = themeService.getTheme().id.toUpperCase();\n            options['map'] = vm.mapId;\n            vm.mapComponent = new geolayer.carto.CartoComponent(options, \"resources/images\"); // Create component\n            vm.mapComponent.showStationView(false);\n            vm.mapComponent.setOwnShipGeometry(shipLength, shipBeam, shipXOffset, shipYOffset);\n            vm.mapComponent.setMarineBackground(background);\n            //addQGISLayers();\n\n            vm.mapComponent.setOwnShipSymbolType(shipSymbol);\n            vm.mapComponent.showSMF(false);\n            vm.mapComponent.showGraticule(vm.gridEnabled);\n            vm.mapComponent.setAutoCenterMode(vm.autoCenterEnabled);\n            vm.mapComponent.setShowRouteMode(false);\n            vm.mapComponent.setShowAISMode(false);\n            vm.mapComponent.setShowTraceMode(vm.traceEnabled);\n            vm.onMeasureToolChange(vm.currentMeasureTool);\n\n            vm.mapComponent.getMap().on(\"pointermove\", function(e) {\n                var coordinate = e.coordinate;\n                //var xy = ol.coordinate.toStringXY(coordinate);\n\n                var lonlat = proj.transform(coordinate,'EPSG:3857', 'EPSG:4326');\n                //Mouse\n                vm.stringMouseLatitude = formatterService.parseLatToString(lonlat[1]);\n                vm.stringMouseLongitude = formatterService.parseLongToString(lonlat[0]);\n            });\n\n            //Set Luminosity\n            var luminosity;\n            if ( themeService.getTheme().id === themeService.THEME.NIGHT.id) {\n                luminosity = geolayer.carto.Luminosity.DUSK;\n            } else {\n                luminosity = geolayer.carto.Luminosity.DAY;\n            }\n            vm.mapComponent.setLuminosity(luminosity);\n\n            // Watches the map element size and calls the 'updateSize()' openlayers\n            var mapElement = document.getElementById(vm.mapId);\n            $scope.$watch(function () {\n                return mapElement.offsetHeight;\n            }, renderMap);\n            $scope.$watch(function () {\n                return mapElement.offsetWidth;\n            }, renderMap);\n\n            // mapService.setMapComponent(vm.mapComponent);\n            // mapService.initDataListener(shipnavDeviceId, frameNavId, waypointsDeviceId,\n            //                             multibeamId, weatherDeviceId,\n            //                             aisDeviceId, frameAisId,\n            //                             mobileDeviceId, lestDeviceId, frameMobileId, trawlingId\n            //                             );\n\n//            vm.position = mapService.getPosition();\n\n            intervalPromise = $interval(renderMap, 1000);\n        }\n\n\n        /** Load user configuration from the 'config' property **/\n        function loadUserConfig() {\n            if (angular.isDefined(vm.config.routeEnabled))\n                vm.routeEnabled = vm.config.routeEnabled;\n            if (angular.isDefined(vm.config.aisEnabled))\n                vm.aisEnabled = vm.config.aisEnabled;\n            if (angular.isDefined(vm.config.traceEnabled))\n                vm.traceEnabled = vm.config.traceEnabled;\n            if (angular.isDefined(vm.config.autoCenterEnabled))\n                vm.autoCenterEnabled = vm.config.autoCenterEnabled;\n            if (angular.isDefined(vm.config.gridEnabled))\n                vm.gridEnabled = vm.config.gridEnabled;\n            if (angular.isDefined(vm.config.multibeamEnabled))\n                vm.multibeamEnabled = vm.config.multibeamEnabled;\n            if (angular.isDefined(vm.config.bottomBarEnabled))\n                vm.bottomBarEnabled = vm.config.bottomBarEnabled;\n            if (angular.isDefined(vm.config.stationViewScale))\n                vm.stationViewScale = vm.config.stationViewScale;\n        }\n\n        /**-------------------- VIEW - MODEL METHODS ----------------**/\n\n        /* Measure tools */\n        vm.onMeasureToolChange = function onMeasureToolChange(selection) {\n            vm.currentMeasureTool = selection;\n            vm.mapComponent.getMeasureTool().setActive(false);\n            vm.mapComponent.getOwnShipMeasureTool().setActive(false);\n            switch (selection) {\n                case 'Free':\n                    vm.mapComponent.getMeasureTool().setActive(true);\n                    break;\n                case 'From boat':\n                    vm.mapComponent.getOwnShipMeasureTool().setActive(true);\n                    break;\n            }\n        };\n        vm.clearMeasures = function clearMeasures() {\n            vm.mapComponent.getMeasureTool().resetTool();\n            vm.mapComponent.getOwnShipMeasureTool().resetTool();\n        };\n\n        vm.focusOnBoat = function focusOnBoat() {\n            vm.mapComponent.setAutoCenterMode(vm.autoCenterEnabled = !vm.autoCenterEnabled);\n            vm.config.autoCenterEnabled = vm.autoCenterEnabled;\n        };\n\n        vm.showTrace = function showTrace() {\n            vm.mapComponent.setShowTraceMode(vm.traceEnabled = !vm.traceEnabled);\n            vm.config.traceEnabled = vm.traceEnabled;\n        };\n\n        vm.showGrid = function showGrid() {\n            vm.mapComponent.showGraticule(vm.gridEnabled = !vm.gridEnabled);\n            vm.config.gridEnabled = vm.gridEnabled;\n        };\n\n        vm.showBottomBar = function showBottomBar() {\n            vm.bottomBarEnabled = !vm.bottomBarEnabled;\n            vm.config.bottomBarEnabled = vm.bottomBarEnabled;\n        };\n\n    }\n\n})();\n\n(function () {\n    'use strict';\n\n    /** Generic view component **/\n    angular.module('tsa.tsaViews.EFMet',[]).component('tsaEfMet', {\n        templateUrl: \"app/tsa-views/ef-met/ef-met.html\",\n        controllerAs: \"ctrl\",\n        controller: genericController,\n        bindings: {\n            config: '=',\n            cardId: '@',\n            onChangeCardType: '&'\n        }\n    });\n\n    /** Generic view controller */\n    function genericController($log, PEFMET) {\n        var vm = this;\n        vm.logger = $log.getInstance(\"tsa-ef-met\");\n\n        /** Initialization function */\n        vm.$onInit = function init() {\n            if (angular.isUndefined(vm.config)\n                || angular.isUndefined(vm.config.deviceId)\n                || angular.isUndefined(vm.config.frameId)) {\n                vm.logger.error('deviceId or/and frameId not defined!');\n                return;\n            }\n\n            vm.deviceId = vm.config.deviceId;\n\n            // properties defined in the front-end configuration file (parameter.json)\n            vm.frameId = vm.config.frameId;\n            vm.PEFMET = PEFMET;\n        };\n    }\n})();\n\n(function () {\n    'use strict';\n\n    /** Generic view component **/\n    angular.module('tsa.tsaViews.EFPos',[]).component('tsaEfPos', {\n        templateUrl: \"app/tsa-views/ef-pos/ef-pos.html\",\n        controllerAs: \"ctrl\",\n        controller: genericController,\n        bindings: {\n            config: '=',\n            cardId: '@',\n            onChangeCardType: '&'\n        }\n    });\n\n    /** Generic view controller */\n    function genericController($log, PEFPOS) {\n        var vm = this;\n        vm.logger = $log.getInstance(\"tsa-ef-pos\");\n\n        /** Initialization function */\n        vm.$onInit = function init() {\n            if (angular.isUndefined(vm.config)\n                || angular.isUndefined(vm.config.deviceId)\n                || angular.isUndefined(vm.config.frameId)) {\n                vm.logger.error('deviceId or/and frameId!');\n                return;\n            }\n\n            vm.deviceId = vm.config.deviceId;\n\n            // properties defined in the front-end configuration file (parameter.json)\n            vm.frameId = vm.config.frameId;\n            vm.PEFPOS = PEFPOS;\n        };\n    }\n})();\n\n(function () {\n    'use strict';\n\n    /** Generic view component **/\n    angular.module('tsa.tsaViews.EFTss',[]).component('tsaEfTss', {\n        templateUrl: \"app/tsa-views/ef-tss/ef-tss.html\",\n        controllerAs: \"ctrl\",\n        controller: genericController,\n        bindings: {\n            config: '=',\n            cardId: '@',\n            onChangeCardType: '&'\n        }\n    });\n\n    /** Generic view controller */\n    function genericController($log, PEFTSS) {\n        var vm = this;\n        vm.logger = $log.getInstance(\"tsa-ef-tss\");\n\n        /** Initialization function */\n        vm.$onInit = function init() {\n            if (angular.isUndefined(vm.config)\n                || angular.isUndefined(vm.config.deviceId)\n                || angular.isUndefined(vm.config.frameId)) {\n                vm.logger.error('deviceId or/and frameId not defined!');\n                return\n            }\n\n            vm.deviceId = vm.config.deviceId;\n\n            // properties defined in the front-end configuration file (parameter.json)\n            vm.frameId = vm.config.frameId;\n            vm.PEFTSS = PEFTSS;\n        };\n    }\n})();\n\n(function () {\n    'use strict';\n\n    /** Component declaration **/\n    angular.module('tsa.tsaViews.ephemeride', []).component('tsaEphemeride', {\n        templateUrl: \"app/tsa-views/ephemeride/ephemeride.html\",\n        controllerAs: \"ctrl\",\n        controller: ephemerideController,\n        bindings: {\n            config: '=',\n            cardId: '@',\n            onChangeCardType: '&'\n        }\n    });\n\n    /** Component controller */\n    function ephemerideController($log, $scope, ephemerideService,\n                                  acquisitionService, NAVIGATION,\n                                  themeService, statusService) {\n\n        /**------------------------------ PROPERTIES -----------------------------**/\n        var vm = this;\n        vm.logger = $log.getInstance(\"tsa-ephemeride\");\n        vm.luminosity = \"day\";\n        vm.offset = 0;\n        vm.times;\n\n        var days = [\"Sunday\", \"Monday\", \"Tuesday\", \"Wednesday\", \"Thursday\", \"Friday\", \"Saturday\"];\n        var months = [\"January\", \"February\", \"March\", \"April\", \"May\", \"June\", \"July\", \"August\", \"September\", \"October\", \"November\", \"December\"];\n\n        /**------------------------------- METHODS -------------------------------**/\n        // Change the luminosity propert\n        themeService.subscribe($scope, function (event, theme) {\n            if ( themeService.getTheme().id === themeService.THEME.NIGHT.id) {\n                    vm.luminosity = \"night\";\n            } else {\n                vm.luminosity = \"day\";\n            }\n        }, true);\n\n        /** Initialization function **/\n        vm.$onInit = function init() {\n\n            if (angular.isUndefined(this.config) || angular.isUndefined(this.config.deviceId) || angular.isUndefined(this.config.frameId)) {\n                vm.logger.error('config and/or deviceId and/or frameId not defined!');\n                return;\n            }\n            vm.deviceId = this.config.deviceId;\n            vm.frameId = this.config.frameId;\n            vm.timeOffset = (statusService.getLocalTimeZoneOffset() ? statusService.getLocalTimeZoneOffset() : \"UTC\");\n            vm.timeLabel = (statusService.getLocalTimeZoneOffset() ? \"\" : \"(UTC)\");\n\n            var shipnavFrameListener = acquisitionService.registerForDevice(vm.deviceId).registerForFrame(NAVIGATION.FRAME_SHIPNAV);\n            shipnavFrameListener.promise.then({}, {}, parseShipnav);\n            function parseShipnav(receivedFrame) {\n                vm.latitude = receivedFrame.value[NAVIGATION.LATITUDE].map(parseFloat);\n                vm.longitude = receivedFrame.value[NAVIGATION.LONGITUDE].map(parseFloat);\n\n                updateDays(vm.offset);\n            }\n\n            vm.nextDay = function nextDay() {\n                vm.offset ++;\n                updateDays(vm.offset);\n            };\n\n            vm.prevDay = function prevDay() {\n                vm.offset --;\n                updateDays(vm.offset);\n            };\n\n            function updateDays(offset) {\n                var ldate = new Date();\n                ldate.setTime(statusService.getServerTime().time ); //Date UTC\n                vm.timeOffset = (statusService.getLocalTimeZoneOffset() ? statusService.getLocalTimeZoneOffset() : \"UTC\");\n                vm.timeLabel = (statusService.getLocalTimeZoneOffset() ? \"\" : \"(UTC)\");\n\n                vm.date = ldate;\n                vm.date.setDate(vm.date.getDate() + offset);\n\n                vm.day = \"date.day.\"+days[vm.date.getDay()];\n                vm.nbDate = vm.date.getDate();\n                vm.month = \"date.month.\"+months[vm.date.getMonth()];\n                vm.year = vm.date.getFullYear();\n\n                var timeOffset = ldate.getTimezoneOffset() / 60;\n\n                vm.saint = ephemerideService.getSaint(vm.date.getDate(), vm.date.getMonth()+1);\n\n                // get sunlight times\n                vm.times = SunCalc.getTimes(vm.date, vm.latitude , vm.longitude);\n\n                vm.moon = SunCalc.getMoonIllumination(/*Date*/ vm.date);\n\n                vm.moonImage = \"new-moon-\" + vm.luminosity + \".png\";\n                if (vm.moon.phase < 1.0/16)\n                    vm.moonImage = \"new-moon-\" + vm.luminosity + \".png\";\n                else if (vm.moon.phase < 3.0/16) //0.18\n                    vm.moonImage = \"waxing-crescent-\" + vm.luminosity + \".png\";\n                else if (vm.moon.phase < 5.0/16) //0.31\n                    vm.moonImage = \"first-quarter-\" + vm.luminosity + \".png\";\n                else if (vm.moon.phase < 7.0/16) //0.43\n                    vm.moonImage = \"waxing-gibbous-\" + vm.luminosity + \".png\";\n                else if (vm.moon.phase < 9.0/16)\n                    vm.moonImage = \"full-moon-\" + vm.luminosity + \".png\";\n                else if (vm.moon.phase < 11.0/16)\n                    vm.moonImage = \"waning-gibbous-\" + vm.luminosity + \".png\";\n                else if (vm.moon.phase < 13.0/16)\n                    vm.moonImage = \"last-quarter-\" + vm.luminosity + \".png\";\n                else if (vm.moon.phase < 15.0/16)\n                    vm.moonImage = \"waning-crescent-\" + vm.luminosity + \".png\";\n            }\n\n        };\n\n\n    }\n})();\n\n(function () {\n    'use strict';\n    angular.module('tsa.tsaViews.ephemeride').factory(\"ephemerideService\", EphemerideService);\n\n    function EphemerideService($log) {\n        var logger = $log.getInstance(\"EphemerideService\");\n\n        var vm = this;\n        \n        var nbJours = 31;\n        var nbMois = 12;\n        vm.ephemeride = new Array();\n        for (var i=1;i<=nbJours;i++)\n            vm.ephemeride[i] = new Array();\n\n        vm.ephemeride[1][1] = 'Jour de l\\'an';\n        vm.ephemeride[1][2] = 'Ste Ella';\n        vm.ephemeride[1][3] = 'St Aubin';\n        vm.ephemeride[1][4] = 'St Hugues';\n        vm.ephemeride[1][5] = 'St Jeremie';\n        vm.ephemeride[1][6] = 'St Justin';\n        vm.ephemeride[1][7] = 'St Thierry';\n        vm.ephemeride[1][8] = 'St Alphonse';\n        vm.ephemeride[1][9] = 'St Gilles';\n        vm.ephemeride[1][10] = 'Ste Thrse';\n        vm.ephemeride[1][11] = 'Toussaint';\n        vm.ephemeride[1][12] = 'Ste Florence';\n        vm.ephemeride[2][1] = 'St Basile';\n        vm.ephemeride[2][2] = 'St Thophane';\n        vm.ephemeride[2][3] = 'St Jaouen';\n        vm.ephemeride[2][4] = 'Ste Sandrine';\n        vm.ephemeride[2][5] = 'St Boris';\n        vm.ephemeride[2][6] = 'Ste Blandine';\n        vm.ephemeride[2][7] = 'St Martinien';\n        vm.ephemeride[2][8] = 'St Julien';\n        vm.ephemeride[2][9] = 'Ste Ingrid';\n        vm.ephemeride[2][10] = 'St Lger';\n        vm.ephemeride[2][11] = 'Dfunts';\n        vm.ephemeride[2][12] = 'Ste Viviane';\n        vm.ephemeride[3][1] = 'Ste Genevive';\n        vm.ephemeride[3][2] = 'St Blaise';\n        vm.ephemeride[3][3] = 'St Gwnola';\n        vm.ephemeride[3][4] = 'St Richard';\n        vm.ephemeride[3][5] = 'St Philippe';\n        vm.ephemeride[3][6] = 'St Kevin';\n        vm.ephemeride[3][7] = 'St Thomas';\n        vm.ephemeride[3][8] = 'Ste Lydie';\n        vm.ephemeride[3][9] = 'St Grgoire';\n        vm.ephemeride[3][10] = 'St Grard';\n        vm.ephemeride[3][11] = 'St Hubert';\n        vm.ephemeride[3][12] = 'St Xavier';\n        vm.ephemeride[4][1] = 'St Odilon';\n        vm.ephemeride[4][2] = 'Ste Vronique';\n        vm.ephemeride[4][3] = 'St Casimir';\n        vm.ephemeride[4][4] = 'St Isidore';\n        vm.ephemeride[4][5] = 'St Sylvain';\n        vm.ephemeride[4][6] = 'Ste Clotilde';\n        vm.ephemeride[4][7] = 'St Florent';\n        vm.ephemeride[4][8] = 'St Jean-Marie';\n        vm.ephemeride[4][9] = 'Ste Rosalie';\n        vm.ephemeride[4][10] = 'St Franois';\n        vm.ephemeride[4][11] = 'St Charles';\n        vm.ephemeride[4][12] = 'Ste Barbara';\n        vm.ephemeride[5][1] = 'St Edouard';\n        vm.ephemeride[5][2] = 'Ste Agathe';\n        vm.ephemeride[5][3] = 'St Olive';\n        vm.ephemeride[5][4] = 'Ste Irne';\n        vm.ephemeride[5][5] = 'Ste Judith';\n        vm.ephemeride[5][6] = 'St Igor';\n        vm.ephemeride[5][7] = 'St Antoine';\n        vm.ephemeride[5][8] = 'St Abel';\n        vm.ephemeride[5][9] = 'Ste Rassa';\n        vm.ephemeride[5][10] = 'Ste Fleur';\n        vm.ephemeride[5][11] = 'Ste Sylvie';\n        vm.ephemeride[5][12] = 'St Grald';\n        vm.ephemeride[6][1] = 'Ste Mlaine';\n        vm.ephemeride[6][2] = 'St Gaston';\n        vm.ephemeride[6][3] = 'Ste Colette';\n        vm.ephemeride[6][4] = 'St Marcellin';\n        vm.ephemeride[6][5] = 'Ste Prudence';\n        vm.ephemeride[6][6] = 'St Norbert';\n        vm.ephemeride[6][7] = 'Ste Mariette';\n        vm.ephemeride[6][8] = 'St Octavien';\n        vm.ephemeride[6][9] = 'St Bertrand';\n        vm.ephemeride[6][10] = 'St Bruno';\n        vm.ephemeride[6][11] = 'Ste Bertille';\n        vm.ephemeride[6][12] = 'St Nicolas';\n        vm.ephemeride[7][1] = 'St Raymond';\n        vm.ephemeride[7][2] = 'Ste Eugnie';\n        vm.ephemeride[7][3] = 'Ste Flicit';\n        vm.ephemeride[7][4] = 'St Jean-Baptiste';\n        vm.ephemeride[7][5] = 'Ste Gisle';\n        vm.ephemeride[7][6] = 'St Gilbert';\n        vm.ephemeride[7][7] = 'St Eliane';\n        vm.ephemeride[7][8] = 'St Gatan';\n        vm.ephemeride[7][9] = 'Ste Reine';\n        vm.ephemeride[7][10] = 'St Serge';\n        vm.ephemeride[7][11] = 'Ste Carine';\n        vm.ephemeride[7][12] = 'St Ambroise';\n        vm.ephemeride[8][1] = 'St Lucien';\n        vm.ephemeride[8][2] = 'Ste Jacqueline';\n        vm.ephemeride[8][3] = 'St Jean de Dieu';\n        vm.ephemeride[8][4] = 'Ste Julie';\n        vm.ephemeride[8][5] = 'St Dsir';\n        vm.ephemeride[8][6] = 'St Mdard';\n        vm.ephemeride[8][7] = 'St Thibaud';\n        vm.ephemeride[8][8] = 'St Dominique';\n        vm.ephemeride[8][9] = 'St Adrien';\n        vm.ephemeride[8][10] = 'Ste Plagie';\n        vm.ephemeride[8][11] = 'St Geoffroy';\n        vm.ephemeride[8][12] = 'Ste Frida';\n        vm.ephemeride[9][1] = 'Ste Alix';\n        vm.ephemeride[9][2] = 'Ste Apolline';\n        vm.ephemeride[9][3] = 'Ste Franoise';\n        vm.ephemeride[9][4] = 'St Gautier';\n        vm.ephemeride[9][5] = 'Ste Pacme';\n        vm.ephemeride[9][6] = 'Ste Diane';\n        vm.ephemeride[9][7] = 'Ste Amandine';\n        vm.ephemeride[9][8] = 'St Amour';\n        vm.ephemeride[9][9] = 'St Alain';\n        vm.ephemeride[9][10] = 'St Denis';\n        vm.ephemeride[9][11] = 'St Thodore';\n        vm.ephemeride[9][12] = 'St Pierre Fourier';\n        vm.ephemeride[10][1] = 'St Guillaume';\n        vm.ephemeride[10][2] = 'St Arnaud';\n        vm.ephemeride[10][3] = 'St Vivien';\n        vm.ephemeride[10][4] = 'St Fulbert';\n        vm.ephemeride[10][5] = 'Ste Solange';\n        vm.ephemeride[10][6] = 'Ste Trinit';\n        vm.ephemeride[10][7] = 'St Ulric';\n        vm.ephemeride[10][8] = 'St Laurent';\n        vm.ephemeride[10][9] = 'Ste Ins';\n        vm.ephemeride[10][10] = 'St Ghislain';\n        vm.ephemeride[10][11] = 'St Lon';\n        vm.ephemeride[10][12] = 'St Romaric';\n        vm.ephemeride[11][1] = 'St Paulin';\n        vm.ephemeride[11][2] = 'ND de Lourdes';\n        vm.ephemeride[11][3] = 'Ste Rosine';\n        vm.ephemeride[11][4] = 'St Stanislas';\n        vm.ephemeride[11][5] = 'Ste Estelle';\n        vm.ephemeride[11][6] = 'St Barnab';\n        vm.ephemeride[11][7] = 'St Benot';\n        vm.ephemeride[11][8] = 'Ste Claire';\n        vm.ephemeride[11][9] = 'St Adelphe';\n        vm.ephemeride[11][10] = 'St Firmin';\n        vm.ephemeride[11][11] = 'St Martin';\n        vm.ephemeride[11][12] = 'St Daniel';\n        vm.ephemeride[12][1] = 'Ste Tatiana';\n        vm.ephemeride[12][2] = 'St Flix';\n        vm.ephemeride[12][3] = 'Ste Justine';\n        vm.ephemeride[12][4] = 'St Jules';\n        vm.ephemeride[12][5] = 'St Achille';\n        vm.ephemeride[12][6] = 'St Guy';\n        vm.ephemeride[12][7] = 'St Olivier';\n        vm.ephemeride[12][8] = 'Ste Clarisse';\n        vm.ephemeride[12][9] = 'St Apollinaire';\n        vm.ephemeride[12][10] = 'St Wilfrid';\n        vm.ephemeride[12][11] = 'St Christian';\n        vm.ephemeride[12][12] = 'Ste Chantal';\n        vm.ephemeride[13][1] = 'Ste Yvette';\n        vm.ephemeride[13][2] = 'Ste Batrice';\n        vm.ephemeride[13][3] = 'St Rodrigue';\n        vm.ephemeride[13][4] = 'Ste Ida';\n        vm.ephemeride[13][5] = 'Ste Rolande';\n        vm.ephemeride[13][6] = 'St Antoine';\n        vm.ephemeride[13][7] = 'St Henri][St Jol';\n        vm.ephemeride[13][8] = 'St Hippolyte';\n        vm.ephemeride[13][9] = 'St Aim';\n        vm.ephemeride[13][10] = 'St Graud';\n        vm.ephemeride[13][11] = 'St Brice';\n        vm.ephemeride[13][12] = 'St Lucie';\n        vm.ephemeride[14][1] = 'Ste Nina';\n        vm.ephemeride[14][2] = 'St Valentin';\n        vm.ephemeride[14][3] = 'Ste Mathilde';\n        vm.ephemeride[14][4] = 'St Maxime';\n        vm.ephemeride[14][5] = 'St Matthias';\n        vm.ephemeride[14][6] = 'St Elise';\n        vm.ephemeride[14][7] = 'St Camille][Fte Nationale';\n        vm.ephemeride[14][8] = 'St Evrard';\n        vm.ephemeride[14][9] = 'St Materne';\n        vm.ephemeride[14][10] = 'St Juste';\n        vm.ephemeride[14][11] = 'St Sidoine';\n        vm.ephemeride[14][12] = 'Ste Odile';\n        vm.ephemeride[15][1] = 'St Rmi';\n        vm.ephemeride[15][2] = 'St Claude';\n        vm.ephemeride[15][3] = 'Ste Louise';\n        vm.ephemeride[15][4] = 'St Paterne';\n        vm.ephemeride[15][5] = 'Ste Denise';\n        vm.ephemeride[15][6] = 'Ste Germaine';\n        vm.ephemeride[15][7] = 'St Donald';\n        vm.ephemeride[15][8] = 'Ste Marie][Assomption';\n        vm.ephemeride[15][9] = 'St Roland';\n        vm.ephemeride[15][10] = 'Ste Thrse';\n        vm.ephemeride[15][11] = 'St Albert';\n        vm.ephemeride[15][12] = 'Ste Ninon';\n        vm.ephemeride[16][1] = 'St Marcel';\n        vm.ephemeride[16][2] = 'Ste Julienne';\n        vm.ephemeride[16][3] = 'Ste Bndicte';\n        vm.ephemeride[16][4] = 'St Benot-Joseph';\n        vm.ephemeride[16][5] = 'St Honor';\n        vm.ephemeride[16][6] = 'St Rgis';\n        vm.ephemeride[16][7] = 'Ste Carmen';\n        vm.ephemeride[16][8] = 'St Armel';\n        vm.ephemeride[16][9] = 'Ste Edith';\n        vm.ephemeride[16][10] = 'Ste Edwige';\n        vm.ephemeride[16][11] = 'Ste Marguerite';\n        vm.ephemeride[16][12] = 'Ste Alice';\n        vm.ephemeride[17][1] = 'Ste Roseline';\n        vm.ephemeride[17][2] = 'St Alexis';\n        vm.ephemeride[17][3] = 'St Patrick';\n        vm.ephemeride[17][4] = 'St Anicet';\n        vm.ephemeride[17][5] = 'St Pascal';\n        vm.ephemeride[17][6] = 'St Herv';\n        vm.ephemeride[17][7] = 'Ste Charlotte';\n        vm.ephemeride[17][8] = 'St Hyacinthe';\n        vm.ephemeride[17][9] = 'St Renaud';\n        vm.ephemeride[17][10] = 'St Baudouin';\n        vm.ephemeride[17][11] = 'Ste Elisabeth';\n        vm.ephemeride[17][12] = 'St Gal';\n        vm.ephemeride[18][1] = 'Ste Prisca';\n        vm.ephemeride[18][2] = 'Ste Bernadette';\n        vm.ephemeride[18][3] = 'St Cyrille';\n        vm.ephemeride[18][4] = 'St Parfait';\n        vm.ephemeride[18][5] = 'St Eric';\n        vm.ephemeride[18][6] = 'St Lonce';\n        vm.ephemeride[18][7] = 'St Frdric';\n        vm.ephemeride[18][8] = 'Ste Hlne';\n        vm.ephemeride[18][9] = 'Ste Nadge';\n        vm.ephemeride[18][10] = 'St Luc';\n        vm.ephemeride[18][11] = 'Ste Aude';\n        vm.ephemeride[18][12] = 'St Gatien';\n        vm.ephemeride[19][1] = 'St Marius';\n        vm.ephemeride[19][2] = 'St Gabin';\n        vm.ephemeride[19][3] = 'St Joseph';\n        vm.ephemeride[19][4] = 'Ste Emma';\n        vm.ephemeride[19][5] = 'St Yves';\n        vm.ephemeride[19][6] = 'St Romuald';\n        vm.ephemeride[19][7] = 'St Arsne';\n        vm.ephemeride[19][8] = 'St Jean-Eudes';\n        vm.ephemeride[19][9] = 'Ste Emilie';\n        vm.ephemeride[19][10] = 'St Ren Goupil';\n        vm.ephemeride[19][11] = 'St Tanguy';\n        vm.ephemeride[19][12] = 'St Urbain';\n        vm.ephemeride[20][1] = 'St Sbastien';\n        vm.ephemeride[20][2] = 'Ste Aime';\n        vm.ephemeride[20][3] = 'St Herbert';\n        vm.ephemeride[20][4] = 'Ste Odette';\n        vm.ephemeride[20][5] = 'St Bernardin';\n        vm.ephemeride[20][6] = 'St Silvre';\n        vm.ephemeride[20][7] = 'Ste Marina';\n        vm.ephemeride[20][8] = 'St Bernard';\n        vm.ephemeride[20][9] = 'St Davy';\n        vm.ephemeride[20][10] = 'Ste Adeline';\n        vm.ephemeride[20][11] = 'St Edmond';\n        vm.ephemeride[20][12] = 'St Thophile';\n        vm.ephemeride[21][1] = 'Ste Agns';\n        vm.ephemeride[21][2] = 'St Damien';\n        vm.ephemeride[21][3] = 'Ste Clmence';\n        vm.ephemeride[21][4] = 'St Anselme';\n        vm.ephemeride[21][5] = 'St Constantin';\n        vm.ephemeride[21][6] = 'St Rodolphe';\n        vm.ephemeride[21][7] = 'St Victor';\n        vm.ephemeride[21][8] = 'St Christophe';\n        vm.ephemeride[21][9] = 'St Matthieu';\n        vm.ephemeride[21][10] = 'Ste Cline';\n        vm.ephemeride[21][11] = 'Prsentation de Marie';\n        vm.ephemeride[21][12] = 'St Pierre Canisius';\n        vm.ephemeride[22][1] = 'St Vincent';\n        vm.ephemeride[22][2] = 'Ste Isabelle';\n        vm.ephemeride[22][3] = 'Ste La';\n        vm.ephemeride[22][4] = 'St Alexandre';\n        vm.ephemeride[22][5] = 'St Emile';\n        vm.ephemeride[22][6] = 'St Alban';\n        vm.ephemeride[22][7] = 'Ste Marie-Madeleine';\n        vm.ephemeride[22][8] = 'St Fabrice';\n        vm.ephemeride[22][9] = 'St Maurice';\n        vm.ephemeride[22][10] = 'Ste Elodie';\n        vm.ephemeride[22][11] = 'Ste Ccile';\n        vm.ephemeride[22][12] = 'Ste Franoise-Xavire';\n        vm.ephemeride[23][1] = 'St Barnard';\n        vm.ephemeride[23][2] = 'St Lazare';\n        vm.ephemeride[23][3] = 'St Victorien';\n        vm.ephemeride[23][4] = 'St Georges';\n        vm.ephemeride[23][5] = 'St Didier';\n        vm.ephemeride[23][6] = 'Ste Audrey';\n        vm.ephemeride[23][7] = 'Ste Brigitte';\n        vm.ephemeride[23][8] = 'Ste Rose';\n        vm.ephemeride[23][9] = 'St Constant';\n        vm.ephemeride[23][10] = 'St Jean de Capistran';\n        vm.ephemeride[23][11] = 'St Clment';\n        vm.ephemeride[23][12] = 'St Armand';\n        vm.ephemeride[24][1] = 'St Franois de Sales';\n        vm.ephemeride[24][2] = 'St Modeste';\n        vm.ephemeride[24][3] = 'Ste Karine';\n        vm.ephemeride[24][4] = 'St Fidle';\n        vm.ephemeride[24][5] = 'St Donatien';\n        vm.ephemeride[24][6] = 'St Yann';\n        vm.ephemeride[24][7] = 'Ste Christine';\n        vm.ephemeride[24][8] = 'St Barthlmy';\n        vm.ephemeride[24][9] = 'Ste Thcle';\n        vm.ephemeride[24][10] = 'St Florentin';\n        vm.ephemeride[24][11] = 'Ste Flora';\n        vm.ephemeride[24][12] = 'Ste Adle';\n        vm.ephemeride[25][1] = 'St Apollos';\n        vm.ephemeride[25][2] = 'St Romo';\n        vm.ephemeride[25][3] = 'Annonciation';\n        vm.ephemeride[25][4] = 'St Marc';\n        vm.ephemeride[25][5] = 'Ste Sophie';\n        vm.ephemeride[25][6] = 'St Prosper';\n        vm.ephemeride[25][7] = 'St Jacques';\n        vm.ephemeride[25][8] = 'St Louis';\n        vm.ephemeride[25][9] = 'St Hermann';\n        vm.ephemeride[25][10] = 'St Crpin';\n        vm.ephemeride[25][11] = 'Ste Catherine';\n        vm.ephemeride[25][12] = 'Nol';\n        vm.ephemeride[26][1] = 'Ste Paule';\n        vm.ephemeride[26][2] = 'St Nestor';\n        vm.ephemeride[26][3] = 'Ste Lara';\n        vm.ephemeride[26][4] = 'Ste Alida';\n        vm.ephemeride[26][5] = 'St Brenger';\n        vm.ephemeride[26][6] = 'St Anthelme';\n        vm.ephemeride[26][7] = 'Ste Anne';\n        vm.ephemeride[26][8] = 'Ste Natacha';\n        vm.ephemeride[26][9] = 'St Cme][St Damien';\n        vm.ephemeride[26][10] = 'St Dimitri';\n        vm.ephemeride[26][11] = 'Ste Delphine';\n        vm.ephemeride[26][12] = 'St Etienne';\n        vm.ephemeride[27][1] = 'Ste Angle';\n        vm.ephemeride[27][2] = 'Ste Honorine';\n        vm.ephemeride[27][3] = 'St Habib';\n        vm.ephemeride[27][4] = 'Ste Zita';\n        vm.ephemeride[27][5] = 'St Augustin';\n        vm.ephemeride[27][6] = 'St Fernand';\n        vm.ephemeride[27][7] = 'Ste Nathalie';\n        vm.ephemeride[27][8] = 'Ste Monique';\n        vm.ephemeride[27][9] = 'St Vincent de Paul';\n        vm.ephemeride[27][10] = 'Ste Emeline';\n        vm.ephemeride[27][11] = 'St Sverin';\n        vm.ephemeride[27][12] = 'St Jean';\n        vm.ephemeride[28][1] = 'St Thomas d\\'Aquin';\n        vm.ephemeride[28][2] = 'St Romain';\n        vm.ephemeride[28][3] = 'St Gontran';\n        vm.ephemeride[28][4] = 'Ste Valrie';\n        vm.ephemeride[28][5] = 'St Germain';\n        vm.ephemeride[28][6] = 'St Irne';\n        vm.ephemeride[28][7] = 'St Samson';\n        vm.ephemeride[28][8] = 'St Augustin';\n        vm.ephemeride[28][9] = 'St Venceslas';\n        vm.ephemeride[28][10] = 'St Simon';\n        vm.ephemeride[28][11] = 'St Jacques de la Marche';\n        vm.ephemeride[28][12] = 'St Gaspard';\n        vm.ephemeride[29][1] = 'St Gildas';\n        vm.ephemeride[29][2] = 'St Auguste';\n        vm.ephemeride[29][3] = 'Ste Gwladys';\n        vm.ephemeride[29][4] = 'Ste Catherine';\n        vm.ephemeride[29][5] = 'St Aymard';\n        vm.ephemeride[29][6] = 'St Pierre][St Paul';\n        vm.ephemeride[29][7] = 'Ste Marthe';\n        vm.ephemeride[29][8] = 'Ste Sabine';\n        vm.ephemeride[29][9] = 'Sts Michel';\n        vm.ephemeride[29][10] = 'St Narcisse';\n        vm.ephemeride[29][11] = 'St Saturnin';\n        vm.ephemeride[29][12] = 'St David';\n        vm.ephemeride[30][1] = 'Ste Martine';\n        vm.ephemeride[30][3] = 'St Amde';\n        vm.ephemeride[30][4] = 'St Robert';\n        vm.ephemeride[30][5] = 'St Ferdinand';\n        vm.ephemeride[30][6] = 'St Martial';\n        vm.ephemeride[30][7] = 'Ste Juliette';\n        vm.ephemeride[30][8] = 'St Fiacre';\n        vm.ephemeride[30][9] = 'St Jrme';\n        vm.ephemeride[30][10] = 'Ste Bienvenue';\n        vm.ephemeride[30][11] = 'St Andr';\n        vm.ephemeride[30][12] = 'St Roger';\n        vm.ephemeride[31][1] = 'Ste Marcelle';\n        vm.ephemeride[31][3] = 'St Benjamin';\n        vm.ephemeride[31][5] = 'Ste Perrette';\n        vm.ephemeride[31][7] = 'St Ignace';\n        vm.ephemeride[31][8] = 'St Aristide';\n        vm.ephemeride[31][10] = 'St Quentin';\n        vm.ephemeride[31][12] = 'St Sylvestre';\n\n        return {\n            getSaint: function getSaint(day, month) {\n                return vm.ephemeride[day][month];\n            }\n        }\n    }\n}());\n\n(function () {\n    'use strict';\n\n    /** FerryboxFluo component declaration **/\n    (function () {\n        'use strict';\n        angular.module('tsa.tsaViews.ferryboxFluo', []).component('tsaFerryboxFluo', {\n            templateUrl: \"app/tsa-views/ferryboxFluo/ferryboxFluo.html\",\n            controllerAs: \"ctrl\",\n            controller: ferryboxFluoController,\n            bindings: {\n                config: '=',\n                cardId: '@',\n                onChangeCardType: '&'\n            }\n        });\n    })();\n\n    /** FerryboxFluo controller */\n    function ferryboxFluoController($timeout, $interval, $log, $scope, acquisitionService, graphUtils, statusService, themeService, FERRYBOX_SCIENCE) {\n        var vm = this;\n        vm.logger = $log.getInstance(\"ferryboxFluo-tsa-view\");\n\n        /**------------------------------ PROPERTIES -------------------------------**/\n\n        vm.canvasId = \"canvas-ferryboxFluo-\" + vm.cardId;\n        var intervalPromise;\n        var timeoutPromise;\n        vm.bufferLoading = {};\n\n        vm.FERRYBOX_SCIENCE = FERRYBOX_SCIENCE;\n        vm.dataList = [\n            { id: FERRYBOX_SCIENCE.AOA_GREEN_ALGAE, cssClass: 'green-algae', color: 'rgb(139, 195, 74)', showInChart: true },\n            { id: FERRYBOX_SCIENCE.AOA_BLUE_ALGAE, cssClass: 'blue-algae', color: 'rgb(26, 117, 174)', showInChart: true },\n            { id: FERRYBOX_SCIENCE.AOA_DIATOMS, cssClass: 'diatoms', color: 'rgb(255, 171, 0)', showInChart: true },\n            { id: FERRYBOX_SCIENCE.AOA_CRYPTOPHYTA, cssClass: 'cryptophyta', color: 'rgb(213, 0, 0)', showInChart: true },\n            { id: FERRYBOX_SCIENCE.AOA_YELLOW_SUB, cssClass: 'yellow-sub', color: 'rgb(27, 94, 32)', showInChart: true },\n            { id: FERRYBOX_SCIENCE.AOA_TOTAL_ALGAE, cssClass: 'total-algae', color: 'rgb(117, 117, 117)', showInChart: true }];\n\n        /**  Time scales **/\n        vm.scales = graphUtils.scales;\n        vm.selectedScale = '1 min';\n\n        /** Chart properties **/\n        var chart = undefined;\n        var chartData = {\n            datasets: []\n        };\n\n        /**-------------------------- INITIALIZATION / DESTROY METHODS -------------------------**/\n\n        /** Initialization function **/\n        vm.$onInit = function init() {\n            if (angular.isUndefined(this.config) || angular.isUndefined(this.config.deviceId) || angular.isUndefined(this.config.frameId)) {\n                vm.logger.error('config and/or deviceId and/or frameId not defined!');\n                return;\n            }\n\n            vm.deviceId = this.config.deviceId;\n            vm.frameId = this.config.frameId;\n\n            vm.device = acquisitionService.registerForDevice(vm.deviceId);\n\n            angular.forEach(vm.dataList, function (data) {\n                vm.device.recordData(vm.frameId, data.id);\n                chartData.datasets.push({\n                    xAxisID: \"x-axis-1\",\n                    yAxisID: \"y-axis-1\",\n                    borderColor: data.color,\n                    backgroundColor: 'rgba(26, 117, 174, 0.3)',\n                    data: []\n                });\n            });\n\n            //Wait the canvas creation, and then create the chart\n            timeoutPromise = $timeout(initTimer, 200);\n\n            // Change gridLinesColor of Graph on every change of service variable\n            themeService.subscribe($scope, function(event, theme) {\n            \tvm.theme = theme; \n            \treloadChart();\n            });\n\n            if (angular.isDefined(vm.config.scale))\n                vm.selectedScale = vm.config.scale;\n        };\n\n        /** Destroy function **/\n        vm.$onDestroy = function () {\n            angular.forEach(vm.dataList, function (data) {\n                vm.device.stopRecordData(vm.frameId, data.id);\n            });\n            $timeout.cancel(timeoutPromise);\n            if (intervalPromise !== undefined)\n                $interval.cancel(intervalPromise);\n        };\n\n        /**------------------------------ METHODS -------------------------------**/\n\n        /** Generate the chart options */\n        function getChartOptions() {\n            var chartOptions = graphUtils.getChartOptions(vm.scales[vm.selectedScale].stepSize);\n            chartOptions.scales.yAxes = [{\n                id: \"y-axis-1\",\n                gridLines: { color: vm.theme.gridLinesColor }\n            }];\n            return chartOptions;\n        };\n\n        /** Redraw the chart **/\n        function reloadChart() {\n            if (chart !== undefined)\n                chart.destroy();\n            var canvas = document.getElementById(vm.canvasId);\n            if (canvas) {\n                chart = Chart.Scatter(canvas, { data: chartData, options: getChartOptions() });\n                updateGraph();\n            }\n            vm.config.scale = vm.selectedScale;\n        }\n\n        /** Start or update the timer (intervalPromise) */\n        var initTimer = function initTimer() {\n            if (intervalPromise !== undefined)\n                $interval.cancel(intervalPromise);\n\n            //Load archived data\n            angular.forEach(vm.dataList, function (data) {\n                if (angular.isDefined(vm.device.getData(vm.frameId, data.id))) {\n                    var bufferId = vm.scales[vm.selectedScale].bufferId;\n                    vm.bufferLoading[vm.selectedScale] = vm.bufferLoading[vm.selectedScale] ? ++vm.bufferLoading[vm.selectedScale] : 1;\n                    var selectedScale = vm.selectedScale;\n\n                    var requestCallback = function () {\n                        vm.bufferLoading[selectedScale]--;\n                        if (chart !== undefined)\n                            updateGraph();\n                    }\n                    vm.device.getData(vm.frameId, data.id).buffers[bufferId].loadArchivedFrames().then(requestCallback, requestCallback);\n                }\n            });\n\n            reloadChart();\n            intervalPromise = $interval(updateGraph, vm.scales[vm.selectedScale].scale / 1000);\n        };\n\n        /** Update the graph with the recorded data (called by the timer (intervalPromise)) */\n        function updateGraph() {\n            //Step 1: update X axis\n            var currentDate = statusService.getServerTime().time;\n            chart.options.scales.xAxes[0].ticks.min = (currentDate - vm.scales[vm.selectedScale].scale);\n            chart.options.scales.xAxes[0].ticks.max = currentDate;\n\n            //Step 2: update data\n            var bufferId = vm.scales[vm.selectedScale].bufferId;\n            var i = 0;\n            angular.forEach(vm.dataList, function (data) {\n                chartData.datasets[i].data = [];\n                if (data.showInChart) {\n                    var recordedData = vm.device.getData(vm.frameId, data.id);\n                    if (recordedData !== undefined)\n                        angular.forEach(recordedData.buffers[bufferId].frames, function (frame) {\n                            chartData.datasets[i].data.push({ x: frame.timestamp, y: frame.value });\n                        });\n                }\n                i++;\n            });\n\n            chart.update();\n        };\n\n        /** Called when a new X scale is selected */\n        vm.onChangeXScale = initTimer;\n\n        /** Called when a checkbox is checked */\n        vm.showInChart = function showInChart(data){\n            data.showInChart = !data.showInChart;\n            updateGraph();\n        }\n\n    }\n})();\n\n(function () {\n    'use strict';\n\n    /** Component declaration **/\n    angular.module('tsa.tsaViews.ferryboxScience', []).component('tsaFerryboxScience', {\n        templateUrl: \"app/tsa-views/ferryboxScience/ferryboxScience.html\",\n        controllerAs: \"ctrl\",\n        controller: ferryboxScienceController,\n        bindings: {\n            config: '=',\n            cardId: '@',\n            onChangeCardType: '&'\n        }\n    });\n\n    /** Component controller */\n    function ferryboxScienceController($log, FERRYBOX_SCIENCE, acquisitionService) {\n\n        /**------------------------------ PROPERTIES -----------------------------**/\n        var vm = this;\n\n        /**------------------------------- METHODS -------------------------------**/\n\n        /** Initialization function **/\n        vm.$onInit = function init() {\n            if (angular.isUndefined(this.config) || angular.isUndefined(this.config.deviceId) || angular.isUndefined(this.config.frameId)) {\n                vm.logger.error('config and/or deviceId and/or frameId not defined!');\n                return;\n            }\n\n            vm.deviceId = this.config.deviceId;\n            vm.frameId = this.config.frameId;\n            vm.FERRYBOX_SCIENCE = FERRYBOX_SCIENCE;\n        };\n    }\n})();\n\n(function () {\n    'use strict';\n\n    /** Component declaration **/\n    angular.module('tsa.tsaViews.ferryboxTechnic', []).component('tsaFerryboxTechnic', {\n        templateUrl: \"app/tsa-views/ferryboxTechnic/ferryboxTechnic.html\",\n        controllerAs: \"ctrl\",\n        controller: ferryboxTechnicController,\n        bindings: {\n            config: '=',\n            cardId: '@',\n            onChangeCardType: '&'\n        }\n    });\n\n    /** Component controller */\n    function ferryboxTechnicController($log, FERRYBOX_SCIENCE, FERRYBOX_TECHNIC, acquisitionService) {\n\n        /**------------------------------ PROPERTIES -----------------------------**/\n        var vm = this;\n\n        /**------------------------------- METHODS -------------------------------**/\n\n        /** Initialization function **/\n        vm.$onInit = function init() {\n            if (angular.isUndefined(this.config) || angular.isUndefined(this.config.deviceId) || angular.isUndefined(this.config.frameId)) {\n                vm.logger.error('config and/or deviceId and/or frameId not defined!');\n                return;\n            }\n\n            vm.deviceId = this.config.deviceId;\n            vm.frameId = this.config.frameId;\n            vm.FERRYBOX_TECHNIC = FERRYBOX_TECHNIC;\n            vm.FERRYBOX_SCIENCE = FERRYBOX_SCIENCE;\n        };\n\n    }\n})();\n\n(function () {\n    'use strict';\n\n    /** Funes winch component declaration **/\n    (function () {\n        'use strict';\n        angular.module('tsa.tsaViews.funesWinch', []).component('tsaFunesWinch', {\n            templateUrl: \"app/tsa-views/funesWinch/funesWinch.html\",\n            controllerAs: \"ctrl\",\n            controller: funesWinchController,\n            bindings: {\n                config: '=',\n                cardId: '@',\n                onChangeCardType: '&'\n            }\n        });\n    })();\n\n    /** Funes winch controller */\n    function funesWinchController($timeout, $interval, $log, $scope, acquisitionService, FUNES_WINCH, graphUtils, statusService, themeService) {\n        var vm = this;\n        vm.logger = $log.getInstance(\"funes-winch-tsa-view\");\n\n        /**------------------------------ PROPERTIES -------------------------------**/\n        vm.canvasId1 = \"canvas-winch-1-\" + vm.cardId;\n        vm.canvasId2 = \"canvas-winch-2-\" + vm.cardId;\n        var intervalPromise;\n        var timeoutPromise;\n\n        /**  Time scales **/\n        vm.scales = graphUtils.scales;\n        vm.selectedScale = '1 min';\n        vm.bufferLoading = {};\n\n        /** Chart properties **/\n        var chart1 = undefined;\n        var chartData1 = {\n            datasets: [{\n                label: \"Data 1\",\n                xAxisID: \"x-axis-1\",\n                yAxisID: \"y-axis-1\",\n                borderColor: '#4CAF50',\n                data: []\n            }]\n        };\n        var chart2 = undefined;\n        var chartData2 = {\n            datasets: [{\n                label: \"Data 1\",\n                xAxisID: \"x-axis-1\",\n                yAxisID: \"y-axis-1\",\n                borderColor: '#F44336',\n                data: []\n            }]\n        };\n\n        /**-------------------------- INITIALIZATION / DESTROY METHODS -------------------------**/\n\n        /** Initialization function **/\n        vm.$onInit = function init() {\n            if (angular.isUndefined(this.config) || angular.isUndefined(this.config.deviceId) || angular.isUndefined(this.config.frameId)) {\n                vm.logger.error('config and/or deviceId and/or frameId not defined!');\n                return;\n            }\n\n            vm.deviceId = this.config.deviceId;\n            vm.frameId = this.config.frameId;\n\n            vm.starboardLength = FUNES_WINCH.STARBOARD_LENGTH;\n            vm.starboardSpeed = FUNES_WINCH.STARBOARD_SPEED;\n            vm.starboardTension = FUNES_WINCH.STARBOARD_TENSION;\n\n            vm.portLength = FUNES_WINCH.PORT_LENGTH;\n            vm.portSpeed = FUNES_WINCH.PORT_SPEED;\n            vm.portTension = FUNES_WINCH.PORT_TENSION;\n\n            vm.device = acquisitionService.registerForDevice(vm.deviceId);\n            vm.device.recordData(vm.frameId, vm.starboardTension);\n            vm.device.recordData(vm.frameId, vm.portTension);\n\n            //Wait the canvas creation, and then create the chart\n            timeoutPromise = $timeout(initTimer, 200);\n\n            // Change gridLinesColor of Graph on every change of service variable\n            themeService.subscribe($scope, function(event, theme) {\n            \tvm.theme = theme;\n            \treloadChart();\n            });\n\n            if (angular.isDefined(vm.config.scale))\n                vm.selectedScale = vm.config.scale;\n        };\n\n        /** Destroy function **/\n        vm.$onDestroy = function () {\n            vm.device.stopRecordData(vm.frameId, vm.starboardTension);\n            vm.device.stopRecordData(vm.frameId, vm.portTension);\n            $timeout.cancel(timeoutPromise);\n            if (intervalPromise !== undefined)\n                $interval.cancel(intervalPromise);\n        };\n\n        /**------------------------------ METHODS -------------------------------**/\n\n        /** Generate the chart options */\n        function getChartOptions() {\n            var chartOptions = graphUtils.getChartOptions(vm.scales[vm.selectedScale].stepSize);\n            chartOptions.scales.yAxes = [{\n                id: \"y-axis-1\",\n                gridLines: { color: vm.theme.gridLinesColor },\n                ticks: { beginAtZero: true, min: 0, suggestedMax: 10 }\n            }];\n            return chartOptions;\n        };\n\n        /** Redraw the chart **/\n        function reloadChart() {\n            if (chart1 !== undefined)\n                chart1.destroy();\n            if (chart2 !== undefined)\n                chart2.destroy();\n\n            var canvas1 = document.getElementById(vm.canvasId1);\n            var canvas2 = document.getElementById(vm.canvasId2);\n            if (canvas1) {\n                chart1 = Chart.Scatter(canvas1, { data: chartData1, options: getChartOptions() });\n                chart2 = Chart.Scatter(canvas2, { data: chartData2, options: getChartOptions() });\n                updateGraph();\n            }\n            vm.config.scale= vm.selectedScale;\n        }\n\n        /** Start or update the timer (intervalPromise) */\n        var initTimer = function initTimer() {\n            if (intervalPromise !== undefined)\n                $interval.cancel(intervalPromise);\n\n            //Load archived data\n            if (angular.isDefined(vm.device)\n                && angular.isDefined(vm.device.getData(vm.frameId, vm.starboardTension))\n                && angular.isDefined(vm.device.getData(vm.frameId, vm.portTension))) {\n                var bufferId = vm.scales[vm.selectedScale].bufferId;\n                vm.bufferLoading[vm.selectedScale] = vm.bufferLoading[vm.selectedScale] ? vm.bufferLoading[vm.selectedScale] += 2 : 2;\n                var selectedScale = vm.selectedScale;\n\n                var requestCallback = function () {  //Callback called when the request is ended\n                    vm.bufferLoading[selectedScale]--;\n                    if (chart1 !== undefined && chart2 !== undefined)\n                        updateGraph();\n                }\n\n                vm.device.getData(vm.frameId, vm.starboardTension).buffers[bufferId].loadArchivedFrames().then(requestCallback, requestCallback);\n                vm.device.getData(vm.frameId, vm.portTension).buffers[bufferId].loadArchivedFrames().then(requestCallback, requestCallback);\n            }\n\n            // (Re)Load the chart and launch a new timer\n            reloadChart();\n            intervalPromise = $interval(updateGraph, vm.scales[vm.selectedScale].scale / 1000);\n        };\n\n        /** Update the graph with the recorded data (called by the timer (intervalPromise)) */\n        function updateGraph() {\n            //Step 1: update X axis\n            var currentDate = statusService.getServerTime().time;\n            chart1.options.scales.xAxes[0].ticks.min = (currentDate - vm.scales[vm.selectedScale].scale);\n            chart1.options.scales.xAxes[0].ticks.max = currentDate;\n            chart2.options.scales.xAxes[0].ticks.min = (currentDate - vm.scales[vm.selectedScale].scale);\n            chart2.options.scales.xAxes[0].ticks.max = currentDate;\n\n            //Step 2: update data\n            var bufferId = vm.scales[vm.selectedScale].bufferId;\n            chartData1.datasets[0].data = [];\n            var recordedData1 = vm.device.getData(vm.frameId, vm.starboardTension);\n            if (recordedData1 !== undefined) {\n                angular.forEach(recordedData1.buffers[bufferId].frames, function (frame) {\n                    chartData1.datasets[0].data.push({ x: frame.timestamp, y: frame.value });\n                });\n            }\n            chart1.update();\n\n            chartData2.datasets[0].data = [];\n            var recordedData2 = vm.device.getData(vm.frameId, vm.portTension);\n            if (recordedData2 !== undefined) {\n                angular.forEach(recordedData2.buffers[bufferId].frames, function (frame) {\n                    chartData2.datasets[0].data.push({ x: frame.timestamp, y: frame.value });\n                });\n            }\n            chart2.update();\n        };\n\n        /** Called when a new X scale is selected */\n        vm.onChangeXScale = initTimer;\n\n    }\n})();\n\n(function () {\n    'use strict';\n\n    /** Generic view component **/\n    angular.module('tsa.tsaViews.flow',[]).component('tsaFlow', {\n        templateUrl: \"app/tsa-views/flow/flow.html\",\n        controllerAs: \"ctrl\",\n        controller: genericController,\n        bindings: {\n            config: '=',\n            cardId: '@',\n            onChangeCardType: '&'\n        }\n    });\n\n    /** Generic view controller */\n    function genericController($log, FLOW) {\n        var vm = this;\n        vm.logger = $log.getInstance(\"tsa-flow\");\n\n        /** Initialization function */\n        vm.$onInit = function init() {\n            if (angular.isUndefined(vm.config)\n                || angular.isUndefined(vm.config.deviceId)\n                || angular.isUndefined(vm.config.frameId)) {\n                vm.logger.error('deviceId or/and frameId or/and flowDeviceId not defined!');\n                return;\n            }\n\n            vm.deviceId = vm.config.deviceId;\n\n            // properties defined in the front-end configuration file (parameter.json)\n            vm.frameId = vm.config.frameId;\n            vm.FLOW = FLOW;\n        };\n    }\n})();\n\n(function () {\n    'use strict';\n\n    /** Generic view component **/\n    angular.module('tsa.tsaViews.generic',[]).component('tsaGeneric', {\n        templateUrl: \"app/tsa-views/generic/generic.html\",\n        controllerAs: \"ctrl\",\n        controller: genericController,\n        bindings: {\n            config: '=',\n            cardId: '@',\n            onChangeCardType: '&'\n        }\n    });\n\n    /** Generic view controller */\n    function genericController() {\n        var vm = this;\n\n        /** Initialization function */\n        vm.$onInit = function init() {\n            console.debug('[genericController] $onInit: deviceId = ' + this.config.title);\n            vm.config = this.config;\n        };\n    }\n})();\n\n(function () {\n    'use strict';\n\n    /** Component declaration **/\n    angular.module('tsa.tsaViews.gps', []).component('tsaGps', {\n        templateUrl: \"app/tsa-views/gps/gps.html\",\n        controllerAs: \"ctrl\",\n        controller: gpsController,\n        bindings: {\n            config: '=',\n            cardId: '@',\n            onChangeCardType: '&'\n        }\n    });\n\n    /** Component controller */\n    function gpsController($log, GPS) {\n\n        /**------------------------------ PROPERTIES -----------------------------**/\n        var vm = this;\n        vm.logger = $log.getInstance(\"GPS-tsa-view\");\n\n        /**------------------------------- METHODS -------------------------------**/\n\n        /** Initialization function **/\n        vm.$onInit = function init() {\n            if (angular.isUndefined(this.config) || angular.isUndefined(this.config.deviceId) || angular.isUndefined(this.config.frameId)) {\n                vm.logger.error('config and/or deviceId and/or frameId not defined!');\n                return;\n            }\n\n            vm.deviceId = this.config.deviceId;\n            vm.framePosition = this.config.frameId;\n\n            //vm.framePosition = GPS.FRAME_POSITION;\n            vm.latitude = GPS.LATITUDE;\n            vm.longitude = GPS.LONGITUDE;\n            vm.groundSpeed = GPS.GROUND_SPEED;\n            vm.groundCourse = GPS.GROUND_COURSE;\n\n            vm.frameSatInfo = GPS.FRAME_SAT_INFO;\n            vm.satNumber = GPS.SATELLITE_NUMBER;\n            vm.hdop = GPS.HDOP;\n        };\n    }\n})();\n\n(function () {\n    'use strict';\n    angular.module('tsa.tsaViews.graphics', ['tsa.services.filters']).component('tsaGraphics', {\n        templateUrl: \"app/tsa-views/graphics/graphics.html\",\n        controller: graphicsController,\n        controllerAs: \"ctrl\",\n        bindings: {\n            cardId: '@',\n            config: '=',\n            onChangeCardType: '&'\n        }\n    });\n\n    /** Graphics controller **/\n    function graphicsController(themeService, graphUtils, statusService, acquisitionService, $interval, $scope, $timeout) {\n        var vm = this;\n        vm.theme = themeService.getTheme();\n        var yAxes1Min = -1, yAxes2Min = -1, yAxes1Max = 1, yAxes2Max = 1;\n\n        /** Canvas Id **/\n        vm.canvasId = \"canvas-\" + vm.cardId;\n\n        /** Data colors **/\n        vm.dataColor1 = 'rgb(26, 117, 174)';\n        vm.dataColor1bis = 'rgba(26, 117, 174, 0.3)';\n        vm.dataColor2 = 'rgb(255, 136, 56)';\n        vm.dataColor2bis = 'rgba(255, 136, 56,0.3)';\n\n        /**  Time scales **/\n        vm.scales = graphUtils.scales;\n        vm.selectedScale = '1 min';\n\n        vm.YScaleModes = {\n            AUTO: 'views.graphics.auto',\n            MANUAL: 'views.graphics.manual'\n        };\n        vm.selectedYScaleMode = vm.YScaleModes.AUTO;\n        vm.zeroOption = false;\n\n        /** Device lists **/\n        vm.deviceList = {};\n\n        /** view- model properties **/\n        vm.doubleYAxes = true;\n        vm.fill = false;\n        vm.showSettings = false;\n        vm.dataLoaders = 0;\n\n        /** Device 1 **/\n        var device1 = undefined;\n        vm.deviceId1 = undefined;\n        vm.frameList1 = {};\n        vm.frameDataId1 = undefined;\n        vm.frameId1 = undefined;\n        vm.dataId1 = undefined;\n        vm.chartTitle1 = \"\";\n        var dataLegend1;\n\n        /** Device 2 **/\n        var device2 = undefined;\n        vm.deviceId2 = undefined;\n        vm.frameList2 = {};\n        vm.frameDataId2 = undefined;\n        vm.frameId2 = undefined;\n        vm.dataId2 = undefined;\n        vm.chartTitle2 = \"\";\n        var dataLegend2;\n\n        /** Chart properties **/\n        var chart = undefined;\n        var chartData = new ChartDataset();\n\n        var intervalPromise = undefined;\n        var timeoutPromise = undefined;\n\n        /**-------------------------- INITIALIZATION / DESTROY METHODS -------------------------**/\n\n        /** Initialization function **/\n        vm.$onInit = function init() {\n            vm.deviceList = acquisitionService.getDeviceList();\n\n            timeoutPromise = $timeout(initTimer, 500); //Wait the canvas creation, and then create the chart\n\n            //Change gridLinesColor of Graph on every change of service variable\n            themeService.subscribe($scope, function(event, theme) {\n            \tvm.theme = theme;\n            \treloadChart();\n            });\n\n            loadUserConfig();\n        };\n\n        /** Destroy function **/\n        vm.$onDestroy = function () {\n            // Stop the record\n            if (device1 !== undefined && vm.frameId1 !== undefined && vm.dataId1 !== undefined)\n                device1.stopRecordData(vm.frameId1, vm.dataId1);\n            if (device2 !== undefined && vm.frameId2 !== undefined && vm.dataId2 !== undefined)\n                device2.stopRecordData(vm.frameId2, vm.dataId2);\n\n            $timeout.cancel(timeoutPromise);\n            if (intervalPromise !== undefined)\n                $interval.cancel(intervalPromise);\n        };\n\n        /** -------------------  PRIVATE METHODS -------------------- */\n\n        /** Generate a new chart dataset */\n        function ChartDataset() {\n            this.datasets = [{\n                label: \"Data 1\",\n                xAxisID: \"x-axis-1\",\n                yAxisID: \"y-axis-1\",\n                borderColor: vm.dataColor1,\n                backgroundColor: vm.dataColor1bis,\n                data: []\n            }, {\n                label: \"Data 2\",\n                xAxisID: \"x-axis-1\",\n                yAxisID: (vm.frameDataId1 !== undefined && vm.frameDataId2 !== undefined && vm.doubleYAxes) ? \"y-axis-2\" : \"y-axis-1\",\n                borderColor: vm.dataColor2,\n                backgroundColor: vm.dataColor2bis,\n                pointRadius: 0,\n                data: []\n            }];\n        }\n\n        /** Generate the chart options */\n        function getChartOptions() {\n            var doubleAxesEnabled = (vm.frameDataId1 === undefined || vm.frameDataId2 === undefined) ? false : vm.doubleYAxes;\n            var data1 = (vm.frameList1 !== undefined && vm.frameList1[vm.frameId1] !== undefined) ? vm.frameList1[vm.frameId1][vm.dataId1] : undefined;\n            var data2 = (vm.frameList2 !== undefined && vm.frameList2[vm.frameId2] !== undefined) ? vm.frameList2[vm.frameId2][vm.dataId2] : undefined;\n            if (angular.isDefined(data1))\n                dataLegend1 = data1.longName + (data1.units ? ' (' + data1.units + ')' : '');\n            if (angular.isDefined(data2))\n                dataLegend2 = data2.longName + (data2.units ? ' (' + data2.units + ')' : '');\n\n            var chartOptions = graphUtils.getChartOptions(vm.scales[vm.selectedScale].stepSize, vm.fill);\n            chartOptions.scales.yAxes = [\n                {\n                    id: \"y-axis-1\",\n                    position: \"left\",\n                    scaleLabel: {\n                        display: doubleAxesEnabled,\n                        fontColor: vm.dataColor1,\n                        labelString: dataLegend1 ? dataLegend1 : 'data 1'\n                    },\n                    gridLines: { color: vm.theme.gridLinesColor },\n                    ticks: {\n                        beginAtZero: vm.zeroOption,\n                        min: vm.selectedYScaleMode == vm.YScaleModes.MANUAL ? yAxes1Min : undefined,\n                        max: vm.selectedYScaleMode == vm.YScaleModes.MANUAL ? yAxes1Max : undefined\n                    }\n                },\n                {\n                    id: \"y-axis-2\",\n                    position: \"right\",\n                    display: doubleAxesEnabled,\n                    reverse: true,\n                    scaleLabel: {\n                        display: true,\n                        fontColor: vm.dataColor2,\n                        labelString: dataLegend2 ? dataLegend2 : 'data 2'\n                    },\n                    gridLines: { drawOnChartArea: false },// only want the grid lines for one axis to show up\n                    ticks: {\n                        beginAtZero: vm.zeroOption,\n                        min: vm.selectedYScaleMode == vm.YScaleModes.MANUAL ? yAxes2Min : undefined,\n                        max: vm.selectedYScaleMode == vm.YScaleModes.MANUAL ? yAxes2Max : undefined\n                    }\n                }];\n            return chartOptions;\n        }\n\n        /** Redraw the chart */\n        function reloadChart() {\n            if (chart !== undefined)\n                chart.destroy();\n\n            var canvas = document.getElementById(vm.canvasId);\n            if (canvas) {\n                chartData = new ChartDataset();\n                chart = Chart.Scatter(canvas, { data: chartData, options: getChartOptions() });\n                updateGraph();\n                saveUserConfig();\n            }\n        }\n\n\n        /** Load archived data */\n        function loadArchivedData() {\n            var bufferId = vm.scales[vm.selectedScale].bufferId;\n\n            function loadArchivedDataEnd() { // Called when the archived request are finished\n                vm.dataLoaders--;\n                if (chart !== undefined)\n                    updateGraph();\n            }\n\n            if (device1 !== undefined && vm.frameId1 !== undefined && vm.dataId1 !== undefined) {\n                var recordedData1 = device1.getData(vm.frameId1, vm.dataId1);\n                if (recordedData1 !== undefined) {\n                    vm.dataLoaders++;\n                    recordedData1.buffers[bufferId].loadArchivedFrames().then(loadArchivedDataEnd, loadArchivedDataEnd);\n                }\n            }\n\n            if (device2 !== undefined && vm.frameId2 !== undefined && vm.dataId2 !== undefined) {\n                var recordedData2 = device2.getData(vm.frameId2, vm.dataId2);\n                if (recordedData2 !== undefined) {\n                    vm.dataLoaders++;\n                    recordedData2.buffers[bufferId].loadArchivedFrames().then(loadArchivedDataEnd, loadArchivedDataEnd);\n                }\n            }\n        }\n\n        /** Start or update the timer (intervalPromise) */\n        function initTimer() {\n            if (intervalPromise !== undefined)\n                $interval.cancel(intervalPromise);\n\n            loadArchivedData();\n            reloadChart();\n            intervalPromise = $interval(updateGraph, vm.scales[vm.selectedScale].scale / 1000);\n        }\n\n        /** Update the graph with the recorded data, called by the timer (intervalPromise) */\n        function updateGraph() {\n            //Step 1: update X axis\n            var currentDate = statusService.getServerTime().time;\n            chart.options.scales.xAxes[0].ticks.min = (currentDate - vm.scales[vm.selectedScale].scale);\n            chart.options.scales.xAxes[0].ticks.max = currentDate;\n\n            //Step 2: update data\n            var bufferId = vm.scales[vm.selectedScale].bufferId;\n            chartData.datasets[0].data = [];\n            chartData.datasets[1].data = [];\n            // Data 1\n            if (device1 !== undefined && vm.frameId1 !== undefined && vm.dataId1 !== undefined) {\n                var recordedData1 = device1.getData(vm.frameId1, vm.dataId1);\n                if (recordedData1 !== undefined) {\n                    angular.forEach(recordedData1.buffers[bufferId].frames, function (frame) {\n                        chartData.datasets[0].data.push({ x: frame.timestamp, y: frame.value });\n                    });\n                }\n            }\n            // Data 2\n            if (device2 !== undefined && vm.frameId2 !== undefined && vm.dataId2 !== undefined) {\n                var recordedData2 = device2.getData(vm.frameId2, vm.dataId2);\n                if (recordedData2 !== undefined) {\n                    angular.forEach(recordedData2.buffers[bufferId].frames, function (frame) {\n                        chartData.datasets[1].data.push({ x: frame.timestamp, y: frame.value });\n                    });\n                }\n            }\n            chart.update();\n        }\n\n        /** Save user configuration in a 'config' property **/\n        function saveUserConfig() {\n            vm.config = {\n                type: 'Graphics',\n                scale: vm.selectedScale,\n                deviceId1: vm.deviceId1,\n                frameDataId1: vm.frameDataId1,\n                title1: vm.chartTitle1,\n                dataLegend1: dataLegend1,\n                deviceId2: vm.deviceId2,\n                frameDataId2: vm.frameDataId2,\n                title2: vm.chartTitle2,\n                dataLegend2: dataLegend2,\n                doubleYAxes: vm.doubleYAxes,\n                fill: vm.fill,\n                zeroOption: vm.zeroOption,\n                selectedYScaleMode: vm.selectedYScaleMode,\n                yAxes1Min: yAxes1Min,\n                yAxes1Max: yAxes1Max,\n                yAxes2Min: yAxes2Min,\n                yAxes2Max: yAxes2Max\n            };\n        }\n\n        /** Load user configuration from the 'config' property **/\n        function loadUserConfig() {\n            if (vm.config && vm.config.type === 'Graphics') {\n                // Global settings\n                vm.selectedScale = vm.config.scale;\n                vm.doubleYAxes = vm.config.doubleYAxes;\n                vm.fill = vm.config.fill;\n                vm.zeroOption = vm.config.zeroOption;\n                vm.selectedYScaleMode = vm.config.selectedYScaleMode;\n                yAxes1Min = vm.config.yAxes1Min;\n                yAxes1Max = vm.config.yAxes1Max;\n                yAxes2Min = vm.config.yAxes2Min;\n                yAxes2Max = vm.config.yAxes2Max;\n                //Device 1\n                vm.chartTitle1 = vm.config.title1;\n                dataLegend1 = vm.config.dataLegend1;\n                vm.deviceId1 = vm.config.deviceId1;\n                vm.updateDataList1();\n                vm.frameDataId1 = vm.config.frameDataId1;\n                vm.onChangeData1();\n                //Device 2\n                vm.chartTitle2 = vm.config.title2;\n                dataLegend2 = vm.config.dataLegend2;\n                vm.deviceId2 = vm.config.deviceId2;\n                vm.updateDataList2();\n                vm.frameDataId2 = vm.config.frameDataId2;\n                vm.onChangeData2();\n            }\n        }\n\n        /** Get Y max value from a dataset **/\n        function getYMaxValue(dataset) {\n            var yValues = [];\n            angular.forEach(dataset, function (data) {\n                if (data.y != null)\n                    yValues.push(data.y);\n            });\n            return Math.max.apply(null, yValues);\n        }\n\n        /** Get Y min value from a dataset **/\n        function getYMinValue(dataset) {\n            var yValues = [];\n            angular.forEach(dataset, function (data) {\n                if (data.y != null)\n                    yValues.push(data.y);\n            });\n            return Math.min.apply(null, yValues);\n        }\n\n        /** -------------------  VIEW-MODEL PUBLIC METHODS -------------------- */\n\n        /** Called when a chart option changed */\n        vm.updateChartOptions = reloadChart;\n\n        /** Called when a new X scale is selected */\n        vm.onChangeXScale = initTimer;\n\n        /** Called when a new device 1 is selected: reset the current data and update the data list **/\n        vm.updateDataList1 = function updateDataList1() {\n            //Reset the data\n            vm.frameDataId1 = undefined;\n            vm.onChangeData1();\n            //Refresh the frame list\n            vm.frameList1 = {};\n            if (vm.deviceId1 !== undefined) {\n                device1 = acquisitionService.registerForDevice(vm.deviceId1);\n                vm.frameList1 = device1.frameList;\n            }\n        };\n\n        /** Called when a new device 2 is selected: reset the current data and update the data list **/\n        vm.updateDataList2 = function updateDataList2() {\n            //Reset the data\n            vm.frameDataId2 = undefined;\n            vm.onChangeData2();\n            //Refresh the frame list\n            vm.frameList2 = {};\n            if (vm.deviceId2 !== undefined) {\n                device2 = acquisitionService.registerForDevice(vm.deviceId2);\n                vm.frameList2 = device2.frameList;\n            }\n        };\n\n        /** Called when a data 1 is selected **/\n        vm.onChangeData1 = function onChangeData1() {\n            if (device1 !== undefined) {\n                if (vm.frameId1 !== undefined && vm.dataId1 !== undefined)\n                    device1.stopRecordData(vm.frameId1, vm.dataId1);//Stop the record of the previous data\n                vm.frameId1 = vm.dataId1 = undefined;\n                if (vm.frameDataId1 !== undefined) {\n                    vm.frameId1 = vm.frameDataId1.split('!')[0]; //Set vm.frameId and data properties\n                    vm.dataId1 = vm.frameDataId1.split('!')[1];\n                    device1.recordData(vm.frameId1, vm.dataId1); //Record the new data\n                }\n                reloadChart();\n                loadArchivedData();\n            }\n        };\n\n        /** Called when a data 2 is selected **/\n        vm.onChangeData2 = function onChangeData2() {\n            if (device2 !== undefined) {\n                if (vm.frameId2 !== undefined && vm.dataId2 !== undefined)\n                    device2.stopRecordData(vm.frameId2, vm.dataId2);//Stop the record of the previous data\n                vm.frameId2 = vm.dataId2 = undefined;\n                if (vm.frameDataId2 !== undefined) {\n                    vm.frameId2 = vm.frameDataId2.split('!')[0]; //Set vm.frameId and data properties\n                    vm.dataId2 = vm.frameDataId2.split('!')[1];\n                    device2.recordData(vm.frameId2, vm.dataId2); //Record the new data\n                }\n                reloadChart();\n                loadArchivedData();\n            }\n        };\n\n        /** Called when the clear button is clicked: remove the data and device selection **/\n        vm.onClearData1 = function onClearData1() {\n            vm.frameDataId1 = undefined;\n            vm.onChangeData1();\n            vm.deviceId1 = undefined;\n            device1 = undefined;\n            vm.frameList1 = {};\n        };\n\n        /** Called when the clear button is clicked: remove the data and device selection **/\n        vm.onClearData2 = function onClearData1() {\n            vm.frameDataId2 = undefined;\n            vm.onChangeData2();\n            vm.deviceId2 = undefined;\n            device2 = undefined;\n            vm.frameList2 = {};\n        };\n\n        /** Called when the Y axes mode switch between 'auto' and 'manual' **/\n        vm.updateYAxesMode = function updateYAxesMode() {\n            if (vm.selectedYScaleMode === vm.YScaleModes.MANUAL) { //Set min / max properties\n                yAxes1Max = chartData.datasets[0].data.length > 0 ? getYMaxValue(chartData.datasets[0].data) : 1;\n                yAxes1Min = chartData.datasets[0].data.length > 0 ? getYMinValue(chartData.datasets[0].data) : -1;\n                yAxes2Max = chartData.datasets[1].data.length > 0 ? getYMaxValue(chartData.datasets[1].data) : 1;\n                yAxes2Min = chartData.datasets[1].data.length > 0 ? getYMinValue(chartData.datasets[1].data) : -1;\n            }\n            reloadChart();\n        };\n\n        /** Called when the 'Zoom +'/'Zoom -' button is clicked **/\n        vm.onZoomY = function onZoomY(out) {\n            if (yAxes1Max !== undefined && yAxes1Min !== undefined) {\n                var i = 0.1 * (yAxes1Max - yAxes1Min);\n                yAxes1Max += out ? i : -i;\n                yAxes1Min += out ? -i : i;\n            }\n            if (yAxes2Max !== undefined && yAxes2Min !== undefined) {\n                var i = 0.1 * (yAxes2Max - yAxes2Min);\n                yAxes2Max += out ? i : -i;\n                yAxes2Min += out ? -i : i;\n            }\n            reloadChart();\n        };\n\n        /** Called when the 'Center' button is clicked: translate the graph to the center **/\n        vm.onCenterYAxes = function onCenterYAxes() {\n            if (vm.selectedYScaleMode === vm.YScaleModes.MANUAL) {\n                //if there is one axes for 2 charts, the center is the middle between the max and the min of all values\n                if (vm.frameDataId1 !== undefined && vm.frameDataId2 !== undefined && !chart.options.scales.yAxes[1].display) {\n                    var minVal = Math.min(getYMinValue(chartData.datasets[0].data), getYMinValue(chartData.datasets[1].data));\n                    var maxVal = Math.max(getYMaxValue(chartData.datasets[0].data), getYMaxValue(chartData.datasets[1].data));\n                    var middle = (maxVal + minVal) / 2;\n                    var height = yAxes1Max - yAxes1Min;\n                    yAxes1Min = middle - height / 2;\n                    yAxes1Max = middle + height / 2;\n                }\n                else {\n                    if (chartData.datasets[1].data.length > 0) {\n                        var middle = (getYMaxValue(chartData.datasets[1].data) + getYMinValue(chartData.datasets[1].data)) / 2;\n                        var height = yAxes2Max - yAxes2Min;\n                        yAxes2Min = middle - height / 2;\n                        yAxes2Max = middle + height / 2;\n                    }\n                    if (chartData.datasets[0].data.length > 0) {\n                        var middle = (getYMaxValue(chartData.datasets[0].data) + getYMinValue(chartData.datasets[0].data)) / 2;\n                        var height = yAxes1Max - yAxes1Min;\n                        yAxes1Min = middle - height / 2;\n                        yAxes1Max = middle + height / 2;\n                    }\n                    else {\n                        yAxes1Min = yAxes2Min;\n                        yAxes1Max = yAxes2Max;\n                    }\n                }\n                reloadChart();\n            }\n        };\n    }\n\n})();\n\n(function () {\n    'use strict';\n\n    /** Component declaration **/\n    angular.module('tsa.tsaViews.gravimeter', []).component('tsaGravimeter', {\n        templateUrl: \"app/tsa-views/gravimeter/gravimeter.html\",\n        controllerAs: \"ctrl\",\n        controller: gravimeterController,\n        bindings: {\n            config: '=',\n            cardId: '@',\n            onChangeCardType: '&'\n        }\n    });\n\n    /** Component controller */\n    function gravimeterController($log, GRAVIMETER, acquisitionService) {\n\n        /**------------------------------ PROPERTIES -----------------------------**/\n        var vm = this;\n        vm.logger = $log.getInstance(\"tsa-gravimeter\");\n\n        /**------------------------------- METHODS -------------------------------**/\n\n        /** Initialization function **/\n        vm.$onInit = function init() {\n            if (angular.isUndefined(this.config) || angular.isUndefined(this.config.deviceId) || angular.isUndefined(this.config.frameId)) {\n                vm.logger.error('config and/or deviceId and/or frameId not defined!');\n                return;\n            }\n\n            vm.deviceId = this.config.deviceId;\n            vm.frameId = this.config.frameId;\n            this.GRAVIMETER = GRAVIMETER;\n        };\n    }\n})();\n\n(function () {\n    'use strict';\n\n    /** Component declaration **/\n    angular.module('tsa.tsaViews.haulComposition', []).component('tsaHaulComposition', {\n        templateUrl: \"app/tsa-views/haulComposition/haulComposition.html\",\n        controllerAs: \"ctrl\",\n        controller: haulCompositionController,\n        bindings: {\n            config: '=',\n            cardId: '@',\n            onChangeCardType: '&'\n        }\n    });\n\n    /** Component controller */\n    function haulCompositionController($interval, $location, $log, $scope, acquisitionService, staticGridService, HAUL) {\n        var vm = this;\n        vm.logger = $log.getInstance(\"HaulComposition-tsa-view\");\n\n        /**------------------------------ PROPERTIES -----------------------------**/\n        var frameListener;\n        var previousHaul;\n        var previousPocket;\n        var intervalPromise;\n        var speciesList = [];\n        vm.speciesListToDisplay = [];\n        vm.sortedPercentage;\n        vm.pageArray = [];\n        vm.selectedPage = 1;\n        vm.playEnabled = true;\n\n        /**-------------------------- INITIALIZATION / DESTROY METHODS -------------------------**/\n\n        /** Initialization function **/\n        vm.$onInit = function init() {\n            if (angular.isUndefined(this.config) || angular.isUndefined(this.config.deviceId) || angular.isUndefined(this.config.frameId)) {\n                vm.logger.error('config and/or deviceId and/or frameId not defined!');\n                return;\n            }\n\n            vm.deviceId = this.config.deviceId;\n            vm.frameId = this.config.frameId;\n\n            vm.haul = HAUL.HAUL_ID;\n            vm.pocket = HAUL.POCKET;\n            vm.totalPocket = HAUL.TOTAL_POCKET_WEIGHT;\n            vm.totalSortedSpecies = HAUL.TOTAL_SORTED_SPECIES_WEIGHT;\n\n            frameListener = acquisitionService.registerForDevice(vm.deviceId).registerForFrame(vm.frameId);\n            frameListener.promise.then({}, {}, function (receivedFrame) {\n                vm.logger.debug('blcar frame received: ' + angular.toJson(receivedFrame.value));\n                parseBlcarFrame(receivedFrame.value);\n            });\n\n            $scope.$watch(function () {\n                return document.getElementById('array').offsetHeight;\n            }, function () {\n                updateSpeciesTable();\n            });\n\n            intervalPromise = $interval(function () {\n                if (vm.playEnabled) {\n                    vm.selectedPage = (vm.selectedPage >= vm.pageArray.length) ? 1 : ++vm.selectedPage;\n                    updateSpeciesTable();\n                }\n            }, 8000);\n        };\n\n        /** Destroy function **/\n        vm.$onDestroy = function () {\n            if (intervalPromise !== undefined)\n                $interval.cancel(intervalPromise);\n            if (angular.isUndefined(vm.deviceId))\n                acquisitionService.registerForDevice(vm.deviceId).unregisterForFrame(frameListener);\n        };\n\n        /**------------------------------- PRIVATE METHODS -------------------------------**/\n\n        /** Called when a Blcar frame has been received **/\n        function parseBlcarFrame(frame) {\n            var haul = frame[HAUL.HAUL_ID][0];\n            var pocketId = frame[HAUL.POCKET][0];\n            var totalSorted = frame[HAUL.TOTAL_SORTED_SPECIES_WEIGHT][0];\n            var totalPocket = frame[HAUL.TOTAL_POCKET_WEIGHT][0];\n            var newSpecies = {\n                'id': frame[HAUL.SPECIES_ID][0],\n                'sign': frame[HAUL.SPECIES_SIGN][0],\n                'weight': frame[HAUL.SPECIES_WEIGHT][0],\n                'estimation': sprintf('%.2f', frame[HAUL.SPECIES_WEIGHT][0] / totalSorted)\n            };\n\n            vm.sortedPercentage = sprintf('%.2f', (totalSorted / totalPocket) * 100) + ' %';\n\n            //If the pocket has changed, reset the species list\n            if (previousHaul != haul || previousPocket != pocketId) {\n                speciesList = [];\n                previousPocket = pocketId;\n                previousHaul = haul;\n            }\n\n            //All the properties of the current species have been received -> add the species to the list\n            var speciesAlreadyExist = false;\n            angular.forEach(speciesList, function (species) {\n                //If the species exist, just update the sign and weight values\n                if (species.id == newSpecies.id) {\n                    speciesAlreadyExist = true;\n                    species.sign = newSpecies.sign;\n                    species.weight = newSpecies.weight;\n                    species.estimation = newSpecies.estimation;\n                }\n            });\n            if (!speciesAlreadyExist)\n                speciesList.push(newSpecies);\n\n            // Sort the list\n            speciesList.sort(function (a, b) {\n                return b.weight - a.weight;\n            });\n        }\n\n        /** Update the Species table (adjust the row number in function of the table height) */\n        function updateSpeciesTable() {\n            var arrayHeight = document.getElementById('array').offsetHeight;\n            var rowHeight = ($location.path() == '/static' && staticGridService.isSingleMode()) ? 64 : 42;\n            var pageCapacity = Math.floor(arrayHeight / rowHeight);\n\n            if (pageCapacity != 0) {\n                vm.pageArray = [];\n                for (var i = 0; i < Math.ceil(speciesList.length / pageCapacity); i++)\n                    vm.pageArray.push(i + 1);\n                vm.speciesListToDisplay = speciesList.slice((vm.selectedPage - 1) * pageCapacity, vm.selectedPage * pageCapacity);\n            }\n        }\n\n        /** Select a page **/\n        vm.selectPage = function selectPage(page) {\n            vm.selectedPage = page;\n            updateSpeciesTable();\n        }\n    }\n})();\n\n(function () {\n    'use strict';\n\n    /** Generic view component **/\n    angular.module('tsa.tsaViews.hullSoundSpeed',[]).component('tsaHullSoundSpeed', {\n        templateUrl: \"app/tsa-views/hullSoundSpeed/hullSoundSpeed.html\",\n        controllerAs: \"ctrl\",\n        controller: hullSoundSpeedController,\n        bindings: {\n            config: '=',\n            cardId: '@',\n            onChangeCardType: '&'\n        }\n    });\n\n    /** Generic view controller */\n    function hullSoundSpeedController($timeout, $interval, $scope, acquisitionService, graphUtils, $log, statusService, themeService, HULLSOUNDSPEED) {\n        var vm = this;\n        vm.logger = $log.getInstance(\"tsa-hullsoundspeed\");\n\n        /**------------------------------ PROPERTIES -------------------------------**/\n\n        vm.canvasId = \"canvas-hss-\" + vm.cardId;\n        var intervalPromise;\n        var timeoutPromise;\n        vm.bufferLoading = {};\n\n        /**  Time scales **/\n        vm.scales = graphUtils.scales;\n        vm.selectedScale = '1 min';\n\n        /** Chart properties **/\n        var chart = undefined;\n        var chartData = {\n            datasets: [{\n                label: \"Data 1\",\n                xAxisID: \"x-axis-1\",\n                yAxisID: \"y-axis-1\",\n                borderColor: 'rgb(26, 117, 174)',\n                backgroundColor: 'rgba(26, 117, 174, 0.3)',\n                data: []\n            }]\n        };\n\n        /** Initialization function */\n        vm.$onInit = function init() {\n            if (angular.isUndefined(vm.config)\n                || angular.isUndefined(vm.config.deviceId)\n                || angular.isUndefined(vm.config.frameId)) {\n                vm.logger.error('deviceId or/and frameId or/and hullsoundspeedDeviceId not defined!');\n                return;\n            }\n\n            vm.deviceId = vm.config.deviceId;\n\n            // properties defined in the front-end configuration file (parameter.json)\n            vm.frameId = vm.config.frameId;\n            vm.HULLSOUNDSPEED = HULLSOUNDSPEED;\n\n            vm.device = acquisitionService.registerForDevice(vm.deviceId);\n            vm.device.recordData(vm.frameId, vm.HULLSOUNDSPEED.DATA);\n\n            //Wait the canvas creation, and then create the chart\n            timeoutPromise = $timeout(initTimer, 200);\n\n            // Change gridLinesColor of Graph on every change of service variable\n            themeService.subscribe($scope, function(event, theme) {\n                vm.theme = theme;\n                reloadChart();\n            });\n\n            if (angular.isDefined(vm.config.scale))\n                vm.selectedScale = vm.config.scale;\n        };\n\n        /** Destroy function **/\n        vm.$onDestroy = function () {\n            vm.device.stopRecordData(vm.frameId, vm.HULLSOUNDSPEED.DATA);\n            $timeout.cancel(timeoutPromise);\n            if (intervalPromise !== undefined)\n                $interval.cancel(intervalPromise);\n        };\n        /**------------------------------ METHODS -------------------------------**/\n\n        /** Generate the chart options */\n        function getChartOptions() {\n            var chartOptions = graphUtils.getChartOptions(vm.scales[vm.selectedScale].stepSize);\n            chartOptions.scales.yAxes = [{\n                id: \"y-axis-1\",\n                gridLines: { color: vm.theme.gridLinesColor },\n                ticks: {suggestedMax: 10 }\n            }];\n            return chartOptions;\n        }\n\n        /** Redraw the chart **/\n        function reloadChart() {\n            if (chart !== undefined)\n                chart.destroy();\n            var canvas = document.getElementById(vm.canvasId);\n            if (canvas) {\n                chart = Chart.Scatter(canvas, { data: chartData, options: getChartOptions() });\n                updateGraph();\n            }\n            vm.config.scale = vm.selectedScale;\n        }\n\n        /** Start or update the timer (intervalPromise) */\n        var initTimer = function initTimer() {\n            if (intervalPromise !== undefined)\n                $interval.cancel(intervalPromise);\n\n            //Load archived data\n            if (angular.isDefined(vm.device.getData(vm.frameId, vm.HULLSOUNDSPEED.DATA))) {\n                var bufferId = vm.scales[vm.selectedScale].bufferId;\n                vm.bufferLoading[vm.selectedScale] = vm.bufferLoading[vm.selectedScale] ? ++vm.bufferLoading[vm.selectedScale] : 1;\n                var selectedScale = vm.selectedScale;\n                var requestCallback = function () {\n                    vm.bufferLoading[selectedScale]--;\n                    if (chart !== undefined)\n                        updateGraph();\n                };\n                vm.device.getData(vm.frameId, vm.HULLSOUNDSPEED.DATA).buffers[bufferId].loadArchivedFrames().then(requestCallback, requestCallback);\n            }\n            reloadChart();\n            intervalPromise = $interval(updateGraph, vm.scales[vm.selectedScale].scale / 1000);\n        };\n\n        /** Update the graph with the recorded data (called by the timer (intervalPromise)) */\n        function updateGraph() {\n            //Step 1: update X axis\n            var currentDate = statusService.getServerTime().time;\n            chart.options.scales.xAxes[0].ticks.min = (currentDate - vm.scales[vm.selectedScale].scale);\n            chart.options.scales.xAxes[0].ticks.max = currentDate;\n\n            //Step 2: update data\n            var bufferId = vm.scales[vm.selectedScale].bufferId;\n            chartData.datasets[0].data = [];\n            var recordedData = vm.device.getData(vm.frameId, vm.HULLSOUNDSPEED.DATA);\n            if (recordedData !== undefined)\n                angular.forEach(recordedData.buffers[bufferId].frames, function (frame) {\n                    chartData.datasets[0].data.push({ x: frame.timestamp, y: frame.value });\n                });\n\n            chart.update();\n        }\n\n        /** Called when a new X scale is selected */\n        vm.onChangeXScale = initTimer;\n\n    }\n})();\n\n(function () {\n    'use strict';\n\n    /** Kley state component */\n    angular.module('tsa.tsaViews.kleyState', []).component('tsaKleyState', {\n        templateUrl: \"app/tsa-views/kley-state/kley-state.html\",\n        controllerAs: \"ctrl\",\n        controller: kleyStateController,\n        bindings: {\n            config: '=',\n            cardId: '@',\n            onChangeCardType: '&'\n        }\n    });\n\n    /** Kley state controller */\n    function kleyStateController($log, acquisitionService, $scope, $timeout, KLEY_STATE) {\n        var vm = this;\n        vm.logger = $log.getInstance(\"kley-state-tsa-view\");\n\n        //  pompe m1 PP_KleyWinch - kley_state\n        vm.deviceId = 'PP_KleyWinch';\n        /**------------------------------ PRIVATE PROPERTIES -------------------------------**/\n\n        vm.KLEY_STATE = {\n            'frameId': KLEY_STATE.FRAME,\n            'datasRight': [\n                { 'id': KLEY_STATE.HP, 'name': 'Hp', 'unit': 'bar', 'cFormat': '%.0f' },\n                { 'id': KLEY_STATE.BP, 'name': 'Bp', 'unit': 'bar', 'cFormat': '%.0f' },\n                { 'id': KLEY_STATE.TEMP, 'name': 'Temp.', 'unit': '', 'cFormat': '%.0f' }\n            ],\n            'datasLeft': [\n                { 'id': KLEY_STATE.M1, 'name': 'M1', 'unit': '', 'cFormat': '' },\n                { 'id': KLEY_STATE.M2, 'name': 'M2', 'unit': '', 'cFormat': '' },\n                { 'id': KLEY_STATE.M3, 'name': 'M3', 'unit': '', 'cFormat': '' },\n                { 'id': KLEY_STATE.M4, 'name': 'M4', 'unit': '', 'cFormat': '' },\n                { 'id': KLEY_STATE.M5, 'name': 'M5', 'unit': '', 'cFormat': '' }\n            ]\n        };\n\n        /**-------------------------- INITIALIZATION / DESTROY METHODS -------------------------**/\n\n        /** Initialization function  */\n        vm.$onInit = function init() {\n            if (angular.isUndefined(this.config) || angular.isUndefined(this.config.deviceId) || angular.isUndefined(this.config.frameId)) {\n                vm.logger.error('config and/or deviceId and/or frameId not defined!');\n            }\n        };\n\n        /** Destroy function: remove the data listeners */\n        vm.$onDestroy = function () {\n        };\n    }\n\n})();\n\n(function () {\n    'use strict';\n\n    /** Component declaration **/\n    angular.module('tsa.tsaViews.kss31', []).component('tsaKss31', {\n        templateUrl: \"app/tsa-views/kss31/kss31.html\",\n        controllerAs: \"ctrl\",\n        controller: gravimeterController,\n        bindings: {\n            config: '=',\n            cardId: '@',\n            onChangeCardType: '&'\n        }\n    });\n\n    /** Component controller */\n    function gravimeterController($log, KSS31, acquisitionService) {\n\n        /**------------------------------ PROPERTIES -----------------------------**/\n        var vm = this;\n        vm.logger = $log.getInstance(\"tsa-kss31\");\n\n        /**------------------------------- METHODS -------------------------------**/\n\n        /** Initialization function **/\n        vm.$onInit = function init() {\n            if (angular.isUndefined(this.config) || angular.isUndefined(this.config.deviceId) || angular.isUndefined(this.config.frameId)) {\n                vm.logger.error('config and/or deviceId and/or frameId not defined!');\n                return;\n            }\n\n            vm.deviceId = this.config.deviceId;\n            vm.frameId = this.config.frameId;\n            this.KSS31 = KSS31;\n        };\n    }\n})();\n\n/*\n * Traverse tribord\n * \n * DA 1 max 800kW\n * DA 3 max 1200kW\n * \n * Traverse bbord\n * DA 2 max 1200kW\n * DA 4 max 800kW\n */\n\n(function () {\n    'use strict';\n    \n    /** Propulsion component **/\n    angular.module('tsa.tsaViews.landingAt', []).component('tsaLandingAt', {\n        templateUrl: \"app/tsa-views/landing-at/landing-at.html\",\n        controllerAs: \"ctrl\",\n        controller: landingControllerAt,\n        bindings: {\n            config: '=',\n            cardId: '@',\n            onChangeCardType: '&'\n        }\n    });\n\n    /** Propulsion controller **/\n    function landingControllerAt(acquisitionService, $timeout, $scope, easelJsUtils, themeService, NAVIGATION, WEATHER) {\n        var vm = this;\n        var TAG = '[landingControllerAt] ';\n\n        /**------------------------------ PROPERTIES -------------------------------**/\n\n        //Canvas\n        vm.propulsionCanvasId = \"canvas-propulsion-landing-at-\" + vm.cardId;\n        var propulsionCanvas;\n        var propulsionStage;\n        var propulsionBackContainer;\n        var propulsionFrontContainer;\n        \n        var propulsionCanvasWidth;\n        var propulsionCanvasHeight;\n       \n        vm.windCanvasId = \"canvas-wind-landing-at-\" + vm.cardId;\n        var windCanvas;\n        var windCanvasSize;\n        var windCanvasWidth;\n        var windCanvasHeight;\n        var windStage;\n        //Shapes\n        var boatShape;\n        var boatHeadingShape;\n        var trueWindShape;\n        var relWindShape;\n        var relHeading;\n\n        // Shape properties\n        var trueWindColor = \"#E53935\";\n        var relWindColor = \"#1a75ae\";\n        \n        vm.readyToDraw = false;\n\n        vm.colors = {\n        \tbackground: '#CCCCCC',\n        \tzero: '#EE2222',\n        \ttick: '#888888',\n        \trudder: '#000000',\n        \tgreen: '#11CC11',\n        \tred: '#EE2222',\n        \tforward: '#1111DD',\n        \tbackward: '#000000',\n        \tfunkyBackground: '#F3BF52'\n        };\n        \n        vm.themeChanged = function themeChanded(event, theme) {\n        \tconsole.log(\"landing at themechanged\");\n        }\n        \n        themeService.subscribe($scope, vm.themeChanged);\n        \n        /**------------------------------ METHODS -------------------------------**/\n\n        /** Initialization function **/\n        vm.$onInit = function init() {\n\n            console.log(TAG + '$onInit: deviceId = ' + (this.config ? this.config.deviceId : 'config undefined'));\n\n            if (this.config == undefined || this.config.deviceId == undefined) {\n                console.error(TAG + 'device Id not found!');\n                return;\n            }\n\n            vm.deviceId = this.config.deviceId; //Component parameter (mandatory)\n            vm.navId = this.config.navId; \n            vm.device = acquisitionService.registerForDevice(vm.deviceId);\n            vm.frameId = 'atpropulsion'\n            vm.navFrameId = 'shipnav';\n\n            vm.weatherFrame = 'weather';\n            vm.weatherDeviceId = this.config.weatherId;\n            vm.trueWindHeadingId = 'trueairheading';\n            vm.trueWindSpeedId = 'trueairspeed';\n            vm.relWindHeadingId = 'relairheading';\n            vm.relWindSpeedId = 'relairspeed';\n            \n            //Create object to add x and y properties\n            vm.frontTrans = { id: 'fronttrans' };\n            vm.frontPropAngle = { id: 'frontpropangle' };\n            vm.mainLeft = { id: 'mainleft' };\n            vm.mainRight= {id: 'mainright' };\n            vm.angle = {id: 'angle' };\n            vm.fontsize = 1;\n\n            vm.frameListener = acquisitionService.registerForDevice(vm.deviceId).registerForFrame(vm.frameId);\n            vm.frameListener.promise.then({}, {}, function (frame) {\n            \tvm.frontTrans.value = frame.value[vm.frontTrans.id];\n            \tvm.frontPropAngle.value = frame.value[vm.frontPropAngle.id];\n            \tvm.mainLeft.value = frame.value[vm.mainLeft.id];\n            \tvm.mainRight.value = frame.value[vm.mainRight.id];\n            \tvm.angle.value = frame.value[vm.angle.id];\n\n            \tif(vm.readyToDraw) {\n                    updatePropulsionFrontContainer();\n            \t\tpropulsionStage.update();\n            \t}\n            }); \n            \t\n\t\t\tvm.heading\t\t= { id: 'heading'};\n\t\t\tvm.gndCourse\t= { id: 'gndcourse'};\n\t\t\tvm.gndSpeed\t\t= { id: 'gndspeed'};\n\t\t\tvm.surfCourse\t= { id: 'surfcourse'};\n\t\t\tvm.surfSpeed\t= { id: 'surfspeed'};\n\t\t\t\n\t\t\tvm.surfNorth = vm.surfWest = vm.surfEast = vm.surfSouth = undefined;\n\t\t\tvm.gndNorth = vm.gndWest = vm.gndEast = vm.gndSouth = undefined;\n\t\t\t\n\t\t\tvm.navFrameListener = acquisitionService.registerForDevice(vm.navId).registerForFrame('shipnav');\n\t\t\tvm.navFrameListener.promise.then({}, {}, function (frame) {\n\t\t\t\tvm.heading.value = frame.value[vm.heading.id];\n\t\t\t\tvm.gndCourse.value = frame.value[vm.gndCourse.id];\n\t\t\t\tvm.gndSpeed.value = frame.value[vm.gndSpeed.id];\n\t\t\t\tvm.surfCourse.value = frame.value[vm.surfCourse.id];\n\t\t\t\tvm.surfSpeed.value = frame.value[vm.surfSpeed.id];\n\n                if (windStage != null && boatShape == null) {\n                    drawBoat();\n                }\n                if (angular.isDefined(boatShape)) {\n                    boatShape.rotation = vm.heading.value - 90;\n                    boatHeadingShape.rotation = vm.heading.value - 90;\n\n                    if (angular.isDefined(relWindShape))\n                        relWindShape.rotation = parseFloat(vm.heading.value) + parseFloat(relHeading) - 90;\n                    windStage.update();\n                }\n                \n\t\t\t\tvar surfA = vm.surfSpeed.value * Math.cos((vm.surfCourse.value-vm.heading.value)*Math.PI/180.0);\n\t\t\t\tif(surfA>=0) {\n\t\t\t\t\tvm.surfNorth = surfA;\n\t\t\t\t\tvm.surfSouth = undefined;\n\t\t\t\t} else {\n\t\t\t\t\tvm.surfNorth = undefined;\n\t\t\t\t\tvm.surfSouth = -surfA;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tvar surfB = vm.surfSpeed.value * Math.sin((vm.surfCourse.value-vm.heading.value)*Math.PI/180.0);\n\t\t\t\tif(surfB<0) {\n\t\t\t\t\tvm.surfWest = -surfB;\n\t\t\t\t\tvm.surfEast = undefined;\n\t\t\t\t} else {\n\t\t\t\t\tvm.surfWest = undefined;\n\t\t\t\t\tvm.surfEast = surfB;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tvar gndA = vm.gndSpeed.value * Math.cos((vm.gndCourse.value-vm.heading.value)*Math.PI/180.0);\n\t\t\t\tif(gndA>=0) {\n\t\t\t\t\tvm.gndNorth = gndA;\n\t\t\t\t\tvm.gndSouth = undefined;\n\t\t\t\t} else {\n\t\t\t\t\tvm.gndNorth = undefined;\n\t\t\t\t\tvm.gndSouth = -gndA;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tvar gndB = vm.gndSpeed.value * Math.sin((vm.gndCourse.value-vm.heading.value)*Math.PI/180.0);\n\t\t\t\tif(gndB<0) {\n\t\t\t\t\tvm.gndWest = -gndB;\n\t\t\t\t\tvm.gndEast = undefined;\n\t\t\t\t} else {\n\t\t\t\t\tvm.gndWest = undefined;\n\t\t\t\t\tvm.gndEast = gndB;\n\t\t\t\t}\n\t\t\t});\n\t\t\t\n\t\t\t\n            vm.trueWindSpeedId = WEATHER.TRUE_AIR_SPEED;\n            vm.trueWindHeadingId = WEATHER.TRUE_AIR_HEADING;\n            vm.relWindSpeedId = WEATHER.REL_AIR_SPEED;\n            vm.relWindHeadingId = WEATHER.REL_AIR_HEADING;\n\n            // Wind listener initisalisation\n            vm.weatherFrameListener = acquisitionService.registerForDevice(vm.weatherDeviceId).registerForFrame(WEATHER.FRAME);\n            vm.weatherFrameListener.promise.then({}, {}, function (frame) {\n                if (angular.isDefined(windStage)) {\n                    var trueSpeed = frame.value[WEATHER.TRUE_AIR_SPEED];\n                    var trueHeading = frame.value[WEATHER.TRUE_AIR_HEADING];\n                    var relSpeed = frame.value[WEATHER.REL_AIR_SPEED];\n                    relHeading = frame.value[WEATHER.REL_AIR_HEADING];\n\n                    windStage.removeChild(trueWindShape);\n                    windStage.removeChild(relWindShape);\n                    if (angular.isDefined(vm.heading.value)) { //If boath heading is known, draw rel and true flags\n                        trueWindShape = drawWindFlag(trueSpeed, trueWindColor, trueHeading);\n                        relWindShape = drawWindFlag(relSpeed, relWindColor, parseFloat(vm.heading.value) + parseFloat(relHeading));\n                    }\n                    else relWindShape = drawWindFlag(relSpeed, relWindColor, parseFloat(relHeading)); // else draw only rel flag\n                    windStage.update();\n                }\n            });\n\t\t\t\n            \t\n            $timeout(function () {\n                initPropulsionCanvas();\n                initWindCanvas();\n                vm.readyToDraw = true;\n            }, 500); \n\n        };\n\n        /** Destroy function: remove the data listeners */\n        vm.$onDestroy = function destroy() {\n            if (angular.isDefined(vm.frameListener))\n                acquisitionService.registerForDevice(vm.deviceId).unregisterForFrame(vm.frameListener);\n            if (angular.isDefined(vm.weatherFrameListener))\n                acquisitionService.registerForDevice(vm.weatherDeviceId).unregisterForFrame(vm.weatherFrameListener);\n            if (angular.isDefined(vm.navFrameListener))\n                acquisitionService.registerForDevice(vm.navId).unregisterForFrame(vm.navFrameListener);\n        }\n        \n        /**Initialize the canvas **/\n        function initPropulsionCanvas() {\n            propulsionCanvas = document.getElementById(vm.propulsionCanvasId);\n            if (propulsionCanvas != null) {\n                propulsionStage = new createjs.Stage(propulsionCanvas);\n\n                propulsionBackContainer = new createjs.Container();\n                propulsionFrontContainer = new createjs.Container();\n                \n                propulsionStage.addChild(propulsionBackContainer, propulsionFrontContainer);\n                \n                $scope.$watch(function () {\n                    return propulsionCanvas.offsetHeight\n                }, function () {\n                    updatePropulsionCanvasSize();\n                });\n                $scope.$watch(function () {\n                    return propulsionCanvas.offsetWidth\n                }, function () {\n                    updatePropulsionCanvasSize();\n                });\n                updatePropulsionCanvasSize();\n            }\n        }\n\n        /** Create the stage if needed, reset the canvas and redraw all the shapes **/\n        function updatePropulsionCanvasSize() {\n            if (propulsionCanvas != null) {\n                propulsionCanvasWidth = propulsionCanvas.offsetWidth;\n                propulsionCanvasHeight = propulsionCanvas.offsetHeight;\n\n                //Canvas size properties setting\n                propulsionCanvas.setAttribute('width', propulsionCanvasWidth);\n                propulsionCanvas.setAttribute('height', propulsionCanvasHeight);\n\n                angular.element(propulsionCanvas).parent().find(\"tsa-data-view .value\").css({\n                \t\"font-size\": \"\"+propulsionCanvasHeight/220+\"em\"\n        \t\t}); \n                \n                angular.element(propulsionCanvas).parent().find(\"tsa-data-view\").css({\n                \t\"width\": \"\"+Math.round(propulsionCanvasHeight/3.5)+\"px !important\",\n                \t\"max-width\": \"\"+Math.round(propulsionCanvasHeight/3.5)+\"px\",\n                \t\"background-color\": \"green\"\n                }); \n\n                propulsionStage.x = propulsionCanvasWidth/2;\n                propulsionStage.y = propulsionCanvasHeight/2;\n            \tvar scale = propulsionCanvasHeight/100;\n            \tpropulsionStage.scaleX = propulsionStage.scaleY = scale;\n            \t                \n                updatePropulsionBackContainer();\n                propulsionBackContainer.cache(-propulsionCanvasWidth/2, -propulsionCanvasHeight/2, \n                \t\tpropulsionCanvasWidth, propulsionCanvasHeight, scale);\n                updatePropulsionFrontContainer();\n                updatePropulsionLabels();\n\n                propulsionStage.update();\n            }\n        }\n        \n        \n        function updatePropulsionBackContainer() {\n        \tpropulsionBackContainer.removeAllChildren();\n        \t\n            var vesselShape = easelJsUtils.createVessel(vm.colors.tick);\n            vesselShape.scaleX = 0.3;\n            vesselShape.scaleY = 0.65;\n            vesselShape.y = -12;\n            \n            var backLeftRudderShape =  easelJsUtils.createBackRudder(vm.colors.background)\n            backLeftRudderShape.y = 22;\n            backLeftRudderShape.x = -10;\n            backLeftRudderShape.scaleX = backLeftRudderShape.scaleY = 12/100;\n            \n            var backRightRudderShape =  easelJsUtils.createBackRudder(vm.colors.background)\n            backRightRudderShape.y = 22;\n            backRightRudderShape.x = +10;\n            backRightRudderShape.scaleX = backRightRudderShape.scaleY = 12/100;\n            \n\t\t\tvar mainLeftBackGaugeShape = easelJsUtils.createBackGauge(vm.colors.background);\n\t\t\tmainLeftBackGaugeShape.y = 2;\n\t\t\tmainLeftBackGaugeShape.x = -10;\n\t\t\tmainLeftBackGaugeShape.scaleX = 0.23;\n\t\t\tmainLeftBackGaugeShape.scaleY = 0.3;\n\t\t\tmainLeftBackGaugeShape.rotation = 270;\n\n\t\t\tvar mainRightBackGaugeShape = easelJsUtils.createBackGauge(vm.colors.background);\n\t\t\tmainRightBackGaugeShape.y = 2;\n\t\t\tmainRightBackGaugeShape.x = +10;\n\t\t\tmainRightBackGaugeShape.scaleX = 0.23;\n\t\t\tmainRightBackGaugeShape.scaleY = 0.3;\n\t\t\tmainRightBackGaugeShape.rotation = 270;\n\n\t\t\tpropulsionBackContainer.addChild(vesselShape, backLeftRudderShape, backRightRudderShape, mainLeftBackGaugeShape, mainRightBackGaugeShape);\n        }\n        \n        function updatePropulsionFrontContainer() {\n        \tpropulsionFrontContainer.removeAllChildren();        \t\n            var rudderColor = vm.colors.rudder;\n\t\t\tif(Math.abs(Math.round(vm.angle.value))>0) {\n\t\t\t\trudderColor = vm.angle.value > 0 ? vm.colors.red : vm.colors.green;\n\t\t\t}\n            \n            var leftRudderShape = easelJsUtils.createRudder(rudderColor);\n            leftRudderShape.y = 22;\n            leftRudderShape.x = -10;\n            leftRudderShape.scaleX = leftRudderShape.scaleY = 12/100;\n            leftRudderShape.rotation = vm.angle.value;\n            \n            var rightRudderShape = easelJsUtils.createRudder(rudderColor);\n            rightRudderShape.y = 22;\n            rightRudderShape.x = +10;\n            rightRudderShape.scaleX = rightRudderShape.scaleY = 12/100;\n            rightRudderShape.rotation = vm.angle.value;\n            \n            var mainLeftGaugeShape = easelJsUtils.createGaugge(vm.colors.tick, vm.colors.zero, \n            \t\tvm.mainLeft.value*100/150, vm.colors.forward, vm.colors.backward);\n            mainLeftGaugeShape.y = 2;\n            mainLeftGaugeShape.x = -10;\n\t\t\tmainLeftGaugeShape.scaleX = 0.23;\n\t\t\tmainLeftGaugeShape.scaleY = 0.3;\n\t\t\tmainLeftGaugeShape.rotation = 270;\n\n            var mainRightGaugeShape = easelJsUtils.createGaugge(vm.colors.tick, vm.colors.zero, \n            \t\tvm.mainRight.value*100/150, vm.colors.forward, vm.colors.backward);\n            mainRightGaugeShape.y = 2;\n            mainRightGaugeShape.x = +10;\n            mainRightGaugeShape.scaleX = 0.23;\n\t\t\tmainRightGaugeShape.scaleY = 0.3;\n\t\t\tmainRightGaugeShape.rotation = 270;\n\t\t\t            \n\t\t\tvar arrowColor = vm.colors.rudder;\n\t\t\tif((vm.frontPropAngle.value <= 180) && (vm.frontPropAngle.value >=0)) {\n\t\t\t\tarrowColor = vm.colors.green;\n\t\t\t} else {\n\t\t\t\tarrowColor = vm.colors.red;\n\t\t\t}\n            var frontTransArrowShape = easelJsUtils.createArrow(\n            \t\tarrowColor, vm.frontTrans.value/2.0);\n\t\t\tfrontTransArrowShape.y = -31.5;\n\t\t\tfrontTransArrowShape.x = 0;\n\t\t\tfrontTransArrowShape.scaleX = frontTransArrowShape.scaleY = 0.1;\n\t\t\tfrontTransArrowShape.rotation = vm.frontPropAngle.value;\n\t\t\t            \n            propulsionFrontContainer.addChild(leftRudderShape, rightRudderShape, mainLeftGaugeShape, mainRightGaugeShape, frontTransArrowShape);\n        }\n        \n\n        function updatePropulsionLabels() {\n            propulsionCanvasWidth = propulsionCanvas.offsetWidth;\n            propulsionCanvasHeight = propulsionCanvas.offsetHeight;\n\n            var canvasX = propulsionCanvas.offsetLeft;\n            var canvasY = propulsionCanvas.offsetTop;\n        \t\n            var delta = propulsionCanvasHeight*5/100;\n            \n            vm.frontTrans.x = canvasX + 0.1*propulsionCanvasWidth/2;\n            vm.frontTrans.y = canvasY + propulsionCanvasHeight*(50 - 38)/100;\n\n            vm.frontPropAngle.x = vm.frontTrans.x;\n            vm.frontPropAngle.y = canvasY + propulsionCanvasHeight*(50 - 25)/100;\n        \n            vm.mainLeft.x = vm.frontTrans.x;\n            vm.mainLeft.y = canvasY + propulsionCanvasHeight*(50 + 0)/100;\n\n            vm.mainRight.x = canvasX + 1.4*propulsionCanvasWidth/2;\n            vm.mainRight.y = vm.mainLeft.y\n\n            vm.angle.x = canvasX + 1*propulsionCanvasWidth/2;\n            vm.angle.y = canvasY + propulsionCanvasHeight*(50 + 37)/100;\n        }\n        \n        \n        /**------------------------------ DRAW METHODS -------------------------------**/\n\n        /** Initialize the canvas **/\n        function initWindCanvas() {\n            windCanvas = document.getElementById(vm.windCanvasId);\n            if (windCanvas != null) {\n                windStage = new createjs.Stage(windCanvas);\n                drawBoat();\n                $scope.$watch(function () {\n                    return windCanvas.offsetHeight\n                }, function () {\n                    updateWindCanvasSize();\n                });\n                $scope.$watch(function () {\n                    return windCanvas.offsetWidth\n                }, function () {\n                    updateWindCanvasSize();\n                });\n                updateWindCanvasSize();\n            }\n        }\n\n        /** Create the stage if needed, reset the canvas and redraw all the shapes **/\n        function updateWindCanvasSize() {\n            if (windCanvas != null) {\n                windCanvasSize = windCanvas.offsetWidth < windCanvas.offsetHeight ? windCanvas.offsetWidth : windCanvas.offsetHeight;\n                windCanvasWidth = windCanvas.offsetWidth;\n                windCanvasHeight = windCanvas.offsetHeight;\n\n                //Canvas size properties setting\n                windCanvas.setAttribute('width', windCanvasWidth);\n                windCanvas.setAttribute('height', windCanvasHeight);\n\n                // Reset canvas\n                windStage.removeAllChildren();\n\n                // Redraw shapes\n                drawCompass();\n                drawBoat();\n                if (trueWindShape != null)\n                    trueWindShape = drawWindFlag(trueWindShape.speed, trueWindColor, trueWindShape.rotation + 90);\n                if (relWindShape != null)\n                    relWindShape = drawWindFlag(relWindShape.speed, relWindColor, relWindShape.rotation + 90);\n                windStage.update();\n            }\n        }\n\n        /** Draw the boat and its heading **/\n        function drawBoat() {\n            // Create shape and set properties (color, size...)\n            boatShape = new createjs.Shape();\n            boatShape.x = windCanvasWidth / 2;\n            boatShape.y = windCanvasHeight / 2;\n            boatShape.rotation = angular.isDefined(vm.heading.value) ? vm.heading.value - 90 : -90;\n            boatShape.graphics.beginStroke('#757575').setStrokeStyle(1, 'round');\n            windStage.addChild(boatShape);\n\n            boatHeadingShape = new createjs.Shape();\n            boatHeadingShape.x = windCanvasWidth / 2;\n            boatHeadingShape.y = windCanvasHeight / 2;\n            boatHeadingShape.rotation = boatShape.rotation;\n            boatHeadingShape.graphics.beginStroke('#757575').setStrokeStyle(1).setStrokeDash([10, 5]);\n            windStage.addChild(boatHeadingShape);\n\n            var boatLength = windCanvasSize * 0.5;\n            var boatWidth = boatLength / 4;\n\n            //Heading line\n            boatHeadingShape.graphics.moveTo(-boatLength * (3 / 4), 0);\n            boatHeadingShape.graphics.lineTo(boatLength * 3 / 4, 0);\n            //Boat\n            boatShape.graphics.moveTo(boatLength / 5, boatWidth / 2)\n                .lineTo(-boatLength / 2, boatWidth / 2)\n                .lineTo(-boatLength / 2, -boatWidth / 2)\n                .lineTo(boatLength / 5, -boatWidth / 2)\n                .bezierCurveTo(boatLength / 1.5, -boatWidth / 4, boatLength / 1.5, boatWidth / 4, boatLength / 5, boatWidth / 2);\n        }\n\n        /** Draw wind shape **/\n        function drawWindFlag(speed, color, angle) {\n            var shape = new createjs.Shape();\n            shape.x = windCanvasWidth / 2;\n            shape.y = windCanvasHeight / 2;\n            shape.rotation = angle - 90;\n            shape.speed = speed;\n            windStage.addChild(shape);\n            shape.graphics.beginStroke(color).setStrokeStyle(2);\n            var flagLength = windCanvasSize / 3;\n\n            if (speed === 0) {//if the true wind is null\n                shape.graphics.drawCircle(0, 0, 20);\n            }\n            else if (speed > 200) {//if the true wind is too big\n                vm.logger.error(\"Error true wind speed too high\");\n            }\n            else {//if the true wind is not null and not too big\n                shape.graphics.moveTo(0, 0);\n                shape.graphics.lineTo(flagLength, 0);\n                shape.graphics.beginFill(color);\n                drawBarb(shape, speed, flagLength);\n            }\n            return shape;\n        }\n\n        /** function used to draw the pennants and the flags on the wind barb (hampe de vent) **/\n        function drawBarb(shape, windSpeed, flagLength) {\n            var currentPosition = flagLength; // virtual mark in order to know where to put pennants,flags and half-flags\n            var pennant = Math.floor(windSpeed / 50);           // for each 50 knots we add one pennant\n            var flag = Math.floor((windSpeed % 50) / 10);       // for each 10 knots we add one flag (max 4)\n            var halfFlag = Math.floor((windSpeed % 10) / 5);    // for each 5 knots we add one half-flag (max 1)\n\n            //Draw pennants\n            for (var i = 0; i < pennant; i++) {\n                shape.graphics.moveTo(currentPosition, 0).lineTo(currentPosition - 12, 20).lineTo(currentPosition - 20, 0);\n                currentPosition -= 20;\n            }\n            if (pennant !== 0)\n                currentPosition -= 10;\n            //Draw flags\n            for (i = 0; i < flag; i++) {\n                shape.graphics.moveTo(currentPosition, 0).lineTo(currentPosition + 8, 20);\n                currentPosition -= 10;\n            }\n            //Draw half flags\n            for (i = 0; i < halfFlag; i++) {\n                shape.graphics.moveTo(currentPosition, 0).lineTo(currentPosition + 4, 10);\n                currentPosition -= 10;\n            }\n        }\n\n        /** Draw the compass **/\n        function drawCompass() {\n            var compassShape = new createjs.Shape();\n            compassShape.x = windCanvasWidth / 2;\n            compassShape.y = windCanvasHeight / 2;\n            windStage.addChild(compassShape);\n            compassShape.graphics.beginStroke('#757575').setStrokeStyle(3);\n            var radius = windCanvasSize / 2 - 20;\n\n            for (var i = 0; i < 24; i++) {\n                var angle = i * Math.PI / 12;\n                var strokeLength = i % 3 === 0 ? 7 : 2;\n                //Draw text\n                if (i % 2 === 0 && i % 6 !== 0) {\n                    var xPosition = (radius + strokeLength + 20) * Math.cos(angle) - 6; //offset to adjust the text position\n                    var yPosition = (radius + strokeLength + 20) * Math.sin(angle);\n                    var text = ((i + 6) % 24) * 360 / 24;\n                    xPosition -= 10; //offset to adjust the text position\n                    drawText(text, xPosition, yPosition);\n                }\n                //Draw stroke\n                compassShape.graphics.moveTo((radius - strokeLength) * Math.cos(angle), (radius - strokeLength) * Math.sin(angle));\n                compassShape.graphics.lineTo((radius + strokeLength) * Math.cos(angle), (radius + strokeLength) * Math.sin(angle));\n\n            }\n        }\n\n        /** Draw a text at a specific position **/\n        function drawText(text, x, y) {\n            var textShape = new createjs.Text(text, \"10px Arial\", '#757575');\n            textShape.x = windCanvasWidth / 2 + x;\n            textShape.y = windCanvasHeight / 2 + y;\n            textShape.textBaseline = \"middle\";\n            return windStage.addChild(textShape);\n\n        }\n\n        \n    }\n})();\n\n(function () {\n    'use strict';\n\n    /** Component declaration **/\n    angular.module('tsa.tsaViews.magnetometer', []).component('tsaMagnetometer', {\n        templateUrl: \"app/tsa-views/magnetometer/magnetometer.html\",\n        controllerAs: \"ctrl\",\n        controller: magnetometerController,\n        bindings: {\n            config: '=',\n            cardId: '@',\n            onChangeCardType: '&'\n        }\n    });\n\n    /** Component controller */\n    function magnetometerController($log, MAGNETOMETER, acquisitionService) {\n\n        /**------------------------------ PROPERTIES -----------------------------**/\n        var vm = this;\n        vm.logger = $log.getInstance(\"tsa-magnetometer\");\n\n        /**------------------------------- METHODS -------------------------------**/\n\n        /** Initialization function **/\n        vm.$onInit = function init() {\n            if (angular.isUndefined(this.config) || angular.isUndefined(this.config.deviceId) || angular.isUndefined(this.config.frameId)) {\n                vm.logger.error('config and/or deviceId and/or frameId not defined!');\n                return;\n            }\n\n            vm.deviceId = this.config.deviceId;\n            vm.frameId = this.config.frameId;\n            this.MAGNETOMETER = MAGNETOMETER;\n        };\n    }\n})();\n\n(function () {\n    'use strict';\n    angular.module('tsa.tsaViews.map', []).component('tsaMap', {\n        templateUrl: \"app/tsa-views/map/map.html\",\n        controllerAs: \"ctrl\",\n        controller: mapController,\n        bindings: {\n            onChangeCardType: '&',\n            cardId: '@',\n            config: '=',\n            mode: '@'\n        }\n    });\n\n    /** Navigation map controller **/\n    function mapController($log, $scope, $timeout, $interval, formatterService,\n                           $location, $mdToast, $filter, themeService, qgisService,\n                           statusService, MapServiceProvider,\n                           MAP,  GEOMOD_SERVER_ADDRESS, MAP_BACKGROUND) {\n\n        /**-------------------- PROPERTIES ----------------**/\n        var vm = this;\n        var mapService = MapServiceProvider.getInstance();\n\n        vm.logger = $log.getInstance(\"map-tsa-view\");\n\n        vm.stationIsUnvailable = false;\n        var intervalPromise;\n        vm.showLayerMenu = false;\n        vm.currentMode = MAP.MODE.NAVIGATION;\n\n        //Default settings (overridden by user config)\n        vm.routeEnabled = true;\n        vm.aisEnabled = false;\n        vm.traceEnabled = true;\n        vm.autoCenterEnabled = true;\n        vm.gridEnabled = false;\n        vm.multibeamEnabled = false;\n        vm.bottomBarEnabled = true;\n        vm.trackingEnabled = false;\n\n        vm.mapComponent = undefined;\n\n        // Change the luminosity propert\n        themeService.subscribe($scope, function (event, theme) {\n            vm.theme = theme;\n            if (vm.mapComponent !== undefined) {\n                // force a reload of the style\n                var luminosity;\n                if ( themeService.getTheme().id === themeService.THEME.NIGHT.id) {\n                    luminosity = geolayer.carto.Luminosity.NIGHT;\n                } else {\n                    luminosity = geolayer.carto.Luminosity.DAY;\n                }\n                vm.mapComponent.setLuminosity(luminosity);\n            }\n        }, true);\n\n        /* Device ID */\n        var shipnavDeviceId;\n        var waypointsDeviceId;\n        var weatherDeviceId;\n        var mobileDeviceId;\n        var lestDeviceId;\n        var aisDeviceId;\n        var frameNavId;\n        var frameMobileId;\n        var frameAisId;\n        var multibeamId;\n        var trawlingId;\n\n        /** Map properties **/\n        vm.mapId = \"map-\" + vm.cardId;\n\n        var background = geolayer.carto.BackgroundProviderType[MAP_BACKGROUND];\n        var shipSymbol = geolayer.carto.OwnShipSymbolType.ZOOM;\n\n        //Ship geometry (by default: length/width of the 'pourquoi pas')\n        var shipLength = 29.6;\n        var shipBeam = 10.6;\n        var shipXOffset = 5;\n        var shipYOffset = 15;\n        var lengthVector = 10;\n\n        /** Properties **/\n        var watchdogInterval;\n\n        //Ship movement\n        vm.latitude = undefined;\n        vm.longitude = undefined;\n        vm.heading = undefined;\n        vm.gndcourse = undefined;\n        vm.gndspeed = undefined;\n        vm.surfspeed = undefined;\n        vm.mousePositionControl = undefined;\n        vm.stringMouseLatitude = \"\";\n        vm.stringMouseLongitude = \"\";\n        vm.position = {};\n        vm.positionStation = {};\n        vm.wind = {};\n\n        //Measure tools\n        vm.measureToolList = ['Free', 'From boat', 'Disabled'];\n        vm.currentMeasureTool = vm.measureToolList[2];\n\n\n        //Station view\n        vm.stationViewScale = 1000;\n\n        vm.stationViewScaleList = [15, 30, 50, 100, 150, 250, 500, 1000, 1500, 2000, 5000, 100000];\n\n        var addQGISLayers = function () {\n            qgisService.getCapabilities().then(function (data) {\n                vm.mapComponent.addCommonLayers(data);\n            })\n                .catch(function (error) {\n                    $mdToast.show(\n                        $mdToast.simple()\n                            .textContent($filter('translate')(\"views.map.qgis.failed\"))\n                            .hideDelay(10000)\n                            .highlightClass('md-warn')\n                            .position('bottom right')\n                    );\n                });\n        };\n\n        var addBoundariesLayers = function () {\n            vm.mapComponent.addBoundariesLayer();\n        };\n        /**-------------------------- INITIALIZATION / DESTROY METHODS -------------------------**/\n\n        /* Initialisation method */\n        vm.$onInit = function init() {\n            if (angular.isUndefined(this.config) || angular.isUndefined(this.config.deviceId) || angular.isUndefined(this.config.frameId)) {\n                vm.logger.error('config and/or deviceId and/or frameId not defined!');\n                return;\n            }\n\n            vm.deviceId = this.config.deviceId;\n            frameNavId = this.config.frameId;\n            frameMobileId = this.config.frameMobileId;\n            frameAisId = this.config.frameAisId;\n            shipnavDeviceId = this.config.deviceId;\n            waypointsDeviceId = this.config.deviceId;\n            weatherDeviceId = this.config.weatherId;\n            mobileDeviceId = this.config.mobileDeviceId;\n            lestDeviceId = this.config.lestDeviceId;\n            aisDeviceId = this.config.aisDeviceId;\n            multibeamId = this.config.multibeamId;\n            trawlingId = this.config.trawlingId;\n\n            vm.currentMode = this.mode;\n\n            //Ship geometry (by default: length/width of the 'pourquoi pas')\n\n            console.log(this.config.ship);\n            \n            if (angular.isDefined(this.config.ship)) {\n                if (angular.isDefined(this.config.ship.length)) {\n                    shipLength = this.config.ship.length;\n                }\n                if (angular.isDefined(this.config.ship.beam)) {\n                    shipBeam = this.config.ship.beam;\n                }\n                if (angular.isDefined(this.config.ship.xOffset)) {\n                    shipXOffset = this.config.ship.xOffset;\n                }\n                if (angular.isDefined(this.config.ship.yOffset)) {\n                    shipYOffset = this.config.ship.yOffset;\n                }\n                if (angular.isDefined(this.config.ship.lengthVector)) {\n                    lengthVector = this.config.ship.lengthVector;\n                    mapService.setLengthVector(lengthVector);\n                }\n            }\n            else {\n                vm.logger.error('ship properties not defined!');\n            }\n\n            loadUserConfig();\n            /** Init function: launch the watchdog to check data reception **/\n            watchdogInterval = $interval(watchdog, 1000);\n\n            $timeout(initMap, 500); //initialize the map (wait the element creation)\n        };\n\n        /* Destroy function, called when the view is destroyed: closes the used resources. */\n        vm.$onDestroy = function onDestroy() {\n            if (angular.isDefined(intervalPromise))\n                $interval.cancel(intervalPromise);\n            mapService.destroyDataListener(shipnavDeviceId, waypointsDeviceId,\n                weatherDeviceId, aisDeviceId, mobileDeviceId, lestDeviceId, multibeamId);\n            $interval.cancel(watchdog);\n        };\n\n        /**-------------------- PRIVATE METHODS ----------------**/\n        /** Watch the data reception **/\n        function watchdog() {\n            var currentDate = statusService.getServerTime().time;\n            if (currentDate - mapService.getLastMobileTimestamp() > 60000){\n                mapService.clearMobileArray();\n            }\n        }\n        /** Refresh the map */\n        function renderMap() {\n\n            //Set position\n            vm.mapComponent.setOwnShipData(vm.position.latitude, vm.position.longitude,\n                vm.position.heading, vm.position.surfspeed, vm.position.gndcourse,\n                vm.position.gndspeed, vm.position.lengthVector);\n\n            //Trace\n            vm.mapComponent.setOwnShipTrace(mapService.getTraceArray());\n\n            //Multibeam\n            if (multibeamId) {\n                vm.mapComponent.setSMFData(mapService.getMultibeamArray());\n            }\n\n            //Mobile\n            if (mobileDeviceId) {\n                vm.mapComponent.setMobiles(mapService.getMobileArray());\n            }\n            //AIS\n            if (aisDeviceId) {\n                vm.mapComponent.setAIS(mapService.getAISArray());\n            }\n\n            //Wind\n            vm.mapComponent.setWindForceAndDirection(vm.wind.windSpeed, vm.wind.windHeading);\n\n            //Set waypoints depending on current mode\n            if (vm.isModeNavigation()) {\n                vm.mapComponent.setOwnShipRoute(mapService.getRoute());\n            }\n            //Station mode\n            else {\n                if (mapService.getRoute().length === 4) {\n                    vm.positionStation.latitude = mapService.getRoute()[2];\n                    vm.positionStation.longitude = mapService.getRoute()[3];\n                } else {\n                    vm.positionStation.latitude = mapService.getRoute()[0];\n                    vm.positionStation.longitude = mapService.getRoute()[1];\n                }\n                vm.mapComponent.setStationViewCenterAndScale(vm.positionStation.latitude, vm.positionStation.longitude, vm.stationViewScale);\n            }\n\n\n\n            if (vm.mapComponent !== undefined) {\n                vm.mapComponent.render();\n            }\n\n        }\n\n        /** Initialize the map **/\n        function initMap() {\n\n            var options = [];\n            options.serverAddress = GEOMOD_SERVER_ADDRESS;\n            options['OSMNightMode'] = themeService.getTheme().id.toUpperCase();\n            options['map'] = vm.mapId;\n            vm.mapComponent = new geolayer.carto.CartoComponent(options, \"resources/images\"); // Create component\n            vm.mapComponent.showStationView(vm.currentMode === MAP.MODE.STATION);\n            vm.mapComponent.setOwnShipGeometry(shipLength, shipBeam, shipXOffset, shipYOffset);\n            vm.mapComponent.setMarineBackground(background);\n            //addQGISLayers();\n\n            vm.mapComponent.setOwnShipSymbolType(shipSymbol);\n            vm.mapComponent.showSMF(vm.multibeamEnabled);\n            vm.mapComponent.showGraticule(vm.gridEnabled);\n            vm.mapComponent.setAutoCenterMode(vm.autoCenterEnabled);\n            vm.mapComponent.setShowRouteMode(vm.routeEnabled);\n            vm.mapComponent.setShowAISMode(vm.aisEnabled);\n            vm.mapComponent.setShowTraceMode(vm.traceEnabled);\n            vm.onMeasureToolChange(vm.currentMeasureTool);\n\n            vm.mapComponent.getMap().on(\"pointermove\", function(e) {\n                var coordinate = e.coordinate;\n                //var xy = ol.coordinate.toStringXY(coordinate);\n\n                var lonlat = proj.transform(coordinate,'EPSG:3857', 'EPSG:4326');\n                //Mouse\n                vm.stringMouseLatitude = formatterService.parseLatToString(lonlat[1]);\n                vm.stringMouseLongitude = formatterService.parseLongToString(lonlat[0]);\n\n\n            });\n\n            //Set Luminosity\n            var luminosity;\n            if ( themeService.getTheme().id === themeService.THEME.NIGHT.id) {\n                luminosity = geolayer.carto.Luminosity.DUSK;\n            } else {\n                luminosity = geolayer.carto.Luminosity.DAY;\n            }\n            vm.mapComponent.setLuminosity(luminosity);\n\n            // Watches the map element size and calls the 'updateSize()' openlayers\n            var mapElement = document.getElementById(vm.mapId);\n            $scope.$watch(function () {\n                return mapElement.offsetHeight;\n            }, renderMap);\n            $scope.$watch(function () {\n                return mapElement.offsetWidth;\n            }, renderMap);\n\n            mapService.setMapComponent(vm.mapComponent);\n            mapService.initDataListener(shipnavDeviceId, frameNavId, waypointsDeviceId,\n                                        multibeamId, weatherDeviceId,\n                                        aisDeviceId, frameAisId,\n                                        mobileDeviceId, lestDeviceId, frameMobileId, trawlingId\n                                        );\n            // Add QGIS layers if tracking\n            if ($location.path() === \"/tracking\") {\n                vm.trackingEnabled = true;\n                addQGISLayers();\n                addBoundariesLayers();\n            } else {\n                vm.trackingEnabled = false;\n            }\n\n            if (angular.isDefined(trawlingId)) {\n                vm.mapComponent.addTrawlingLayer();\n                mapService.getArchiveTrawling();\n            }\n            vm.position = mapService.getPosition();\n            vm.wind = mapService.getWind();\n            vm.positionStation = mapService.getPositionStation();\n\n            intervalPromise = $interval(renderMap, 1000);\n\n        }\n\n\n        /** Load user configuration from the 'config' property **/\n        function loadUserConfig() {\n            if (angular.isDefined(vm.config.routeEnabled))\n                vm.routeEnabled = vm.config.routeEnabled;\n            if (angular.isDefined(vm.config.aisEnabled))\n                vm.aisEnabled = vm.config.aisEnabled;\n            if (angular.isDefined(vm.config.traceEnabled))\n                vm.traceEnabled = vm.config.traceEnabled;\n            if (angular.isDefined(vm.config.autoCenterEnabled))\n                vm.autoCenterEnabled = vm.config.autoCenterEnabled;\n            if (angular.isDefined(vm.config.gridEnabled))\n                vm.gridEnabled = vm.config.gridEnabled;\n            if (angular.isDefined(vm.config.multibeamEnabled))\n                vm.multibeamEnabled = vm.config.multibeamEnabled;\n            if (angular.isDefined(vm.config.bottomBarEnabled))\n                vm.bottomBarEnabled = vm.config.bottomBarEnabled;\n            if (angular.isDefined(vm.config.stationViewScale))\n                vm.stationViewScale = vm.config.stationViewScale;\n        }\n\n        /**-------------------- VIEW - MODEL METHODS ----------------**/\n\n        /* Measure tools */\n        vm.onMeasureToolChange = function onMeasureToolChange(selection) {\n            vm.currentMeasureTool = selection;\n            vm.mapComponent.getMeasureTool().setActive(false);\n            vm.mapComponent.getOwnShipMeasureTool().setActive(false);\n            switch (selection) {\n                case 'Free':\n                    vm.mapComponent.getMeasureTool().setActive(true);\n                    break;\n                case 'From boat':\n                    vm.mapComponent.getOwnShipMeasureTool().setActive(true);\n                    break;\n            }\n        };\n        vm.clearMeasures = function clearMeasures() {\n            vm.mapComponent.getMeasureTool().resetTool();\n            vm.mapComponent.getOwnShipMeasureTool().resetTool();\n        };\n\n        vm.onStationViewScaleChange = function onStationViewScaleChange() {\n            if (angular.isDefined(vm.positionStation.latitude) && angular.isDefined(vm.positionStation.longitude)) {\n                vm.mapComponent.setStationViewCenterAndScale(vm.positionStation.latitude, vm.positionStation.longitude, vm.stationViewScale);\n                vm.config.stationViewScale = vm.stationViewScale;\n            }\n        };\n\n        vm.showMultibeam = function showMultibeam() {\n            vm.mapComponent.showSMF(vm.multibeamEnabled = !vm.multibeamEnabled);\n            mapService.clearMultibeamArray();\n            vm.config.multibeamEnabled = vm.multibeamEnabled;\n        };\n\n        vm.focusOnBoat = function focusOnBoat() {\n            vm.mapComponent.setAutoCenterMode(vm.autoCenterEnabled = !vm.autoCenterEnabled);\n            vm.config.autoCenterEnabled = vm.autoCenterEnabled;\n        };\n\n        vm.showRoute = function showRoute() {\n            vm.mapComponent.setShowRouteMode(vm.routeEnabled = !vm.routeEnabled);\n            vm.config.routeEnabled = vm.routeEnabled;\n        };\n\n        vm.showAIS = function showAIS() {\n            vm.mapComponent.setShowAISMode(vm.aisEnabled = !vm.aisEnabled);\n            vm.config.aisEnabled = vm.aisEnabled;\n        };\n\n        vm.showTrace = function showTrace() {\n            vm.mapComponent.setShowTraceMode(vm.traceEnabled = !vm.traceEnabled);\n            vm.config.traceEnabled = vm.traceEnabled;\n        };\n\n        vm.showGrid = function showGrid() {\n            vm.mapComponent.showGraticule(vm.gridEnabled = !vm.gridEnabled);\n            vm.config.gridEnabled = vm.gridEnabled;\n        };\n\n        vm.showBottomBar = function showBottomBar() {\n            vm.bottomBarEnabled = !vm.bottomBarEnabled;\n            vm.config.bottomBarEnabled = vm.bottomBarEnabled;\n        };\n\n        vm.toggleLayerMenu = function () {\n            vm.showLayerMenu = !vm.showLayerMenu;\n        };\n\n        vm.getCustomPointMode = function () {\n            return !vm.mapComponent ? 'readonly' : vm.mapComponent.getCustomPointMode();\n        };\n\n        vm.getCustomRouteMode = function () {\n            return !vm.mapComponent ? 'readonly' : vm.mapComponent.getCustomRouteMode();\n        };\n\n        vm.onToggleCustomPointMode = function (mode) {\n            vm.mapComponent.toggleCustomPointLayerMode(mode);\n            vm.mapComponent.toggleCustomRouteLayerMode('readonly');\n        };\n\n        vm.onToggleCustomRouteMode = function (mode) {\n            vm.mapComponent.toggleCustomRouteLayerMode(mode);\n            vm.mapComponent.toggleCustomPointLayerMode('readonly');\n        };\n\n        vm.isModeNavigation = function () {\n            return vm.currentMode === MAP.MODE.NAVIGATION;\n        };\n\n    }\n\n})();\n\n(function () {\n    'use strict';\n    angular.module('tsa.tsaViews.map').constant(\"MAP\", {\n        MODE: {NAVIGATION: 'navigation', STATION: 'station'}\n    });\n    angular.module('tsa.tsaViews.map').factory(\"MapServiceProvider\", MapServiceProvider);\n\n    function MapServiceProvider($interval, $log, acquisitionService, formatterService,\n                                statusService, archiveService, restService,\n                                MAP, WAYPOINTS, NAVIGATION, MULTIBEAM, WEATHER, MOBILE, AIS, TRAWLING) {\n\n        var mapService = function () {\n            var logger = $log.getInstance(\"MapService\");\n\n            var vm = this;\n\n            /** Data listeners **/\n            var shipnavFrameListener;\n            var aisFrameListener;\n            var mobileFrameListener;\n            var lestFrameListener;\n            var multibeamFrameListener;\n            var waypointsFrameListener;\n            var trawlingFrameListener;\n            var trueWindSpeedListener;\n            var trueWindHeadingListener;\n            var traceIndex = 0;\n            var traceIndexTrawling = 0;\n            var traceRT = [];\n            //Ship trace\n            var coordinateHistoric = [];\n            vm.componentNumber = 0;\n\n            vm.lengthVector = 15;\n            vm.stationInit = true;\n            vm.route = [];\n            vm.traceArray = [];\n\n            vm.position = {\n                latitude: undefined,\n                longitude: undefined,\n                heading: undefined,\n                gndcourse: undefined,\n                gndspeed: undefined,\n                surfspeed: undefined,\n                stringLatitude: undefined,\n                stringLongitude: undefined\n            };\n            vm.positionStation = {\n                latitude: undefined,\n                longitude: undefined\n            };\n            vm.wind = {\n                windSpeed: 0,\n                windHeading: 0\n            };\n            vm.AISArray = [];\n            vm.mobileArray = [];\n            vm.lastMobileTimestamp;\n\n            /** Called when a Shipnav frame has been received **/\n            function parseShipnavFrame(receivedFrame) {\n                var timestamp = receivedFrame.timestamp;\n                vm.position.latitude = parseFloat(receivedFrame.value[NAVIGATION.LATITUDE]);\n                vm.position.longitude = parseFloat(receivedFrame.value[NAVIGATION.LONGITUDE]);\n                vm.position.heading = parseFloat(receivedFrame.value[NAVIGATION.HEADING]);\n                vm.position.gndcourse = parseFloat(receivedFrame.value[NAVIGATION.GROUND_COURSE]);\n                vm.position.gndspeed = parseFloat(receivedFrame.value[NAVIGATION.GROUND_SPEED]).toFixed(2);\n                vm.position.surfspeed = parseFloat(receivedFrame.value[NAVIGATION.SURFACE_SPEED]);\n\n                vm.position.stringLatitude = formatterService.parseLatToString(vm.position.latitude);\n                vm.position.stringLongitude = formatterService.parseLongToString(vm.position.longitude);\n\n                // Simulate mobile\n                //vm.mobileArray[0] = [vm.position.latitude, vm.position.longitude + 0.001, vm.position.heading+90, geolayer.carto.MobileType.MOBILE, geolayer.carto.MobileStatus.ALIVE];\n\n                if (vm.position.longitude !== undefined && vm.position.latitude !== undefined) {\n\n                    //Ship trace (add 1 point every 60 frames)\n                    traceIndex++;\n                    if (traceIndex === 60) {\n                        coordinateHistoric.push({\n                            latitude: vm.position.latitude,\n                            longitude: vm.position.longitude,\n                            timestamp: timestamp\n                        });\n                        if (coordinateHistoric.length > 500) {\n                            coordinateHistoric = coordinateHistoric.slice(1);  //Remove the too old coordinates\n                        }\n                        vm.traceArray = [];\n                        angular.forEach(coordinateHistoric, function (coordinate, key) {\n                            vm.traceArray.push(coordinate.latitude, coordinate.longitude);\n                        }, this);\n                        traceIndex = 0;\n                    }\n                }\n            }\n\n            //multibeam\n            vm.multibeamArray = [];\n\n            function addMultibeamData(latitude, longitude, heading, sXOffset, sYOffset, pXOffset, pYOffset) {\n                if (vm.multibeamArray.length > 99)\n                    vm.multibeamArray = vm.multibeamArray.slice(1);\n                vm.multibeamArray.push([latitude, longitude, heading, sXOffset, sYOffset, pXOffset, pYOffset]);\n            }\n\n            function parseMultibeam(receivedFrame) {\n                var alongDistance = [];\n                var acrossDistance = [];\n                alongDistance = receivedFrame.value[MULTIBEAM.ALONG].map(parseFloat);\n                acrossDistance = receivedFrame.value[MULTIBEAM.ACROSS].map(parseFloat);\n\n                var sAccross = 0;\n                var sAlong = 0;\n                var pAccross = 0;\n                var pAlong = 0;\n                for (var i = 0; i < acrossDistance.length; i++) {\n                    if (sAccross > acrossDistance[i]) {\n                        sAccross = acrossDistance[i];\n                        sAlong = alongDistance[i];\n                    }\n                    if (pAccross < acrossDistance[i]) {\n                        pAccross = acrossDistance[i];\n                        pAlong = alongDistance[i];\n                    }\n                }\n\n                addMultibeamData(vm.position.latitude, vm.position.longitude, vm.position.heading,\n                    -sAccross, -sAlong, pAccross, pAlong);\n\n            }\n\n            /** Called when a waypoint frame has been received */\n            // Clear route array\n\n            function parseTrawling(receivedFrame) {\n\n                if (receivedFrame.value[TRAWLING.COMMENT][0] === 'start') {\n                    var data = {\n                        Latitude: vm.position.latitude,\n                        Longitude: vm.position.longitude,\n                        ActionCode: \"DEBTR\",\n                        Field1: \"start\",\n                        Field2: \"\"\n                    };\n                    vm.mapComponent.addTrawlingFeature(data);\n                    vm.mapComponent.addPointToTraceRT([vm.position.latitude, vm.position.longitude]);\n                } else if (receivedFrame.value[TRAWLING.COMMENT][0] === \"trawling\") {\n                    //Ship trace (add 1 point every 60 frames)\n                    if (traceIndexTrawling === 0) {\n                        vm.mapComponent.addPointToTraceRT([vm.position.latitude, vm.position.longitude]);\n                        traceIndexTrawling = 19;\n                    }\n                    traceIndexTrawling--;\n                } else if (receivedFrame.value[TRAWLING.COMMENT][0] === 'stop') {\n                    var data = {\n                        Latitude: vm.position.latitude,\n                        Longitude: vm.position.longitude,\n                        ActionCode: \"FINTR\",\n                        Field1: \"end\",\n                        Field2: \"\"\n                    };\n                    vm.mapComponent.addTrawlingFeature(data);\n                    vm.mapComponent.addPointToTraceRT([vm.position.latitude, vm.position.longitude]);\n                    vm.mapComponent.clearTraceRT();\n                }\n            }\n\n\n            function parseWaypoints(receivedFrame) {\n                var wptsLat = receivedFrame.value[WAYPOINTS.LATITUDE].map(parseFloat);\n                var wptsLon = receivedFrame.value[WAYPOINTS.LONGITUDE].map(parseFloat);\n\n                vm.route = [];\n                for (var index = 0; index < wptsLat.length; index++) {\n                    vm.route.push(wptsLat[index], wptsLon[index]);\n                }\n            }\n\n            /** Called when a mobile frame has been received (in navigation mode) */\n            function parseMobileFrame(receivedFrame) {\n                vm.lastMobileTimestamp = statusService.getServerTime().time;\n                var mobileLat = parseFloat(receivedFrame.value[MOBILE.LATITUDE]);\n                var mobileLon = parseFloat(receivedFrame.value[MOBILE.LONGITUDE]);\n                var mobileHeading = 0;\n                vm.mobileArray[0] = [mobileLat, mobileLon, mobileHeading + 90, geolayer.carto.MobileType.MOBILE, geolayer.carto.MobileStatus.ALIVE];\n            }\n\n            function parseLestFrame(receivedFrame) {\n                vm.lastMobileTimestamp = statusService.getServerTime().time;\n                var mobileLat = parseFloat(receivedFrame.value[MOBILE.LATITUDE]);\n                var mobileLon = parseFloat(receivedFrame.value[MOBILE.LONGITUDE]);\n                var mobileHeading = 0;\n                vm.mobileArray[1] = [mobileLat, mobileLon, mobileHeading + 90, geolayer.carto.MobileType.LEST, geolayer.carto.MobileStatus.ALIVE];\n            }\n\n            /** Called when a waypoint frame has been received (in navigation mode) */\n            function parseAisFrame(receivedFrame) {\n                var mobileLat = parseFloat(receivedFrame.value[AIS.LATITUDE]);\n                var mobileLon = parseFloat(receivedFrame.value[AIS.LONGITUDE]);\n                var mobileHeading = parseFloat(receivedFrame.value[AIS.HEAD]);\n                var mobile_MMSI = parseFloat(receivedFrame.value[AIS.MMSI]);\n                var now = new Date().getTime();\n\n                var found = false;\n\n                var i = 0;\n                var value;\n                for (i = 0; i < vm.AISArray.length; i++) {\n                    value = vm.AISArray[i];\n                    if (found === false) {\n                        if (value[1] === mobile_MMSI) {\n                            vm.AISArray[i] = [now, mobile_MMSI, mobileLat, mobileLon, mobileHeading, geolayer.carto.MobileType.AIS, geolayer.carto.MobileStatus.ALIVE];\n                            found = true;\n                        }\n                    }\n                }\n                if (found === false) {\n                    vm.AISArray[vm.AISArray.length] = [now, mobile_MMSI, mobileLat, mobileLon, mobileHeading, geolayer.carto.MobileType.AIS, geolayer.carto.MobileStatus.ALIVE];\n                }\n\n                // Remove old data from mobileMap (10 min)\n                for (i = 0; i < vm.AISArray.length; i++) {\n                    value = vm.AISArray[i];\n                    if (value[1] === mobile_MMSI) {\n                        var millisec_diff = now - value[0];\n                        // If no update for more than 5min remove mobile\n                        if (millisec_diff > 5 * 60 * 1000) {\n                            vm.AISArray.splice(i, 1)\n                        }\n                    }\n                }\n            }\n\n            return {\n                clearMultibeamArray: function () {\n                    vm.multibeamArray = [];\n                },\n                setLengthVector: function (lengthVector) {\n                    vm.lengthVector = lengthVector;\n                },\n                setMapComponent: function (mapComponent) {\n                    vm.mapComponent = mapComponent;\n                },\n                getMapComponent: function () {\n                    return vm.mapComponent;\n                },\n                clearAISArray: function () {\n                    vm.AISArray = [];\n                },\n                getAISArray: function () {\n                    return vm.AISArray;\n                },\n                clearMobileArray: function () {\n                    vm.mobileArray = [];\n                },\n                getMobileArray: function () {\n                    return vm.mobileArray;\n                },\n                getMultibeamArray: function () {\n                    return vm.multibeamArray;\n                },\n                getPosition: function () {\n                    return vm.position;\n                },\n                getPositionStation: function () {\n                    return vm.positionStation;\n                },\n                getRoute: function () {\n                    return vm.route;\n                },\n                getLastMobileTimestamp: function () {\n                    return vm.lastMobileTimestamp;\n                },\n                getTraceArray: function () {\n                    return vm.traceArray;\n                },\n                getWind: function () {\n                    return vm.wind;\n                },\n\n                getArchiveTrawling: function() {\n                    var startDate = statusService.getServerTime().time - 86400 * 1000;\n                    var endDate = statusService.getServerTime().time;\n                    var date = new Date(startDate);\n                    var startdatestring = date.getFullYear() + \"-\" + (date.getMonth() + 1) + \"-\" + date.getDate() + \"-\" +\n                        date.getHours() + \":\" + date.getMinutes() + \":\" + date.getSeconds();\n                    var date = new Date(endDate);\n                    var enddatestring = date.getFullYear() + \"-\" + (date.getMonth() + 1) + \"-\" + date.getDate() + \"-\" +\n                        date.getHours() + \":\" + date.getMinutes() + \":\" + date.getSeconds();\n\n                    var period = 1000;\n\n                    var frameId = \"trawling\";\n                    var deviceId = \"EU_TRAWLING\";\n                    var variableList = [new archiveService.Variable(\"lat\", frameId, deviceId),\n                        new archiveService.Variable(\"long\", frameId, deviceId),\n                        new archiveService.Variable(\"comment\", frameId, deviceId)];\n                    var resultPromise = restService.getArchiveAllData(\"EU_TRAWLING\", startdatestring, enddatestring);\n\n                    resultPromise.then(\n                        function successCallback(result) {\n                            var data = {};\n                            var trace = [];\n                            var start = false;\n                            var stop = false;\n                            var trawling = false;\n                            var latitude;\n                            var longitude;\n                            angular.forEach(result.data, function (value) {\n                                angular.forEach(value.data, function (res) {\n                                    if (res.name === \"lat\" && res.samples[0] !== undefined) {\n                                        latitude = parseFloat(res.samples[0]);\n                                    } else if (res.name === \"long\" && res.samples[0] !== undefined) {\n                                        longitude = parseFloat(res.samples[0]);\n                                    } else if (res.name === \"comment\" &&\n                                        res.samples[0] === \"start\") {\n                                        start = true;\n                                    } else if (res.name === \"comment\" &&\n                                        res.samples[0] === \"stop\") {\n                                        stop = true;\n                                    } else if (res.name === \"comment\" &&\n                                        res.samples[0] === \"trawling\") {\n                                        trawling = true;\n                                    }\n                                });\n                                if (start) {\n                                    data = {\n                                        Latitude: latitude,\n                                        Longitude: longitude,\n                                        ActionCode: \"DEBTR\",\n                                        Field1: \"start\",\n                                        Field2: \"\"\n                                    };\n                                    vm.mapComponent.addTrawlingFeature(data);\n                                    start = false;\n                                }\n                                if (stop) {\n                                    data = {\n                                        Latitude: latitude,\n                                        Longitude: longitude,\n                                        ActionCode: \"FINTR\",\n                                        Field1: \"end\",\n                                        Field2: \"\"\n                                    };\n                                    vm.mapComponent.addTrawlingFeature(data);\n                                    stop = false;\n                                    vm.mapComponent.addTrawlingTrace(trace);\n                                    trace = [];\n                                }\n                                if (trawling) {\n                                    trace.push(latitude);\n                                    trace.push(longitude);\n                                    trawling = false;\n                                }\n                            });\n                        });\n                },\n\n                /** Initialize the data listeners (subscriptions to the acquisition service...) **/\n                initDataListener: function initDataListener(shipnavDeviceId, frameNavId, waypointsDeviceId,\n                                                            multibeamId, weatherDeviceId,\n                                                            aisDeviceId, frameAisId,\n                                                            mobileDeviceId, lestDeviceId, frameMobileId,\n                                                            trawlingId) {\n\n                    vm.lastMobileTimestamp = statusService.getServerTime().time;\n\n                    if (vm.componentNumber === 0) {\n                        //1 - Shipnav frame listener\n                        shipnavFrameListener = acquisitionService.registerForDevice(shipnavDeviceId).registerForFrame(frameNavId);\n                        shipnavFrameListener.promise.then({}, {}, parseShipnavFrame);\n\n                        //2 - Waypoints frame listener\n                        waypointsFrameListener = acquisitionService.registerForDevice(waypointsDeviceId).registerForFrame(WAYPOINTS.FRAME);\n                        waypointsFrameListener.promise.then({}, {}, parseWaypoints);\n\n                        //2 - Multibeam frame listener\n                        multibeamFrameListener = acquisitionService.registerForDevice(multibeamId).registerForFrame(MULTIBEAM.FRAME);\n                        multibeamFrameListener.promise.then({}, {}, parseMultibeam);\n\n                        //2 - Trawling frame listener\n                        if (angular.isDefined(trawlingId)) {\n                            trawlingFrameListener = acquisitionService.registerForDevice(trawlingId).registerForFrame(TRAWLING.FRAME);\n                            trawlingFrameListener.promise.then({}, {}, parseTrawling);\n                        }\n                        //3 - Wind data listener\n                        if (angular.isDefined(weatherDeviceId)) {\n\n                            //Wind\n                            var windHeading;\n                            var windSpeed;\n                            var weatherDevice = acquisitionService.registerForDevice(weatherDeviceId);\n                            trueWindSpeedListener = weatherDevice.registerForData(WEATHER.FRAME, WEATHER.TRUE_AIR_SPEED);\n                            trueWindSpeedListener.promise.then({}, {}, function (data) {\n                                windSpeed = sprintf('%d', data.value);\n                                vm.wind.windSpeed = windSpeed;\n                            });\n                            trueWindHeadingListener = weatherDevice.registerForData(WEATHER.FRAME, WEATHER.TRUE_AIR_HEADING);\n                            trueWindHeadingListener.promise.then({}, {}, function (data) {\n                                windHeading = sprintf('%d', data.value);\n                                vm.wind.windHeading = windHeading;\n                            });\n                        }\n                        if (angular.isDefined(aisDeviceId)) {\n                            aisFrameListener = acquisitionService.registerForDevice(aisDeviceId).registerForFrame(frameAisId);\n                            aisFrameListener.promise.then({}, {}, parseAisFrame);\n                        }\n                        if (angular.isDefined(mobileDeviceId)) {\n                            mobileFrameListener = acquisitionService.registerForDevice(mobileDeviceId).registerForFrame(frameMobileId);\n                            mobileFrameListener.promise.then({}, {}, parseMobileFrame);\n                        }\n                        if (angular.isDefined(lestDeviceId)) {\n                            lestFrameListener = acquisitionService.registerForDevice(lestDeviceId).registerForFrame(frameMobileId);\n                            lestFrameListener.promise.then({}, {}, parseLestFrame);\n                        }\n                    } else {\n                        vm.componentNumber++;\n                    }\n                },\n\n                destroyDataListener: function destroyDataListener(shipnavDeviceId, waypointsDeviceId, weatherDeviceId,\n                                                                  aisDeviceId, mobileDeviceId, lestDeviceId, multibeamId) {\n                    if (vm.componentNumber === 0) {\n                        if (shipnavFrameListener !== undefined)\n                            acquisitionService.registerForDevice(shipnavDeviceId).unregisterForFrame(shipnavFrameListener);\n                        if (waypointsFrameListener !== undefined)\n                            acquisitionService.registerForDevice(waypointsDeviceId).unregisterForFrame(waypointsFrameListener);\n                        if (trueWindSpeedListener !== undefined)\n                            acquisitionService.registerForDevice(weatherDeviceId).unregisterForData(trueWindSpeedListener);\n                        if (trueWindHeadingListener !== undefined)\n                            acquisitionService.registerForDevice(weatherDeviceId).unregisterForData(trueWindHeadingListener);\n                        if (aisFrameListener !== undefined)\n                            acquisitionService.registerForDevice(aisDeviceId).unregisterForData(aisFrameListener);\n                        if (mobileFrameListener !== undefined)\n                            acquisitionService.registerForDevice(mobileDeviceId).unregisterForData(mobileFrameListener);\n                        if (lestFrameListener !== undefined)\n                            acquisitionService.registerForDevice(lestDeviceId).unregisterForData(lestFrameListener);\n                        if (multibeamFrameListener !== undefined)\n                            acquisitionService.registerForDevice(multibeamId).unregisterForData(multibeamFrameListener);\n                        var customRouteFileInput = document.querySelector('#custom-route-file');\n                        if (customRouteFileInput) {\n                            customRouteFileInput.removeEventListener('change', vm.onUploadRoutes);\n                        }\n                    }\n                }\n\n            };\n        };\n        return {\n            getInstance: function () {\n                return new mapService();\n            }\n        };\n    }\n})();\n\n(function () {\n  'use strict';\n\n  /** Component declaration **/\n  angular.module('tsa.tsaViews.mapSidemenu', []).component('tsaMapSidemenu', {\n    templateUrl: \"app/tsa-views/map-sidemenu/map-sidemenu.html\",\n    controllerAs: \"ctrl\",\n    controller: mapSidemenuController,\n    bindings: {\n      mapComponent: '='\n    }\n  });\n\n  /** Component controller */\n  function mapSidemenuController($log, $scope, $rootScope, $mdDialog, casinoService, $q, qgisService, userService) {\n\n    /* =====================================================================================\n     * PROPERTIES\n     * =====================================================================================\n     */\n    var vm = this;\n    vm.logger = $log.getInstance(\"GPS-tsa-view\");\n    vm.selectedLayer = null;\n    vm.backdrop = null;\n    vm.contextualOptionMenu = null;\n    vm.opacity = 1;\n    vm.layer = null;\n    vm.background = geolayer.carto.BackgroundProviderType.OPENSEAMAP;\n\n\n    /* =====================================================================================\n     * PRIVATE FUNCTION\n     * =====================================================================================\n     */\n\n    vm.openCustomPointCreatedDialog = function (e) {\n      $scope.customPointForm.$setPristine();\n      $scope.customPointForm.$setUntouched();\n      vm.currentPointEdit = null;\n\n      if (typeof (e) !== 'undefined') {\n        var coordinates = vm.mapComponent.transform(e.detail.feature.getGeometry().getCoordinates(), 'EPSG:3857', 'EPSG:4326');\n        vm.currentCustomPoint = {\n          feature: e.detail.feature,\n          coordinates: coordinates,\n          new: true,\n          label: e.detail.feature.getProperties().name,\n          edited: e.detail.feature.getProperties().name ? true : false\n        };\n      }\n\n      $mdDialog.show({\n        contentElement: '#custom-points-create-dialog',\n        parent: angular.element(document.querySelector('tsa-map')),\n        clickOutsideToClose: false\n      });\n    };\n\n    function openCustomPointEditDialog(e) {\n      var coordinates = vm.mapComponent.transform(e.detail.feature.getGeometry().getCoordinates(), 'EPSG:3857', 'EPSG:4326');\n      vm.currentCustomPoint = {\n        feature: e.detail.feature,\n        coordinates: coordinates,\n        label: e.detail.feature.getProperties().name,\n        edited: e.detail.feature.getProperties().name ? true : false\n      };\n\n      var positions = vm.mapComponent.getMap().getPixelFromCoordinate(e.detail.feature.getGeometry().getCoordinates());\n      vm.currentPointEdit = {\n        left: '' + parseInt(positions[0]) + 382 + 'px',\n        top: '' + (parseInt(positions[1])) + 'px'\n      };\n    }\n\n\n    vm.openCustomRouteDialog = function () {\n      $mdDialog.show({\n        contentElement: '#custom-routes-edit-dialog',\n        parent: angular.element(document.querySelector('tsa-map')),\n        clickOutsideToClose: true\n      });\n      vm.currentRouteEdit = null;\n    };\n\n    function openCustomRouteEditDialog(e) {\n      var coordinates = vm.mapComponent.transform(e.detail.coordinate, 'EPSG:3857', 'EPSG:4326');\n\n      vm.currentCustomRoute = {\n        feature: e.detail.feature,\n        coordinates: coordinates\n      };\n\n      var positions = vm.mapComponent.getMap().getPixelFromCoordinate(e.detail.coordinate);\n      vm.currentRouteEdit = {\n        left: '' + (parseInt(positions[0]) + 382) + 'px',\n        top: '' + (parseInt(positions[1])) + 'px'\n      };\n    }\n\n    function checkUserConnection() {\n      vm.isConnected = userService.getCurrentUser() !== undefined;\n    }\n\n    function pushQGISProject(reader) {\n      return function () {\n        qgisService.pushQGISProject(reader.result)\n          .then(function (data) { $mdDialog.hide(); vm.currentPointEdit = null; })\n          .catch(function (error) { console.log(\"zajegazezae\" + error); });\n      };\n    }\n\n    /* =====================================================================================\n     * PUBLIC FUNCTION\n     * =====================================================================================\n     */\n\n    vm.$onInit = function () {\n      checkUserConnection();\n      $scope.saveUploadPoint = true;\n      $scope.saveUploadRoute = true;\n      $scope.$watch(function () { return vm.mapComponent; }, function (newVal) {\n        if (newVal) {\n          vm.mapComponent = newVal;\n          vm.mapComponent.onCustomPointCreated(vm.openCustomPointCreatedDialog);\n          vm.mapComponent.onCustomPointContextMenu(openCustomPointEditDialog);\n          vm.mapComponent.onCustomPointHover(onCustomPointHover);\n        }\n      });\n      $rootScope.$on('current-user-changed', function () { checkUserConnection(); });\n      document.querySelector('tsa-map').addEventListener('click', function (e) {\n        if (!document.getElementById('custom-points-edit-dialog').contains(e.target)) {\n          vm.currentPointEdit = null;\n          vm.currentRouteEdit = null;\n        }\n      });\n    };\n\n    vm.$postLink = function () {\n      // Add event listener on change to file input because ng-change does not support file upload control\n      // cf. : https://stackoverflow.com/questions/17922557/angularjs-how-to-check-for-changes-in-file-input-fields\n      var customRouteFileInput = document.querySelector('#custom-route-file');\n      if (customRouteFileInput) {\n        customRouteFileInput.addEventListener('change', vm.enableUploadRoutes);\n      }\n      var customPointFileInput = document.querySelector('#custom-point-file');\n      if (customPointFileInput) {\n        customPointFileInput.addEventListener('change', vm.enableUploadPointSave);\n      }\n      var qgisUploadProjectFileInput = document.querySelector('#qgis-upload-project');\n      if (qgisUploadProjectFileInput) {\n        qgisUploadProjectFileInput.addEventListener('change', vm.enableUploadQGISFile);\n      }\n    };\n\n    vm.getTreeLayer = function () {\n      if (vm.mapComponent && vm.mapComponent.treeLayers) {\n        return vm.mapComponent.treeLayers.branches;\n      }\n      return [];\n    };\n\n    vm.isBranchIsIndeterminate = function (branch) {\n      if (branch.hadChild()) {\n        var checkedChild = branch.getChildren().filter(function (child) { return !child.getVisible(); });\n        return checkedChild.length !== 0 && checkedChild.length !== branch.getChildren().length;\n\n      }\n      return false;\n    };\n\n    vm.openMenu = function ($mdMenu, ev, layer) {\n      vm.layer = layer;\n      vm.opacity = vm.layer.getOpacity();\n      $mdMenu.open(ev);\n    };\n\n    vm.setLayerOpacity = function () {\n      vm.layer.setOpacity(parseFloat(vm.opacity));\n    };\n\n    vm.toggleMapBackground = function () {\n      vm.mapComponent.setMarineBackground(vm.background);\n    };\n\n    vm.getBackgroundLayer = function () {\n      if (vm.mapComponent && vm.mapComponent.getBackgroundLayerGroup) {\n        return vm.mapComponent.getBackgroundLayerGroup();\n      }\n      return null;\n    };\n\n    /* --------------------------------------------------------------\n     * Custom routes\n     * --------------------------------------------------------------\n     */\n    vm.onToggleCustomRouteMode = function () {\n      var mode = vm.mapComponent.getCustomRouteMode() == 'edit' ? 'readonly' : 'edit';\n      vm.mapComponent.toggleCustomRouteLayerMode(mode);\n      vm.mapComponent.toggleCustomPointLayerMode('readonly');\n    };\n\n    vm.openUploadRouteDialog = function (ev) {\n      $mdDialog.show({\n        contentElement: '#custom-routes-upload-dialog',\n        parent: angular.element(document.querySelector('tsa-map')),\n        targetEvent: ev,\n        clickOutsideToClose: true\n      });\n    };\n\n    vm.closeRouteDialog = function () {\n      $mdDialog.hide();\n      vm.customRouteEdit = null;\n      vm.currentCustomRoute = null;\n    };\n\n    vm.enableUploadRoutes = function (event) {\n      $scope.saveUploadRoute = false;\n      $scope.customRouteFile = event.target.files;\n    };\n\n    vm.cancelImportRoutes = function () {\n      $mdDialog.hide();\n      $scope.saveUploadRoute = true;\n      angular.element(\"#custom-route-file\").val(null);\n    };\n\n    vm.onUploadRoutes = function () {\n      var files = $scope.customRouteFile; // FileList object\n      if (files && files.length !== 0) {\n        for (var i = 0; i < files.length; i++) {\n          vm.mapComponent.importCustomRoute(files[i]);\n        }\n        $mdDialog.hide();\n        angular.element(\"#custom-route-file\").val(null);\n      }\n    };\n\n    vm.onRemoveAllCustomRoutes = function () {\n      vm.mapComponent.removeAllCustomRoutes();\n    };\n\n    vm.onExportRoutes = function (format) {\n      var exportString = vm.mapComponent.exportCustomRoutes(format);\n      document.querySelector('#custom-routes-export-' + format).href = 'data:text/csv;base64,' + btoa(exportString);\n    };\n\n    vm.getCustomRouteMode = function () {\n      return !vm.mapComponent ? 'readonly' : vm.mapComponent.getCustomRouteMode();\n    };\n\n    vm.saveCustomRoute = function () {\n      vm.mapComponent.updateSelectedRouteCoordinate(vm.currentCustomRoute.coordinates);\n      $mdDialog.hide();\n      vm.currentPointEdit = null;\n    };\n\n    vm.deleteCustomRoute = function () {\n      vm.currentRouteEdit = null;\n      vm.mapComponent.removeCustomRoute(vm.currentCustomRoute.feature);\n      $mdDialog.hide();\n    };\n\n\n    /* --------------------------------------------------------------\n     * Custom points\n     * --------------------------------------------------------------\n     */\n    vm.onToggleCustomPointMode = function () {\n      var mode = vm.mapComponent.getCustomPointMode() == 'edit' ? 'readonly' : 'edit';\n      vm.mapComponent.toggleCustomPointLayerMode(mode);\n      vm.mapComponent.toggleCustomRouteLayerMode('readonly');\n    };\n\n    vm.openUploadPointDialog = function (ev) {\n      $mdDialog.show({\n        contentElement: '#custom-points-upload-dialog',\n        parent: angular.element(document.querySelector('tsa-map')),\n        targetEvent: ev,\n        clickOutsideToClose: true\n      });\n    };\n\n    vm.closePointDialog = function () {\n      if (vm.currentCustomPoint.new) {\n        vm.mapComponent.removeCustomPoint(vm.currentCustomPoint.feature);\n      }\n      $mdDialog.hide();\n      vm.currentPointEdit = null;\n      vm.currentCustomPoint = null;\n    };\n\n    vm.onUploadPoints = function () {\n      var files = $scope.customPointFile; // FileList objec\n      if (files && files.length !== 0) {\n        for (var i = 0; i < files.length; i++) {\n          vm.mapComponent.importCustomPoint(files[i]);\n        }\n        $mdDialog.hide();\n        angular.element(\"#custom-point-file\").val(null);\n      }\n    };\n\n    vm.enableUploadPointSave = function (event) {\n      $scope.saveUploadPoint = false;\n      $scope.customPointFile = event.target.files;\n    };\n\n\n    vm.onRemoveAllCustomPoints = function () {\n      vm.currentPointEdit = null;\n      vm.mapComponent.removeAllCustomPoints();\n    };\n\n    vm.toggleCustomPointLabel = function () {\n      vm.mapComponent.setCustomPointShowLabel(!vm.mapComponent.getCustomPointShowLabel());\n    };\n\n    vm.getCustomPointLabelState = function () {\n      return vm.mapComponent ? vm.mapComponent.getCustomPointShowLabel() : false;\n    };\n\n    vm.onExportPoints = function (format) {\n      var exportString = vm.mapComponent.exportCustomPoint(format);\n      document.querySelector('#custom-points-export-' + format).href = 'data:text/csv;base64,' + btoa(exportString);\n    };\n\n    vm.cancelImportPoint = function () {\n      $mdDialog.hide();\n      $scope.saveUploadPoint = true;\n      angular.element(\"#custom-point-file\").val(null);\n    };\n\n    vm.getCustomPointMode = function () {\n      return !vm.mapComponent ? 'readonly' : vm.mapComponent.getCustomPointMode();\n    };\n\n    vm.saveCustomPoint = function () {\n      var coordinates = vm.mapComponent.transform(vm.currentCustomPoint.coordinates, 'EPSG:4326', 'EPSG:3857');\n      vm.currentCustomPoint.feature.getGeometry().setCoordinates(coordinates);\n      vm.currentCustomPoint.feature.setProperties({ name: vm.currentCustomPoint.label });\n      $mdDialog.hide();\n      vm.currentPointEdit = null;\n      vm.mapComponent.setCustomPointShowLabel(vm.mapComponent.getCustomPointShowLabel());\n    };\n\n    vm.deleteCustomPoint = function () {\n      vm.currentPointEdit = null;\n      vm.mapComponent.removeCustomPoint(vm.currentCustomPoint.feature);\n      $mdDialog.hide();\n    };\n\n    function onCustomPointHover(e) {\n      if (document.querySelector('.custom-point-hover')) {\n        var pointsHover = document.getElementsByClassName('custom-point-hover');\n        while (pointsHover.length > 0) {\n          pointsHover[0].parentNode.removeChild(pointsHover[0]);\n        }\n      }\n\n      if ((e.detail.features.length > 0 && e.detail.showLabel) || (!e.detail.showLabel && e.detail.features.length === 1)) {\n        e.detail.features.forEach(function (feat) {\n          if (feat.properties.geometry && feat.id && feat.properties.name) {\n            var positions = vm.mapComponent.getMap().getPixelFromCoordinate(feat.properties.geometry.getCoordinates());\n\n            if (positions.length) {\n\n              var contentPointHover = document.createElement('div');\n              contentPointHover.id = feat.id;\n              contentPointHover.classList.add('custom-point-hover');\n              contentPointHover.style.position = 'absolute';\n              contentPointHover.style.top = '' + positions[1] + 'px';\n              contentPointHover.innerHTML = '' + feat.properties.name;\n\n              document.querySelector('tsa-map').appendChild(contentPointHover);\n              var widthContent = contentPointHover.offsetWidth / 2;\n              contentPointHover.style.left = '' + (positions[0] + 381.5 - widthContent) + 'px';\n\n            }\n          }\n        });\n      }\n    }\n\n\n\n    /* --------------------------------------------------------------\n     * Casino\n     * --------------------------------------------------------------\n     */\n    vm.onOpenCasinoDialog = function (ev) {\n      vm.casinoState = 'init';\n      vm.casinoLoading = false;\n      vm.casinoErrorLoad = false;\n      vm.cruises = [];\n      vm.selectedCruises = [];\n      vm.devices = [];\n      vm.selectedDevices = [];\n      vm.casinoConnectionParams = { url: 'localhost:3306', login: 'root', password: 'admin' };\n      // vm.casinoConnectionParams = { url: null, login: null, password: null };\n      $mdDialog.show({\n        contentElement: '#casino-dialog',\n        parent: angular.element(document.querySelector('tsa-map')),\n        targetEvent: ev,\n        clickOutsideToClose: true\n      });\n    };\n\n    vm.casinoConnection = function () {\n      vm.casinoLoading = true;\n      casinoService.connect(vm.casinoConnectionParams.url, vm.casinoConnectionParams.login, vm.casinoConnectionParams.password)\n        .then(function () {\n          return casinoService.getCruises();\n        })\n        .then(function (cruises) {\n          vm.casinoErrorLoad = false;\n          vm.casinoState = 'cruises';\n          vm.casinoLoading = false;\n          vm.cruises = cruises;\n        })\n        .catch(function () {\n          vm.casinoErrorLoad = true;\n          vm.casinoLoading = false;\n        });\n    };\n\n    vm.casinoCanConnect = function () {\n      return !vm.casinoConnectionParams ||\n        !vm.casinoConnectionParams.url.trim() ||\n        !vm.casinoConnectionParams.login.trim() ||\n        !vm.casinoConnectionParams.password.trim() ||\n        vm.casinoLoading;\n    };\n\n    vm.onChangeCruise = function (cruise, selected) {\n      if (cruise.selected) {\n        vm.selectedCruises.push(cruise.FullName);\n      } else {\n        vm.selectedCruises = vm.selectedCruises.filter(function (c) { return c !== cruise.FullName; });\n      }\n    };\n\n    vm.casinoSelectCruises = function () {\n      casinoService.setSelectCruises(vm.selectedCruises);\n      vm.casinoErrorLoad = false;\n      casinoService.getCasinoDevices(true, ['FFIL', 'DVIR', 'DEBTR', 'FINTR'])\n        .then(function (devices) {\n          vm.casinoLoading = false;\n          vm.devices = devices;\n          vm.casinoState = 'devices';\n        })\n        .catch(function () {\n          vm.casinoLoading = false;\n          vm.casinoErrorLoad = true;\n        });\n    };\n\n    vm.onChangeDevices = function (device) {\n      if (device.selected) {\n        var sd = { name: device.DeviceName, code: device.DeviceCode, actions: [] };\n        device.actions.map(function (action) {\n          sd.actions.push({ name: action.ActionName, code: action.ActionCode });\n          action.selected = true;\n          return action;\n        });\n        vm.selectedDevices.push(sd);\n      } else {\n        vm.selectedDevices = vm.selectedDevices.filter(function (d) { return d.name !== device.DeviceName; });\n        device.indeterminate = false;\n        device.actions.map(function (action) {\n          action.selected = false;\n          return action;\n        });\n      }\n    };\n\n    vm.onChangeAction = function (device) {\n      var selectedAction = device.actions.filter(function (a) { return a.selected; });\n      device.indeterminate = selectedAction.length !== device.actions.length;\n    };\n\n    vm.casinoSelectDevices = function () {\n      casinoService.setSelectDevices(vm.selectedDevices);\n      if (vm.selectedDevices.length !== 0) {\n        vm.casinoLoadData();\n      }\n    };\n\n    vm.casinoLoadData = function () {\n      vm.casinoErrorLoad = false;\n      var cruises = casinoService.getSelectCruises();\n      var devices = casinoService.getSelectDevices();\n      var promises = [];\n      vm.fullfilledEventsPromise = 0;\n\n      cruises.forEach(function (cruise) {\n        devices.forEach(function (device) {\n          device.actions.forEach(function (action) {\n            var promise = casinoService.getEvents(cruise, device.code, action.code)\n              .then(function (data) {\n                vm.fullfilledEventsPromise++;\n                return { name: cruise, events: data };\n              });\n            promises.push(promise);\n          });\n        });\n      });\n\n      $q.all(promises)\n        .then(function (data) {\n          var events = {};\n          data.forEach(function (cruiseData) {\n            if (!events[cruiseData.name]) {\n              events[cruiseData.name] = [];\n            }\n            events[cruiseData.name] = events[cruiseData.name].concat(cruiseData.events);\n          });\n          vm.mapComponent.addCasinoLayers(events);\n          $mdDialog.hide();\n          vm.currentPointEdit = null;\n        })\n        .catch(function () { vm.casinoErrorLoad = true; });\n    };\n\n    /* --------------------------------------------------------------\n     * QGIS\n     * --------------------------------------------------------------\n     */\n    vm.openUploadQGISDialog = function (ev) {\n      $mdDialog.show({\n        contentElement: '#qgis-upload-project-dialog',\n        parent: angular.element(document.querySelector('tsa-map')),\n        targetEvent: ev,\n        clickOutsideToClose: true\n      });\n    };\n\n    vm.closeUploadQGISDialog = function (ev) {\n      vm.saveUploadQGIS = false;\n      angular.element(\"input#qgis-upload-project\").val(null);\n      $mdDialog.hide();\n      vm.qgisFileUpload = null;\n    };\n\n    vm.onQGISFileUpload = function (event) {\n      var files = vm.qgisFileUpload; // FileList object\n      if (files && files.length !== 0) {\n        for (var i = 0; i < files.length; i++) {\n          var reader = new FileReader();\n          reader.readAsDataURL(files[i]);\n          reader.onload = pushQGISProject(reader);\n        }\n\n        angular.element(\"input#qgis-upload-project\").val(null);\n        $mdDialog.hide();\n      }\n    };\n\n    vm.enableUploadQGISFile = function (event) {\n      vm.saveUploadQGIS = true;\n      vm.qgisFileUpload = event.target.files;\n    };\n\n\n  }\n})();\n\n(function () {\n    'use strict';\n\n    /** Kley state component */\n    angular.module('tsa.tsaViews.menu', []).component('tsaMenu', {\n        templateUrl: \"app/tsa-views/menu/menu.html\",\n        controllerAs: \"ctrl\",\n        controller: menuController,\n        bindings: {\n            config: '=',\n            cardId: '@',\n            onChangeCardType: '&'\n        }\n    });\n\n    /** Kley state controller */\n    function menuController($log, $scope, $http, $interval) {\n        var vm = this;\n        vm.logger = $log.getInstance(\"menu-tsa-view\");\n        vm.handler;\n        vm.menu = '';\n\n        var getMenu = function() {\n            $http({\n                url: '/api/menu',\n                method: 'GET',\n                transformResponse: [function (data) {\n                    // Do whatever you want!\n                    return data;\n                }]\n            }).then(function(response) {\n                vm.menu = response.data;\n            });\n        }\n\n        /** Initialization function  */\n        vm.$onInit = function init() {\n            getMenu();\n            vm.handler = $interval(getMenu, 30000);\n        };\n\n        /** Destroy function: remove the data listeners */\n        vm.$onDestroy = function () {\n            $interval.cancel(handler);\n        };\n    }\n\n})();\n\n(function () {\n    'use strict';\n\n    /** Message component **/\n    angular.module('tsa.tsaViews.message', []).component('tsaMessage', {\n        templateUrl: \"app/tsa-views/message/message.html\",\n        controllerAs: \"ctrl\",\n        controller: messageController,\n        bindings: {\n            config: '=',\n            cardId: '@',\n            onChangeCardType: '&'\n        }\n    });\n\n    /** Message controller **/\n    function messageController($timeout, $scope, messagingService) {\n        var vm = this;\n\n        /**------------------------------ PROPERTIES -------------------------------**/\n        vm.lastMessage=messagingService.lastMessage;\n\n    }\n})();\n\n(function () {\n    'use strict';\n\n    /** Mobile view component **/\n    angular.module('tsa.tsaViews.mobile',[]).component('tsaMobile', {\n        templateUrl: \"app/tsa-views/mobile/mobile.html\",\n        controllerAs: \"ctrl\",\n        controller: mobileController,\n        bindings: {\n            config: '=',\n            cardId: '@',\n            onChangeCardType: '&'\n        }\n    });\n\n    /** Mobile view controller */\n    function mobileController($log, MOBILE) {\n        var vm = this;\n        vm.logger = $log.getInstance(\"tsa-mobile\");\n\n        /** Initialization function */\n        vm.$onInit = function init() {\n            vm.deviceId = this.config.deviceId;\n            vm.lestDeviceId = \"LEST_NAV\";\n            vm.frameId = this.config.frameId;\n            vm.MOBILE = MOBILE;\n        };\n    }\n})();\n\n(function () {\n    'use strict';\n\n    /** Navigation component **/\n    angular.module('tsa.tsaViews.navigation', []).component('tsaNavigation', {\n        templateUrl: \"app/tsa-views/navigation/navigation.html\",\n        controllerAs: \"ctrl\",\n        controller: navigationController,\n        bindings: {\n            config: '=',\n            cardId: '@',\n            onChangeCardType: '&'\n        }\n    });\n\n    /** Navigation controller */\n    function navigationController($log, acquisitionService, NAVIGATION, WAYPOINTS, SHIP_ID, statusService) {\n        var vm = this;\n        vm.logger = $log.getInstance(\"navigation-tsa-view\");\n\n        /** Initialization function */\n        vm.$onInit = function init() {\n            if (angular.isUndefined(this.config) || angular.isUndefined(this.config.deviceId) || angular.isUndefined(this.config.frameId)) {\n                vm.logger.error('config and/or deviceId and/or frameId not defined!');\n                return;\n            }\n            vm.MODE = { NAVIGATION: 'navigation', STATION: 'station' };\n            vm.currentMode = vm.MODE.NAVIGATION;\n\n            vm.shipId = SHIP_ID;\n            vm.isMD = ('MD' === SHIP_ID);\n            vm.currentWptName = '';\n\n            vm.statusService = statusService;\n\n            vm.deviceId = this.config.deviceId;\n            vm.frameId = this.config.frameId;\n\n            vm.latitude = NAVIGATION.LATITUDE;\n            vm.longitude = NAVIGATION.LONGITUDE;\n            vm.heading = NAVIGATION.HEADING;\n            vm.sounder = NAVIGATION.SOUNDER;\n            vm.groundSpeed = NAVIGATION.GROUND_SPEED;\n            vm.groundCourse = NAVIGATION.GROUND_COURSE;\n            vm.surfaceSpeed = NAVIGATION.SURFACE_SPEED;\n            vm.surfaceCourse = NAVIGATION.SURFACE_COURSE;\n            vm.driftSpeed = NAVIGATION.DRIFT_SPEED;\n            vm.driftCourse = NAVIGATION.DRIFT_COURSE;\n\n            vm.frameRoutingId = NAVIGATION.FRAME_ROUTING;\n            vm.curDist = NAVIGATION.CUR_DIST;\n            vm.curCourse = NAVIGATION.CUR_COURSE;\n            vm.prevDist = NAVIGATION.PREV_DIST;\n            vm.prevCourse = NAVIGATION.PREV_COURSE;\n            vm.eta = NAVIGATION.ETA;\n\n            vm.dataViewSize = 0.8;\n            vm.dataFormat = '%.1f';\n            vm.angleFormat = '%.0f';\n            vm.positionFormat = 'coordinate';\n\n            var waypointsFrameListener = acquisitionService.registerForDevice(vm.deviceId).registerForFrame(WAYPOINTS.FRAME);\n            waypointsFrameListener.promise.then({}, {}, parseWaypoints);\n            function parseWaypoints(receivedFrame) {\n                var wptsLat = receivedFrame.value[WAYPOINTS.LATITUDE].map(parseFloat);\n                var wptsLon = receivedFrame.value[WAYPOINTS.LONGITUDE].map(parseFloat);\n                var wptsId = receivedFrame.value[NAVIGATION.ID];\n                var wptsIndex = receivedFrame.value[NAVIGATION.INDEX].map(parseInt);\n\n                //Profil mode\n                if (wptsLat.lenght != 1 || wptsLon.lenght != 1) {\n                    vm.currentMode = vm.MODE.NAVIGATION;\n                }\n                else vm.currentMode = vm.MODE.STATION;\n\n                if(wptsIndex.length && (wptsId.length >= wptsIndex[0])) {\n                    vm.currentWptName = wptsId[wptsIndex[0]-1];\n                }\n            }\n\n        };\n    }\n})();\n\n(function () {\n    'use strict';\n\n    /** Component declaration **/\n    (function () {\n        'use strict';\n        angular.module('tsa.tsaViews.multibeam', []).component('tsaMultibeam', {\n            templateUrl: \"app/tsa-views/multibeam/multibeam.html\",\n            controllerAs: \"ctrl\",\n            controller: multibeamController,\n            bindings: {\n                config: '=',\n                cardId: '@',\n                onChangeCardType: '&'\n            }\n        });\n    })();\n\n    /** Controller */\n    function multibeamController($interval, $timeout, $scope, $log, MULTIBEAM, acquisitionService, statusService, themeService, graphUtils) {\n        var vm = this;\n        vm.logger = $log.getInstance(\"multibeam-tsa-view\");\n\n        /**------------------------------ PROPERTIES -------------------------------**/\n\n        vm.canvasId = \"canvas-mb-\" + vm.cardId;\n        var dataMissing = true;\n        var lastFrameTimestamp;\n        var canvas;\n        var intervalPromise;\n        var timeoutPromise;\n        var portColor = '#F44336';\n        var starboardColor = '#4CAF50';\n        var frameListener;\n\n        /** Chart properties **/\n        var chart = undefined;\n        var chartData = {\n            datasets: [{ // PORT\n                xAxisID: \"x-axis-1\",\n                yAxisID: \"y-axis-1\",\n                borderColor: portColor,\n                data: []\n            }, { // STARBORD\n                xAxisID: \"x-axis-1\",\n                yAxisID: \"y-axis-1\",\n                borderColor: starboardColor,\n                data: []\n            }]\n        };\n        var chartOptions = {\n            animation: false,\n            maintainAspectRatio: false,\n            legend: {\n                display: false\n            },\n            showLines: false,\n            tooltips: {\n                enabled: false\n            },\n            elements: {\n                point: {\n                    radius: 1,\n                    borderWidth: 2\n                }\n            },\n            scales: {\n                xAxes: [{\n                    type: \"linear\",\n                    position: \"top\",\n                    gridLines: {\n                        zeroLineColor: \"#9E9E9E\",\n                        color: \"#BDBDBD\"\n                    }\n                }],\n                yAxes: [\n                    {\n                        id: \"y-axis-1\",\n                        position: \"left\",\n                        display: true,\n                        scaleLabel: {\n                            display: true,\n                            labelString: 'Depth (m)'\n                        },\n                        gridLines: {\n                            zeroLineColor: \"#9E9E9E\",\n                            color: \"#BDBDBD\"\n                        },\n                        afterTickToLabelConversion: function (scale) {\n                            angular.forEach(scale.ticks, function (tick, index) {\n                                scale.ticks[index] = Math.abs(tick);\n                            });\n                        },\n                        ticks: {\n                            suggestedMin: -10\n                        }\n                    }]\n            }\n        };\n\n        /**-------------------------- INITIALIZATION / DESTROY METHODS -------------------------**/\n\n        /** Initialization function **/\n        vm.$onInit = function init() {\n\n            if (angular.isUndefined(this.config)\n                || angular.isUndefined(this.config.deviceId)\n                || angular.isUndefined(this.config.frameId)) {\n                vm.logger.error('deviceId or/and frameId  not defined!');\n                return;\n            }\n\n            vm.deviceId = this.config.deviceId;\n            vm.frameId = this.config.frameId;\n\n            //Wait the canvas creation, and then create the chart...\n            timeoutPromise = $timeout(function () {\n                createChart();\n                initDataListener();\n                initDataWatcher();\n                initThemeWatcher();\n            }, 500);\n        };\n\n        /** Destroy function **/\n        vm.$onDestroy = function () {\n            if (angular.isDefined(frameListener))\n                acquisitionService.registerForDevice(vm.deviceId).unregisterForFrame(frameListener);\n            if (angular.isDefined(timeoutPromise))\n                $timeout.cancel(timeoutPromise);\n            if (angular.isDefined(intervalPromise))\n                $interval.cancel(intervalPromise);\n        };\n\n        /**------------------------------ PRIVATE METHODS -------------------------------**/\n\n        /** Redraw the chart **/\n        function createChart() {\n            if (chart !== undefined)\n                chart.destroy();\n\n            canvas = document.getElementById(vm.canvasId);\n            if (canvas != undefined)\n                chart = Chart.Scatter(canvas, { data: chartData, options: chartOptions });\n        }\n\n        /** Initialize the data listener **/\n        function initDataListener() {\n            frameListener = acquisitionService.registerForDevice(vm.deviceId).registerForFrame(vm.frameId);\n            frameListener.promise.then({}, {}, function (frame) {\n                if (dataMissing) {\n                    dataMissing = false;\n                    chartData.datasets[0].borderColor = portColor;\n                    chartData.datasets[1].borderColor = starboardColor;\n                }\n\n                lastFrameTimestamp = frame.timestamp;\n\n                var minAcross, maxAcross, verticalDepth;\n                var acrossValues = frame.value[MULTIBEAM.ACROSS];\n                vm.nbValue = frame.value[MULTIBEAM.DEPTH].length;\n\n                var i = 0;\n                chartData.datasets[0].data = [];\n                chartData.datasets[1].data = [];\n                angular.forEach(frame.value[MULTIBEAM.DEPTH], function (value) {\n                    var acrossValue = parseFloat(acrossValues[i]);\n\n                    if (acrossValue < 0)\n                        chartData.datasets[0].data.push({ x: acrossValue, y: -parseFloat(value) });\n                    else chartData.datasets[1].data.push({ x: acrossValue, y: -parseFloat(value) });\n\n                    if (angular.isUndefined(minAcross) || acrossValue < minAcross) {\n                        minAcross = acrossValue;\n                        verticalDepth = parseFloat(value);\n                    }\n\n                    if (angular.isUndefined(maxAcross) || acrossValue > maxAcross)\n                        maxAcross = acrossValue;\n\n                    i++;\n                });\n\n                if (angular.isDefined(minAcross) && angular.isDefined(maxAcross)) {\n                    vm.swathValue = maxAcross - minAcross;\n                    vm.verticalDepth = verticalDepth;\n\n                    //TODO: must be tested\n                    var maxAbs = Math.max(Math.abs(minAcross), Math.abs(maxAcross));\n                    chart.chart.config.options.scales.xAxes[0].ticks.suggestedMin = -maxAbs;\n                    chart.chart.config.options.scales.xAxes[0].ticks.suggestedMax = maxAbs;\n                }\n\n                chart.update();\n            });\n\n        }\n\n        /** Check the data reception **/\n        function initDataWatcher() {\n            intervalPromise = $interval(function () {\n                var devicePeriod = acquisitionService.registerForDevice(vm.deviceId).periodList[vm.frameId];\n                if (angular.isUndefined(devicePeriod))\n                    devicePeriod = 1000;\n                if (angular.isDefined(lastFrameTimestamp) &&\n                    statusService.getServerTime().time - lastFrameTimestamp > 5 * devicePeriod) {\n                    dataMissing = true;\n                    chartData.datasets[0].borderColor = \"#BDBDBD\";\n                    chartData.datasets[1].borderColor = \"#BDBDBD\";\n                    chart.update();\n                }\n            }, 1000);\n        }\n\n        /** Change gridLinesColor of Graph on every change of service variable  **/\n        function initThemeWatcher() {\n            themeService.subscribe($scope, function(event, theme) {\n                chartOptions.scales.xAxes[0].gridLines.color = theme.gridLinesColor;\n                chartOptions.scales.yAxes[0].gridLines.color = theme.gridLinesColor;\n                createChart();\n            });\n        }\n    }\n})();\n\n(function () {\n    'use strict';\n    angular.module('tsa.tsaViews.numerical', ['tsa.services.filters']).component('tsaNumerical', {\n        templateUrl: \"app/tsa-views/numerical/numerical.html\",\n        controller: numericalController,\n        controllerAs: \"numerical\",\n        bindings: {\n            cardId: '@',\n            config: '=',\n            onChangeCardType: '&'\n        }\n    });\n\n    /** Controller **/\n    function numericalController(acquisitionService, $mdDialog, dialogService) {\n        var vm = this;\n\n        /** -------------------  PROPERTIES -------------------- */\n        vm.itemList = [];\n        vm.editionMode = false;\n        \n        /*** -------------------  Item class: represents a item line --------------------*/\n\n        function Item(deviceId, frameId, dataId, title) {\n            /*** Properties ***/\n            this.deviceId = deviceId;\n            this.frameId = frameId;\n            this.dataId = dataId;\n            this.title = title;\n\n            this.frameDataId = function (newFrameDataId) {\n                if (arguments.length) {\n                    this.frameId = newFrameDataId.split('!')[0];\n                    this.dataId = newFrameDataId.split('!')[1];\n                }\n                return this.frameId + '!' + this.dataId;\n            };\n\n            this.remove = function remove() {\n                vm.itemList.splice(vm.itemList.indexOf(this), 1);\n                saveConfig();\n            };\n\n            this.up = function up() {\n                var currentIndex = vm.itemList.indexOf(this);\n                var nextIndex = currentIndex - 1;\n                if (nextIndex < 0)\n                    return;\n                var tmp = vm.itemList[nextIndex];\n                vm.itemList[currentIndex] = tmp;\n                vm.itemList[nextIndex] = this;\n                saveConfig();\n            };\n\n            this.down = function down() {\n                var currentIndex = vm.itemList.indexOf(this);\n                var nextIndex = currentIndex + 1;\n                if (nextIndex > vm.itemList.length - 1)\n                    return;\n                var tmp = vm.itemList[nextIndex];\n                vm.itemList[nextIndex] = this;\n                vm.itemList[currentIndex] = tmp;\n                saveConfig();\n            }\n        }\n\n        /*** -------------------  PRIVATE METHODS --------------------*/\n\n        /** Initialization function **/\n        vm.$onInit = function init() {\n            loadConfig();\n        };\n\n        /** Save the current configuration in the vm.config property **/\n        function saveConfig() {\n            vm.config = {};\n            vm.config.type = 'Numerical';\n            vm.config.dataList = [];\n            angular.forEach(vm.itemList, function (item) {\n                vm.config.dataList.push({\n                    deviceId: item.deviceId,\n                    frameId: item.frameId,\n                    dataId: item.dataId,\n                    title: item.title !== undefined ? item.title : \"\"\n                });\n            }, vm);\n        }\n\n        /** Restore the current configuration from the vm.config property **/\n        function loadConfig() {\n            if (vm.config !== undefined && vm.config.type === 'Numerical') {\n                angular.forEach(vm.config.dataList, function (data) {\n                    vm.itemList.push(new Item(data.deviceId, data.frameId, data.dataId, data.title));\n                });\n            }\n        }\n\n        /** -------------------  VIEW-MODEL METHODS -------------------- */\n\n        /** Show \"Add data\" dialog box **/\n        vm.addItem = function addItem() {\n            dialogService.showSelectData(acquisitionService.getEnabledDeviceList())\n                .then(function (dataList) {\n                    angular.forEach(dataList, function (data) {\n                        vm.itemList.push(new Item(data.deviceId, data.frameId, data.id));\n                    });\n                    saveConfig();\n                });\n        };\n    }\n\n})();\n\n/*\n * Traverse tribord\n * \n * DA 1 max 800kW\n * DA 3 max 1200kW\n * \n * Traverse bbord\n * DA 2 max 1200kW\n * DA 4 max 800kW\n */\n\n(function () {\n    'use strict';\n    \n    /** Propulsion component **/\n    angular.module('tsa.tsaViews.propulsionAt', []).component('tsaPropulsionAt', {\n        templateUrl: \"app/tsa-views/propulsion-at/propulsion-at.html\",\n        controllerAs: \"ctrl\",\n        controller: propulsionControllerAt,\n        bindings: {\n            config: '=',\n            cardId: '@',\n            onChangeCardType: '&'\n        }\n    });\n\n    /** Propulsion controller **/\n    function propulsionControllerAt(acquisitionService, $timeout, $scope, easelJsUtils, themeService, NAVIGATION) {\n        var vm = this;\n        var TAG = '[propulsionControllerAt] ';\n\n        /**------------------------------ PROPERTIES -------------------------------**/\n\n        //Canvas\n        vm.canvasId = \"canvas-propulsion-at-\" + vm.cardId;\n\n        var canvas;\n        var stage;\n        var backContainer;\n        var frontContainer;\n        \n        var canvasWidth;\n        var canvasHeight;\n       \n        vm.readyToDraw = false;\n\n        vm.colors = {\n        \tbackground: '#CCCCCC',\n        \tzero: '#EE2222',\n        \ttick: '#888888',\n        \trudder: '#000000',\n        \tgreen: '#11CC11',\n        \tred: '#EE2222',\n        \tforward: '#1111DD',\n        \tbackward: '#000000',\n        \tfunkyBackground: '#F3BF52'\n        };\n        \n        vm.themeChanged = function themeChanded(event, theme) {\n        \tconsole.log(\"propulsion at themechanged\");\n        }\n        \n        themeService.subscribe($scope, vm.themeChanged);\n        \n        /**------------------------------ METHODS -------------------------------**/\n\n        /** Initialization function **/\n        vm.$onInit = function init() {\n            console.log(TAG + '$onInit: deviceId = ' + (this.config ? this.config.deviceId : 'config undefined'));\n\n            if (this.config == undefined || this.config.deviceId == undefined) {\n                console.error(TAG + 'device Id not found!');\n                return;\n            }\n\n            vm.deviceId = this.config.deviceId; //Component parameter (mandatory)\n            vm.navId = this.config.navId; \n            vm.device = acquisitionService.registerForDevice(vm.deviceId);\n            \n            vm.frameId = 'atpropulsion';\n            vm.navFrameId = 'shipnav';\n\n            //Create object to add x and y properties\n            vm.frontTrans = { id: 'fronttrans' };\n            vm.frontPropAngle = { id: 'frontpropangle' };\n            vm.mainLeft = { id: 'mainleft' };\n            vm.mainRight= {id: 'mainright' };\n            vm.angle = {id: 'angle' };\n            vm.fontsize = 1;\n\n            vm.frameListener = acquisitionService.registerForDevice(vm.deviceId).registerForFrame(vm.frameId);\n            vm.frameListener.promise.then({}, {}, function (frame) {\n            \tvm.frontTrans.value = frame.value[vm.frontTrans.id];\n            \tvm.frontPropAngle.value = frame.value[vm.frontPropAngle.id];\n            \tvm.mainLeft.value = frame.value[vm.mainLeft.id];\n            \tvm.mainRight.value = frame.value[vm.mainRight.id];\n            \tvm.angle.value = frame.value[vm.angle.id];\n\n            \tif(vm.readyToDraw) {\n                    updateFrontContainer();\n            \t\tstage.update();\n            \t}\n            });\n\n            vm.heading\t\t= { id: 'heading'};\n            vm.gndCourse\t= { id: 'gndcourse'};\n            vm.gndSpeed\t\t= { id: 'gndspeed'};\n            vm.surfCourse\t= { id: 'surfcourse'};\n            vm.surfSpeed\t= { id: 'surfspeed'};\n            \n            vm.surfNorth = vm.surfWest = vm.surfEast = vm.surfSouth = undefined;\n            vm.gndNorth = vm.gndWest = vm.gndEast = vm.gndSouth = undefined;\n            \n            vm.navFrameListener = acquisitionService.registerForDevice(vm.navId).registerForFrame('shipnav');\n            vm.navFrameListener.promise.then({}, {}, function (frame) {\n            \tvm.heading.value = frame.value[vm.heading.id];\n            \tvm.gndCourse.value = frame.value[vm.gndCourse.id];\n            \tvm.gndSpeed.value = frame.value[vm.gndSpeed.id];\n            \tvm.surfCourse.value = frame.value[vm.surfCourse.id];\n            \tvm.surfSpeed.value = frame.value[vm.surfSpeed.id];\n\n            \tvar surfA = vm.surfSpeed.value * Math.cos((vm.surfCourse.value-vm.heading.value)*Math.PI/180.0);\n            \tif(surfA>=0) {\n            \t\tvm.surfNorth = surfA;\n            \t\tvm.surfSouth = undefined;\n            \t} else {\n            \t\tvm.surfNorth = undefined;\n            \t\tvm.surfSouth = -surfA;\n            \t}\n            \t\n            \tvar surfB = vm.surfSpeed.value * Math.sin((vm.surfCourse.value-vm.heading.value)*Math.PI/180.0);\n            \tif(surfB<0) {\n            \t\tvm.surfWest = -surfB;\n            \t\tvm.surfEast = undefined;\n            \t} else {\n            \t\tvm.surfWest = undefined;\n            \t\tvm.surfEast = surfB;\n            \t}\n            \t\n            \tvar gndA = vm.gndSpeed.value * Math.cos((vm.gndCourse.value-vm.heading.value)*Math.PI/180.0);\n            \tif(gndA>=0) {\n            \t\tvm.gndNorth = gndA;\n            \t\tvm.gndSouth = undefined;\n            \t} else {\n            \t\tvm.gndNorth = undefined;\n            \t\tvm.gndSouth = -gndA;\n            \t}\n            \t\n            \tvar gndB = vm.gndSpeed.value * Math.sin((vm.gndCourse.value-vm.heading.value)*Math.PI/180.0);\n            \tif(gndB<0) {\n            \t\tvm.gndWest = -gndB;\n            \t\tvm.gndEast = undefined;\n            \t} else {\n            \t\tvm.gndWest = undefined;\n            \t\tvm.gndEast = gndB;\n            \t}\n            \t\n            \tif(vm.readyToDraw) {\n//                    updateFrontContainer();\n//            \t\tstage.update();\n            \t}\n            });\n\n\n            $timeout(function () {\n                initCanvas();\n                vm.readyToDraw = true;\n            }, 500); \n\n        };\n\n        /** Destroy function: remove the data listeners */\n        vm.$onDestroy = function destroy() {\n            if (angular.isDefined(vm.frameListener)) {\n                acquisitionService.registerForDevice(vm.deviceId).unregisterForFrame(vm.frameListener);\n                acquisitionService.registerForDevice(vm.navId).unregisterForFrame(vm.navFrameListener);\n            }\n        }\n        \n        /**Initialize the canvas **/\n        function initCanvas() {\n            canvas = document.getElementById(vm.canvasId);\n            if (canvas != null) {\n                stage = new createjs.Stage(canvas);\n                \n                backContainer = new createjs.Container();\n                frontContainer = new createjs.Container();\n                \n                stage.addChild(backContainer, frontContainer);\n                \n                $scope.$watch(function () {\n                    return canvas.offsetHeight\n                }, function () {\n                    updateCanvasSize();\n                });\n                $scope.$watch(function () {\n                    return canvas.offsetWidth\n                }, function () {\n                    updateCanvasSize();\n                });\n                updateCanvasSize();\n            }\n        }\n\n        /** Create the stage if needed, reset the canvas and redraw all the shapes **/\n        function updateCanvasSize() {\n            if (canvas != null) {\n                canvasWidth = canvas.offsetWidth;\n                canvasHeight = canvas.offsetHeight;\n\n                //Canvas size properties setting\n                canvas.setAttribute('width', canvasWidth);\n                canvas.setAttribute('height', canvasHeight);\n\n                angular.element(canvas).parent().find(\"tsa-data-view .value\").css({\n                \t\"font-size\": \"\"+canvasHeight/220+\"em\"\n        \t\t}); \n                \n                angular.element(canvas).parent().find(\"tsa-data-view\").css({\n                \t\"width\": \"\"+Math.round(canvasHeight/3.5)+\"px !important\",\n                \t\"max-width\": \"\"+Math.round(canvasHeight/3.5)+\"px\",\n                }); \n\n                stage.x = canvasWidth/2;\n                stage.y = canvasHeight/2;\n            \tvar scale = canvasHeight/100;\n            \tstage.scaleX = stage.scaleY = scale;\n            \t                \n                updateBackContainer();\n                backContainer.cache(-canvasWidth/2, -canvasHeight/2, canvasWidth, canvasHeight, scale);\n                updateFrontContainer();\n                updateLabels();\n\n                stage.update();\n            }\n        }\n        \n        \n        function updateBackContainer() {\n        \tbackContainer.removeAllChildren();\n        \t\n            var vesselShape = easelJsUtils.createVessel(vm.colors.tick);\n            vesselShape.scaleX = 0.3;\n            vesselShape.scaleY = 0.65;\n            vesselShape.y = -12;\n            \n            var backLeftRudderShape =  easelJsUtils.createBackRudder(vm.colors.background)\n            backLeftRudderShape.y = 22;\n            backLeftRudderShape.x = -10;\n            backLeftRudderShape.scaleX = backLeftRudderShape.scaleY = 12/100;\n            \n            var backRightRudderShape =  easelJsUtils.createBackRudder(vm.colors.background)\n            backRightRudderShape.y = 22;\n            backRightRudderShape.x = +10;\n            backRightRudderShape.scaleX = backRightRudderShape.scaleY = 12/100;\n            \n\t\t\tvar mainLeftBackGaugeShape = easelJsUtils.createBackGauge(vm.colors.background);\n\t\t\tmainLeftBackGaugeShape.y = 2;\n\t\t\tmainLeftBackGaugeShape.x = -10;\n\t\t\tmainLeftBackGaugeShape.scaleX = 0.23;\n\t\t\tmainLeftBackGaugeShape.scaleY = 0.3;\n\t\t\tmainLeftBackGaugeShape.rotation = 270;\n\n\t\t\tvar mainRightBackGaugeShape = easelJsUtils.createBackGauge(vm.colors.background);\n\t\t\tmainRightBackGaugeShape.y = 2;\n\t\t\tmainRightBackGaugeShape.x = +10;\n\t\t\tmainRightBackGaugeShape.scaleX = 0.23;\n\t\t\tmainRightBackGaugeShape.scaleY = 0.3;\n\t\t\tmainRightBackGaugeShape.rotation = 270;\n\n            backContainer.addChild(vesselShape, backLeftRudderShape, backRightRudderShape, mainLeftBackGaugeShape, mainRightBackGaugeShape);\n        }\n        \n        function updateFrontContainer() {\n        \tfrontContainer.removeAllChildren();        \t\n\n            var rudderColor = vm.colors.rudder;\n\t\t\tif(Math.abs(Math.round(vm.angle.value))>0) {\n\t\t\t\trudderColor = vm.angle.value > 0 ? vm.colors.red : vm.colors.green;\n\t\t\t}\n            \n            var leftRudderShape = easelJsUtils.createRudder(rudderColor);\n            leftRudderShape.y = 22;\n            leftRudderShape.x = -10;\n            leftRudderShape.scaleX = leftRudderShape.scaleY = 12/100;\n            leftRudderShape.rotation = vm.angle.value;\n            \n            var rightRudderShape = easelJsUtils.createRudder(rudderColor);\n            rightRudderShape.y = 22;\n            rightRudderShape.x = +10;\n            rightRudderShape.scaleX = rightRudderShape.scaleY = 12/100;\n            rightRudderShape.rotation = vm.angle.value;\n            \n            var mainLeftGaugeShape = easelJsUtils.createGaugge(vm.colors.tick, vm.colors.zero, \n            \t\tvm.mainLeft.value*100/150, vm.colors.forward, vm.colors.backward);\n            mainLeftGaugeShape.y = 2;\n            mainLeftGaugeShape.x = -10;\n\t\t\tmainLeftGaugeShape.scaleX = 0.23;\n\t\t\tmainLeftGaugeShape.scaleY = 0.3;\n\t\t\tmainLeftGaugeShape.rotation = 270;\n\n            var mainRightGaugeShape = easelJsUtils.createGaugge(vm.colors.tick, vm.colors.zero, \n            \t\tvm.mainRight.value*100/150, vm.colors.forward, vm.colors.backward);\n            mainRightGaugeShape.y = 2;\n            mainRightGaugeShape.x = +10;\n            mainRightGaugeShape.scaleX = 0.23;\n\t\t\tmainRightGaugeShape.scaleY = 0.3;\n\t\t\tmainRightGaugeShape.rotation = 270;\n\t\t\t            \n\t\t\tvar arrowColor = vm.colors.rudder;\n\t\t\tif((vm.frontPropAngle.value <= 180) && (vm.frontPropAngle.value >=0)) {\n\t\t\t\tarrowColor = vm.colors.green;\n\t\t\t} else {\n\t\t\t\tarrowColor = vm.colors.red;\n\t\t\t}\n            var frontTransArrowShape = easelJsUtils.createArrow(\n            \t\tarrowColor, vm.frontTrans.value/2.0);\n\t\t\tfrontTransArrowShape.y = -31.5;\n\t\t\tfrontTransArrowShape.x = 0;\n\t\t\tfrontTransArrowShape.scaleX = frontTransArrowShape.scaleY = 0.1;\n\t\t\tfrontTransArrowShape.rotation = vm.frontPropAngle.value;\n\t\t\t            \n            frontContainer.addChild(leftRudderShape, rightRudderShape, mainLeftGaugeShape, mainRightGaugeShape, frontTransArrowShape);\n        }\n        \n\n        function updateLabels() {\n            canvasWidth = canvas.offsetWidth;\n            canvasHeight = canvas.offsetHeight;\n            var canvasX = canvas.offsetLeft;\n            var canvasY = canvas.offsetTop;\n        \t\n            var delta = canvasHeight*5/100;\n            \n            vm.frontTrans.x = canvasX + 0.1*canvasWidth/2;\n            vm.frontTrans.y = canvasY + canvasHeight*(50 - 38)/100;\n\n            vm.frontPropAngle.x = vm.frontTrans.x;\n            vm.frontPropAngle.y = canvasY + canvasHeight*(50 - 25)/100;\n        \n            vm.mainLeft.x = vm.frontTrans.x;\n            vm.mainLeft.y = canvasY + canvasHeight*(50 + 0)/100;\n\n            vm.mainRight.x = canvasX + 1.4*canvasWidth/2;\n            vm.mainRight.y = vm.mainLeft.y\n\n            vm.angle.x = canvasX + 1*canvasWidth/2;\n            vm.angle.y = canvasY + canvasHeight*(50 + 37)/100;\n        }\n    }\n})();\n\n/*\n    Propulsion Pp component\n */\n\n(function () {\n    'use strict';\n\n    /** Propulsion component **/\n    angular.module('tsa.tsaViews.propulsionPp', []).component('tsaPropulsionPp', {\n        templateUrl: \"app/tsa-views/propulsion-pp/propulsion-pp.html\",\n        controllerAs: \"ctrl\",\n        controller: propulsionControllerAt,\n        bindings: {\n            config: '=',\n            cardId: '@',\n            onChangeCardType: '&'\n        }\n    });\n\n    /** Propulsion controller **/\n    function propulsionControllerAt(acquisitionService, $timeout, $scope, easelJsUtils, themeService, NAVIGATION,\n        PP_ENGINE, PP_VDR) {\n        var vm = this;\n        var TAG = '[propulsionControllerAt] ';\n\n        /**------------------------------ PROPERTIES -------------------------------**/\n\n        //Canvas\n        vm.canvasId = \"canvas-propulsion-pp-\" + vm.cardId;\n\n        vm.DA = {\n            'deviceId': 'PP_ENGINE',\n            'frameId': PP_ENGINE.FRAME,\n            'datas': [\n                { 'dataId': PP_ENGINE.DA1_POWER },\n                { 'dataId': PP_ENGINE.DA2_POWER },\n                { 'dataId': PP_ENGINE.DA3_POWER },\n                { 'dataId': PP_ENGINE.DA4_POWER }\n            ]\n        };\n\n        vm.PROP_VDR = {\n            'deviceId': 'PP_VDR',\n            'frameId': PP_VDR.FRAME,\n            'trans1': { 'id': PP_VDR.TRANS1_PROP, 'value': undefined, 'lastTimeStamp': 0},\n            'trans2': { 'id': PP_VDR.TRANS2_PROP, 'value': undefined, 'lastTimeStamp': 0},\n            'trans3': { 'id': PP_VDR.TRANS3_PROP, 'value': undefined, 'lastTimeStamp': 0},\n            'trans4': { 'id': PP_VDR.TRANS4_PROP, 'value': undefined, 'lastTimeStamp': 0},\n            'starboardRudder': { 'id': PP_VDR.RUDDER_STARBOARD, 'value': undefined, 'lastTimeStamp': 0},\n            'portRudder': { 'id': PP_VDR.RUDDER_PORT, 'value': undefined, 'lastTimeStamp': 0}\n        }\n\n        vm.PROP_ENGINE = {\n            'deviceId': 'PP_ENGINE',\n            'frameId': PP_ENGINE.FRAME,\n            'starboardMain': { 'id': PP_ENGINE.MAIN_STARBOARD, 'value': undefined, 'lastTimeStamp': 0},\n            'portMain': { 'id': PP_ENGINE.MAIN_PORT, 'value': undefined, 'lastTimeStamp': 0}\n        }\n\n        var canvas;\n        var stage;\n        var backContainer;\n        var frontContainer;\n\n        var canvasWidth;\n        var canvasHeight;\n\n        vm.readyToDraw = false;\n\n        vm.colors = {\n        \tbackground: '#CCCCCC',\n        \tzero: '#EE2222',\n        \ttick: '#888888',\n        \trudder: '#000000',\n        \tgreen: '#11CC11',\n        \tred: '#EE2222',\n        \tforward: '#1111DD',\n        \tbackward: '#000000',\n        \tfunkyBackground: '#F3BF52'\n        };\n\n        vm.themeChanged = function themeChanded(event, theme) {\n        \tconsole.log(\"propulsion at themechanged\");\n        }\n\n        themeService.subscribe($scope, vm.themeChanged);\n\n        /**------------------------------ METHODS -------------------------------**/\n\n        /** Initialization function **/\n        vm.$onInit = function init() {\n            console.log(TAG + '$onInit: deviceId = ' + (this.config ? this.config.deviceId : 'config undefined'));\n\n            vm.fontsize = 1;\n\n            function updateData(data, frame) {\n                if(frame.value.hasOwnProperty(data.id)) {\n                    data.value = frame.value[data.id][0];\n                    data.lastTimeStamp = (new Date()).getTime();\n                }\n            }\n\n            vm.PROP_VDR.frameListener =\n                acquisitionService.registerForDevice(vm.PROP_VDR.deviceId)\n                .registerForFrame(vm.PROP_VDR.frameId);\n\n            vm.PROP_VDR.frameListener.promise.then({}, {},\n                function(frame) {\n                    updateData(vm.PROP_VDR.trans1, frame);\n                    updateData(vm.PROP_VDR.trans2, frame);\n                    updateData(vm.PROP_VDR.trans3, frame);\n                    updateData(vm.PROP_VDR.trans4, frame);\n                    updateData(vm.PROP_VDR.portRudder, frame);\n                    updateData(vm.PROP_VDR.starboardRudder, frame);\n\n                    if(vm.readyToDraw) {\n                        updateFrontContainer();\n                        stage.update();\n                    }\n               });\n\n            vm.PROP_ENGINE.frameListener =\n                acquisitionService.registerForDevice(vm.PROP_ENGINE.deviceId)\n                .registerForFrame(vm.PROP_ENGINE.frameId);\n\n            vm.PROP_ENGINE.frameListener.promise.then({}, {},\n                function(frame) {\n                    updateData(vm.PROP_ENGINE.portMain, frame);\n                    updateData(vm.PROP_ENGINE.starboardMain, frame);\n                });\n\n            function testTimeOut(data, now) {\n                if((now - data.lastTimeStamp) > 5000) {\n                    data.value = undefined;\n                }\n            }\n\n            vm.timeout = setInterval(function() {\n                var now = (new Date()).getTime();\n                testTimeOut(vm.PROP_VDR.trans1, now);\n                testTimeOut(vm.PROP_VDR.trans2, now);\n                testTimeOut(vm.PROP_VDR.trans3, now);\n                testTimeOut(vm.PROP_VDR.trans4, now);\n                testTimeOut(vm.PROP_VDR.portRudder, now);\n                testTimeOut(vm.PROP_VDR.starboardRudder, now);\n                testTimeOut(vm.PROP_ENGINE.portMain, now);\n                testTimeOut(vm.PROP_ENGINE.starboardMain, now);\n            }, 1000);\n\n             $timeout(function () {\n                 initCanvas();\n                 vm.readyToDraw = true;\n             }, 500);\n        };\n\n        /** Destroy function: remove the data listeners */\n        vm.$onDestroy = function destroy() {\n            acquisitionService.registerForDevice(vm.PROP_VDR.deviceId).unregisterForFrame(vm.PROP_VDR.frameId);\n            acquisitionService.registerForDevice(vm.PROP_ENGINE.deviceId).unregisterForFrame(vm.PROP_ENGINE.frameId);\n            clearInterval(vm.timeout);\n        }\n\n        /**Initialize the canvas **/\n        function initCanvas() {\n            canvas = document.getElementById(vm.canvasId);\n            if (canvas != null) {\n                stage = new createjs.Stage(canvas);\n\n                backContainer = new createjs.Container();\n                frontContainer = new createjs.Container();\n\n                stage.addChild(backContainer, frontContainer);\n\n                $scope.$watch(function () {\n                    return canvas.offsetHeight\n                }, function () {\n                    updateCanvasSize();\n                });\n                $scope.$watch(function () {\n                    return canvas.offsetWidth\n                }, function () {\n                    updateCanvasSize();\n                });\n                updateCanvasSize();\n            }\n        }\n\n        /** Create the stage if needed, reset the canvas and redraw all the shapes **/\n        function updateCanvasSize() {\n            if (canvas != null) {\n                canvasWidth = canvas.offsetWidth;\n                canvasHeight = canvas.offsetHeight;\n\n                //Canvas size properties setting\n                canvas.setAttribute('width', canvasWidth);\n                canvas.setAttribute('height', canvasHeight);\n\n                angular.element(canvas).parent().find(\"tsa-data-view .value\").css({\n                \t\"font-size\": \"\"+canvasHeight/220+\"em\"\n        \t\t});\n\n                angular.element(canvas).parent().find(\"tsa-data-view\").css({\n                \t\"width\": \"\"+Math.round(canvasHeight/3.5)+\"px !important\",\n                \t\"max-width\": \"\"+Math.round(canvasHeight/3.5)+\"px\",\n                });\n\n                stage.x = canvasWidth/2;\n                stage.y = canvasHeight/2;\n            \tvar scale = canvasHeight/100;\n            \tstage.scaleX = stage.scaleY = scale;\n\n                updateBackContainer();\n                backContainer.cache(-canvasWidth/2, -canvasHeight/2, canvasWidth, canvasHeight, scale);\n                updateFrontContainer();\n                updateLabels();\n\n                stage.update();\n            }\n        }\n\n        function updateBackContainer() {\n        \tbackContainer.removeAllChildren();\n\n            var vesselShape = easelJsUtils.createVessel(vm.colors.tick);\n            vesselShape.scaleX = 0.3;\n            vesselShape.scaleY = 0.65;\n            vesselShape.y = -12;\n            backContainer.addChild(vesselShape);\n\n            var backStarboardRudderShape =  easelJsUtils.createBackRudder(vm.colors.background)\n            backStarboardRudderShape.y = 22;\n            backStarboardRudderShape.x = -10;\n            backStarboardRudderShape.scaleX = backStarboardRudderShape.scaleY = 12/100;\n            backContainer.addChild(backStarboardRudderShape);\n\n            var backPortRudderShape =  easelJsUtils.createBackRudder(vm.colors.background)\n            backPortRudderShape.y = 22;\n            backPortRudderShape.x = +10;\n            backPortRudderShape.scaleX = backPortRudderShape.scaleY = 12/100;\n            backContainer.addChild(backPortRudderShape);\n\n\t\t\tvar mainStarboardBackGaugeShape = easelJsUtils.createBackGauge(vm.colors.background);\n\t\t\tmainStarboardBackGaugeShape.y = 2;\n\t\t\tmainStarboardBackGaugeShape.x = -35;\n\t\t\tmainStarboardBackGaugeShape.scaleX = 0.23;\n\t\t\tmainStarboardBackGaugeShape.scaleY = 0.3;\n\t\t\tmainStarboardBackGaugeShape.rotation = 270;\n            backContainer.addChild(mainStarboardBackGaugeShape);\n\n\t\t\tvar mainPortBackGaugeShape = easelJsUtils.createBackGauge(vm.colors.background);\n\t\t\tmainPortBackGaugeShape.y = 2;\n\t\t\tmainPortBackGaugeShape.x = +35;\n\t\t\tmainPortBackGaugeShape.scaleX = 0.23;\n\t\t\tmainPortBackGaugeShape.scaleY = 0.3;\n            mainPortBackGaugeShape.rotation = 270;\n            backContainer.addChild(mainPortBackGaugeShape);\n        }\n\n        function updateFrontContainer() {\n         \tfrontContainer.removeAllChildren();\n\n            function updateRudder(value, port) {\n                if(angular.isDefined(value)) {\n                    var rudderColor = vm.colors.rudder;\n                    if(Math.abs(Math.round(value))>0) {\n                        rudderColor = value > 0 ? vm.colors.green : vm.colors.red;\n                    }\n\n                    var rudderShape = easelJsUtils.createRudder(rudderColor);\n                    rudderShape.y = 22;\n                    rudderShape.x = port ? 10 : -10;\n                    rudderShape.scaleX = rudderShape.scaleY = 12/100;\n                    rudderShape.rotation = -value;\n                    frontContainer.addChild(rudderShape);\n                }\n            }\n\n            updateRudder(vm.PROP_VDR.starboardRudder.value, false);\n            updateRudder(vm.PROP_VDR.portRudder.value, true)\n\n            function updateArrow(value, y) {\n                if(angular.isDefined(value)) {\n                    if(Math.abs(Math.round(value))>0) {\n                        var arrowColor = value > 0 ? vm.colors.green : vm.colors.red;\n                        var arrowShape = easelJsUtils.createArrow(arrowColor, Math.abs(value));\n                        arrowShape.y = y;\n                        arrowShape.x = 0;\n                        arrowShape.scaleX = arrowShape.scaleY = 0.1;\n                        arrowShape.rotation = value > 0 ? 90 : 270;\n                        frontContainer.addChild(arrowShape);\n                    }\n                }\n            }\n\n            updateArrow(vm.PROP_VDR.trans1.value, -38);\n            updateArrow(vm.PROP_VDR.trans2.value, -25);\n            updateArrow(vm.PROP_VDR.trans3.value, -12);\n            updateArrow(vm.PROP_VDR.trans4.value, 10);\n\n            function updateMain(value, x) {\n                var mainShape = easelJsUtils.createGaugge(vm.colors.tick, vm.colors.zero,\n            \t\tvalue, vm.colors.forward, vm.colors.backward);\n                    mainShape.y = 2;\n                    mainShape.x = x;\n                    mainShape.scaleX = 0.23;\n                    mainShape.scaleY = 0.3;\n                    mainShape.rotation = 270;\n                    frontContainer.addChild(mainShape);\n            }\n\n            updateMain(vm.PROP_ENGINE.portMain.value, 35);\n            updateMain(vm.PROP_ENGINE.starboardMain.value, -35);\n        }\n\n\n         function updateLabels() {\n            canvasWidth = canvas.offsetWidth;\n            canvasHeight = canvas.offsetHeight;\n            var canvasX = canvas.offsetLeft;\n            var canvasY = canvas.offsetTop;\n\n            var delta = canvasHeight*5/100;\n\n            vm.PROP_VDR.trans1.x = canvasX + 1.6*canvasWidth/2;\n            vm.PROP_VDR.trans1.y = canvasY + canvasHeight*(50 - 38)/100;\n\n            vm.PROP_VDR.trans2.x = canvasX + 1.6*canvasWidth/2;\n            vm.PROP_VDR.trans2.y = canvasY + canvasHeight*(50 - 25)/100;\n\n            vm.PROP_VDR.trans3.x = canvasX + 1.6*canvasWidth/2;\n            vm.PROP_VDR.trans3.y = canvasY + canvasHeight*(50 - 12)/100;\n\n            vm.PROP_VDR.trans4.x = canvasX + 1.6*canvasWidth/2;\n            vm.PROP_VDR.trans4.y = canvasY + canvasHeight*(50 + 10)/100;\n\n            vm.PROP_VDR.portRudder.x = canvasX + 1.05*canvasWidth/2;\n            vm.PROP_VDR.portRudder.y = canvasY + canvasHeight*(50 +44)/100;\n\n            vm.PROP_VDR.starboardRudder.x = canvasX + 0.60*canvasWidth/2;\n            vm.PROP_VDR.starboardRudder.y = canvasY + canvasHeight*(50 +44)/100;\n\n            vm.PROP_ENGINE.portMain.x = canvasX + 1.3*canvasWidth/2;\n            vm.PROP_ENGINE.portMain.y = canvasY + canvasHeight*(50 + 30)/100;\n\n            vm.PROP_ENGINE.starboardMain.x = canvasX + 0.4*canvasWidth/2;\n            vm.PROP_ENGINE.starboardMain.y = canvasY + canvasHeight*(50 +30)/100;\n        }\n    }\n})();\n\n/*\n * Traverse tribord\n * \n * DA 1 max 800kW\n * DA 3 max 1200kW\n * \n * Traverse bbord\n * DA 2 max 1200kW\n * DA 4 max 800kW\n */\n\n(function () {\n    'use strict';\n    \n    /** Propulsion component **/\n    angular.module('tsa.tsaViews.propulsionTl', []).component('tsaPropulsionTl', {\n        templateUrl: \"app/tsa-views/propulsion-tl/propulsion-tl.html\",\n        controllerAs: \"ctrl\",\n        controller: propulsionControllerTl,\n        bindings: {\n            config: '=',\n            cardId: '@',\n            onChangeCardType: '&'\n        }\n    });\n\n    /** Propulsion controller **/\n    function propulsionControllerTl(acquisitionService, $timeout, $scope, easelJsUtils, themeService) {\n        var vm = this;\n        var TAG = '[propulsionControllerTl] ';\n\n        /**------------------------------ PROPERTIES -------------------------------**/\n\n        //Canvas\n        vm.canvasId = \"canvas-propulsion-tl-\" + vm.cardId;\n\n        var canvas;\n        var stage;\n        var backContainer;\n        var frontContainer;\n        \n        var canvasWidth;\n        var canvasHeight;\n       \n        vm.readyToDraw = false;\n\n        vm.colors = {\n        \tbackground: '#CCCCCC',\n        \tzero: '#EE2222',\n        \ttick: '#888888',\n        \trudder: '#000000',\n        \tgreen: '#11CC11',\n        \tred: '#EE2222',\n        \tforward: '#1111DD',\n        \tbackward: '#000000',\n        \tfunkyBackground: '#F3BF52'\n        };\n        \n        vm.themeChanged = function themeChanded(event, theme) {\n        \tconsole.log(\"propulsion themechanged\");\n        };\n        \n        themeService.subscribe($scope, vm.themeChanged);\n        \n        /**------------------------------ METHODS -------------------------------**/\n\n        /** Initialization function **/\n        vm.$onInit = function init() {\n\n            console.log(TAG + '$onInit: deviceId = ' + (this.config ? this.config.deviceId : 'config undefined'));\n\n            if (this.config == undefined || this.config.deviceId == undefined) {\n                console.error(TAG + 'device Id not found!');\n                return;\n            }\n\n            vm.deviceId = this.config.deviceId; //Component parameter (mandatory)\n            vm.device = acquisitionService.registerForDevice(vm.deviceId);\n\n            vm.frameId = 'tlpropulsion';\n\n            //Create object to add x and y properties\n            vm.frontTrans = { id: 'fronttrans' };\n            vm.rearTrans= { id: 'reartrans' };\n            vm.main = { id: 'main' };\n            vm.angle = {id: 'angle' };\n            vm.gene1 = {id: 'gene1' };\n            vm.gene2 = {id: 'gene2' };\n            vm.gene3 = {id: 'gene3' };\n            vm.gene4 = {id: 'gene4' };\n            vm.fontsize = 1;\n\n            vm.frameListener = acquisitionService.registerForDevice(vm.deviceId).registerForFrame(vm.frameId);\n            vm.frameListener.promise.then({}, {}, function (frame) {\n            \tvm.frontTrans.value = frame.value[vm.frontTrans.id];\n            \tvm.rearTrans.value = frame.value[vm.rearTrans.id];\n            \tvm.main.value = frame.value[vm.main.id];\n            \tvm.angle.value = frame.value[vm.angle.id];\n            \tvm.gene1.value = parseFloat(frame.value[vm.gene1.id]);\n            \tvm.gene2.value = parseFloat(frame.value[vm.gene2.id]);\n            \tvm.gene3.value = parseFloat(frame.value[vm.gene3.id]);\n            \tvm.gene4.value = parseFloat(frame.value[vm.gene4.id]);\n            \t\n            \tif(vm.readyToDraw) {\n                    updateFrontContainer();\n            \t\tstage.update();\n            \t}\n            });\n\n            $timeout(function () {\n                initCanvas();\n                vm.readyToDraw = true;\n            }, 500); \n\n        };\n\n        /** Destroy function: remove the data listeners */\n        vm.$onDestroy = function destroy() {\n            if (angular.isDefined(vm.frameListener))\n                acquisitionService.registerForDevice(vm.deviceId).unregisterForFrame(vm.frameListener);\n        };\n        \n        /**Initialize the canvas **/\n        function initCanvas() {\n            canvas = document.getElementById(vm.canvasId);\n            if (canvas != null) {\n                stage = new createjs.Stage(canvas);\n                \n                backContainer = new createjs.Container();\n                frontContainer = new createjs.Container();\n                \n                stage.addChild(backContainer, frontContainer);\n                \n                $scope.$watch(function () {\n                    return canvas.offsetHeight\n                }, function () {\n                    updateCanvasSize();\n                });\n                $scope.$watch(function () {\n                    return canvas.offsetWidth\n                }, function () {\n                    updateCanvasSize();\n                });\n                updateCanvasSize();\n            }\n        }\n\n        /** Create the stage if needed, reset the canvas and redraw all the shapes **/\n        function updateCanvasSize() {\n            if (canvas != null) {\n                canvasWidth = canvas.offsetWidth;\n                canvasHeight = canvas.offsetHeight;\n\n                //Canvas size properties setting\n                canvas.setAttribute('width', canvasWidth);\n                canvas.setAttribute('height', canvasHeight);\n\n/*                angular.element(canvas).parent().find(\"tsa-data-view .value\").css({\n                \t\"font-size\": \"\"+canvasHeight/200+\"em\"\n        \t\t}); \n*/\n/*\n                angular.element(canvas).parent().find(\"tsa-data-view\").css({\n                \t\"width\": \"\"+Math.round(canvasHeight/3)+\"px !important\",\n                \t\"max-width\": \"\"+Math.round(canvasHeight/3)+\"px\",\n                \t\"background-color\": \"green\"\n                });\n*/\n\n                stage.x = canvasWidth/2;\n                stage.y = canvasHeight/2;\n            \tvar scale = canvasHeight/100;\n            \tstage.scaleX = stage.scaleY = scale;\n            \t                \n                updateBackContainer();\n                backContainer.cache(-canvasWidth/2, -canvasHeight/2, canvasWidth, canvasHeight, scale);\n                updateFrontContainer();\n                updateLabels();\n\n                stage.update();\n            }\n        }\n        \n        \n        function updateBackContainer() {\n        \tbackContainer.removeAllChildren();\n        \t\n            var vesselShape = easelJsUtils.createVessel(vm.colors.tick);\n            vesselShape.scaleX = 0.6;\n            vesselShape.scaleY = 0.95;\n            \n            var backRudderShape =  easelJsUtils.createBackRudder(vm.colors.background)\n            backRudderShape.y = 25;\n            backRudderShape.scaleX = backRudderShape.scaleY = 18/100;\n            \n            var rearPropBackGaugeShape = easelJsUtils.createBackGauge(vm.colors.background);\n            rearPropBackGaugeShape.y = 18;\n            rearPropBackGaugeShape.scaleX = 0.4;\n            rearPropBackGaugeShape.scaleY = 0.3;\n         \n\t\t\tvar frontPropBackGaugeShape = easelJsUtils.createBackGauge(vm.colors.background);\n\t\t\tfrontPropBackGaugeShape.y = -38;\n\t\t\tfrontPropBackGaugeShape.scaleX = 0.4;\n\t\t\tfrontPropBackGaugeShape.scaleY = 0.3;\n\t\t\t  \n\t\t\tvar mainBackGaugeShape = easelJsUtils.createBackGauge(vm.colors.background);\n\t\t\tmainBackGaugeShape.y = -10;\n\t\t\tmainBackGaugeShape.scaleX = 0.4;\n\t\t\tmainBackGaugeShape.scaleY = 0.3;\n\t\t\tmainBackGaugeShape.rotation = 270;\n\n            backContainer.addChild(vesselShape, backRudderShape, rearPropBackGaugeShape, frontPropBackGaugeShape, mainBackGaugeShape);\n        }\n        \n        function updateFrontContainer() {\n        \tfrontContainer.removeAllChildren();        \t\n\n            var rudderColor = vm.colors.rudder;\n\t\t\tif(Math.abs(Math.round(vm.angle.value))>0) {\n\t\t\t\trudderColor = vm.angle.value > 0 ? vm.colors.red : vm.colors.green;\n\t\t\t}\n            \n            var rudderShape = easelJsUtils.createRudder(rudderColor);\n            rudderShape.y = 25;\n            rudderShape.scaleX = rudderShape.scaleY = 18/100;\n            rudderShape.rotation = vm.angle.value;\n            \n            var rearPropGaugeShape = easelJsUtils.createGaugge(vm.colors.tick, vm.colors.zero, \n            \t\tvm.rearTrans.value, vm.colors.green, vm.colors.red);\n            rearPropGaugeShape.y = 18;\n            rearPropGaugeShape.scaleX = 0.4;\n            rearPropGaugeShape.scaleY = 0.3;\n            \n            var frontPropGaugeShape = easelJsUtils.createGaugge(vm.colors.tick, vm.colors.zero, \n            \t\tvm.frontTrans.value, vm.colors.green, vm.colors.red);\n            frontPropGaugeShape.y = -38;\n            frontPropGaugeShape.scaleX = 0.4;\n            frontPropGaugeShape.scaleY = 0.3;\n            \n            var mainGaugeShape = easelJsUtils.createGaugge(vm.colors.tick, vm.colors.zero, \n            \t\tvm.main.value*100/150, vm.colors.forward, vm.colors.backward);\n            mainGaugeShape.y = -10;\n            mainGaugeShape.scaleX = 0.4;\n            mainGaugeShape.scaleY = 0.3;\n            mainGaugeShape.rotation = 270;\n            \n            frontContainer.addChild(rudderShape, rearPropGaugeShape, frontPropGaugeShape, mainGaugeShape);\n        }\n        \n\n        function updateLabels() {\n            canvasWidth = canvas.offsetWidth;\n            canvasHeight = canvas.offsetHeight;\n            var canvasX = canvas.offsetLeft;\n            var canvasY = canvas.offsetTop;\n        \t\n            vm.frontTrans.x = canvasX + 1.4*canvasWidth/2;\n            vm.frontTrans.y = canvasY + canvasHeight*(50 - 38)/100;\n\n            vm.rearTrans.x = vm.frontTrans.x;\n            vm.rearTrans.y = canvasY + canvasHeight*(50 + 18)/100;\n        \n            vm.main.x = vm.frontTrans.x;\n            vm.main.y = canvasY + canvasHeight*(50 - 10)/100;\n            \n            vm.angle.x = vm.frontTrans.x;\n            vm.angle.y = canvasY + canvasHeight*(50 + 32)/100;\n\n            vm.gene1.y = vm.frontTrans.y;\n            vm.gene2.y = vm.gene1.y + 50;\n            vm.gene3.y = vm.gene2.y + 50;\n            vm.gene4.y = vm.gene3.y + 50;\n            vm.gene1.x = canvasX + 10;\n            vm.gene2.x = canvasX + 10;\n            vm.gene3.x = canvasX + 10;\n            vm.gene4.x = canvasX + 10;\n\n        }\n    }\n})();\n\n(function () {\n    'use strict';\n\n    var excelToDate = function(excelDate) {\n        return (excelDate - (25569))*86400*1000;\n    }\n\n    var VincentyConstants = {\n        a: 6378137,\n        b: 6356752.3142,\n        f: 1/298.257223563\n    };    \n\n    var rad = function(x) {return x*Math.PI/180;};\n\n    var distVincenty = function(lat1, lon1, lat2, lon2) {\n        var p1 = { lat: lat1, lon: lon1};\n        var p2 = { lat: lat2, lon: lon2};\n\n        var ct = VincentyConstants;\n        var a = ct.a, b = ct.b, f = ct.f;\n    \n        var L = rad(p2.lon - p1.lon);\n        var U1 = Math.atan((1-f) * Math.tan(rad(p1.lat)));\n        var U2 = Math.atan((1-f) * Math.tan(rad(p2.lat)));\n        var sinU1 = Math.sin(U1), cosU1 = Math.cos(U1);\n        var sinU2 = Math.sin(U2), cosU2 = Math.cos(U2);\n        var lambda = L, lambdaP = 2*Math.PI;\n        var iterLimit = 20;\n        while (Math.abs(lambda-lambdaP) > 1e-12 && --iterLimit>0) {\n            var sinLambda = Math.sin(lambda), cosLambda = Math.cos(lambda);\n            var sinSigma = Math.sqrt((cosU2*sinLambda) * (cosU2*sinLambda) +\n            (cosU1*sinU2-sinU1*cosU2*cosLambda) * (cosU1*sinU2-sinU1*cosU2*cosLambda));\n            if (sinSigma==0) {\n                return 0;  // co-incident points\n            }\n            var cosSigma = sinU1*sinU2 + cosU1*cosU2*cosLambda;\n            var sigma = Math.atan2(sinSigma, cosSigma);\n            var alpha = Math.asin(cosU1 * cosU2 * sinLambda / sinSigma);\n            var cosSqAlpha = Math.cos(alpha) * Math.cos(alpha);\n            var cos2SigmaM = cosSigma - 2*sinU1*sinU2/cosSqAlpha;\n            var C = f/16*cosSqAlpha*(4+f*(4-3*cosSqAlpha));\n            lambdaP = lambda;\n            lambda = L + (1-C) * f * Math.sin(alpha) *\n            (sigma + C*sinSigma*(cos2SigmaM+C*cosSigma*(-1+2*cos2SigmaM*cos2SigmaM)));\n        }\n        if (iterLimit==0) {\n            return NaN;  // formula failed to converge\n        }\n        var uSq = cosSqAlpha * (a*a - b*b) / (b*b);\n        var A = 1 + uSq/16384*(4096+uSq*(-768+uSq*(320-175*uSq)));\n        var B = uSq/1024 * (256+uSq*(-128+uSq*(74-47*uSq)));\n        var deltaSigma = B*sinSigma*(cos2SigmaM+B/4*(cosSigma*(-1+2*cos2SigmaM*cos2SigmaM)-\n            B/6*cos2SigmaM*(-3+4*sinSigma*sinSigma)*(-3+4*cos2SigmaM*cos2SigmaM)));\n        var s = b*A*(sigma-deltaSigma);\n        var d = s.toFixed(3)/1000; // round to 1mm precision\n        return d * 1000.0;\n    };\n    \n    \n    /** Route component declaration **/\n    angular.module('tsa.tsaViews.routeMd', []).component('tsaRouteMd', {\n        templateUrl: \"app/tsa-views/route/route.html\",\n        controllerAs: \"ctrl\",\n        controller: routeController,\n        bindings: {\n            config: '=',\n            cardId: '@',\n            onChangeCardType: '&'\n        }\n    });\n\n    /** Route controller */\n    function routeController($log, $interval, $http, $rootScope, $scope, $anchorScroll, $location,\n        acquisitionService, statusService,\n        MD_ADDONS_URL, NAVIGATION) {\n        $anchorScroll.yOffset = 50;   // always scroll by 50 extra pixels\n        var vm = this;\n\n        /**-------------------- PROPERTIES ----------------**/\n        var intervalPromise;\n        vm.deviceId = this.config.deviceId;\n        vm.frameId = this.config.frameId;\n        vm.latitude = undefined;\n        vm.longitude = undefined;\n        vm.speed = undefined;\n        vm.index = undefined;\n        vm.eta = undefined;\n        vm.curdist = undefined;\n        vm.currentWpt = undefined;\n\n        vm.previroute = undefined;\n            \n        vm.ready = false;\n\n        vm.header = ['views.route.name', 'views.route.type', 'views.route.eta', 'views.route.stationduration',\n            'views.route.etanextwpt', 'views.route.distance', 'views.route.time'];\n\n        vm.route = [];\n\n        vm.updateReady = function updateReady() {\n            vm.ready = ( (vm.route.length > 1) && \n                        (vm.index != undefined) &&\n                        ((vm.latitude != undefined) && (vm.longitude != undefined) && (vm.speed != undefined)) &&\n                        (vm.curdist != undefined) &&\n                        (statusService.getLocalTimeZoneOffset()));\n        }\n\n        /**\n         * Init function\n         */\n        vm.$onInit = function init() {\n            intervalPromise = $interval(function () {\n                vm.updateRoute();\n            }, 10000);\n            vm.updateRoute();\n\n            var shipnavFrameListener = acquisitionService.registerForDevice(vm.deviceId).registerForFrame(NAVIGATION.FRAME_SHIPNAV);\n            shipnavFrameListener.promise.then({}, {}, parseShipnav);\n            function parseShipnav(receivedFrame) {\n                vm.latitude = receivedFrame.value[NAVIGATION.LATITUDE].map(parseFloat);\n                vm.longitude = receivedFrame.value[NAVIGATION.LONGITUDE].map(parseFloat);\n                vm.speed = receivedFrame.value[NAVIGATION.GROUND_SPEED].map(parseFloat);\n                vm.calculateRoute();\n            }\n\n            var waypointsFrameListener = acquisitionService.registerForDevice(vm.deviceId).registerForFrame(NAVIGATION.FRAME_WAYPOINTS);\n            waypointsFrameListener.promise.then({}, {}, parseWaypoints);\n            function parseWaypoints(receivedFrame) {\n                vm.index = receivedFrame.value[NAVIGATION.INDEX].map(parseInt);\n                vm.calculateRoute();\n            }\n            \n            var routingFrameListener = acquisitionService.registerForDevice(vm.deviceId).registerForFrame(NAVIGATION.FRAME_ROUTING);\n            routingFrameListener.promise.then({}, {}, parseRouting);\n            function parseRouting(receivedFrame) {\n                if(receivedFrame.value[NAVIGATION.CUR_DIST].length)\n                    vm.curdist = receivedFrame.value[NAVIGATION.CUR_DIST].map(parseFloat)[0];\n                if(receivedFrame.value[NAVIGATION.ETA].length)\n                    vm.eta = receivedFrame.value[NAVIGATION.ETA].map(parseFloat)[0];\n                vm.calculateRoute();\n            }\n        };\n\n        /**\n         * Destroy function\n         */\n        vm.$onDestroy = function onDestroy() {\n            if (angular.isDefined(intervalPromise))\n                $interval.cancel(intervalPromise);\n\n            if (angular.isDefined(shipnavFrameListener)) {\n                acquisitionService.registerForDevice(vm.deviceId).unregisterForFrame(shipnavFrameListener);\n            }\n    \n            if (angular.isDefined(waypointsFrameListener)) {\n                acquisitionService.registerForDevice(vm.deviceId).unregisterForFrame(waypointsFrameListener);\n            }\n\n            if (angular.isDefined(routingFrameListener)) {\n                acquisitionService.registerForDevice(vm.deviceId).unregisterForFrame(routingFrameListener);\n            }\n        };\n\n        vm.updateRoute = function() {\n            $http.get(MD_ADDONS_URL + '/api/previroute').then(\n                function(response) {\n                    vm.previroute = response.data;\n                    vm.calculateRoute();\n                }\n            );\n        }\n\n        vm.calculateRoute = function() {\n            vm.route = [];\n\n            if( ((vm.previroute != undefined) && (vm.previroute.route.length)) &&\n                (vm.index != undefined) &&\n                ((vm.latitude != undefined) && (vm.longitude != undefined) && (vm.speed != undefined)) &&\n                (vm.curdist != undefined) &&\n                (statusService.getLocalTimeZoneOffset())) {\n                \n                var now = (new Date()).getTime();\n\n                var currentIndex = vm.index - 1;\n                var toIndex = -1;\n                for(var i=0; i<vm.previroute.route.length; i++) {\n                    if(vm.previroute.to === vm.previroute.route[i].name) {\n                        toIndex = i;\n                        break;\n                    }\n                }\n\n                var wpt = {};\n                wpt = {};\n                wpt.name = '';\n                wpt.type = '';\n                wpt.duration = 0.0;\n                wpt.eta = 0;\n                wpt.etanext = excelToDate(vm.eta);\n                wpt.distance = vm.curdist;\n                wpt.time = (wpt.etanext - now);\n                vm.route.push(wpt);\n\n                var newPrevi = [];\n                for(var i=currentIndex; i<toIndex+1; i++) {\n                    if(vm.previroute.route[i].visible) {\n                        newPrevi.push(vm.previroute.route[i]);\n                    }\n                }\n\n                var curEta = wpt.etanext;\n                for(var i=0; i<newPrevi.length-1; i++) {\n                    var curWpt = newPrevi[i];\n                    var nextWpt = newPrevi[i+1];\n\n                    var wpt = {};\n                    wpt.name = curWpt.name;\n                    wpt.type = curWpt.stationtype;\n                    wpt.duration = curWpt.stationtime * 60.0 * 60.0 * 1000.0;\n                    wpt.distance = distVincenty(curWpt.latitude, curWpt.longitude,\n                        nextWpt.latitude, nextWpt.longitude);\n                    wpt.time = ((wpt.distance/1852) / curWpt.speed) * 60.0 * 60.0 * 1000.0;\n                    wpt.eta = curEta;\n                    wpt.etanext = wpt.eta + wpt.time + wpt.duration;\n\n                    curEta = wpt.etanext;\n                    vm.route.push(wpt);\n                }\n\n                var wpt = {};\n                wpt = {};\n                wpt.name = nextWpt.name;\n                wpt.type = nextWpt.type;\n                wpt.duration = 0.0;\n                wpt.eta = curEta;\n                wpt.distance = 0;\n                wpt.time = 0;\n                vm.route.push(wpt);\n\n                vm.updateReady();\n            }\n        }\n    }\n})();\n\n(function () {\n    'use strict';\n\n    /** Component declaration **/\n    angular.module('tsa.tsaViews.species', []).component('tsaSpecies', {\n        templateUrl: \"app/tsa-views/species/species.html\",\n        controllerAs: \"ctrl\",\n        controller: speciesController,\n        bindings: {\n            config: '=',\n            cardId: '@',\n            onChangeCardType: '&'\n        }\n    });\n\n    /** Component controller */\n    function speciesController($log, HAUL) {\n\n        /**------------------------------ PROPERTIES -----------------------------**/\n        var vm = this;\n        vm.logger = $log.getInstance(\"Species-tsa-view\");\n\n        /**------------------------------- METHODS -------------------------------**/\n\n        /** Initialization function **/\n        vm.$onInit = function init() {\n            if (angular.isUndefined(this.config) || angular.isUndefined(this.config.deviceId) || angular.isUndefined(this.config.frameId)) {\n                vm.logger.error('config and/or deviceId and/or frameId not defined!');\n                return;\n            }\n\n            vm.deviceId = this.config.deviceId;\n            vm.frameId = this.config.frameId;\n\n            vm.haul = HAUL.HAUL_ID;\n\n            vm.pocket = HAUL.POCKET;\n            vm.totalPocket = HAUL.TOTAL_POCKET_WEIGHT;\n\n            vm.speciesId = HAUL.SPECIES_ID;\n            vm.sign = HAUL.SPECIES_SIGN;\n\n            vm.box = HAUL.BOX_ID;\n            vm.boxWeight = HAUL.BOX_WEIGHT;\n            vm.boxDest = HAUL.BOX_DESTINATION;\n\n            vm.totalSpecies = HAUL.SPECIES_WEIGHT;\n            vm.totalSorted = HAUL.TOTAL_SORTED_SPECIES_WEIGHT;\n\n        };\n    }\n})();\n\n(function () {\n    'use strict';\n    angular.module('tsa.tsaViews.thermoConfig', []).component('tsaThermoConfig', {\n        templateUrl: \"app/tsa-views/thermoConfig/thermoConfig.html\",\n        controllerAs: \"ctrl\",\n        controller: thermoConfigController,\n        bindings: {\n            onChangeCardType: '&',\n            cardId: '@'\n        }\n    });\n\n    function thermoConfigController($log, $cookies, FileUploader) {\n        var vm = this;\n\n        /**-------------------- PROPERTIES ----------------**/\n        vm.view = 'General';\n        vm.thermo = {};\n        vm.instrument = {};\n        vm.intakeTemperatureSensor = {};\n        vm.conductivitySensor = {};\n        vm.temperatureSensor = {};\n\n        /**-------------------- PUBLIC METHODS ----------------**/\n\n        vm.init = function init() {\n            vm.logger = $log.getInstance(\"ThermoConfig\");\n            var csrf = $cookies.csrftoken;\n            csrf = $cookies.get(\"XSRF-TOKEN\");\n            vm.uploader = new FileUploader(\n                {url: 'api/files', headers: {'X-XSRF-TOKEN': csrf}}\n            );\n            vm.uploader.onSuccessItem = function (item, response, status, headers) {\n                vm.logger.log(response);\n                vm.instrument = response.instrument;\n                vm.temperatureSensor = vm.instrument.sensorArray.sensor[0].temperatureSensor;\n                vm.conductivitySensor = vm.instrument.sensorArray.sensor[1].conductivitySensor;\n                vm.intakeTemperatureSensor = vm.instrument.sensorArray.sensor[2].temperatureSensor;\n            };\n            vm.uploader.onAfterAddingFile = function (item, filter, options) {\n                if (vm.uploader.queue.length > 1) {\n                    vm.uploader.queue.splice(0, 1);\n                }\n            };\n        };\n    }\n})();\n\n(function () {\n    'use strict';\n\n    /** Component declaration **/\n    angular.module('tsa.tsaViews.thermometer', []).component('tsaThermometer', {\n        templateUrl: \"app/tsa-views/thermometer/thermometer.html\",\n        controllerAs: \"ctrl\",\n        controller: thermometerController,\n        bindings: {\n            config: '=',\n            cardId: '@',\n            onChangeCardType: '&'\n        }\n    });\n\n    /** Component controller */\n    function thermometerController($log, THERMOMETER, acquisitionService) {\n\n        /**------------------------------ PROPERTIES -----------------------------**/\n        var vm = this;\n        vm.logger = $log.getInstance(\"tsa-thermometer\");\n\n        /**------------------------------- METHODS -------------------------------**/\n\n        /** Initialization function **/\n        vm.$onInit = function init() {\n            if (angular.isUndefined(this.config) || angular.isUndefined(this.config.deviceId) || angular.isUndefined(this.config.frameId)) {\n                vm.logger.error('config and/or deviceId and/or frameId not defined!');\n                return;\n            }\n\n            vm.deviceId = this.config.deviceId;\n            vm.frameId = this.config.frameId;\n            this.THERMOMETER = THERMOMETER;\n        };\n    }\n})();\n\n(function () {\n    'use strict';\n\n    /** Component declaration */\n    angular.module('tsa.tsaViews.thermosal', []).component('tsaThermosal', {\n        templateUrl: \"app/tsa-views/thermosal/thermosal.html\",\n        controllerAs: \"ctrl\",\n        controller: thermosalController,\n        bindings: {\n            config: '=',\n            cardId: '@',\n            onChangeCardType: '&'\n        }\n    });\n\n    /** Component controller */\n    function thermosalController($log, THERMOSAL) {\n        var vm = this;\n        vm.logger = $log.getInstance(\"thermosal-tsa-view\");\n\n        /** Initialization function */\n        vm.$onInit = function init() {\n\n            if (angular.isUndefined(this.config)\n                || angular.isUndefined(this.config.deviceId)\n                || angular.isUndefined(this.config.frameId)\n                || angular.isUndefined(this.config.flowDeviceId)) {\n                vm.logger.error('deviceId or/and frameId or/and flowDeviceId not defined!');\n                return;\n            }\n\n            vm.deviceId = this.config.deviceId;\n\n            // properties defined in the front-end configuration file (parameter.json)\n            vm.frameId = this.config.frameId;\n            vm.flowDeviceId = this.config.flowDeviceId;\n\n            // constants defined in devices.constants.js\n            vm.TS = THERMOSAL;\n        };\n    }\n})();\n\n(function () {\n    'use strict';\n\n    /** Trawl component **/\n    angular.module('tsa.tsaViews.trawl', []).component('tsaTrawl', {\n        templateUrl: \"app/tsa-views/trawl/trawl.html\",\n        controllerAs: \"ctrl\",\n        controller: trawlController,\n        bindings: {\n            config: '=',\n            cardId: '@',\n            onChangeCardType: '&'\n        }\n    });\n\n    /** Trawl controller **/\n    function trawlController(acquisitionService, $timeout, TRAWL, NAVIGATION, $scope, userService) {\n        var vm = this;\n        var TAG = '[trawlController] ';\n\n        /**------------------------------ PROPERTIES -------------------------------**/\n\n        //Canvas\n        vm.canvasId = \"canvas-weather-\" + vm.cardId;\n        var trawlShape;\n        var canvas;\n        var stage;\n        var canvasWidth;\n        var canvasHeight;\n        \n        /**-------------------------- INITIALIZATION / DESTROY METHODS -------------------------**/\n\n        /** Initialization function **/\n        vm.$onInit = function init() {\n\n            console.log(TAG + '$onInit: deviceId = ' + (this.config ? this.config.deviceId : 'config undefined'));\n\n            if (this.config == undefined || this.config.deviceId == undefined) {\n                console.error(TAG + 'device Id not found!');\n                return;\n            }\n\n            vm.deviceId = this.config.deviceId; //Component parameter (mandatory)\n            vm.device = acquisitionService.registerForDevice(vm.deviceId);\n\n            vm.frameId = TRAWL.FRAME; //shipnav frame;\n\n            //Create object to add x and y properties\n            vm.verSpread = { id: TRAWL.VERTICAL_SPREAD };\n            vm.clearance = { id: TRAWL.CLEARANCE };\n            vm.doorDistance = { id: TRAWL.DOOR_DISTANCE };\n            vm.horSpread = { id: TRAWL.HORIZONTAL_SPREAD };\n            vm.altitude = { id: TRAWL.ALTITUDE };\n            vm.immersion = { id: TRAWL.DEPTH };\n\n            vm.temp = TRAWL.TEMP;\n            vm.sounder = {\n                deviceId: NAVIGATION.DEVICE_ID,\n                frameId: NAVIGATION.FRAME_SHIPNAV,\n                data: NAVIGATION.SOUNDER\n            };\n\n            vm.dataFormat = '%.1f';\n\n            $timeout(function () {\n                initCanvas();\n                drawTrawl();\n            }, 500);\n\n        };\n\n        /**------------------------------ PRIVATE METHODS -------------------------------**/\n\n        /**Initialize the canvas **/\n        function initCanvas() {\n            canvas = document.getElementById(vm.canvasId);\n            if (canvas != null) {\n                stage = new createjs.Stage(canvas);\n                $scope.$watch(function () {\n                    return canvas.offsetHeight\n                }, function () {\n                    updateCanvasSize();\n                });\n                $scope.$watch(function () {\n                    return canvas.offsetWidth\n                }, function () {\n                    updateCanvasSize();\n                });\n                updateCanvasSize();\n            }\n        }\n\n        /** Create the stage if needed, reset the canvas and redraw all the shapes **/\n        function updateCanvasSize() {\n            if (canvas != null) {\n\n                canvasWidth = canvas.offsetWidth;\n                canvasHeight = canvas.offsetHeight;\n\n                //Canvas size properties setting\n                canvas.setAttribute('width', canvasWidth);\n                canvas.setAttribute('height', canvasHeight);\n\n                // Reset canvas\n                stage.removeAllChildren();\n\n                // Redraw shapes\n                drawTrawl();\n                stage.update();\n            }\n        }\n\n        /** Draw the trawl shape **/\n        function drawTrawl() {\n            canvas = document.getElementById(vm.canvasId);\n            if (canvas != null)\n                stage = new createjs.Stage(canvas);\n\n            // Create shape and set properties (color, size...)\n            trawlShape = new createjs.Shape();\n            stage.addChild(trawlShape);\n\n            // Center point\n            trawlShape.x = canvasWidth / 1.65;\n            trawlShape.y = canvasHeight / 1.8;\n\n            trawlShape.graphics.beginStroke('#757575').setStrokeStyle(2, 'round');\n\n\n            /*           TRAWL REPRESENTATION\n             ----------------------------------> X\n             |\n             | F1-----------D1 ---------- D2\n             |        A1    |              |   A2\n             |   E1   |     |      .[0,0]  |   |    E2\n             |        B1    |              |   B2\n          Y  V              C1----------- C2\n             */\n\n            var rectWidth = canvasWidth / 3.7;\n            var rectHeight = canvasHeight / 3;\n\n            var A1 = [-rectWidth * 0.9, - rectHeight / 6];\n            var B1 = [A1[0], A1[1] + rectHeight / 3];\n            var C1 = [-rectWidth / 2, rectHeight / 2];\n            var D1 = [C1[0], -C1[1]];\n            var E1 = [-rectWidth * 1.3, 0];\n\n            var A2 = [-A1[0], A1[1]];\n            var B2 = [-B1[0], B1[1]];\n            var C2 = [-C1[0], C1[1]];\n            var D2 = [-D1[0], D1[1]];\n            var E2 = [-E1[0], E1[1]];\n\n            var F1 = [-canvasWidth / 2, D1[1] * 1.3];\n\n            var quadCurveVertOffset = D1[1] * 1.6;\n            var quadCurveHorzOffset = -D1[0] * 1.7;\n\n            var panelWidth = canvasWidth / 60;\n            var panelHeight = canvasHeight / 8;\n\n            var doorDistArrowOffset = - 0.9*rectHeight;\n\n            trawlShape.graphics\n                // Main ellipse\n                .beginFill('rgba(67, 203, 44, 0.1)')\n                .beginStroke('#8BC34A')\n\n                .moveTo(A1[0], A1[1])\n                .lineTo(D1[0], D1[1])\n                .quadraticCurveTo(0, quadCurveVertOffset, D2[0], D2[1])\n                .lineTo(A2[0], A2[1])\n                .lineTo(B2[0], B2[1])\n                .lineTo(C2[0], C2[1])\n                .quadraticCurveTo(0, -quadCurveVertOffset, C1[0], C1[1])\n                .lineTo(B1[0], B1[1])\n                .lineTo(A1[0], A1[1])\n\n                .endFill()\n                .moveTo(D1[0], D1[1])\n                .quadraticCurveTo(-quadCurveHorzOffset, 0, C1[0], C1[1])\n                .moveTo(D2[0], D2[1])\n                .quadraticCurveTo(quadCurveHorzOffset, 0, C2[0], C2[1])\n\n                //Panels\n                .beginStroke('#757575')\n                .moveTo(A1[0], A1[1])\n                .lineTo(E1[0], E1[1])\n                .lineTo(B1[0], B1[1])\n                .moveTo(A2[0], A2[1])\n                .lineTo(E2[0], E2[1])\n                .lineTo(B2[0], B2[1])\n                .beginFill('#757575')\n                .drawRect(E1[0] - panelWidth / 2, E1[1] - panelHeight / 2, panelWidth, panelHeight)\n                .drawRect(E2[0] - panelWidth / 2, E1[1] - panelHeight / 2, panelWidth, panelHeight)\n\n                //Dashed line\n                .beginStroke('#757575').setStrokeStyle(1, 'round').setStrokeDash([5, 5], 0)\n                .moveTo(F1[0], F1[1])\n                .lineTo(0, F1[1])\n                .moveTo(E1[0], E1[1])\n                .lineTo(E1[0], E1[1] + doorDistArrowOffset)\n                .moveTo(E2[0], E2[1])\n                .lineTo(E2[0], E2[1] + doorDistArrowOffset);\n\n\n            //Arrow 1: door distance\n            drawArrow([E1[0], doorDistArrowOffset], [E2[0], doorDistArrowOffset], vm.doorDistance);\n            //vm.doorDistance.y -= 20 if label \n            //Arrow 2: horizontal spread\n            drawArrow([A1[0] + 3, A1[1] * 0.7], [A2[0] - 3, A2[1] * 0.7], vm.horSpread);\n            vm.horSpread.x -= rectWidth / 3;\n            //vm.horSpread.y -= 20; if label \n            //Arrow 3: vertical spread\n            drawArrow([0, D1[1] * 1.33 + 5], [0, C1[1] * 1.33 - 5], vm.verSpread);\n            vm.verSpread.y += rectHeight / 3;\n            //Arrow 4: clearance\n            drawArrow([0, C1[1] * 1.3 + 5], [0, canvasHeight - trawlShape.y - 5 - 0.05 * canvasHeight], vm.clearance);\n            //Arrow 5: altitude\n            drawArrow([F1[0], F1[1] + 5], [F1[0], canvasHeight - trawlShape.y - 5 - 0.05 * canvasHeight], vm.altitude);\n            //Arrow 6: immersion\n            drawArrow([F1[0], F1[1] - 5], [F1[0], -trawlShape.y + 5 + 0.05 * canvasHeight], vm.immersion);\n\n            //drawGround();\n            drawSurfaceAndGround();\n            \n            stage.update();\n        }\n\n        /** Draw an arrow with a label **/\n        function drawArrow(startPoint, endPoint, label) {\n            var arrowShape = new createjs.Shape();\n            stage.addChild(arrowShape);\n            arrowShape.graphics.beginStroke('#757575').setStrokeStyle(2);//.setStrokeDash([5, 5], 0);1a75ae\n\n            arrowShape.x = trawlShape.x;\n            arrowShape.y = trawlShape.y;\n\n            var headLength = 10;   // length of head in pixels\n            var angle = Math.atan2(endPoint[1] - startPoint[1], endPoint[0] - startPoint[0]);\n            arrowShape.graphics\n                .moveTo(startPoint[0], startPoint[1])\n                .lineTo(startPoint[0] + headLength * Math.cos(angle - Math.PI / 6), startPoint[1] + headLength * Math.sin(angle - Math.PI / 6))\n                .moveTo(startPoint[0], startPoint[1])\n                .lineTo(startPoint[0] + headLength * Math.cos(angle + Math.PI / 6), startPoint[1] + headLength * Math.sin(angle + Math.PI / 6))\n                .moveTo(startPoint[0], startPoint[1])\n                .lineTo(endPoint[0], endPoint[1])\n                .moveTo(endPoint[0], endPoint[1])\n                .lineTo(endPoint[0] - headLength * Math.cos(angle - Math.PI / 6), endPoint[1] - headLength * Math.sin(angle - Math.PI / 6))\n                .moveTo(endPoint[0], endPoint[1])\n                .lineTo(endPoint[0] - headLength * Math.cos(angle + Math.PI / 6), endPoint[1] - headLength * Math.sin(angle + Math.PI / 6));\n\n            //Set the label position\n            if (label != undefined) {\n                label.x = trawlShape.x + (startPoint[0] + endPoint[0]) / 2 - 50;  // - 100 with labels;\n                label.y = trawlShape.y + (startPoint[1] + endPoint[1]) / 2 - 14;  // - 12 with labels;\n            }\n        }\n\n        /** Draw the surface and the ground **/\n        function drawSurfaceAndGround() {\n            var surfShape = new createjs.Shape();\n\n            var startPointSurface = [0.02 * canvasWidth, 0.05 * canvasHeight];\n            var endPointSurface = [canvasWidth - startPointSurface[0], startPointSurface[1]];\n            var startPointGround = [startPointSurface[0], canvasHeight - startPointSurface[1]];\n            var endPointGround = [endPointSurface[0], startPointGround[1]];\n\n            stage.addChild(surfShape);\n\n            surfShape.graphics.beginStroke('')\n                .setStrokeStyle(1, 'round')\n                .beginFill('rgba(44, 151, 203, 0.1)');\n\n            var index = startPointSurface[0];//+ 5;\n            while (index < endPointSurface[0] - 60) {\n                surfShape.graphics.moveTo(index, startPointSurface[1])\n                    .arcTo(index + 30, startPointSurface[1] + 10, index + 60, startPointSurface[1], 95);\n                index += 60;\n            }\n            surfShape.graphics.lineTo(endPointSurface[0], endPointSurface[1])\n                .lineTo(endPointGround[0], endPointGround[1])\n                .lineTo(startPointGround[0], startPointGround[1])\n                .lineTo(startPointSurface[0], startPointSurface[1]);\n\n\n            surfShape.graphics.endFill().beginStroke('#757575')\n                .setStrokeStyle(1, 'round');\n\n            var index = startPointSurface[0];//+ 5;\n            while (index < endPointSurface[0] - 60) {\n                surfShape.graphics.moveTo(index, startPointSurface[1])\n                    .arcTo(index + 30, startPointSurface[1] + 10, index + 60, startPointSurface[1], 95);\n                index += 60;\n            }\n            surfShape.graphics.lineTo(endPointSurface[0], endPointSurface[1]);\n\n\n            surfShape.graphics.moveTo(startPointGround[0], startPointGround[1]).lineTo(endPointGround[0], endPointGround[1]);\n            index = startPointGround[0] + 10;\n            while (index < endPointGround[0]) {\n                surfShape.graphics.moveTo(index, startPointGround[1]).lineTo(index - 10, startPointGround[1] + 10);\n                index += 20;\n            }\n\n        }\n\n    }\n\n})();\n\n(function () {\n    'use strict';\n    angular.module('tsa.tsaViews.map').factory(\"TrawlingServiceProvider\", TrawlingServiceProvider);\n\n    function TrawlingServiceProvider($interval, $log, acquisitionService,statusService, TRAWLING) {\n\n        var trawlingService = function() {\n            var logger = $log.getInstance(\"TrawlingService\");\n\n            var vm = this;\n\n            /** Data listeners **/\n            var trawlingFrameListener;\n            vm.isAcquiring = {value: false};\n            vm.trawling = {\n                lat: undefined,\n                long: undefined,\n                starboardunwound: undefined,\n                portunwound: undefined,\n                verSpread: undefined,\n                horSpread: undefined,\n                waterropealt: undefined,\n                comment: undefined\n            };\n            vm.lastMessageTimestamp;\n\n            /** Called when a Shipnav frame has been received **/\n            function parseTrawlingFrame(receivedFrame) {\n                var timestamp = receivedFrame.timestamp;\n                vm.trawling.lat = parseFloat(receivedFrame.value[TRAWLING.LAT]);\n                vm.trawling.long = parseFloat(receivedFrame.value[TRAWLING.LONG]);\n                vm.trawling.starboardunwound = parseFloat(receivedFrame.value[TRAWLING.STARBOARDUNWOUND]);\n                vm.trawling.portunwound = parseFloat(receivedFrame.value[TRAWLING.PORTUNWOUND]);\n                vm.trawling.verSpread = parseFloat(receivedFrame.value[TRAWLING.VERTICAL_SPREAD]);\n                vm.trawling.horSpread = parseFloat(receivedFrame.value[TRAWLING.HORIZONTAL_SPREAD]);\n                vm.trawling.waterropealt = parseFloat(receivedFrame.value[TRAWLING.ALTITUDE]);\n                vm.trawling.comment = parseFloat(receivedFrame.value[TRAWLING.COMMENT]);\n\n                vm.isAcquiring.value = true;\n            }\n\n\n            return {\n/*\n                clearMultibeamArray: function () {\n                    vm.multibeamArray = [];\n                },\n                setLengthVector: function (lengthVector) {\n                    vm.lengthVector = lengthVector;\n                },\n                setMapComponent: function (mapComponent) {\n                    vm.mapComponent = mapComponent;\n                },\n                */\n                isAcquiring: function () {\n                    return vm.isAcquiring;\n                },\n                /** Initialize the data listeners (subscriptions to the acquisition service...) **/\n                initDataListener: function initDataListener(trawlingDeviceId, frameTrawlingId) {\n\n                    vm.lastMessageTimestamp = statusService.getServerTime().time;\n\n                    //1 - Shipnav frame listener\n                    trawlingFrameListener = acquisitionService.registerForDevice(trawlingDeviceId).registerForFrame(frameTrawlingId);\n                    trawlingFrameListener.promise.then({}, {}, parseTrawlingFrame);\n                },\n\n                destroyDataListener: function destroyDataListener(trawlingDeviceId) {\n                    if (trawlingFrameListener !== undefined)\n                        acquisitionService.registerForDevice(trawlingDeviceId).unregisterForFrame(trawlingFrameListener);\n                }\n\n            };\n        };\n        return {\n          getInstance: function () {\n              return new trawlingService();\n          }\n        }\n    }\n})();\n\n(function () {\n    'use strict';\n\n    /** Trawling component **/\n    angular.module('tsa.tsaViews.trawling', []).component('tsaTrawling', {\n        templateUrl: \"app/tsa-views/trawling/trawling.html\",\n        controllerAs: \"ctrl\",\n        controller: trawlingController,\n        bindings: {\n            config: '=',\n            cardId: '@',\n            onChangeCardType: '&'\n        }\n    });\n\n    /** Trawling controller **/\n    function trawlingController(acquisitionService, userService, $timeout, $http, TRAWLING, TrawlingServiceProvider) {\n        var vm = this;\n        var TAG = '[trawlingController] ';\n        var trawlingService = TrawlingServiceProvider.getInstance();\n        /**------------------------------ PROPERTIES -------------------------------**/\n\n        //Canvas\n        vm.canvasId = \"canvas-trawling-\" + vm.cardId;\n\n        /**-------------------------- INITIALIZATION / DESTROY METHODS -------------------------**/\n\n        /** Initialization function **/\n        vm.$onInit = function init() {\n\n            vm.currentUserProvider = userService.getCurrentUserProvider();\n            if (vm.currentUserProvider.currentUser) {\n                vm.isAdminLogged = (vm.currentUserProvider.currentUser.login === 'admin' || vm.currentUserProvider.currentUser.login === 'europe');\n            } else {\n                vm.isAdminLogged = false;\n            }\n            console.log(TAG + '$onInit: deviceId = ' + (this.config ? this.config.deviceId : 'config undefined'));\n\n            if (this.config === undefined || this.config.deviceId === undefined) {\n                console.error(TAG + 'device Id not found!');\n                return;\n            }\n\n            vm.horspread = 0;\n            vm.horspread_mean = 0;\n            vm.horspread_mean_nb = 0;\n            vm.verspread = 0;\n            vm.verspread_mean = 0;\n            vm.verspread_mean_nb = 0;\n            vm.altitude = 0;\n            vm.altitude_mean = 0;\n            vm.altitude_mean_nb = 0;\n            vm.starboardunwound = 0;\n            vm.starboardunwound_mean = 0;\n            vm.starboardunwound_mean_nb = 0;\n            vm.portunwound = 0;\n            vm.portunwound_mean = 0;\n            vm.portunwound_mean_nb = 0;\n\n            vm.deviceId = this.config.deviceId; //Component parameter (mandatory)\n            vm.frameId = this.config.frameId;\n            vm.frameListener = acquisitionService.registerForDevice(vm.deviceId).registerForFrame(vm.frameId);\n            vm.frameListener.promise.then({}, {}, function (frame) {\n                var nbValue = 1;\n                if (frame.value[TRAWLING.HORIZONTAL_SPREAD_SUM]) {\n                    vm.horspread = parseFloat(frame.value[TRAWLING.HORIZONTAL_SPREAD_SUM]);\n                    nbValue = parseInt(frame.value[TRAWLING.HORIZONTAL_SPREAD_NB]);\n                    if (nbValue !== 0) {\n                        vm.horspread_mean_nb = nbValue;\n                        vm.horspread_mean = (frame.value[TRAWLING.HORIZONTAL_SPREAD_NB] !== undefined) ? vm.horspread / nbValue : vm.horspread_mean;\n                    }\n                }\n\n\n                if (frame.value[TRAWLING.VERTICAL_SPREAD_SUM]) {\n                    vm.verspread = parseFloat(frame.value[TRAWLING.VERTICAL_SPREAD_SUM]);\n                    nbValue = parseInt(frame.value[TRAWLING.VERTICAL_SPREAD_NB]);\n                    if (nbValue !== 0) {\n                        vm.verspread_mean_nb = nbValue;\n                        vm.verspread_mean = (frame.value[TRAWLING.VERTICAL_SPREAD_NB] !== undefined) ? vm.verspread / nbValue : vm.verspread_mean;\n                    }\n                }\n\n                if (frame.value[TRAWLING.ALTITUDE_SUM]) {\n                    vm.altitude = parseFloat(frame.value[TRAWLING.ALTITUDE_SUM]);\n                    nbValue = parseInt(frame.value[TRAWLING.ALTITUDE_NB]);\n                    if (nbValue !== 0) {\n                        vm.altitude_mean_nb = nbValue;\n                        vm.altitude_mean = (frame.value[TRAWLING.ALTITUDE_NB] !== undefined) ? vm.altitude / nbValue : vm.altitude_mean;\n                    }\n                }\n\n                if (frame.value[TRAWLING.STARBOARDUNWOUND_SUM]) {\n                    vm.starboardunwound = parseFloat(frame.value[TRAWLING.STARBOARDUNWOUND_SUM]);\n                    nbValue = parseInt(frame.value[TRAWLING.STARBOARDUNWOUND_NB]);\n                    if (nbValue !== 0) {\n                        vm.starboardunwound_mean_nb = nbValue;\n                        vm.starboardunwound_mean = (frame.value[TRAWLING.STARBOARDUNWOUND_NB] !== undefined) ? vm.starboardunwound / nbValue : vm.starboardunwound_mean;\n                    }\n                }\n\n                if (frame.value[TRAWLING.PORTUNWOUND_SUM]) {\n                    vm.portunwound = parseFloat(frame.value[TRAWLING.PORTUNWOUND_SUM]);\n                    nbValue = parseInt(frame.value[TRAWLING.PORTUNWOUND_NB]);\n                    if (nbValue !== 0) {\n                        vm.portunwound_mean_nb = nbValue;\n                        vm.portunwound_mean = (frame.value[TRAWLING.PORTUNWOUND_NB] !== undefined) ? vm.portunwound / nbValue : vm.portunwound_mean;\n                    }\n                }\n\n            });\n\n            var commentListener = acquisitionService.registerForDevice(vm.deviceId).registerForData(TRAWLING.FRAME, TRAWLING.COMMENT);\n            commentListener.promise.then({}, {}, function (data) {\n                if (data.value === 'trawling') {\n                    vm.isAcquiring = true;\n                }\n                if (data.value === 'stop') {\n                    vm.isAcquiring = false;\n                }\n\n            });\n            vm.frameId = TRAWLING.FRAME; //shipnav frame;\n            trawlingService.initDataListener(vm.deviceId, vm.frameId);\n            vm.dataFormat = '%.1f';\n            vm.lat = {id: TRAWLING.LAT};\n            vm.lon = {id: TRAWLING.LONG};\n            vm.comment = {id: TRAWLING.COMMENT};\n            vm.distance_straight = {id: TRAWLING.DISTANCE_STRAIGHT};\n            vm.distance_real = {id: TRAWLING.DISTANCE_REAL};\n            vm.ratio = {id: TRAWLING.RATIO};\n        };\n\n        vm.startAcquire = function startAcquire() {\n            vm.isAcquiring = true;\n            return $http.put('/api/devices/EU_TRAWLING/acquire', true);\n        };\n\n        vm.stopAcquire = function stopAcquire() {\n            vm.isAcquiring = false;\n            return $http.put('/api/devices/EU_TRAWLING/acquire', false);\n        };\n    }\n\n})();\n\n(function () {\n    'use strict';\n\n    /** Video component declaration **/\n    angular.module('tsa.tsaViews.video', []).component('tsaVideo', {\n        templateUrl: \"app/tsa-views/video/video.html\",\n        controllerAs: \"ctrl\",\n        controller: videoController,\n        bindings: {\n            config: '=',\n            cardId: '@',\n            onChangeCardType: '&'\n        }\n    });\n\n\n    /** Video controller */\n    function videoController($interval, $timeout, $scope, $log, userService, themeService, videoStreamingService, VIDEO_PARAMS) {\n\n        /**------------------------------ PROPERTIES -------------------------------**/\n        var vm = this;\n        vm.logger = $log.getInstance(\"video-tsa-view\");\n        vm.videoId = \"video-\" + vm.cardId;\n        var timeoutPromise;\n\n        /** Initialization function **/\n        vm.$onInit = function init() {\n            if (angular.isUndefined(this.config)\n                || angular.isUndefined(this.config.url)) {\n                vm.logger.error('url not found!');\n                return;\n            }\n\n            vm.title = this.config.deviceId;\n            vm.url = this.config.url;\n            vm.janusStreamIndex = this.config.janusStreamIndex;\n            vm.currentUser = userService.getCurrentUser();\n            vm.janus = null;\n\n            timeoutPromise = $timeout(function () {\n\n                var parentDiv = angular.element('#' + vm.videoId);\n\n                var videoElm = angular.element('<video width=800 height=600 autoplay=\"true\"/>');\n                parentDiv.append(videoElm);\n\n                // Use Janus\n                videoStreamingService.startJanus(function (janus) {\n                    vm.janus = janus;\n                    videoStreamingService.startStream(janus, vm.janusStreamIndex);\n                }, videoElm[0]);\n\n            }, 50);\n        };\n\n        /** Destroy function **/\n        vm.$onDestroy = function () {\n            $timeout.cancel(timeoutPromise);\n            if (vm.janus) {\n                vm.janus.destroy();\n            }\n        };\n    }\n})();\n\n(function () {\n    'use strict';\n\n    /** Video component declaration **/\n    angular.module('tsa.tsaViews.videoCall', []).component('tsaVideoCall', {\n        templateUrl: \"app/tsa-views/videoCall/videoCall.html\",\n        controllerAs: \"ctrl\",\n        controller: videoCallController,\n        bindings: {\n            config: '=',\n            cardId: '@',\n            onChangeCardType: '&'\n        }\n    });\n\n\n    /** Video controller */\n    function videoCallController($scope, $log, $timeout,\n        userService, videoCallService) { //$interval, $timeout,themeService, janusService, VIDEO_PARAMS) {\n\n        /**------------------------------ PROPERTIES -------------------------------**/\n        var vm = this;\n        vm.logger = $log.getInstance(\"videocall-tsa-view\");\n        vm.parentId = \"videocall-\" + vm.cardId;\n\n        vm.disableVideo = false;\n        vm.diableAudio = false;\n\n        /** Initialization function **/\n        vm.$onInit = function init() {\n\n            vm.videoCallState = videoCallService.getVideoCallState()\n\n            $timeout(function () {\n                var localvideo = document.querySelector('#' + vm.parentId + ' #localvideo');\n                var remotevideo = document.querySelector('#' + vm.parentId + ' #remotevideo');\n                videoCallService.setVideo(localvideo, remotevideo);\n            }, 50);\n        };\n\n        vm.test = function test() {\n            videoCallService.test();\n        }\n\n        vm.videoCall = function videoCall(username) {\n            videoCallService.videoCall(username);\n        }\n\n        vm.hangup = function hangup() {\n            videoCallService.hangup();\n        }\n\n        vm.toggleVideo = function() {\n            vm.disableVideo = !vm.disableVideo;\n            videoCallService.enableVideo(!vm.disableVideo);\n        }\n\n        vm.toggleAudio = function() {\n            vm.disableAudio = !vm.disableAudio;\n            videoCallService.enableAudio(!vm.disableAudio);\n        }\n\n    }\n})();\n\n(function () {\n    'use strict';\n\n    /** Weather component */\n    angular.module('tsa.tsaViews.weather', []).component('tsaWeather', {\n        templateUrl: \"app/tsa-views/weather/weather.html\",\n        controllerAs: \"ctrl\",\n        controller: weatherController,\n        bindings: {\n            config: '=',\n            cardId: '@',\n            onChangeCardType: '&',\n            mode: '@'\n        }\n    });\n\n    /** Weather controller */\n    function weatherController($log, acquisitionService, WEATHER, NAVIGATION, $scope, $timeout) {\n        var vm = this;\n        vm.logger = $log.getInstance(\"weather-tsa-view\");\n\n        /**------------------------------ PRIVATE PROPERTIES -------------------------------**/\n\n        //Mode (Default / Anemometer)\n        vm.MODE = { DEFAULT: 'default', ANEMOMETER: 'anemometer' };\n\n        //Canvas\n        vm.canvasId = \"canvas-weather-\" + vm.cardId;\n        var canvas;\n        var canvasSize;\n        var canvasWidth;\n        var canvasHeight;\n        var stage;\n\n        //Shapes\n        var boatShape;\n        var boatHeadingShape;\n        var trueWindShape;\n        var relWindShape;\n        var relHeading;\n\n        // Shape properties\n        var trueWindColor = \"#E53935\";\n        var relWindColor = \"#1a75ae\";\n\n        //Data listeners\n        var frameListener;\n        var boatHeadingListener;\n        var boatHeadingValue;\n\n        /**-------------------------- INITIALIZATION / DESTROY METHODS -------------------------**/\n\n        /** Initialization function  */\n        vm.$onInit = function init() {\n            if (angular.isUndefined(this.config) || angular.isUndefined(this.config.deviceId) || angular.isUndefined(this.config.frameId)) {\n                vm.logger.error('config and/or deviceId and/or frameId not defined!');\n                return;\n            }\n\n            vm.logger.debug('vm.currentMode: ' + vm.currentMode + '; vm.mode: ' + vm.mode + '; this.mode: ' + this.mode);\n\n            vm.weatherDeviceId = this.config.deviceId;\n            vm.weatherFrame = this.config.frameId;\n\n            vm.weatherDataList = WEATHER.DATA_TO_DISPLAY;\n\n            vm.trueWindSpeedId = WEATHER.TRUE_AIR_SPEED;\n            vm.trueWindHeadingId = WEATHER.TRUE_AIR_HEADING;\n            vm.relWindSpeedId = WEATHER.REL_AIR_SPEED;\n            vm.relWindHeadingId = WEATHER.REL_AIR_HEADING;\n\n            // Boat heading listener initialisation (not done in \"Anemometer\" mode)\n            if (vm.mode != vm.MODE.ANEMOMETER) {\n                boatHeadingListener = acquisitionService.registerForDevice(this.config.navId).registerForData(NAVIGATION.FRAME_SHIPNAV, NAVIGATION.HEADING);\n                boatHeadingListener.promise.then({}, {}, function (head) {\n                    boatHeadingValue = head.value;\n                    if (stage != null && boatShape == null) {\n                        drawBoat();\n                    }\n                    if (boatShape !== undefined) {\n                        boatShape.rotation = head.value - 90;\n                        boatHeadingShape.rotation = head.value - 90;\n\n                        if (angular.isDefined(relWindShape))\n                            relWindShape.rotation = parseFloat(boatHeadingValue) + parseFloat(relHeading) - 90;\n                        stage.update();\n                    }\n                });\n            }\n\n            // Wind listener initisalisation\n            frameListener = acquisitionService.registerForDevice(vm.weatherDeviceId).registerForFrame(WEATHER.FRAME);\n            frameListener.promise.then({}, {}, function (frame) {\n                if (angular.isDefined(stage)) {\n                    var trueSpeed = frame.value[WEATHER.TRUE_AIR_SPEED];\n                    var trueHeading = frame.value[WEATHER.TRUE_AIR_HEADING];\n                    var relSpeed = frame.value[WEATHER.REL_AIR_SPEED];\n                    relHeading = frame.value[WEATHER.REL_AIR_HEADING];\n\n                    stage.removeChild(trueWindShape);\n                    stage.removeChild(relWindShape);\n                    if (angular.isDefined(boatHeadingValue)) { //If boath heading is known, draw rel and true flags\n                        trueWindShape = drawWindFlag(trueSpeed, trueWindColor, trueHeading);\n                        relWindShape = drawWindFlag(relSpeed, relWindColor, parseFloat(boatHeadingValue) + parseFloat(relHeading));\n                    }\n                    else relWindShape = drawWindFlag(relSpeed, relWindColor, parseFloat(relHeading)); // else draw only rel flag\n                    stage.update();\n                }\n            });\n\n            //Wait the canvas creation, and then call the init function\n            $timeout(function () {\n                initCanvas();\n            }, 500);\n        };\n\n        /** Destroy function: remove the data listeners */\n        vm.$onDestroy = function () {\n            if (angular.isDefined(frameListener))\n                acquisitionService.registerForDevice(vm.weatherDeviceId).unregisterForFrame(frameListener);\n            if (angular.isDefined(boatHeadingListener))\n                acquisitionService.registerForDevice(vm.config.navId).unregisterForData(boatHeadingListener);\n        }\n\n        /**------------------------------ DRAW METHODS -------------------------------**/\n\n        function vector_dirmag_xy( direction, magnitude) {\n            var angle = direction * Math.PI / 180.0;\n            var xEast = magnitude * Math.sin( angle);\n            var yNorth = magnitude * Math.sin( angle);\n            return { \"xEast\": xEast, \"yNorth\": yNorth};\n        }\n\n        function vector_xy_dirmag( xEast, yNorth) {\n            var direction, magnitude;\n\n            if(yNorth == 0.0) {\n                if(xEast >= 0.0) {\n                    direction = 90.0;\n                } else {\n                    direction = 270.0;\n                }\n            } else {\n                direction = Math.atan( xEast / yNorth) * 180.0 / Math.PI;\n                if( yNorth < 0.0) {\n                    direction += 180.0;\n                }\n            }\n\n            magnitude = Math.sqrt( xEast*xEast + yNorth*yNorth);\n            return { \"direction\": direction, \"magnitude\": magnitude};\n        }\n\n        function computeTrueWind(relativeWindDirection, relativeWindMagnitude,\n            heading, cog, sog) {\n\n            // Direction du vent apparent / au nord geographique\n            var relativeWindNorthDirection = relativeWindDirection + 180.0;\n            if(relativeWindNorthDirection > 360.0) relativeWindNorthDirection -= 360.0;\n\n            relativeWindNorthDirection += heading;\n            if(relativeWindNorthDirection > 360.0) relativeWindNorthDirection -= 360.0;\n\n            var groundCoords = vector_dirmag_xy( cog, sog);\n            var relativeWindCoords =  vector_dirmag_xy( relativeWindNorthDirection, relativeWindMagnitude);\n\n            var trueWindxEast = groundCoords.xEast + relativeWindCoords.xEast;\n            var trueWindyNorth = groundCoords.yNorth + relativeWindCoords.yNorth;\n\n            var trueWind = vector_xy_dirmag(trueWindxEast, trueWindyNorth);\n\n            trueWind.direction -= 180.0;\n            if(trueWind.direction < 0.0) trueWind.direction += 360.0;\n\n            return trueWind;\n        }\n\n\n        /** Initialize the canvas **/\n        function initCanvas() {\n            canvas = document.getElementById(vm.canvasId);\n            if (canvas != null) {\n                stage = new createjs.Stage(canvas);\n                drawBoat();\n                $scope.$watch(function () {\n                    return canvas.offsetHeight\n                }, function () {\n                    updateCanvasSize();\n                });\n                $scope.$watch(function () {\n                    return canvas.offsetWidth\n                }, function () {\n                    updateCanvasSize();\n                });\n                updateCanvasSize();\n            }\n        }\n\n        /** Create the stage if needed, reset the canvas and redraw all the shapes **/\n        function updateCanvasSize() {\n            if (canvas != null) {\n                canvasSize = canvas.offsetWidth < canvas.offsetHeight ? canvas.offsetWidth : canvas.offsetHeight;\n                canvasWidth = canvas.offsetWidth;\n                canvasHeight = canvas.offsetHeight;\n\n                //Canvas size properties setting\n                canvas.setAttribute('width', canvasWidth);\n                canvas.setAttribute('height', canvasHeight);\n\n                // Reset canvas\n                stage.removeAllChildren();\n\n                // Redraw shapes\n                drawCompass();\n                drawBoat();\n                if (trueWindShape != null)\n                    trueWindShape = drawWindFlag(trueWindShape.speed, trueWindColor, trueWindShape.rotation + 90);\n                if (relWindShape != null)\n                    relWindShape = drawWindFlag(relWindShape.speed, relWindColor, relWindShape.rotation + 90);\n                stage.update();\n            }\n        }\n\n        /** Draw the boat and its heading **/\n        function drawBoat() {\n            // Create shape and set properties (color, size...)\n            boatShape = new createjs.Shape();\n            boatShape.x = canvasWidth / 2;\n            boatShape.y = canvasHeight / 2;\n            boatShape.rotation = angular.isDefined(boatHeadingValue) ? boatHeadingValue - 90 : -90;\n            boatShape.graphics.beginStroke('#757575').setStrokeStyle(1, 'round');\n            stage.addChild(boatShape);\n\n            boatHeadingShape = new createjs.Shape();\n            boatHeadingShape.x = canvasWidth / 2;\n            boatHeadingShape.y = canvasHeight / 2;\n            boatHeadingShape.rotation = boatShape.rotation;\n            boatHeadingShape.graphics.beginStroke('#757575').setStrokeStyle(1).setStrokeDash([10, 5]);\n            stage.addChild(boatHeadingShape);\n\n            var boatLength = canvasSize * 0.5;\n            var boatWidth = boatLength / 4;\n\n            //Heading line\n            boatHeadingShape.graphics.moveTo(-boatLength * (3 / 4), 0);\n            boatHeadingShape.graphics.lineTo(boatLength * 3 / 4, 0);\n            //Boat\n            boatShape.graphics.moveTo(boatLength / 5, boatWidth / 2)\n                .lineTo(-boatLength / 2, boatWidth / 2)\n                .lineTo(-boatLength / 2, -boatWidth / 2)\n                .lineTo(boatLength / 5, -boatWidth / 2)\n                .bezierCurveTo(boatLength / 1.5, -boatWidth / 4, boatLength / 1.5, boatWidth / 4, boatLength / 5, boatWidth / 2);\n        }\n\n        /** Draw wind shape **/\n        function drawWindFlag(speed, color, angle) {\n            var shape = new createjs.Shape();\n            shape.x = canvasWidth / 2;\n            shape.y = canvasHeight / 2;\n            shape.rotation = angle - 90;\n            shape.speed = speed;\n            stage.addChild(shape);\n            shape.graphics.beginStroke(color).setStrokeStyle(2);\n            var flagLength = canvasSize / 3;\n\n            if (speed === 0) {//if the true wind is null\n                shape.graphics.drawCircle(0, 0, 20);\n            }\n            else if (speed > 200) {//if the true wind is too big\n                vm.logger.error(\"Error true wind speed too high\");\n            }\n            else {//if the true wind is not null and not too big\n                shape.graphics.moveTo(0, 0);\n                shape.graphics.lineTo(flagLength, 0);\n                shape.graphics.beginFill(color);\n                drawBarb(shape, speed, flagLength);\n            }\n            return shape;\n        }\n\n        /** function used to draw the pennants and the flags on the wind barb (hampe de vent) **/\n        function drawBarb(shape, windSpeed, flagLength) {\n            var currentPosition = flagLength; // virtual mark in order to know where to put pennants,flags and half-flags\n            var pennant = Math.floor(windSpeed / 50);           // for each 50 knots we add one pennant\n            var flag = Math.floor((windSpeed % 50) / 10);       // for each 10 knots we add one flag (max 4)\n            var halfFlag = Math.floor((windSpeed % 10) / 5);    // for each 5 knots we add one half-flag (max 1)\n\n            //Draw pennants\n            for (var i = 0; i < pennant; i++) {\n                shape.graphics.moveTo(currentPosition, 0).lineTo(currentPosition - 12, 20).lineTo(currentPosition - 20, 0);\n                currentPosition -= 20;\n            }\n            if (pennant !== 0)\n                currentPosition -= 10;\n            //Draw flags\n            for (i = 0; i < flag; i++) {\n                shape.graphics.moveTo(currentPosition, 0).lineTo(currentPosition + 8, 20);\n                currentPosition -= 10;\n            }\n            //Draw half flags\n            for (i = 0; i < halfFlag; i++) {\n                shape.graphics.moveTo(currentPosition, 0).lineTo(currentPosition + 4, 10);\n                currentPosition -= 10;\n            }\n        }\n\n        /** Draw the compass **/\n        function drawCompass() {\n            var compassShape = new createjs.Shape();\n            compassShape.x = canvasWidth / 2;\n            compassShape.y = canvasHeight / 2;\n            stage.addChild(compassShape);\n            compassShape.graphics.beginStroke('#757575').setStrokeStyle(3);\n            var radius = canvasSize / 2 - 20;\n\n            for (var i = 0; i < 24; i++) {\n                var angle = i * Math.PI / 12;\n                var strokeLength = i % 3 === 0 ? 7 : 2;\n                //Draw text\n                if (i % 2 === 0 && i % 6 !== 0) {\n                    var xPosition = (radius + strokeLength + 20) * Math.cos(angle) - 6; //offset to adjust the text position\n                    var yPosition = (radius + strokeLength + 20) * Math.sin(angle);\n                    var text = ((i + 6) % 24) * 360 / 24;\n                    xPosition -= 10; //offset to adjust the text position\n                    drawText(text, xPosition, yPosition);\n                }\n                //Draw stroke\n                compassShape.graphics.moveTo((radius - strokeLength) * Math.cos(angle), (radius - strokeLength) * Math.sin(angle));\n                compassShape.graphics.lineTo((radius + strokeLength) * Math.cos(angle), (radius + strokeLength) * Math.sin(angle));\n\n            }\n        }\n\n        /** Draw a text at a specific position **/\n        function drawText(text, x, y) {\n            var textShape = new createjs.Text(text, \"18px Arial\", '#757575');\n            textShape.x = canvasWidth / 2 + x;\n            textShape.y = canvasHeight / 2 + y;\n            textShape.textBaseline = \"middle\";\n            return stage.addChild(textShape);\n\n        }\n    }\n\n})();\n\n(function () {\n    'use strict';\n\n    /** Winch component declaration **/\n    (function () {\n        'use strict';\n        angular.module('tsa.tsaViews.winch', []).component('tsaWinch', {\n            templateUrl: \"app/tsa-views/winch/winch.html\",\n            controllerAs: \"ctrl\",\n            controller: winchController,\n            bindings: {\n                config: '=',\n                cardId: '@',\n                onChangeCardType: '&'\n            }\n        });\n    })();\n\n    /** Winch controller */\n    function winchController($timeout, $interval, $log, $scope, acquisitionService, graphUtils, statusService, themeService, WINCH, NAVIGATION) {\n        var vm = this;\n        vm.logger = $log.getInstance(\"winch-tsa-view\");\n\n        /**------------------------------ PROPERTIES -------------------------------**/\n\n        vm.canvasId = \"canvas-winch-\" + vm.cardId;\n        var intervalPromise;\n        var timeoutPromise;\n        vm.bufferLoading = {};\n\n        var winchFrameListener;\n\n        /**  Time scales **/\n        vm.scales = graphUtils.scales;\n        vm.selectedScale = '1 min';\n        vm.spinningText=\"views.winch.spinning\";\n\n        /** Chart properties **/\n        var chart = undefined;\n        var chartData = {\n            datasets: [{\n                label: \"Data 1\",\n                xAxisID: \"x-axis-1\",\n                yAxisID: \"y-axis-1\",\n                borderColor: 'rgb(26, 117, 174)',\n                backgroundColor: 'rgba(26, 117, 174, 0.3)',\n                data: []\n            }]\n        };\n\n        /**-------------------------- INITIALIZATION / DESTROY METHODS -------------------------**/\n\n        /** Initialization function **/\n        vm.$onInit = function init() {\n            if (angular.isUndefined(this.config) || angular.isUndefined(this.config.deviceId) || angular.isUndefined(this.config.frameId)) {\n                vm.logger.error('config and/or deviceId and/or frameId not defined!');\n                return;\n            }\n\n            vm.deviceId = this.config.deviceId;\n            vm.frameId = this.config.frameId;\n\n            vm.tension = WINCH.TENSION;\n            vm.spinning = WINCH.SPINNING;\n            vm.length = WINCH.LENGTH;\n\n            vm.deviceSoundingId = this.config.sounder.deviceSoundingId;\n            vm.frameSounding = this.config.sounder.frameSounding;\n            vm.sounding = this.config.sounder.sounding;\n\n            //Register for Tension Chart\n            vm.device = acquisitionService.registerForDevice(vm.deviceId);\n            vm.device.recordData(vm.frameId, vm.tension);\n\n            winchFrameListener = acquisitionService.registerForDevice(vm.deviceId).registerForFrame(vm.frameId);\n            winchFrameListener.promise.then({}, {}, parseWinchFrame);\n            function parseWinchFrame(receivedFrame) {\n                var spinning = parseFloat(receivedFrame.value[WINCH.SPINNING]);\n                vm.spinningText=(spinning < 0) ? \"views.winch.spinning.negative\":\"views.winch.spinning.positive\";\n\n            }\n\n            //Wait the canvas creation, and then create the chart\n            timeoutPromise = $timeout(initTimer, 200);\n\n            // Change gridLinesColor of Graph on every change of service variable\n            themeService.subscribe($scope, function(event, theme) {\n            \tvm.theme = theme;\n            \treloadChart();\n            });\n\n            if (angular.isDefined(vm.config.scale))\n                vm.selectedScale = vm.config.scale;\n        };\n\n        /** Destroy function **/\n        vm.$onDestroy = function () {\n            if (winchFrameListener !== undefined)\n                acquisitionService.registerForDevice(vm.deviceId).unregisterForFrame(winchFrameListener);\n\n            vm.device.stopRecordData(vm.frameId, vm.tension);\n            $timeout.cancel(timeoutPromise);\n            if (intervalPromise !== undefined)\n                $interval.cancel(intervalPromise);\n        };\n\n        /**------------------------------ METHODS -------------------------------**/\n\n        /** Generate the chart options */\n        function getChartOptions() {\n            var chartOptions = graphUtils.getChartOptions(vm.scales[vm.selectedScale].stepSize);\n            chartOptions.scales.yAxes = [{\n                id: \"y-axis-1\",\n                gridLines: { color: vm.theme.gridLinesColor },\n                ticks: { beginAtZero: true, min: 0, suggestedMax: 10 }\n            }];\n            return chartOptions;\n        }\n\n        /** Redraw the chart **/\n        function reloadChart() {\n            if (chart !== undefined)\n                chart.destroy();\n            var canvas = document.getElementById(vm.canvasId);\n            if (canvas) {\n                chart = Chart.Scatter(canvas, { data: chartData, options: getChartOptions() });\n                updateGraph();\n            }\n            vm.config.scale = vm.selectedScale;\n        }\n\n        /** Start or update the timer (intervalPromise) */\n        var initTimer = function initTimer() {\n            if (intervalPromise !== undefined)\n                $interval.cancel(intervalPromise);\n\n            //Load archived data\n            if (angular.isDefined(vm.device.getData(vm.frameId, vm.tension))) {\n                var bufferId = vm.scales[vm.selectedScale].bufferId;\n                vm.bufferLoading[vm.selectedScale] = vm.bufferLoading[vm.selectedScale] ? ++vm.bufferLoading[vm.selectedScale] : 1;\n                var selectedScale = vm.selectedScale;\n                var requestCallback = function () {\n                    vm.bufferLoading[selectedScale]--;\n                    if (chart !== undefined)\n                        updateGraph();\n                };\n                vm.device.getData(vm.frameId, vm.tension).buffers[bufferId].loadArchivedFrames().then(requestCallback, requestCallback);\n            }\n            reloadChart();\n            intervalPromise = $interval(updateGraph, vm.scales[vm.selectedScale].scale / 1000);\n        };\n\n        /** Update the graph with the recorded data (called by the timer (intervalPromise)) */\n        function updateGraph() {\n            //Step 1: update X axis\n            var currentDate = statusService.getServerTime().time;\n            chart.options.scales.xAxes[0].ticks.min = (currentDate - vm.scales[vm.selectedScale].scale);\n            chart.options.scales.xAxes[0].ticks.max = currentDate;\n\n            //Step 2: update data\n            var bufferId = vm.scales[vm.selectedScale].bufferId;\n            chartData.datasets[0].data = [];\n            var recordedData = vm.device.getData(vm.frameId, vm.tension);\n            if (recordedData !== undefined)\n                angular.forEach(recordedData.buffers[bufferId].frames, function (frame) {\n                    chartData.datasets[0].data.push({ x: frame.timestamp, y: frame.value });\n                });\n\n            chart.update();\n        }\n\n        /** Called when a new X scale is selected */\n        vm.onChangeXScale = initTimer;\n\n    }\n})();\n\n/*\n    Winch Alarm Pp component\n */\n\n(function () {\n    'use strict';\n\n    /** Winch Alarm Pp component **/\n    angular.module('tsa.tsaViews.winchAlarmPp', []).component('tsaWinchAlarmPp', {\n        templateUrl: \"app/tsa-views/winch-alarm-pp/winch-alarm-pp.html\",\n        controllerAs: \"ctrl\",\n        controller: winchAlarmPpController,\n        bindings: {\n            config: '=',\n            cardId: '@',\n            onChangeCardType: '&'\n        }\n    });\n\n    /** Winch Alarm Pp controller **/\n    function winchAlarmPpController(acquisitionService, $timeout, $scope, PP_WINCH_ALARM, $interval) {\n        var vm = this;\n        var TAG = '[winchAlarmPpController] ';\n\n        var alarmInterval;\n        var last = -1;\n        var frameListener;\n\n        /**------------------------------ PROPERTIES -------------------------------**/\n\n        vm.alarms = [\n        ];\n\n        vm.deviceId = 'PP_KleyWinch';\n\n        /**------------------------------ METHODS -------------------------------**/\n\n        /** Initialization function **/\n        vm.$onInit = function init() {\n//            console.log(TAG + '$onInit: deviceId = ' + (this.config ? this.config.deviceId : 'config undefined'));\n\n            alarmInterval = $interval(alarmSwipe, 5000);\n\n            frameListener =\n                acquisitionService.registerForDevice(vm.deviceId)\n                    .registerForFrame(PP_WINCH_ALARM.FRAME);\n\n            frameListener.promise.then({}, {},\n                function(frame) {\n                    newAlarm(\n                        frame.value[PP_WINCH_ALARM.CODE][0],\n                        frame.value[PP_WINCH_ALARM.TEXT][0],\n                        frame.value[PP_WINCH_ALARM.LEVEL][0],\n                        frame.value[PP_WINCH_ALARM.ENDDATE][0]\n                    );\n            });\n        };\n\n        /** Destroy function: remove the data listeners */\n        vm.$onDestroy = function destroy() {\n            acquisitionService.registerForDevice(vm.deviceId).unregisterForFrame(PP_WINCH_ALARM.FRAME);\n            $interval.cancel(alarmInterval);\n        }\n\n        function alarmSwipe() {\n            if( (last > 0) && (((new Date().getTime()) - last) > (2*60*1000))) {\n                last = -1;\n                vm.alarms.length = 0;\n            }\n        }\n\n        function newAlarm( code, text, level, enddate) {\n            var index = vm.alarms.findIndex(function(item) {\n                return code === item.code;\n            });\n            if( enddate >= 100000.0) {\n                if( index < 0) {\n                    vm.alarms.push(\n                        { 'code': code, 'text': text, 'level': level, 'enddate': enddate}\n                    );\n                }\n            } else if( enddate === 0.0) {\n                if( index >= 0) {\n                    vm.alarms = vm.alarms.splice(index, 1);\n                }\n            }\n        }\n    }\n})();\n\n(function () {\n    'use strict';\n\n    /** Component declaration */\n    angular.module('tsa.tsaViews.winchInfo', []).component('tsaWinchInfo', {\n        templateUrl: \"app/tsa-views/winch-info/winch-info.html\",\n        controllerAs: \"ctrl\",\n        controller: winchInfoController,\n        bindings: {\n            config: '=',\n            cardId: '@',\n            onChangeCardType: '&'\n        }\n    });\n\n    /** Component controller */\n    function winchInfoController($log, WINCH, NAVIGATION, acquisitionService) {\n        var vm = this;\n        vm.logger = $log.getInstance(\"winch-info-tsa-view\");\n\n        var winchFrameListener;\n\n        /** Initialization function */\n        vm.$onInit = function init() {\n\n            if (angular.isUndefined(this.config)\n                || angular.isUndefined(this.config.deviceId)\n                || angular.isUndefined(this.config.frameId)) {\n                vm.logger.error('deviceId or/and frameId or/and flowDeviceId not defined!');\n                return;\n            }\n\n            console.log(this.config);\n\n            vm.deviceId = this.config.deviceId;\n            vm.frameId = this.config.frameId;\n            vm.navId = this.config.navId;\n\n            // constants defined in devices.constants.js\n            vm.WINCH = WINCH;\n            vm.NAVIGATION = NAVIGATION;\n\n            vm.spinningText=\"views.winch.spinning\";\n            winchFrameListener = acquisitionService.registerForDevice(vm.deviceId).registerForFrame(vm.frameId);\n            winchFrameListener.promise.then({}, {}, parseWinchFrame);\n            function parseWinchFrame(receivedFrame) {\n                var spinning = parseFloat(receivedFrame.value[WINCH.SPINNING]);\n                vm.spinningText=(spinning < 0) ? \"views.winch.spinning.negative\":\"views.winch.spinning.positive\";\n            }\n        };\n\n        /** Destroy function **/\n        vm.$onDestroy = function () {\n            if (winchFrameListener !== undefined)\n                acquisitionService.registerForDevice(vm.deviceId).unregisterForFrame(winchFrameListener);\n        };\n    }\n})();\n\n/***\n * This is a test\n */\n(function () {\n    'use strict';\n    angular\n        .module('tsa.pages.acquisition')\n        .controller('addChannelController', addChannelController);\n\n    /** @ngInject */\n    function addChannelController($mdDialog, restService) {\n\n        /**-------------------- View-model properties ----------------**/\n        var vm = this;\n\n        /** Title **/\n        vm.title = \"New channel\";\n\n        /** Selected channel **/\n        vm.channel = undefined;\n        vm.newChannelId = undefined;\n        vm.newChannelURL = undefined;\n\n        /** Driver list **/\n        vm.channelList = [];\n        restService.getChannels().then(function (result) {\n            vm.channelList = result;\n        });\n\n\n\n        vm.cancel = function cancel() {\n            $mdDialog.cancel();\n        };\n\n        vm.save = function save() {\n            if (vm.channel === 'New channel') {\n                vm.channel = {\n                    channelId: vm.newChannelId,\n                    url: vm.newChannelURL\n                };\n                if (vm.channel !== undefined && vm.newChannelURL !== undefined)\n                    restService.putChannel(vm.newChannelId, vm.newChannelURL);\n            }\n\n            $mdDialog.hide({channel: vm.channel});\n        };\n    }\n})();\n\n/***\n * This is a test\n */\n(function () {\n    'use strict';\n    angular\n        .module('tsa.pages.acquisition')\n        .controller('editDeviceController', EditDeviceController);\n\n    /** @ngInject */\n    function EditDeviceController($mdDialog, restService, $stateParams, dialogService, $state, userService, AUTHORITIES) {\n        /** Authorisation checking **/\n        if (!userService.checkAuthority(AUTHORITIES.ADMIN))\n            return;\n\n        var vm = this;\n        vm.title = 'New device';\n\n        vm.channels = [];\n\n        /** Device properties **/\n        vm.device = {\n            deviceId: \"UNIQUE_DEVICE_ID\",\n            name: \"my-device\",\n            frames: [],\n            period: \"1000\",\n            drivers: [],\n            triggerMode: \"FRAME\",\n            triggerFrameName: \"$TEST\",\n            triggerInterval: \"\"\n        };\n        /** Trigger value **/\n        vm.triggerValue = \"$TEST\";\n\n        /**-------------------- PRIVATE METHODS ----------------**/\n\n\t    /**\n\t     * Init function (automatically called)\n         */\n        (function init() {\n            if ($stateParams.id !== undefined) {\n                restService.getConfiguration().then(function (result) {\n                    angular.forEach(result.devices, function (device) {\n                        if (device.deviceId === $stateParams.id) {\n                            vm.device = device;\n                            vm.title = vm.device.deviceId;\n                            switch (vm.device.triggerMode) {\n                                case 'FRAME':\n                                    vm.triggerValue = vm.device.triggerFrameName;\n                                    break;\n                                case 'TIME':\n                                    vm.triggerValue = vm.device.triggerInterval;\n                                    break;\n                            }\n                            var channelIds = [];\n                            angular.forEach(vm.device.drivers, function(d) {\n                                var exist=0;\n                                angular.forEach(channelIds, function(c) {\n                                    if (c === d.channelId) {\n                                        exist=1;\n                                    }\n                                });\n                                if (exist === 0) {\n                                    channelIds.push(d.channelId);\n                                }\n                            })\n                            angular.forEach(channelIds, function(c) {\n                                vm.channels\n                            })\n                        }\n                    });\n                });\n            }\n        })();\n\n        /**-------------------- VIEW-MODEL METHODS ----------------**/\n\n        /**\n         * Remove driver: remove the selected driver, if the channel has not anymore driver, it is removed.\n         */\n        vm.removeChannel = function removeChannel(channel) {\n            var index = vm.channels.indexOf(channel);\n            if (index != -1)\n                vm.channels.splice(index, 1);\n            //if (vm.channels.length == 0)\n            //    delete vm.channels;\n        };\n\n        /**\n         * Remove driver: remove the selected driver, if the channel has not anymore driver, it is removed.\n         */\n        vm.removeDriver = function removeDriver(index) {\n            if (index != -1)\n                vm.device.drivers.splice(index, 1);\n            //if (vm.driver.length == 0)\n            //    delete vm.driver;\n        };\n\n        /**\n         * Add channel: open a dialog window to add a new channel\n         */\n        vm.addChannel = function addChannel() {\n            $mdDialog.show({\n                controller: 'addChannelController',\n                controllerAs: 'ctrl',\n                templateUrl: 'app/pages/acquisition/addChannel/addChannel.html',\n                clickOutsideToClose: true,\n                locals: {channel: undefined}\n            }).then(function (result) {\n                console.log('new channel: ' + result.channel);\n                var exist=0;\n                angular.forEach(vm.channels, function(channel) {\n                    if (channel.channelId === result.channel.channelId ||\n                        channel.url === result.channel.url) {\n                        exist=1;\n                    }\n                });\n\n                if (exist === 0) {\n                    vm.channels.push(result.channel);\n                }\n            });\n        };\n\n        /**\n         * Add driver: open a dialog window to add a new driver\n         */\n        vm.addDriver = function addDriver() {\n            $mdDialog.show({\n                controller: 'addDriverController',\n                controllerAs: 'ctrl',\n                templateUrl: 'app/pages/acquisition/addDriver/addDriver.html',\n                clickOutsideToClose: true,\n                locals: {channelList: vm.channels, driver: undefined}\n            }).then(function (result) {\n                console.log('new driver: ' + result.driver.driverName);\n                vm.device.drivers.push(result.driver);\n                angular.forEach(result.frames, function(f) {\n                    vm.device.frames.push({name:f, major:1, minor:0})\n                });\n            });\n        };\n\n\t    /**\n\t     * Edit driver: open a dialog window to edit the selected driver\n         */\n        vm.editDriver = function editDriver(driver){\n            $mdDialog.show({\n                controller: 'addDriverController',\n                controllerAs: 'ctrl',\n                templateUrl: 'app/pages/acquisition/addDriver/addDriver.html',\n                clickOutsideToClose: true,\n                locals: {channelList: vm.channels, driver: driver}\n            }).then(function (result) {\n                vm.device.drivers.push(result.driver);\n            });\n        };\n\n\n        /**\n         * Save the current device.\n         */\n        vm.save = function save() {\n            //Build the trigger properties\n            switch (vm.device.triggerMode) {\n                case 'FRAME':\n                    vm.device.triggerFrameName = vm.triggerValue;\n                    break;\n                case 'TIME':\n                    vm.device.triggerInterval = vm.triggerValue;\n                    break;\n            }\n\n            restService.putDevice(vm.device.deviceId, vm.device).then (function (success) {\n                dialogService.showDialog('Device saved','Successful device creation!');\n                $state.go('acquisition');\n            });\n        };\n\n    }\n})();\n\n/***\n * This is a test\n */\n(function () {\n    'use strict';\n    angular\n        .module('tsa.pages.acquisition')\n        .controller('addDriverController', AddDriverController);\n\n    /** @ngInject */\n    function AddDriverController($mdDialog, restService, driver, channelList) {\n\n        /**-------------------- View-model properties ----------------**/\n        var vm = this;\n\n        /** Title **/\n        vm.title = \"New driver\";\n\n        vm.headerLine = false;\n\n        /** Driver properties **/\n        vm.driver = {\n            channelId: \"\",\n            driverClassName: \"\",\n            header: \"\",\n            fields: [],\n            parameters: {\n                regex: \"\",\n                separator: \",\"\n            }\n        };\n\n        vm.frames = [];\n\n        vm.channelList = [];\n\n        /** Driver list **/\n        vm.driverList = [];\n        restService.getDrivers().then(function (result) {\n            vm.driverList = result;\n        });\n\n        /** Frame list **/\n        vm.frameList = [];\n        restService.getDescriptions().then(function (result) {\n            vm.frameList = result;\n        });\n\n        /** Fields **/\n        function Field(fieldIndex, frame, data, option) {\n            this.frame = frame;\n            this.data = data;\n            this.fieldIndex = fieldIndex;\n            this.option = option;\n        }\n        vm.fieldList = [];\n\n        /** For controller edition **/\n        loadParams();\n\n        vm.changeDriverSelected = function changeDriverSelected() {\n            if (vm.driver.driverClassName.match(\"(NMEADriver|RegexDriver)\")) {\n                vm.headerLine = true;\n            }\n        };\n\n        /**-------------------- Private methods ----------------**/\n\n        /**\n         * Load parameters: if a driver and a channel have been specified, they are loaded.\n         */\n        function loadParams() {\n            if (driver !== undefined) {\n                vm.driver = driver;\n                vm.title = \"Edit driver '\";\n                angular.forEach(vm.driver.fields, function (field) {\n                    vm.fieldList.push(new Field(field.fieldIndex, field.frame, field.data, field.option));\n                });\n            }\n            if (channelList !== undefined) {\n                angular.forEach( channelList, function(channel) {\n                    vm.channelList.push(channel);\n                });\n            }\n        }\n\n        /**-------------------- View-model methods ----------------**/\n\n        vm.addField = function addField() {\n            vm.fieldList.push(new Field());\n        };\n\n        vm.removeField = function removeField(field) {\n            var index = vm.fieldList.indexOf(field);\n            if (index != -1)\n                vm.fieldList.splice(index, 1);\n        };\n\n        vm.cancel = function cancel() {\n            $mdDialog.cancel();\n        };\n\n        vm.save = function save() {\n            vm.driver.fields = [];\n            angular.forEach(vm.fieldList, function (field) {\n                var frame = field.frame.split(\":\")[0];\n                var data = field.frame.split(\":\")[1];\n                vm.driver.fields.push(new Field(field.fieldIndex,\n                                                frame,\n                                                data,\n                                                field.option));\n                var exist = 0;\n                angular.forEach(vm.frames, function (f) {\n                    if(frame === f) {\n                        exist = 1;\n                    }\n                });\n                if (exist === 0) {\n                    vm.frames.push(frame);\n                }\n            });\n\n            $mdDialog.hide({driver: vm.driver, frames:vm.frames});\n        };\n    }\n})();\n\n(function () {\n    'use strict';\n    angular.module('tsa.services.dialog').controller('dataSelectionController', dataSelectionController);\n\n    /**  Add data dialog's controller */\n    function dataSelectionController($mdDialog, deviceList) {\n\n        /** ------------------------------ DATA CLASS-----------------------------**/\n        function Data(id, frameId, deviceId) {\n            this.id = id;\n            this.frameId = frameId;\n            this.deviceId = deviceId;\n        }\n\n        /** ---------------------------- DATA LIST CLASS -------------------------**/\n        function DataList() {\n            this.dataList = [];\n        }\n\n        /* Add a new data (if it doesn't already exist ) */\n        DataList.prototype.add = function add(id, frameId, deviceId) {\n            if (!this.includes(id, frameId, deviceId))\n                this.dataList.push(new Data(id, frameId, deviceId));\n        };\n\n        /* Remove a data from the list */\n        DataList.prototype.remove = function remove(id, frameId, deviceId) {\n            var index = undefined;\n            angular.forEach(this.dataList, function (data) {\n                if (data.id == id & data.frameId == frameId & data.deviceId == deviceId)\n                    this.splice(this.indexOf(data), 1);\n            }, this.dataList);\n        };\n\n        /* Check if the list contains the specified data */\n        DataList.prototype.includes = function includes(id, frameId, deviceId) {\n            var dataIsIncluded = false;\n            angular.forEach(this.dataList, function (data) {\n                if (data.id == id & data.frameId == frameId & data.deviceId == deviceId)\n                    dataIsIncluded = true;\n            });\n            return dataIsIncluded;\n        };\n\n        /** ------------------------------ PROPERTIES ----------------------------------**/\n        var vm = this;\n        vm.deviceList = deviceList;\n        vm.selectedDataList = new DataList();\n\n        /** ---------------------------- VIEW-MODEL METHODS ----------------------------**/\n\n        /* Check if a specified frame is selected */\n        vm.frameIsSelected = function frameIsSelected(frame, frameId, deviceId) {\n            var oneDataIsSelected = false;\n            var allDataSelected = true;\n            angular.forEach(frame, function (data) {\n                if (vm.selectedDataList.includes(data.name, frameId, deviceId))\n                    oneDataIsSelected = true;\n                else allDataSelected = false;\n            });\n            return allDataSelected ? true : oneDataIsSelected ? 'indeterminate' : false;\n        }\n\n        /* Called when a data is selected */\n        vm.selectData = function selectData(id, frameId, deviceId) {\n            //If the data is already selected, unselect it\n            if (vm.selectedDataList.includes(id, frameId, deviceId))\n                vm.selectedDataList.remove(id, frameId, deviceId);\n            //else select it\n            else vm.selectedDataList.add(id, frameId, deviceId);\n        }\n\n        /* Called when a frame is selected */\n        vm.selectFrame = function selectFrame(frame, frameId, deviceId) {\n            //if the frame is already selected, unselect it (= unselect each data)\n            if (vm.frameIsSelected(frame, frameId, deviceId) === true) {\n                angular.forEach(frame, function (data) {\n                    vm.selectedDataList.remove(data.name, frameId, deviceId);\n                });\n            }\n            else {// else select all the unselected data\n                angular.forEach(frame, function (data) {\n                    if (!vm.selectedDataList.includes(data.name, frameId, deviceId))\n                        vm.selectedDataList.add(data.name, frameId, deviceId);\n                });\n            }\n        }\n\n        /* Called when the close button is called */\n        vm.cancel = function () {\n            $mdDialog.cancel();\n        };\n\n        /* Called when the \"Add\" button is called */\n        vm.answer = function () {\n            if (vm.selectedDataList.dataList.length > 0)\n                $mdDialog.hide(vm.selectedDataList.dataList);\n        };\n\n    }\n})();\n\n(function () {\n    'use strict';\n    angular.module('tsa.services.dialog').controller('dateRangeSelectionController', dateRangeSelectionController);\n\n    /**  Add data dialog's controller */\n    function dateRangeSelectionController($mdDialog, startDate, endDate) {\n\n        /** ------------------------------ PROPERTIES ----------------------------------**/\n        var vm = this;\n        vm.startDate = startDate;\n        vm.startTime = (startDate.getUTCHours() > 9 ? '' : '0') + startDate.getUTCHours()\n            + (startDate.getUTCMinutes() > 9 ? ':' : ':0') + startDate.getUTCMinutes()\n            + (startDate.getUTCSeconds() > 9 ? ':' : ':0') + startDate.getUTCSeconds();\n        vm.endDate = endDate;\n        vm.endTime = (endDate.getUTCHours() > 9 ? '' : '0') + endDate.getUTCHours()\n            + (endDate.getUTCMinutes() > 9 ? ':' : ':0') + endDate.getUTCMinutes()\n            + (endDate.getUTCSeconds() > 9 ? ':' : ':0') + endDate.getUTCSeconds();\n\n        /** ---------------------------- VIEW-MODEL METHODS ----------------------------**/\n\n        /* Called when the close button is called */\n        vm.cancel = function () {\n            $mdDialog.cancel();\n        };\n\n        /* Called when the \"Add\" button is called */\n        vm.answer = function () {\n            // start date\n            var hours = vm.startTime.split(':');\n            vm.startDate.setHours(parseInt(hours[0], 10) - vm.startDate.getTimezoneOffset() / 60, hours[1], hours[2]);\n\n            // end date\n            hours = vm.endTime.split(':');\n            vm.endDate.setHours(parseInt(hours[0], 10) - vm.endDate.getTimezoneOffset() / 60, hours[1], hours[2]);\n\n            $mdDialog.hide({ start: vm.startDate, end: vm.endDate });\n        };\n    }\n})();\n\n(function () {\n    'use strict';\n    angular.module('tsa.services.dialog').controller('messagingController', messagingController);\n\n    /**  Add data dialog's controller */\n    function messagingController($mdDialog, messagingService) {\n\n        /** ------------------------------ PROPERTIES ----------------------------------**/\n        var vm = this;\n\n        vm.messageList = messagingService.messageList;\n        vm.currentMessage = undefined;\n\n        /**---------------- initialize the message list ---------------------**/\n        (function init() {\n            messagingService.getLastMessages();\n        })();\n\n        /** ---------------------------- VIEW-MODEL METHODS ----------------------------**/\n\n        /* Called when the close button is called */\n        vm.close = function close() {\n            $mdDialog.cancel();\n        };\n\n        vm.send= function send(){\n            if (angular.isDefined(vm.currentMessage))\n                messagingService.send(vm.currentMessage)\n                    .then(function successCallBack (response) {\n                        vm.currentMessage = undefined;\n                    }, function callBackError (response) {\n                        console.log('message has not been send ' +response.$resolved);\n                    })\n        };\n\n        //allow tab in messaging textarea\n        vm.tabFunction=function tabFunction(e) {\n            var keyCode = e.keyCode || e.which;\n            //Allow tab as first input\n            if (vm.currentMessage===undefined){\n                vm.currentMessage=\"\";\n            }\n            if (keyCode === 9) {\n                e.preventDefault();\n                var start=e.target.selectionStart;\n                var end=e.target.selectionEnd;\n\n                // set textarea value to: text before caret + tab + text after caret\n                vm.currentMessage=vm.currentMessage.substring(0,start)\n                    +'\\t'\n                    +vm.currentMessage.substring(end);\n\n                // put caret at right position again\n                angular.element(e.target).val(vm.currentMessage);\n                e.target.selectionStart=e.target.selectionEnd=start+1;\n            }\n        };\n    }\n})();\n\n(function () {\n    'use strict'\n    angular.module('tsa.services.dialog').factory(\"Message\", messagingFactory);\n\n    function messagingFactory() {\n        //Message constructor\n        function Message (user, content, timestamp){\n            this.user=user;\n            this.message=content;\n            this.messageTime=timestamp;\n        }\n        return Message;\n    }\n})();\n\n/**\n * Messaging service\n */\n(function () {\n    'use strict';\n\n\n    angular.module(\"tsa.services\").service(\"messagingService\", messagingService);\n    function messagingService (dialogService, statusService, userService, Message, restService, $filter) {\n        var self = this;\n\n        self.connectionTime=statusService.getServerTime().time;\n        self.messageList=[];\n        self.lastMessage={};\n\n        /**------------------------------ PUBLIC SERVICE API -------------------------------**/\n\n        self.send=function send(message){\n            // get current user or if undefined, set a default one\n            var user= getUser();\n            function getUser(){\n                if (angular.isDefined(userService.getCurrentUser())){\n                    return user=userService.getCurrentUser().name;\n                }else {\n                    return user=\"user\";\n                }\n            }\n\n            //Post a message\n            var msg= new Message(user, message, statusService.getServerTime().time);\n            return restService.sendMessage(msg)\n              .then(function success(response) {\n                  //refresh messages list\n                  self.getLastMessages();\n                  return response;\n            }, function error(response){\n                  return response;\n            });\n        };\n\n        //Get the 10 last messages posted\n        self.getLastMessages=function getLastMessages(){\n            return restService.getLastMessages()\n                .then(function success(response) {\n                    angular.copy(response, self.messageList);\n                }, function error(response){\n                    return response;\n                });\n        };\n\n\n        //Get the last message posted (tsa-views/message).\n        self.getLastMessage=function getLastMessage(){\n            return restService.getLastMessage()\n                .then(function success(response) {\n                    if (self.lastMessage.messageTime!==response.messageTime){\n                        angular.copy(response, self.lastMessage);\n                        //Toast pop up if message newer than connection time\n                        if (self.connectionTime < response.messageTime){\n                            dialogService.showToastChat($filter('translate')('toast.newMessage'));\n                            self.connectionTime=response.messageTime;\n                        }\n                    }\n                }, function error(response){\n                    return response;\n                });\n        };\n\n        //{{\"toast.newMessage\"|| translate}}\n    }\n})();\n\n(function () {\n    'use strict';\n    angular.module('tsa.services.dialog').controller('messagingAccessController', messagingAccessController);\n\n    /**  Access to messaging controller*/\n    function messagingAccessController($mdDialog, dialogService) {\n        /** ------------------------------ PROPERTIES ----------------------------------**/\n        var vm=this;\n        var password=\"author\";\n        vm.passwordInput = undefined;\n        vm.inputMatch = false;\n        /** ---------------------------- VIEW-MODEL METHODS ----------------------------**/\n\n        /* Called when the close button is called */\n        vm.close = function close() {\n            $mdDialog.cancel();\n        };\n\n        /*called when password is submit */\n        vm.redirect= function redirect(){\n            if (vm.passwordInput===password){\n                dialogService.showMessaging();\n            }\n            else {\n                return vm.inputMatch=true;\n            }\n        };\n\n        /** Check press on the enter key **/\n        vm.onKeyPressed = function onKeyPressed(keyEvent) {\n            if (keyEvent.which === 13)\n                vm.redirect();\n        };\n    }\n})();\n\n/***\n * This is a test\n */\n(function () {\n    'use strict';\n    angular\n        .module('tsa.services.dialog')\n        .controller('saveDashboardController', SaveDashboardController);\n\n    /** @ngInject */\n    function SaveDashboardController($mdDialog, title) {\n        var vm = this;\n        vm.title = title;\n\n        vm.cancel = function cancel() {\n            $mdDialog.cancel();\n        };\n\n        vm.save = function save() {\n            $mdDialog.hide(vm.title);\n        };\n    }\n})();\n\n(function () {\n    'use strict';\n    angular.module('tsa.services.dialog').controller('validationController', ValidationController);\n\n    /** Validation dialog box controller */\n    function ValidationController($mdDialog, title, msg, msgOk, msgCancel) {\n        var vm = this;\n        vm.title = title;\n        vm.msg = msg;\n        vm.msgOk = msgOk !== undefined? msgOk : 'yes';\n        vm.msgCancel = msgCancel !== undefined? msgCancel: 'cancel';\n\n        vm.cancel = function cancel() {\n            $mdDialog.cancel();\n        };\n\n        vm.disconnect = function selectView() {\n            $mdDialog.hide();\n        };\n    }\n})();\n\n/***\n * Controller of the dialog box used to select a TECHSAS view.\n */\n(function () {\n    'use strict';\n    angular\n        .module('tsa.services.dialog')\n        .controller('viewSelectionController', ViewSelectionController);\n\n    function ViewSelectionController($mdDialog, acquisitionService, viewProvider) {\n        var vm = this;\n\n        // Retrieve the device list\n        vm.viewProvider = viewProvider;\n        vm.viewList = viewProvider.getViewList();\n        vm.mosaicList = viewProvider.getMosaicList();\n        \n        // Watch the device list updates\n        var deviceListListener = acquisitionService.registerForDeviceList();\n        deviceListListener.promise.then({}, {}, function () {\n            vm.viewList = viewProvider.getViewList();\n        });\n\n        /** Called when the dialog is closed without selection **/\n        vm.cancel = function () {\n            viewProvider.stopRefreshMosaic();\n            acquisitionService.unregisterForDeviceList(deviceListListener);\n            $mdDialog.cancel();\n        };\n\n        /** Called when a view has been selected **/\n        vm.selectView = function selectView(view) {\n            viewProvider.stopRefreshMosaic();\n            acquisitionService.unregisterForDeviceList(deviceListListener);\n            $mdDialog.hide({view: view.type, config: view.config, title: view.title, icon: view.icon});\n        };\n\n    }\n})();\n\n(function () {\n    'use strict';\n\n    /** Component **/\n    angular.module('tsa.tsaViews.codeNameFields', [])\n        .component('tsaCodeNameFields', {\n            templateUrl: \"app/tsa-views/casino/codeNameFields/codeNameFields.html\",\n            controller: codeNameFieldsController,\n            controllerAs: \"ctrl\",\n            bindings: {\n                itemType: '@',\n                listItems: '<',\n                itemCode: '<',\n                onItemChange: '&',\n                itemReadonly: '<',\n                itemFollow: '<'\n            }\n        });\n\n    /** Controller **/\n    function codeNameFieldsController() {\n        var vm = this;\n\n        /**------------------------------ PROPERTIES -------------------------------**/\n        vm.selectedItem;\n\n        /**-------------------------- INITIALIZATION / DESTROY METHODS -------------------------**/\n\n        /** Init function: select initial item **/\n        vm.$onInit = function () {\n            if(vm.listItems && vm.itemCode){\n                angular.forEach(vm.listItems, function(item) {\n                    if (item.code === vm.itemCode){\n                        vm.selectedItem = item;\n                        vm.updateItem();\n                    }\n                })\n            }\n        };\n\n        /** OnChanges: Called whenever one-way bindings (itemCode, listItems) are updated. */\n        vm.$onChanges = function (changesObj) {\n            if (changesObj['listItems'] && angular.isDefined(changesObj['listItems'].currentValue)) {\n                vm.selectedItem = undefined;\n            }\n            if (changesObj['itemCode'] && angular.isDefined(changesObj['itemCode'].currentValue)) {\n                if(vm.listItems){\n                    angular.forEach(vm.listItems, function(item) {\n                        if (item.code === changesObj['itemCode'].currentValue){\n                            vm.selectedItem = item;\n                        }\n                    })\n                }\n            }\n        };\n\n        /** Called when the view is destroyed. */\n        vm.$onDestroy = function onDestroy() {\n            // nothing to do\n        };\n\n        /**--------------------------  METHODS -------------------------**/\n        vm.updateItem = function() {\n            // send event\n            vm.onItemChange({$item: vm.selectedItem});\n        }\n    }\n})();\n\n(function () {\n    'use strict';\n\n    /** Component **/\n    angular.module('tsa.pages.dataAccess.paramSelector', [])\n        .component('tsaParamSelector', {\n            templateUrl: \"app/pages/dataAccess/components/paramSelector/paramSelector.html\",\n            controller: paramSelectorController,\n            controllerAs: \"ctrl\",\n            bindings: {\n                getParams: '=',\n                mode: '<'\n            }\n        });\n\n    /** Controller **/\n    function paramSelectorController(dialogService) {\n\n        /**------------------------------ PROPERTIES ----------------------------------**/\n        var vm = this;\n        vm.simpleSampingInterval = 60;\n        vm.maxValues = 100000;\n        vm.timeStampingStrategy = 'resampling';\n        vm.reference = 'reference';\n        vm.resampleInterval = 1;\n        vm.intervalStampFraction = 1;\n\n        /**------------------- PUBLIC METHOD (used by others components) -----------------**/\n\n        /* Get the selected data range */\n        vm.getParams = function getParams() {\n            var result = { maxValues: vm.maxValues };\n\n            //Simple mode\n            if (vm.mode == 'simple') {\n                result['timeStampingStrategy'] = 'resampling';\n                result['intervalOrRef'] = vm.simpleSampingInterval;\n                return result;\n            }\n\n            //Advanced mode\n            result['timeStampingStrategy'] = vm.timeStampingStrategy;\n            switch (vm.timeStampingStrategy) {\n                case 'reference':\n                    result['intervalOrRef'] = vm.reference;\n                    break;\n                case 'resampling':\n                    result['intervalOrRef'] = vm.resampleInterval;\n                    result['intervalStampFraction'] = vm.intervalStampFraction;\n                    break;\n            }\n            return result;\n        }\n    }\n})();\n\n(function () {\n    'use strict';\n\n    /** Component **/\n    angular.module('tsa.pages.dataAccess.periodSelector', [])\n        .component('tsaPeriodSelector', {\n            templateUrl: \"app/pages/dataAccess/components/periodSelector/periodSelector.html\",\n            controller: periodSelectorController,\n            controllerAs: \"ctrl\",\n            bindings: {\n                getDateRange: '='\n            }\n        });\n\n    /** Controller **/\n    function periodSelectorController(dialogService) {\n\n        /**------------------------------ PROPERTIES ----------------------------------**/\n        var vm = this;\n\n        vm.CUSTOM_RANGE = \"pages.data-access.custom-range\";\n        vm.selectionList = {\n            LAST_HOUR: \"pages.data-access.last-hour\",\n            LAST_6_HOURS: \"pages.data-access.last-6-hours\",\n            LAST_24_HOURS: \"pages.data-access.last-24-hours\"\n        }\n\n        vm.currentSelection = vm.selectionList.LAST_HOUR;\n\n        /**---------------- PUBLIC METHOD (used by others components) ----------------**/\n\n        /* Get the selected data range */\n        vm.getDateRange = function getDateRange() {\n            switch (vm.currentSelection) {\n                case vm.selectionList.LAST_HOUR: return { start: (new Date()) - (60 * 60 * 1000), end: new Date().getTime(), };\n                case vm.selectionList.LAST_6_HOURS: return { start: (new Date()) - (6 * 60 * 60 * 1000), end: new Date().getTime(), };\n                case vm.selectionList.LAST_24_HOURS: return { start: (new Date()) - (24 * 60 * 60 * 1000), end: new Date().getTime() };\n                case vm.CUSTOM_RANGE: return { start: vm.startDate.getTime(), end: vm.endDate.getTime() };\n            }\n        }\n\n        /**-------------------------- VIEW MODEL METHODS -----------------------------**/\n\n        /* Show the dialog box to selected a custom date/time range */\n        vm.setCustomRange = function setCustomRange() {\n            vm.startDate = new Date();\n            vm.endDate = new Date();\n            dialogService.showSelectDateRange(vm.startDate, vm.endDate)\n                .then(function (result) {\n                    vm.startDate = result.start;\n                    vm.endDate = result.end;\n                });\n        }\n    }\n})();\n\n(function () {\n    'use strict';\n\n    /** Component **/\n    angular.module('tsa.pages.dataAccess.resultCard', [])\n        .component('tsaResultCard', {\n            templateUrl: \"app/pages/dataAccess/components/resultCard/resultCard.html\",\n            controller: resultCardController,\n            controllerAs: \"ctrl\",\n            bindings: {\n                frames: '<',\n                description: '<'\n            }\n        });\n\n    /** Controller **/\n    function resultCardController($timeout, $filter, $scope, graphUtils, themeService) {\n\n        /**------------------------------ PROPERTIES ----------------------------------**/\n        var vm = this;\n        vm.displayMode = \"table\";\n        vm.chartData = { datasets: [] };\n\n        // Chart properties\n        vm.canvasId = \"resultView\";\n        vm.chart = undefined;\n        var chartColorIndex = 0;\n        var chartColors = [\n            \"rgb(26, 117, 174)\", //Blue ifremer\n            \"#8BC34A\",  // Light green\n            \"#FF5722\",  // Orange\n            \"#3F51B5\",  // Indigo\n            \"#F44336\",  // Red\n            \"#9C27B0\",  // Purple\n            \"#FDD835\",  // yellow\n            \"#2196F3\",  // Blue\n            \"#E91E63\",  // Pink\n            \"#009688\",  // blue-green\n            \"#673AB7\",  // Deep purple\n            \"#795548\",  // Brown\n            \"#E91E63\",  // Pink\n            \"#CDDC39\"   // Lime\n        ];\n\n\n        /**------------------------------ CHART TAB METHODS -------------------------------**/\n\n        /** DataSet constructor **/\n        function DataSet(id, color) {\n            this.label = id;\n            this.data = [];\n            this.hidden = false;\n            this.borderColor = chartColors[chartColorIndex % chartColors.length];\n            chartColorIndex++;\n            angular.forEach(vm.frames, function (frame) {\n                this.data.push({ x: frame['time'], y: frame[id] });\n            }, this);\n        }\n\n        /** Redraw the chart **/\n        function reloadChart() {\n            if (vm.chart !== undefined)\n                vm.chart.destroy();\n            var canvas = document.getElementById(vm.canvasId);\n            //canvas.addEventListener('click', function(event) {console.log(event) }, false);\n            if (canvas)\n                vm.chart = Chart.Scatter(canvas, { data: vm.chartData, options: graphUtils.getChartOptions() });\n        }\n\n        /** Update the chart with new frame list */\n        vm.updateChart = function updateChart() {\n            chartColorIndex = 0;\n            vm.chartData.datasets = [];\n            if (angular.isDefined(vm.frames) && vm.frames.length > 0) {\n                angular.forEach(vm.frames[0], function (value, key) {\n                    if (key != \"time\" && key != \"$$hashKey\")\n                        vm.chartData.datasets.push(new DataSet(key));\n                })\n                if (vm.chart != undefined)\n                    vm.chart.update();\n            }\n        }\n\n        /**------------------------------ MAP TAB METHODS -------------------------------**/\n\n\n    /**------------------------------ PUBLIC VIEW-MODEL METHODS ----------------------------**/\n\n    /** Initialization function **/\n    vm.$onInit = function init() {\n        var timeoutPromise = $timeout(reloadChart, 200);\n        //var timeoutPromise = $timeout(vm.showMap, 200);\n        // Change gridLinesColor of Graph on every change of service variable\n        themeService.subscribe($scope, reloadChart);\n    };\n\n    vm.$onChanges = function (changesObj) {\n        vm.updateChart();\n        if (vm.frames != undefined && vm.frames.length > 0) {\n            vm.framesTable = vm.frames.slice();\n            angular.forEach(vm.framesTable, function (frame) {\n                frame.time = $filter('date')(new Date(frame.time), \"dd MMM yyyy; HH:mm:ss\", \"+0\");\n            });\n        }\n    };\n\n\n}\n})();\n\n(function () {\n    'use strict';\n\n    /** Component **/\n    angular.module('tsa.pages.dataAccess.variableSelector', [])\n        .component('tsaVariableSelector', {\n            templateUrl: \"app/pages/dataAccess/components/variableSelector/variableSelector.html\",\n            controller: variableSelectorController,\n            controllerAs: \"ctrl\",\n            bindings: {\n                getVariableList: '=',\n                mode: '<'\n            }\n        });\n\n    /** Controller **/\n    function variableSelectorController($filter, acquisitionService, archiveService, dialogService, restService, DATA_ACCESS) {\n\n        /**------------------- PREDEFINED DATA LIST (get from /frontend/parameters during the bootstrap step)------------------------**/\n        var navigationDataList = DATA_ACCESS.NAVIGATION;\n        var weatherDataList = DATA_ACCESS.WEATHER;\n        var thermosalDataList = DATA_ACCESS.THERMOSAL;\n\n        /**------------------------------ PROPERTIES -----------------------------**/\n        var vm = this;\n\n//        vm.aggregateList = [\"raw\", \"hold\", \"nearest\", \"interpolate\", \"total\", \"count\", \"average\"];\n        vm.aggregateList = [\"RAW\", \"HOLD\", \"NEAREST\", \"INTERPOLATE\", \"TOTAL\", \"COUNT\", \"AVERAGE\"];\n\n        vm.simpleDataList = [];\n        /* USE FOR TEST\n            { id: 'airpressure', frameId: 'weather', deviceId: 'BATOS001', colname: 'Air pressure' },\n            { id: 'relairspeed', frameId: 'weather', deviceId: 'BATOS001', colname: 'Rel air speed' }\n        ];*/\n\n        vm.advancedDataList = [];\n        /* USE FOR TEST\n            { varid: \"GYRO001!gyro!head\", colname: \"heading\", aggregate: \"raw\", units: \"\", default: \"default\", min: \"0\", max: \"360\" },\n            { varid: \"BATOS001!weather!airtemp\", colname: \"air temperature\", aggregate: \"raw\", units: \"\", default: \"default\", min: \"0\", max: \"360\" },\n            new archiveService.Variable('watertemp', 'weather', 'BATOS001')];*/\n\n        /**------------------------------ PRIVATE METHODS -----------------------------**/\n\n        function addDataToSimpleList(dataList) {\n            var dataAlreadyPresent = [];\n            angular.forEach(dataList, function (data) {\n                if (data.colname === undefined) //Add colname if undefined\n                    data.colname = data.id;\n\n                angular.forEach(vm.simpleDataList, function (dataInTheList) {\n                    if (dataInTheList.id === data.id && dataInTheList.frameId === data.frameId && dataInTheList.deviceId === data.deviceId)\n                        dataAlreadyPresent.push(data);\n                });\n\n                if (!dataAlreadyPresent.includes(data))\n                    vm.simpleDataList.push(data);\n            });\n\n            if (dataAlreadyPresent.length > 0)\n                dialogService.showDialog($filter('translate')(\"pages.data-access.data-selection\"),\n                    $filter('translate')(\"pages.data-access.data-already-in-table\"));\n        }\n\n\n        /**------------------- PUBLIC METHOD (used by others components) -----------------**/\n\n        /* Get the selected data range */\n        vm.getVariableList = function getVariableList() {\n            if (vm.mode === 'advanced') {\n                return vm.advancedDataList;\n            }\n            else {\n                var variableList = [];\n                angular.forEach(vm.simpleDataList, function (data) {\n                    variableList.push(new archiveService.Variable(data.id, data.frameId, data.deviceId, undefined, data.colname));\n                });\n                return variableList;\n            }\n        };\n\n        /**------------------------------ VIEW MODEL METHODS -------------------------------**/\n\n        /* Add new data in the custom data table */\n        vm.addData = function addData() {\n            switch (vm.mode) {\n                case 'simple':\n                    restService.getArchiveDevices().then(\n                        function success(deviceList) { dialogService.showSelectData(deviceList).then(addDataToSimpleList); },\n                        function error() {\n                            dialogService.showDialog($filter('translate')(\"pages.data-access.error\"),\n                                $filter('translate')(\"pages.data-access.device-list-unavailable\"));\n                        });\n                    break;\n                case 'advanced':\n                    vm.advancedDataList.push({\n                        varid: \"\",\n                        colname: \"\",\n                        aggregate: \"\",\n                        units: \"\",\n                        default: \"\",\n                        min: \"\",\n                        max: \"\"\n                    });\n                    break;\n            }\n        };\n\n        /* Clear all the list */\n        vm.clearAll = function clearAll() {\n            switch (vm.mode) {\n                case 'simple': vm.simpleDataList = []; break;\n                case 'advanced': vm.advancedDataList = []; break;\n            }\n        };\n\n        /* Add the predefined navigation data list */\n        vm.addNavData = function addNavData() {\n            addDataToSimpleList(navigationDataList);\n        };\n\n        /* Add the predefined weather data list */\n        vm.addWeatherData = function addWeatherData() {\n            addDataToSimpleList(weatherDataList);\n\n        };\n\n        /* Add the predefined thermosalinometer data list */\n        vm.addTSData = function addTSData() {\n            addDataToSimpleList(thermosalDataList);\n        }\n    }\n})();\n\nangular.module(\"tsa\").run([\"$templateCache\", function($templateCache) {$templateCache.put(\"app/components/card/card.html\",\"<md-card id={{ctrl.cardId}} ng-switch=ctrl.type><tsa-adcp ng-switch-when=ADCP card-id={{ctrl.cardId}} on-change-card-type=ctrl.setType(type) config=ctrl.config></tsa-adcp><tsa-attitude ng-switch-when=Attitude card-id={{ctrl.cardId}} on-change-card-type=ctrl.setType(type) config=ctrl.config></tsa-attitude><tsa-debug ng-switch-when=Debug card-id={{ctrl.cardId}} on-change-card-type=ctrl.setType(type)></tsa-debug><tsa-depth ng-switch-when=Depth card-id={{ctrl.cardId}} on-change-card-type=ctrl.setType(type) config=ctrl.config></tsa-depth><tsa-devices ng-switch-when=Devices card-id={{ctrl.cardId}} on-change-card-type=ctrl.setType(type) config=ctrl.config></tsa-devices><tsa-driver-preview ng-switch-when=DriverPreview card-id={{ctrl.cardId}} on-change-card-type=ctrl.setType(type) config=ctrl.config></tsa-driver-preview><tsa-ephemeride ng-switch-when=Ephemeride card-id={{ctrl.cardId}} on-change-card-type=ctrl.setType(type) config=ctrl.config></tsa-ephemeride><tsa-ferrybox-fluo ng-switch-when=\\\"Ferrybox fluo\\\" card-id={{ctrl.cardId}} on-change-card-type=ctrl.setType(type) config=ctrl.config></tsa-ferrybox-fluo><tsa-ferrybox-technic ng-switch-when=\\\"Ferrybox technic\\\" card-id={{ctrl.cardId}} on-change-card-type=ctrl.setType(type) config=ctrl.config></tsa-ferrybox-technic><tsa-ferrybox-science ng-switch-when=\\\"Ferrybox science\\\" card-id={{ctrl.cardId}} on-change-card-type=ctrl.setType(type) config=ctrl.config></tsa-ferrybox-science><tsa-flow ng-switch-when=Flow card-id={{ctrl.cardId}} on-change-card-type=ctrl.setType(type) config=ctrl.config></tsa-flow><tsa-funes-winch ng-switch-when=\\\"Funes winch\\\" card-id={{ctrl.cardId}} on-change-card-type=ctrl.setType(type) config=ctrl.config></tsa-funes-winch><tsa-generic ng-switch-when=Generic card-id={{ctrl.cardId}} on-change-card-type=ctrl.setType(type) config=ctrl.config></tsa-generic><tsa-gps ng-switch-when=GPS card-id={{ctrl.cardId}} on-change-card-type=ctrl.setType(type) config=ctrl.config></tsa-gps><tsa-graphics ng-switch-when=Graphics card-id={{ctrl.cardId}} on-change-card-type=ctrl.setType(type) config=ctrl.config></tsa-graphics><tsa-gravimeter ng-switch-when=Gravimeter card-id={{ctrl.cardId}} on-change-card-type=ctrl.setType(type) config=ctrl.config></tsa-gravimeter><tsa-kss31 ng-switch-when=Kss31 card-id={{ctrl.cardId}} on-change-card-type=ctrl.setType(type) config=ctrl.config></tsa-kss31><tsa-haul-composition ng-switch-when=\\\"Haul composition\\\" card-id={{ctrl.cardId}} on-change-card-type=ctrl.setType(type) config=ctrl.config></tsa-haul-composition><tsa-hull-sound-speed ng-switch-when=\\\"Hull sound speed\\\" card-id={{ctrl.cardId}} on-change-card-type=ctrl.setType(type) config=ctrl.config></tsa-hull-sound-speed><tsa-navigation ng-switch-when=Navigation card-id={{ctrl.cardId}} on-change-card-type=ctrl.setType(type) config=ctrl.config></tsa-navigation><tsa-magnetometer ng-switch-when=Magnetometer card-id={{ctrl.cardId}} on-change-card-type=ctrl.setType(type) config=ctrl.config></tsa-magnetometer><tsa-map ng-switch-when=Map card-id={{ctrl.cardId}} on-change-card-type=ctrl.setType(type) config=ctrl.config mode=navigation></tsa-map><tsa-map ng-switch-when=Station card-id={{ctrl.cardId}} on-change-card-type=ctrl.setType(type) config=ctrl.config mode=station></tsa-map><tsa-mobile ng-switch-when=Mobile card-id={{ctrl.cardId}} on-change-card-type=ctrl.setType(type) config=ctrl.config></tsa-mobile><tsa-numerical ng-switch-when=Numerical card-id={{ctrl.cardId}} on-change-card-type=ctrl.setType(type) config=ctrl.config></tsa-numerical><tsa-propulsion-tl ng-switch-when=\\\"Propulsion Tl\\\" card-id={{ctrl.cardId}} on-change-card-type=ctrl.setType(type) config=ctrl.config></tsa-propulsion-tl><tsa-propulsion-at ng-switch-when=\\\"Propulsion At\\\" card-id={{ctrl.cardId}} on-change-card-type=ctrl.setType(type) config=ctrl.config></tsa-propulsion-at><tsa-propulsion-pp ng-switch-when=\\\"Propulsion Pp\\\" card-id={{ctrl.cardId}} on-change-card-type=ctrl.setType(type) config=ctrl.config></tsa-propulsion-pp><tsa-landing-at ng-switch-when=\\\"Landing At\\\" card-id={{ctrl.cardId}} on-change-card-type=ctrl.setType(type) config=ctrl.config></tsa-landing-at><tsa-multibeam ng-switch-when=Multibeam card-id={{ctrl.cardId}} on-change-card-type=ctrl.setType(type) config=ctrl.config></tsa-multibeam><tsa-species ng-switch-when=Species card-id={{ctrl.cardId}} on-change-card-type=ctrl.setType(type) config=ctrl.config></tsa-species><tsa-template ng-switch-when=Template card-id={{ctrl.cardId}} on-change-card-type=ctrl.setType(type) config=ctrl.config></tsa-template><tsa-thermo-config ng-switch-when=ThermoConfig card-id={{ctrl.cardId}} on-change-card-type=ctrl.setType(type) config=ctrl.config></tsa-thermo-config><tsa-thermometer ng-switch-when=Thermometer card-id={{ctrl.cardId}} on-change-card-type=ctrl.setType(type) config=ctrl.config></tsa-thermometer><tsa-thermosal ng-switch-when=Thermosal card-id={{ctrl.cardId}} on-change-card-type=ctrl.setType(type) config=ctrl.config></tsa-thermosal><tsa-trawl ng-switch-when=Trawl card-id={{ctrl.cardId}} on-change-card-type=ctrl.setType(type) config=ctrl.config></tsa-trawl><tsa-trawling ng-switch-when=Trawling card-id={{ctrl.cardId}} on-change-card-type=ctrl.setType(type) config=ctrl.config></tsa-trawling><tsa-video ng-switch-when=Video card-id={{ctrl.cardId}} on-change-card-type=ctrl.setType(type) config=ctrl.config></tsa-video><tsa-video-call ng-switch-when=\\\"Video Call\\\" card-id={{ctrl.cardId}} on-change-card-type=ctrl.setType(type) config=ctrl.config></tsa-video-call><tsa-weather ng-switch-when=Anemometer card-id={{ctrl.cardId}} on-change-card-type=ctrl.setType(type) config=ctrl.config mode=anemometer></tsa-weather><tsa-weather ng-switch-when=Weather card-id={{ctrl.cardId}} on-change-card-type=ctrl.setType(type) config=ctrl.config mode=default></tsa-weather><tsa-winch ng-switch-when=Winch card-id={{ctrl.cardId}} on-change-card-type=ctrl.setType(type) config=ctrl.config></tsa-winch><tsa-message ng-switch-when=Message card-id={{ctrl.cardId}} on-change-card-type=ctrl.setType(type) config=ctrl.config></tsa-message><tsa-ef-pos ng-switch-when=EFPos card-id={{ctrl.cardId}} on-change-card-type=ctrl.setType(type) config=ctrl.config></tsa-ef-pos><tsa-ef-met ng-switch-when=EFMet card-id={{ctrl.cardId}} on-change-card-type=ctrl.setType(type) config=ctrl.config></tsa-ef-met><tsa-ef-tss ng-switch-when=EFTss card-id={{ctrl.cardId}} on-change-card-type=ctrl.setType(type) config=ctrl.config></tsa-ef-tss><tsa-ef-aum ng-switch-when=EFAum card-id={{ctrl.cardId}} on-change-card-type=ctrl.setType(type) config=ctrl.config></tsa-ef-aum><tsa-casino ng-switch-when=Casino card-id={{ctrl.cardId}} on-change-card-type=ctrl.setType(type) config=ctrl.config></tsa-casino><tsa-casino-add-event ng-switch-when=\\\"Casino - Add event\\\" card-id={{ctrl.cardId}} on-change-card-type=ctrl.setType(type) config=ctrl.config></tsa-casino-add-event><tsa-route-md ng-switch-when=Route card-id={{ctrl.cardId}} on-change-card-type=ctrl.setType(type) config=ctrl.config></tsa-route-md><tsa-winch-alarm-pp ng-switch-when=\\\"Winch Alarm Pp\\\" card-id={{ctrl.cardId}} on-change-card-type=ctrl.setType(type) config=ctrl.config></tsa-winch-alarm-pp><tsa-winch-info ng-switch-when=\\\"Winch Info\\\" card-id={{ctrl.cardId}} on-change-card-type=ctrl.setType(type) config=ctrl.config></tsa-winch-info><tsa-kley-state ng-switch-when=\\\"Kley state\\\" card-id={{ctrl.cardId}} on-change-card-type=ctrl.setType(type) config=ctrl.config></tsa-kley-state><tsa-menu ng-switch-when=Menu card-id={{ctrl.cardId}} on-change-card-type=ctrl.setType(type) config=ctrl.config></tsa-menu><!-- Default view (= empty view) --><div ng-switch-default><!-- Toolbar --><div layout=row class=tsa-toolbar><md-icon class=material-icons>web_asset</md-icon><p class=title>{{\\\"views.empty.title\\\" | translate }}</p><span flex></span><tsa-settings-button on-change-view=ctrl.setType(type) card-id={{ctrl.cardId}}></tsa-settings-button></div><md-divider></md-divider><div layout=row layout-align=\\\"center center\\\"><md-button class=md-primary ng-click=ctrl.showChangeViewDialog()>{{\\\"views.empty.select\\\" | translate }}</md-button></div></div></md-card>\");\n$templateCache.put(\"app/components/console/console.html\",\"<div layout=column style=\\\"resize: both; height: 300px; margin:0px\\\"><md-nav-bar md-selected-nav-item=ctrl.consoleView md-whiteframe=5><md-nav-item ng-repeat=\\\"view in ctrl.consoleViews\\\" md-nav-click=ctrl.changeConsole(view) name={{view}}>{{view}}</md-nav-item></md-nav-bar><div layout=row flex=100 style=\\\"margin: 0px; padding: 0px\\\"><textarea id=acquisition-textarea flex md-no-autogrow ng-model=ctrl.console md-select-on-focus readonly style=\\\"border: 0px\\\"></textarea></div></div>\");\n$templateCache.put(\"app/components/dataView/dataView.html\",\"<div layout=row layout-align=\\\"center center\\\" ng-class=\\\"{\\'data-missing\\': ctrl.dataMissing, \\'green\\': ctrl.redGreen}\\\"><!-- Title & subtitle side --><div ng-hide=ctrl.titleDisabled flex=45 layout=column layout-align=center class=title-zone><!-- Title --><h2 class=\\\"title md-headline\\\">{{ctrl.title | translate}}</h2><!-- Subtitle --><p ng-if=ctrl.showSubtitle class=\\\"subtitle md-subhead\\\">{{ctrl.subtitle}}</p></div><!-- Value --><h2 flex class=\\\"value md-display-1\\\" ng-class=ctrl.frontColor>{{ctrl.value}}</h2></div>\");\n$templateCache.put(\"app/components/doubleDataView/doubleDataView.html\",\"<div layout=row layout-align=\\\"center center\\\"><!-- Title --><h2 flex=30 class=md-headline>{{ctrl.title | translate}}</h2><!-- Data 1 --><tsa-data-view flex=35 data=ctrl.dataId1 frame-id=ctrl.frameId1 device-id=ctrl.deviceId1 title-disabled=true format={{ctrl.format1}} opt-value=ctrl.optValue1></tsa-data-view><!-- Data 2 --><tsa-data-view flex=35 data=ctrl.dataId2 frame-id=ctrl.frameId2 device-id=ctrl.deviceId2 title-disabled=true format={{ctrl.format2}} opt-value=ctrl.optValue2></tsa-data-view></div>\");\n$templateCache.put(\"app/components/navbar/navbar.html\",\"<tsa-sidenav></tsa-sidenav><md-toolbar class=md-hue-2 md-whiteframe=2 layout=row layout-align=\\\"start center\\\" ng-style=\\\"!navbar.connected.flag && {\\'background-color\\':\\'#F44336\\'} ||\\n                      navbar.isWelcomePage() && {\\'background-color\\':\\'transparent\\'} ||\\n                      !navbar.isWelcomePage() && {}\\\"><div class=md-toolbar-tools><!-- MENU ICON --><md-button ng-hide=navbar.isSDIVUserAndStaticView() ng-click=navbar.openSidenav() class=md-icon-button style=\\\"background: transparent !important\\\"><i class=material-icons>menu</i></md-button><!-- TOOLBAR TITLE --> <img src=resources/images/favicon.ico class=tsa-icon><h2 ng-if=!navbar.isSDIVUserAndStaticView() ui-sref=welcome style=\\\"cursor: pointer\\\">TECHSAS</h2><h2 ng-if=navbar.isSDIVUserAndStaticView()>TECHSAS - {{navbar.currentUserProvider.currentUser.name}}</h2><span flex></span><h2 ng-if=!navbar.connected.flag>{{\\\"components.navbar.connection-error\\\" | translate}}</h2><span flex></span><div layout=row layout-align=\\\"center center\\\" ng-if=navbar.isSDIVUserAndStaticView()><i class=\\\"mdi mdi-24px mdi-alert-outline\\\"></i><p class=message><i>{{\\\"components.navbar.message\\\" | translate}}</i></p></div><span flex></span><!-- TIME --><div class=\\\"time show-time-button\\\" layout=row ng-click=navbar.showTimes()><h2><b>{{navbar.serverTime.time | date: \\\"HH:mm:ss\\\" : \\\"UTC\\\" }}</b></h2><p class=md-body-1>UTC</p><h3>{{navbar.serverTime.time | date: \\\"dd/MM/yy\\\" : \\\"UTC\\\" }}</h3><md-tooltip>{{\\\"components.navbar.server-time\\\" | translate}}</md-tooltip></div><!--DAY MODE--><md-button class=md-icon-button ng-click=navbar.changeDayMode()><md-icon class=material-icons>{{navbar.theme.icon}}</md-icon><md-tooltip>{{\\\"components.navbar.day-night-mode\\\" | translate}}</md-tooltip></md-button><!--TRANSLATION--><md-menu md-position-mode=\\\"target-right target\\\"><md-button layout=row layout-align=\\\"center center\\\" ng-click=$mdOpenMenu($event) style=\\\"min-width: 0; margin: 6px; padding: 7px\\\"><img ng-src={{navbar.currentLocaleImg}} style=\\\"height: 20px\\\"><md-tooltip>{{\\\"components.navbar.select-language\\\" | translate}}</md-tooltip></md-button><md-menu-content style=\\\"width: 150px\\\"><md-menu-item ng-repeat=\\\"locale in navbar.locales\\\"><md-button ng-click=navbar.changeLocale(locale) ng-style=\\\"locale.id === (\\'directives.language-select.Language\\' | translate) ?{\\'color\\': \\' #1a75ad\\'}: {}\\\"><div layout=row flex layout-align=\\\"center center\\\"><p flex>{{locale.name}}</p><img ng-src={{locale.img}} style=\\\"width: 30px\\\" md-menu-align-target></div></md-button></md-menu-item></md-menu-content></md-menu><!-- MESSAGING --><md-button ng-if=navbar.ENABLE_CHAT class=md-icon-button ng-click=navbar.openMessagingWindow()><md-icon class=material-icons>chat</md-icon><md-tooltip>{{\\\"components.navbar.messaging\\\" | translate}}</md-tooltip></md-button><!-- HELP --><md-button class=md-icon-button ng-click=navbar.goToHelpPage() ng-hide=navbar.isSDIVUserAndStaticView()><md-icon class=material-icons>help</md-icon><md-tooltip>{{\\\"components.navbar.online-help\\\" | translate}}</md-tooltip></md-button></div><audio hidden id=ringtone loop><source src=resources/mario_bros_1up.mp3 type=audio/mpeg></audio></md-toolbar><!--</nav>-->\");\n$templateCache.put(\"app/components/settingsButton/settingsButton.html\",\"<div><md-button class=md-icon-button ng-click=ctrl.showChangeViewDialog() ng-if=ctrl.isStaticPage()><md-icon>system_update_alt</md-icon><md-tooltip>{{\\\"components.settings-button.change-view\\\" | translate}}</md-tooltip></md-button><md-button class=md-icon-button ng-click=ctrl.deleteClick() ng-if=!ctrl.isStaticPage()><md-icon>close</md-icon><md-tooltip>{{\\\"components.settings-button.close\\\" | translate}}</md-tooltip></md-button></div>\");\n$templateCache.put(\"app/components/sidenav/sidenav.html\",\"<md-sidenav class=md-sidenav-left md-component-id=left layout=column><!-- Title bar --><div class=title md-whiteframe=2 layout=row layout-align=\\\"start center\\\"><h1 class=md-headline ui-sref=welcome style=\\\"cursor: pointer\\\">TECHSAS</h1><span flex></span><md-button ng-click=ctrl.closeSidenav() class=md-icon-button><md-icon class=material-icons>close</md-icon></md-button></div><!-- User --><div class=user-block layout=column><!--Login title--><div layout=row style=\\\"color: grey\\\"><md-icon class=account-icon ng-class=\\\"ctrl.isConnected ? \\'connected\\': \\'not-connected\\'\\\">account_circle</md-icon><div flex style=\\\"padding: 8px\\\"><h2 class=md-headline ng-show=!ctrl.isConnected>{{\\\"components.sidenav.not-connected\\\" | translate}}</h2><div ng-show=ctrl.isConnected><h3 class=md-headline>{{ctrl.currentUser.name}}</h3><p class=md-subhead>{{ctrl.currentUser.login}}</p></div></div></div><!-- Login input--><div layout=column ng-show=\\\"!ctrl.connectionInProgress && !ctrl.isConnected\\\" style=\\\"height: 144px\\\"><md-input-container><label>{{\\\"components.sidenav.login\\\" | translate}}</label><input ng-model=ctrl.login type=text></md-input-container><md-input-container><label>{{\\\"components.sidenav.password\\\" | translate}}</label><input type=password ng-model=ctrl.password ng-keypress=ctrl.onKeyPressed($event)></md-input-container></div><!-- Login progress circle--><div ng-show=ctrl.connectionInProgress layout=column layout-align=\\\"center center\\\" style=\\\"height: 144px\\\"><md-progress-circular md-mode=indeterminate></md-progress-circular></div><!-- Login Button--><div layout=row layout-align=end><md-button class=\\\"md-primary md-raised\\\" ng-show=!ctrl.isConnected ng-click=ctrl.connection() ng-disabled=\\\"!ctrl.login || !ctrl.password\\\">{{\\\"components.sidenav.log-in\\\" | translate}}</md-button><md-button class=md-warn ng-show=ctrl.isConnected ng-click=ctrl.disconnection()>{{\\\"components.sidenav.log-out\\\" | translate}}</md-button></div></div><md-divider></md-divider><!-- Route selection --><md-button ng-repeat=\\\"route in ctrl.routeList\\\" layout=row layout-align=\\\"start stretch\\\" ng-class=\\\"route.isSelected ? \\'button-route-selected\\':\\'button-route\\'\\\" ui-sref={{route.sref}}><md-icon style=\\\"padding: 10px; width: 48px\\\">{{route.icon}}</md-icon><h3>{{\\'components.sidenav.\\' + route.title | translate}}</h3><span flex></span><div class=vertical-bar></div></md-button><md-divider></md-divider><span flex></span><div layout=row class=info><p class=md-subhead>{{\\\"pages.welcome.info\\\" | translate}} <a href=mailto:techsas@ifremer.fr>techsas@ifremer.fr</a></p></div></md-sidenav>\");\n$templateCache.put(\"app/pages/acquisition/acquisition.html\",\"<div class=\\\"tsa-page acquisition\\\" layout=column ng-init=ctrl.init()><!-- Buttons in the main navigation bar --><div class=tsa-navbar-buttons layout=row layout-align=\\\"center center\\\"><!--        <md-button class=\\\"md-icon-button\\\" ui-sref=\\\"device\\\">--><!--            <md-icon>add_circle</md-icon>--><!--            <md-tooltip>{{\\\"pages.acquisition.new-device\\\" | translate}}</md-tooltip>--><!--        </md-button>--><md-menu md-position-mode=\\\"target-right target\\\"><md-button class=md-icon-button ng-click=$mdOpenMenu($event)><md-icon md-menu-origin>filter_list</md-icon><md-tooltip>Filters</md-tooltip></md-button><md-menu-content><md-menu-item><div layout=row layout-align=\\\"center center\\\" style=\\\"padding-right: 0px\\\"><p flex>Status filters</p><md-button ng-click=\\\"\\\" class=md-icon-button style=\\\"background-color: transparent !important\\\"><md-icon md-menu-align-target style=\\\"margin: auto 3px auto 0\\\">close</md-icon></md-button></div></md-menu-item><md-menu-divider></md-menu-divider><md-menu-item ng-repeat=\\\"status in ctrl.STATUS\\\" style=\\\"padding-left: 16px\\\"><md-checkbox ng-model=status.show><p>{{status.text}}</p></md-checkbox></md-menu-item></md-menu-content></md-menu><md-button class=md-icon-button ng-click=\\\"ctrl.displayMode = ctrl.displayMode == \\'grid\\' ? \\'list\\': \\'grid\\';\\\"><md-icon ng-show=\\\"ctrl.displayMode === \\'list\\'\\\">view_module</md-icon><md-icon ng-show=\\\"ctrl.displayMode === \\'grid\\'\\\">view_headline</md-icon><md-tooltip>Display mode</md-tooltip></md-button><md-button class=md-icon-button ng-click=\\\"ctrl.showConsole = !ctrl.showConsole\\\"><md-icon>message</md-icon><md-tooltip>Show/hide console</md-tooltip></md-button></div><!-- Toolbar--><div ng-show=\\\"ctrl.displayMode === \\'list\\'\\\" class=tsa-toolbar md-whiteframe=1 layout=row layout-align=\\\"center center\\\"><md-button flex=20 layout=row layout-align=\\\"start center\\\" class=tsa-button-text-icon ng-click=\\\"ctrl.setOrderDevice(\\'device.name\\')\\\"><div layout=row><p>Device</p><md-icon class=material-icons>arrow_drop_down</md-icon></div><md-tooltip>Sort by name</md-tooltip></md-button><md-button flex=20 layout=row layout-align=\\\"start center\\\" class=tsa-button-text-icon ng-click=\\\"ctrl.setOrderDevice(\\'status.text\\')\\\"><div layout=row><p>Status</p><md-icon class=material-icons>arrow_drop_down</md-icon></div><md-tooltip>Sort by status</md-tooltip></md-button><p flex=15>Frames</p><div flex layout=row><p flex=80>File(s)</p><p flex=20>Size</p></div></div><!--<md-divider></md-divider>--><!--Device list --><md-list ng-show=\\\"ctrl.displayMode === \\'list\\'\\\" layout=column flex style=\\\"padding: 0px\\\"><md-content flex><!--Item list--  ng-show=\\\"item.device.isEnabled\\\" --><md-list-item class=device style=\\\"padding: 0px\\\" ng-repeat=\\\"item in ctrl.itemList | orderBy: ctrl.orderDevice\\\" ng-show=item.status.show ng-click=ctrl.selectItem(item) ng-style=\\\"(item.isSelected) ?\\n                          {\\'background-color\\': \\' rgba(254, 237, 1, 0.47)\\'}: {}\\\" ng-disabled=item.isRemoved><div flex layout=row layout-align=\\\"center center\\\"><div flex=20 layout=row><p class=tsa-device-title>{{item.device.name}}</p><p style=\\\"font-size: small\\\">{{item.device.id}}</p></div><p flex=20 style=\\\"color: {{item.status.color}}\\\">{{item.status.text}}</p><div flex=15><p>{{item.frameNumber}}</p></div><div flex layout=column><div ng-repeat=\\\"file in item.files\\\" layout=row><p flex=80>{{file.filename.split(\\'/\\').pop()}}</p><p flex=20>{{file.filesizeFormated}}</p></div></div></div><div layout=row layout-align=end><!--                    <md-button class=\\\"md-icon-button\\\" ui-sref=\\\"device({id:\\'{{item.device.id}}\\'})\\\">--><!--                        <md-icon>edit</md-icon>--><!--                    </md-button>--><!--                    <md-button class=\\\"md-icon-button\\\" ng-click=\\\"ctrl.removeItem(item)\\\">--><!--                        <md-icon>delete</md-icon>--><!--                    </md-button>--></div><md-divider></md-divider></md-list-item></md-content></md-list><!-- Grid --><md-content ng-show=\\\"ctrl.displayMode === \\'grid\\'\\\" flex class=tsa-page><md-grid-list flex md-cols-xs=2 md-cols-sm=4 md-cols-md=6 md-cols-gt-md=8 md-cols-gt-lg=10 md-row-height=130px md-gutter=12px style=\\\"margin: 12px\\\"><md-grid-tile ng-repeat=\\\"item in ctrl.itemList\\\" md-whiteframe=1 layout=column ng-if=item.status.show><md-content layout=column><p class=tsa-device-title>{{item.device.name}}</p><md-divider></md-divider><p>{{item.device.id}}</p><p>{{item.frameNumber}}</p></md-content><md-grid-tile-footer style=background-color:{{item.status.color}}><h3>{{item.status.text}}</h3></md-grid-tile-footer></md-grid-tile></md-grid-list></md-content><!-- Console --><div ng-show=ctrl.showConsole layout=column style=\\\"resize: both; height: 300px; margin:0px ; z-index: 2\\\"><md-nav-bar md-selected-nav-item=ctrl.consoleView md-whiteframe=5><md-nav-item ng-repeat=\\\"view in ctrl.consoleViews\\\" md-nav-click=ctrl.changeConsole(view) name={{view}}>{{view}}</md-nav-item><span flex></span><md-button class=md-icon-button ng-click=\\\"ctrl.showConsole = false\\\" style=\\\"margin: auto\\\"><md-icon>close</md-icon></md-button></md-nav-bar><div layout=row flex=100 style=\\\"margin: 0px; padding: 0px\\\"><textarea id=acquisition-textarea flex md-no-autogrow ng-model=ctrl.console md-select-on-focus readonly style=\\\"border: 0px\\\"></textarea></div></div></div>\");\n$templateCache.put(\"app/pages/dashboard/dashboard.html\",\"<div ng-init=ctrl.init() class=tsa-page><!-- Buttons inside the main toolbar --><div class=tsa-navbar-buttons layout=row layout-align=\\\"center center\\\"><!-- Dashboard selection menu --><md-menu md-position-mode=\\\"target-right target\\\"><md-button layout=row layout-align=\\\"center center\\\" ng-click=$mdOpenMenu($event)><div layout=row><p style=\\\"margin: 0 8px\\\">{{ctrl.selectedDashboard.title | translate}}</p><md-icon class=material-icons>arrow_drop_down</md-icon></div><md-tooltip>{{\\\"pages.dashboard.select-dashboard\\\" | translate}}</md-tooltip></md-button><md-menu-content width=4><!-- Personal dashboard list --><md-menu-item ng-repeat=\\\"(title, itemList) in ctrl.dashboardListPerso\\\"><md-button ng-click=\\\"ctrl.dashboardService.setCurrentDashboard(title, itemList)\\\" style=\\\"padding-right: 0px\\\" ng-style=\\\"title  === ctrl.selectedDashboard.title ?{\\'color\\': \\' #1a75ad\\'}: {}\\\"><div layout=row flex><p flex>{{title}}</p><md-icon md-menu-align-target ng-style=\\\"title  === ctrl.selectedDashboard.title ? {\\'color\\': \\' #1a75ad\\'}: {}\\\">dashboard</md-icon></div></md-button></md-menu-item><md-menu-divider></md-menu-divider><md-menu-item><md-button ng-click=ctrl.dashboardService.switchToNewDashboard() style=\\\"padding-right: 0px\\\"><div layout=row flex><p flex>{{\\\"pages.dashboard.new-dashboard\\\" | translate}}</p><md-icon md-menu-align-target>add</md-icon></div></md-button></md-menu-item></md-menu-content></md-menu><!-- buttons --><md-button class=md-icon-button ng-click=ctrl.showSaveDialog() ng-disabled=\\\"ctrl.userService.getCurrentUser() == undefined\\\"><md-icon class=material-icons>save</md-icon><md-tooltip>{{\\\"pages.dashboard.save-dashboard\\\" | translate}}</md-tooltip></md-button><md-button class=md-icon-button ng-click=ctrl.showDeleteDialog() ng-disabled=!ctrl.deleteEnabled()><md-icon class=material-icons>delete</md-icon><md-tooltip>{{\\\"pages.dashboard.delete-dashboard\\\" | translate}}</md-tooltip></md-button><md-button class=md-icon-button ng-click=ctrl.dashboardService.showAddItem()><md-icon class=material-icons>add_circle</md-icon><md-tooltip>{{\\\"pages.dashboard.new-card\\\" | translate}}</md-tooltip></md-button></div><!-- Dashboard grid --><div gridster=ctrl.gridsterOpts style=height:100%><ul><li gridster-item=item ng-repeat=\\\"item in ctrl.currentDashboard.itemList\\\"><tsa-card card-id={{item.id}} type=item.type config=item.config></tsa-card></li></ul></div></div>\");\n$templateCache.put(\"app/pages/dataAccess/dataAccess.html\",\"<div class=\\\"tsa-page data-access\\\" layout=column ng-init=ctrl.init()><!-- Buttons in the main navigation bar --><div class=tsa-navbar-buttons layout=row layout-align=\\\"center center\\\"><md-nav-bar md-selected-nav-item=ctrl.currentMode><md-nav-item md-nav-click=\\\"goto(\\'page1\\')\\\" name=simple>{{\\\"pages.data-access.simple\\\" | translate}}</md-nav-item><md-nav-item md-nav-click=\\\"goto(\\'page2\\')\\\" name=advanced>{{\\\"pages.data-access.advanced\\\" | translate}}</md-nav-item></md-nav-bar></div><!-- Inputs (period, settings, data...) --><div layout=row class=inputs md-whiteframe=2><tsa-variable-selector flex=70 mode=ctrl.currentMode get-variable-list=ctrl.getVariableList></tsa-variable-selector><md-divider></md-divider><div flex=30 layout=column><tsa-period-selector mode=ctrl.currentMode get-date-range=ctrl.getDateRange></tsa-period-selector><tsa-param-selector mode=ctrl.currentMode get-params=ctrl.getParams></tsa-param-selector><span flex></span><!-- Download buttons --><div layout=row layout-align=center class=download-buttons><md-button class=md-primary ng-disabled=\\\"ctrl.netcdfInProgress || ctrl.csvInProgress\\\" ng-click=\\\"ctrl.sendRequest(\\'json\\')\\\" ng-class=\\\"{\\'in-progress\\': ctrl.researchInProgress}\\\"><div layout=row layout-align=\\\"center center\\\"><md-icon>search</md-icon><md-progress-circular md-mode=indeterminate md-diameter=20px></md-progress-circular>{{\\\"pages.data-access.search\\\" | translate}}</div></md-button><md-button class=md-primary ng-disabled=\\\"ctrl.netcdfInProgress || ctrl.researchInProgress\\\" ng-click=\\\"ctrl.sendRequest(\\'csv\\')\\\" ng-class=\\\"{\\'in-progress\\': ctrl.csvInProgress}\\\"><div layout=row layout-align=\\\"center center\\\"><md-icon>file_download</md-icon><md-progress-circular md-mode=indeterminate md-diameter=20px></md-progress-circular>CSV</div></md-button><md-button class=md-primary ng-disabled=\\\"ctrl.csvInProgress || ctrl.researchInProgress\\\" ng-click=\\\"ctrl.sendRequest(\\'netcdf\\')\\\" ng-class=\\\"{\\'in-progress\\': ctrl.netcdfInProgress}\\\"><div layout=row layout-align=\\\"center center\\\"><md-icon>file_download</md-icon><md-progress-circular md-mode=indeterminate md-diameter=20px></md-progress-circular>NetCDF</div></md-button></div></div></div><!-- Login progress --><div flex ng-show=ctrl.researchInProgress layout=column layout-align=\\\"center center\\\" style=\\\"height: 200px\\\"><md-progress-circular md-mode=indeterminate></md-progress-circular><h2 class=md-headline style=\\\"color: #1A75AE\\\">{{\\\"pages.data-access.research-msg\\\" | translate}}</h2></div><!-- Result --><tsa-result-card flex frames=ctrl.results ng-show=\\\"!ctrl.researchInProgress && ctrl.results.length > 0\\\"></tsa-result-card></div>\");\n$templateCache.put(\"app/pages/login/login.html\",\"<div class=tsa-login layout=column layout-align=\\\"center center\\\"><!-- login card --><md-card><div layout=row layout-align=start><md-icon class=account-icon>lock_outline</md-icon><h1 class=\\\"md-headline card-title\\\">{{\\\"pages.login.authentication\\\" | translate}}</h1></div><p class=md-body-1>{{\\\"pages.login.authentication-msg\\\" | translate}}</p><md-input-container ng-show=!ctrl.connectionInProgress><label>{{\\\"components.sidenav.login\\\" | translate}}</label><input ng-model=ctrl.login type=text></md-input-container><md-input-container ng-show=!ctrl.connectionInProgress><label>{{\\\"components.sidenav.password\\\" | translate}}</label><input type=password ng-model=ctrl.password ng-keypress=ctrl.onKeyPressed($event)></md-input-container><!-- Login progress circle--><div ng-show=ctrl.connectionInProgress layout=column layout-align=\\\"center center\\\" style=\\\"height: 144px\\\"><md-progress-circular md-mode=indeterminate></md-progress-circular></div><!-- Login Button--><div layout=row layout-align=end ng-show=!ctrl.connectionInProgress><md-button class=\\\"md-primary md-raised\\\" ng-click=ctrl.connection() ng-disabled=\\\"!ctrl.login || !ctrl.password\\\">{{\\\"components.sidenav.log-in\\\" | translate}}</md-button></div></md-card></div>\");\n$templateCache.put(\"app/pages/staticGrid/staticGrid.html\",\"<div class=\\\"tsa-page tsa-static-grid\\\" layout=column><!-- Buttons inside the main toolbar --><div class=tsa-navbar-buttons layout=row layout-align=\\\"center center\\\"><md-button class=md-icon-button ng-click=ctrl.service.changeViewMode()><md-icon ng-if=\\\"ctrl.service.getViewMode() == ctrl.service.MODES.SINGLE\\\" class=material-icons>filter_1</md-icon><md-tooltip ng-if=\\\"ctrl.service.getViewMode() == ctrl.service.MODES.SINGLE\\\">{{\\\"pages.static-grid.switch-to-4\\\" | translate}}</md-tooltip><md-icon ng-if=\\\"ctrl.service.getViewMode() == ctrl.service.MODES.MULTIPLE_4\\\" class=material-icons>filter_4</md-icon><md-tooltip ng-if=\\\"ctrl.service.getViewMode() == ctrl.service.MODES.MULTIPLE_4\\\">{{\\\"pages.static-grid.switch-to-6\\\" | translate}}</md-tooltip><md-icon ng-if=\\\"ctrl.service.getViewMode() == ctrl.service.MODES.MULTIPLE_6\\\" class=material-icons>filter_6</md-icon><md-tooltip ng-if=\\\"ctrl.service.getViewMode() == ctrl.service.MODES.MULTIPLE_6\\\">{{\\\"pages.static-grid.switch-to-1\\\" | translate}}</md-tooltip></md-button></div><!-- Nav bar (only in single mode) --><md-nav-bar ng-if=ctrl.service.isSingleMode() md-selected-nav-item=ctrl.currentNavItemId md-whiteframe=2 style=\\\"z-index: 2\\\"><div layout=row ng-repeat=\\\"cardrow in ctrl.cards\\\" ng-init=\\\"rowIndex = $index\\\"><md-nav-item md-nav-click=\\\"ctrl.selectCard(rowIndex, $index)\\\" name={{card.id}} ng-repeat=\\\"card in cardrow\\\"><i class=\\\"mdi mdi-24px mdi-{{card.icon | translate}}\\\"></i> {{card.title | translate }}</md-nav-item></div></md-nav-bar><!-- Static grid --><div style=\\\"margin-bottom: 8px\\\"></div><div flex layout=column ng-class=\\\"ctrl.service.isSingleMode() ? \\'static-single-mode\\':\\'\\'\\\" style=\\\"padding-left: 8px; padding-bottom: 8px\\\" ng-repeat=\\\"cardrow in ctrl.cards\\\" ng-show=ctrl.showRow($index)><div layout=row layout-fill><tsa-card ng-repeat=\\\"card in cardrow\\\" ng-show=ctrl.showCard(card) flex={{ctrl.flex}} card-id={{card.id}} type=card.type config=card.config title-value=card.title icon=card.icon style=\\\"padding-right: 8px\\\"></tsa-card></div></div></div>\");\n$templateCache.put(\"app/pages/tracking/tracking.html\",\"<div ng-init=ctrl.init() class=tsa-page><tsa-map mode=navigation title=Map config=ctrl.config card-id={{ctrl.cardId}}></tsa-map></div>\");\n$templateCache.put(\"app/pages/welcome/welcome.html\",\"<div flex class=\\\"tsa-welcome {{ctrl.ship}}\\\" layout=row ng-init=ctrl.init()><!-- Background layer --><div flex class=layer layout=column><div flex layout=row layout-align=space-between><!--Title--><div><h1 class=md-display-4>TECHSAS</h1><h3 class=md-headline>{{\\\"pages.welcome.techsas.subtitle\\\" | translate}}</h3></div><!--Message--><div layout=row class=info><i class=material-icons>info</i><p class=md-subhead>{{\\\"pages.welcome.info\\\" | translate}} <a href=mailto:techsas@ifremer.fr>techsas@ifremer.fr</a></p></div></div><!-- Cards --><div flex layout=row layout-align=\\\"space-around center\\\"><md-card ui-sref=dashboard layout=column><md-card-title><md-card-title-text><span class=md-headline>{{\\\"pages.welcome.dashboard.title\\\" | translate}}</span> <span class=md-subhead>{{\\\"pages.welcome.dashboard.subtitle\\\" | translate}}</span></md-card-title-text></md-card-title><md-card-content layout=row layout-align=\\\"center center\\\"><i class=material-icons>dashboard</i></md-card-content></md-card><md-card ui-sref=dataAccess ng-if=ctrl.showExtraction><md-card-title><md-card-title-text><span class=md-headline>{{\\\"pages.welcome.data-access.title\\\" | translate}}</span> <span class=md-subhead>{{\\\"pages.welcome.data-access.subtitle\\\" | translate}}</span></md-card-title-text></md-card-title><md-card-content layout=row layout-align=\\\"center center\\\"><i class=material-icons>file_download</i></md-card-content></md-card><md-card ui-sref=acquisition><md-card-title><md-card-title-text><span class=md-headline>{{\\\"pages.welcome.acquisition.title\\\" | translate}}</span> <span class=md-subhead>{{\\\"pages.welcome.acquisition.subtitle\\\" | translate}}</span></md-card-title-text></md-card-title><md-card-content layout=row layout-align=\\\"center center\\\"><i class=material-icons>settings_input_component</i></md-card-content></md-card></div></div></div>\");\n$templateCache.put(\"app/tsa-views/adcp/adcp.html\",\"<div layout=column><!-- Toolbar --><div layout=row class=tsa-toolbar><i class=\\\"mdi mdi-24px mdi-{{\\'views.adcp.icon\\' | translate }}\\\"></i><p class=title>{{\\\"views.adcp.title\\\" | translate }}</p><p class=device-id>- {{ctrl.deviceId}}</p><span flex></span><tsa-settings-button on-change-view=\\\"ctrl.onChangeCardType({type: type})\\\" card-id={{ctrl.cardId}}></tsa-settings-button></div><md-divider></md-divider><!-- Content --><div flex layout=row class=tsa-content ng-class=\\\"{\\'data-missing\\': ctrl.dataMissing}\\\"><div flex=50 layout=column class=starboard><p class=md-headline>{{ \\\"views.adcp.north-south.title\\\" | translate }}</p><div flex class=tsa-chart-container><canvas id={{ctrl.canvasId1}}></canvas></div></div><div flex=50 layout=column class=port><p class=md-headline>{{ \\\"views.adcp.east-west.title\\\" | translate }}</p><div flex class=tsa-chart-container><canvas id={{ctrl.canvasId2}}></canvas></div></div></div><div flex=1 layout=row ng-style=\\\"{ color: ctrl.dateColor }\\\">{{ ctrl.dateContent | date: \\\"dd/MM/yy HH:mm:ss\\\" : \\\"UTC\\\" }}</div></div>\");\n$templateCache.put(\"app/tsa-views/atpropulsion/atpropulsion.html\",\"<meta charset=utf-8><div layout=column><!-- Toolbar --><div layout=row class=tsa-toolbar><i class=\\\"mdi mdi-24px mdi-{{\\'views.propulsion.icon\\' | translate }}\\\"></i><p class=title>{{\\\"views.propulsion.title\\\" | translate }}</p><p class=device-id>- {{ctrl.deviceId}}</p><span flex></span><tsa-settings-button on-change-view=\\\"ctrl.onChangeCardType({type: type})\\\" card-id={{ctrl.cardId}}></tsa-settings-button></div><md-divider></md-divider><!-- Content --><div flex layout=column class=tsa-content><div class=canvas flex layout=column><canvas flex id={{ctrl.canvasId}}><p>Error during the display of the canvas (maybe due to the browser version)</p></canvas><!-- Data views --><tsa-data-view id=fronttrans data=ctrl.frontTrans.id frame-id=ctrl.frameId device-id=ctrl.deviceId format=%.0f title-disabled=true units=\\\"\\\" ng-style=\\\"{top:ctrl.frontTrans.y + \\'px\\', left: ctrl.frontTrans.x + \\'px\\'};\\\"></tsa-data-view><!--\\n            <tsa-data-view\\n            \tid=\\\"reartrans\\\"\\n                data=ctrl.rearTrans.id\\n                frame-id=ctrl.frameId\\n                device-id=ctrl.deviceId\\n                format=\\\"%.0f\\\"\\n                title-disabled=\\\"true\\\"\\n                units=\\\"\\\"\\n                ng-style=\\\"{top:ctrl.rearTrans.y + \\'px\\', left: ctrl.rearTrans.x + \\'px\\'};\\\">\\n            </tsa-data-view>\\n--><tsa-data-view id=mainLeft data=ctrl.mainLeft.id frame-id=ctrl.frameId device-id=ctrl.deviceId format=%.0f title-disabled=true units=rpm ng-style=\\\"{top:ctrl.mainLeft.y + \\'px\\', left: ctrl.mainLeft.x + \\'px\\'};\\\"></tsa-data-view><tsa-data-view id=angle data=ctrl.angle.id frame-id=ctrl.frameId device-id=ctrl.deviceId format=%.0f title-disabled=true units= redgreen=true ng-style=\\\"{top:ctrl.angle.y + \\'px\\', left: ctrl.angle.x + \\'px\\'};\\\"></tsa-data-view><span id=greendummy1 hidden>Green dummy 1</span></div></div></div>\");\n$templateCache.put(\"app/tsa-views/attitude/attitude.html\",\"<div layout=column><!-- Toolbar --><div layout=row class=tsa-toolbar><i class=\\\"mdi mdi-24px mdi-{{\\'views.attitude.icon\\' | translate }}\\\"></i><p class=title>{{\\\"views.attitude.title\\\" | translate }}</p><p class=device-id>- {{ctrl.deviceId}}</p><span flex></span><tsa-settings-button on-change-view=\\\"ctrl.onChangeCardType({type: type})\\\" card-id={{ctrl.cardId}}></tsa-settings-button></div><md-divider></md-divider><!-- Content --><div flex layout=row class=tsa-content><div flex=50 layout=column><tsa-data-view data=ctrl.heading frame-id=ctrl.frameId device-id=ctrl.deviceId opt-title=views.attitude.heading format=%.1f units=></tsa-data-view><tsa-data-view data=ctrl.roll frame-id=ctrl.frameId device-id=ctrl.deviceId opt-title=views.attitude.roll format=%.1f units=></tsa-data-view><tsa-data-view data=ctrl.pitch frame-id=ctrl.frameId device-id=ctrl.deviceId opt-title=views.attitude.pitch format=%.1f units=></tsa-data-view><tsa-data-view data=ctrl.heave frame-id=ctrl.frameId device-id=ctrl.deviceId opt-title=views.attitude.heave format=%.1f units=m></tsa-data-view></div><md-divider></md-divider><div flex=50 layout=column><span class=column-span></span><tsa-data-view opt-value=ctrl.list opt-title=views.attitude.list format=%.1f units=></tsa-data-view><tsa-data-view opt-value=ctrl.trim opt-title=views.attitude.trim format=%.1f units=></tsa-data-view></div></div></div>\");\n$templateCache.put(\"app/tsa-views/casino/casino.html\",\"<div layout=column><!-- Toolbar --><div layout=row class=tsa-toolbar><i class=\\\"mdi mdi-24px mdi-{{\\'views.casino.icon\\' | translate }}\\\"></i><p class=title>{{\\\"views.casino.title\\\" | translate }}</p><p class=device-id ng-show=ctrl.selectedCruise>- {{ctrl.selectedCruise.FullName}}</p><span flex></span><!-- Loading icon --><div ng-if=ctrl.casinoLoading layout=column layout-align=\\\"center center\\\" style=\\\"width: 40px\\\"><md-tooltip>{{\\\"archive-loading\\\" | translate }}</md-tooltip><md-progress-circular md-diameter=20px></md-progress-circular></div><!-- Period choice--><md-input-container ng-if=\\\"ctrl.selectedCruise && !ctrl.casinoErrorConnect && !ctrl.casinoErrorLoad\\\"><md-select ng-model=ctrl.period ng-change=ctrl.refreshCruise(false)><md-option value=0>{{ctrl.config.limit}} {{\\\"views.casino.period-list.0\\\" | translate }}</md-option><md-option value=6>{{\\\"views.casino.period-list.6\\\" | translate }}</md-option><md-option value=24>{{\\\"views.casino.period-list.24\\\" | translate }}</md-option><md-option value=168>{{\\\"views.casino.period-list.168\\\" | translate }}</md-option></md-select><md-tooltip>{{\\\"Scale\\\" | translate }}</md-tooltip></md-input-container><!-- Refresh cruise --><md-button class=md-icon-button ng-click=ctrl.refreshCruise(true) ng-if=ctrl.casinoErrorLoad><i class=\\\"mdi mdi-24px mdi-{{\\'views.casino.refresh.icon\\' | translate }}\\\"></i><md-tooltip>{{\\\"views.casino.refresh.label\\\" | translate }}</md-tooltip></md-button><tsa-settings-button on-change-view=\\\"ctrl.onChangeCardType({type: type})\\\" card-id={{ctrl.cardId}}></tsa-settings-button></div><md-divider></md-divider><!-- Content --><div flex class=tsa-content layout=column><!-- ERROR Content --><div ng-if=ctrl.casinoErrorConnect><br><div>{{\\\"views.casino.connection.error\\\" | translate }}</div><br><md-button class=\\\"md-raised md-primary\\\" ng-click=ctrl.casinoConnection() ng-disabled=ctrl.casinoCanConnect()>{{\\\"views.casino.connection.button\\\" | translate }}</md-button></div><div ng-if=ctrl.casinoErrorLoad><br><div>{{\\\"views.casino.connection.loaderror\\\" | translate }}</div></div><!-- Events table --><div flex layout=column class=tsa-table ng-if=\\\"ctrl.selectedCruise && !ctrl.casinoErrorConnect && !ctrl.casinoErrorLoad\\\"><div layout=row class=\\\"title tsa-table-title\\\"><p flex ng-repeat=\\\"column in ctrl.config.eventsDisplayColumns\\\">{{\\\"views.casino.event.\\\" + column | translate }}</p></div><div flex id=casino_event_array class=tsa-table-content><div flex layout=row ng-repeat=\\\"eventDisplay in ctrl.eventsListToDisplay\\\"><p flex ng-repeat=\\\"columnDisplay in ctrl.config.eventsDisplayColumns\\\"><span ng-switch=columnDisplay><span ng-switch-when=Date>{{eventDisplay[columnDisplay] | date:\\'yyyy-MM-dd HH:mm:ss\\'}}</span> <span ng-switch-when=Latitude>{{eventDisplay[columnDisplay] | number:2}}</span> <span ng-switch-when=Longitude>{{eventDisplay[columnDisplay] | number:2}}</span> <span ng-switch-default=\\\"\\\">{{eventDisplay[columnDisplay]}}</span></span></p></div></div></div></div></div>\");\n$templateCache.put(\"app/tsa-views/casino/casinoAddEvent.html\",\"<div layout=column><!-- Toolbar --><div layout=row class=tsa-toolbar><i class=\\\"mdi mdi-24px mdi-{{\\'views.casino.add-event.icon\\' | translate }}\\\"></i><p class=title>{{\\\"views.casino.add-event.title\\\" | translate }}</p><p class=device-id ng-if=!ctrl.isFollow>- {{\\\"views.casino.add-event.subtitle\\\" | translate}}</p><p class=device-id ng-if=ctrl.isFollow>- {{\\\"views.casino.add-event.follow-subtitle\\\" | translate}} {{ctrl.operationId.getStringOperationId()}}</p><span flex></span><!-- Loading icon --><div ng-if=ctrl.casinoLoading layout=column layout-align=\\\"center center\\\" style=\\\"width: 40px\\\"><md-tooltip>{{\\\"archive-loading\\\" | translate }}</md-tooltip><md-progress-circular md-diameter=20px></md-progress-circular></div><!-- Refresh cruise --><md-button class=md-icon-button ng-click=ctrl.refreshCruise(true) ng-if=ctrl.casinoErrorLoad><i class=\\\"mdi mdi-24px mdi-{{\\'views.casino.refresh.icon\\' | translate }}\\\"></i><md-tooltip>{{\\\"views.casino.refresh.label\\\" | translate }}</md-tooltip></md-button><!-- Reset Form --><md-button class=md-icon-button ng-click=ctrl.onResetClick() ng-if=\\\"!ctrl.casinoErrorConnect && !ctrl.casinoErrorLoad\\\"><i class=\\\"mdi mdi-24px mdi-{{\\'views.casino.add-event.reset.icon\\' | translate }}\\\"></i><md-tooltip>{{\\\"views.casino.add-event.reset.label\\\" | translate}}</md-tooltip></md-button><tsa-settings-button on-change-view=\\\"ctrl.onChangeCardType({type: type})\\\" card-id={{ctrl.cardId}} valid-close-title={{ctrl.validExitTitle}} valid-close-msg={{ctrl.validExitMsg}}></tsa-settings-button></div><md-divider></md-divider><!-- Content --><div flex layout=column class=tsa-content><!-- ERROR Content --><div ng-if=ctrl.casinoErrorConnect><br><div>{{\\\"views.casino.connection.error\\\" | translate }}</div><br><md-button class=\\\"md-raised md-primary\\\" ng-click=ctrl.casinoConnection() ng-disabled=ctrl.casinoCanConnect()>{{\\\"views.casino.connection.button\\\" | translate }}</md-button></div><div ng-if=ctrl.casinoErrorLoad><br><div>{{\\\"views.casino.connection.loaderror\\\" | translate }}</div></div><div ng-if=ctrl.error style=color:red><br><div>ERROR: {{ctrl.error.message}}</div><br></div><!-- FORM CONTENT --><form name=casinoEventForm flex layout=column layout-align=\\\"space-between stretch\\\" ng-if=\\\"!ctrl.casinoErrorConnect && !ctrl.casinoErrorLoad\\\"><div flex layout=row class=form-group><!-- Current Cruise --><md-input-container flex><label>{{\\\"views.casino.cruises.title\\\" | translate }}</label><input type=text ng-model=ctrl.selectedCruise.FullName readonly></md-input-container><md-button class=md-icon-button ng-click=ctrl.refreshCruise(true) ng-if=ctrl.error style=color:red flex=10><i class=\\\"mdi mdi-24px mdi-{{\\'views.casino.refresh.icon\\' | translate }}\\\"></i><md-tooltip>{{\\\"views.casino.refresh.label\\\" | translate }}</md-tooltip></md-button><!-- Select Type --><md-input-container flex=50><label>{{\\\"views.casino.event.Type\\\" | translate }}</label><md-select class=form-control required ng-model=ctrl.casinoEvent.type ng-disabled=ctrl.isFollow><md-option ng-value=eventType ng-repeat=\\\"eventType in ctrl.eventTypeEnum\\\">{{\\\"views.casino.event-type.\\\"+eventType | translate }}</md-option></md-select></md-input-container></div><!-- PHASE content --><div flex layout=row ng-if=\\\"ctrl.casinoEvent.type && ctrl.casinoEvent.type === \\'PHA\\'\\\"><!-- Select Phase Type --><md-input-container flex=50><label>{{\\\"views.casino.event.PhaseType\\\" | translate }}</label><md-select class=form-control required ng-model=ctrl.casinoEvent.phaseType><md-option ng-value=phaseType ng-repeat=\\\"phaseType in ctrl.phaseTypeEnum\\\">{{\\\"views.casino.event-phase.\\\"+phaseType | translate }}</md-option></md-select></md-input-container><!-- Phase Name --><md-input-container flex=50><label>{{\\\"views.casino.event.PhaseFullName\\\" | translate }}</label><input type=text ng-model=ctrl.casinoEvent.phaseFullName></md-input-container></div><!-- OPERATION content --><div flex layout=row ng-if=\\\"ctrl.casinoEvent.type && ctrl.casinoEvent.type === \\'OPE\\'\\\"><tsa-code-name-fields flex=50 item-type=device list-items=ctrl.listCasinoDevices item-code=ctrl.casinoEvent.deviceCode on-item-change=ctrl.updateDevice($item) item-readonly=ctrl.isFollow item-follow=false></tsa-code-name-fields><tsa-code-name-fields flex=50 item-type=action list-items=ctrl.listDeviceActions item-code=ctrl.casinoEvent.actionCode on-item-change=ctrl.updateAction($item) item-readonly=false item-follow=ctrl.isFollow></tsa-code-name-fields></div><!-- Operation Label --><div flex layout=row ng-if=\\\"ctrl.casinoEvent.type && ctrl.casinoEvent.type === \\'OPE\\'\\\"><md-input-container flex=30><label>{{\\\"views.casino.event.OperationId\\\" | translate }}</label><input type=text ng-model=ctrl.operationId.prefix disabled></md-input-container><md-input-container flex=50><label>{{\\\"views.casino.add-event.operation.custom\\\" | translate }}</label><input type=text ng-model=ctrl.operationId.custom ng-disabled=ctrl.isFollow></md-input-container><md-input-container flex=20><label>{{\\\"views.casino.add-event.operation.number\\\" | translate }}</label><input type=number required ng-model=ctrl.operationId.number ng-disabled=ctrl.isFollow></md-input-container></div><!-- commun to OPE and OBS : Strate and Station Number (halieutic) --><div flex layout=row ng-if=\\\"ctrl.casinoEvent.type && ctrl.casinoEvent.type != \\'PHA\\'\\\"><!-- Station Number --><md-input-container flex=50><label>{{\\\"views.casino.event.Field1\\\" | translate }}</label><input type=text ng-model=ctrl.casinoEvent.field1></md-input-container><!-- Strate --><md-input-container flex=50><label>{{\\\"views.casino.event.Field2\\\" | translate }}</label><input type=text ng-model=ctrl.casinoEvent.field2></md-input-container></div><!-- common content --><div flex layout=row><!-- Observations --><md-input-container flex=100><label>{{\\\"views.casino.event.Observation\\\" | translate }}</label><input type=text ng-model=ctrl.casinoEvent.observation ng-value=ctrl.casinoEvent.observation md-maxlength=255></md-input-container></div><!-- submit form --><md-button class=\\\"md-raised md-primary\\\" ng-disabled=\\\"casinoEventForm.$invalid || ctrl.error\\\" ng-click=ctrl.onSubmit()>{{\\\"views.casino.add-event.submit\\\" | translate }}</md-button></form></div></div>\");\n$templateCache.put(\"app/tsa-views/debug/debug.html\",\"<div layout=column ng-switch=ctrl.view><!-- Nav bar --><md-nav-bar md-selected-nav-item=ctrl.view class=tsa-debug><md-nav-item md-nav-click=\\\"ctrl.view=\\'Devices\\'\\\" name=Devices>Devices</md-nav-item><md-nav-item md-nav-click=\\\"ctrl.view=\\'Topics\\'\\\" name=Topics>Topics</md-nav-item><md-nav-item md-nav-click=\\\"ctrl.view=\\'Topic\\'\\\" name=Topic>Topic</md-nav-item><md-nav-item md-nav-click=\\\"ctrl.view=\\'Buffers\\'\\\" name=Buffers>Buffers</md-nav-item><md-nav-item md-nav-click=\\\"ctrl.view=\\'REST\\'\\\" name=REST>REST</md-nav-item><span flex></span><tsa-settings-button class=tsa-debug on-change-view=\\\"ctrl.onChangeCardType({type: type})\\\" card-id={{ctrl.cardId}}></tsa-settings-button></md-nav-bar><!-- DEVICES tab --><div ng-switch-when=Devices flex layout=column><!--Device list title and legends --><div class=tsa-debug-title-bar layout=row layout-align=\\\"space-around center\\\"><div layout=row layout-align=\\\"center center\\\"><md-icon style=\\\"color: #F44336\\\">highlight_off<md-tooltip>Device missing from the configuration messages.</md-tooltip></md-icon><md-icon style=\\\"color: #8BC34A\\\">check_circle<md-tooltip>Device enabled.</md-tooltip></md-icon><md-subheader>status</md-subheader></div><div layout=row layout-align=\\\"center center\\\"><md-subheader>data listeners</md-subheader></div></div><md-divider></md-divider><!--Device list --><md-content><md-list flex style=\\\"padding: 0px\\\"><md-list-item class=md-2-line ng-repeat=\\\"device in ctrl.deviceList\\\" ng-click=null style=\\\"padding: 0px\\\" layout-align=\\\"center center\\\"><div style=\\\"padding: 15px\\\"><md-icon ng-show=!device.isEnabled style=\\\"color: #F44336\\\">highlight_off</md-icon><md-icon ng-show=device.isEnabled style=\\\"color: #8BC34A\\\">check_circle</md-icon></div><div flex=50 class=md-list-item-text><h3>{{device.name}}</h3><p>{{device.id}}</p></div><div flex=50 layout=row><p>Device: {{ device.listenerCount }} / Frame: {{ device.frameListenerList.length }} / Data: {{ device.dataListenerList.length }}</p></div><span flex=5></span><md-divider></md-divider></md-list-item></md-list></md-content></div><!--TOPICS tab --><div ng-switch-when=Topics layout=column><div layout=column><!--STOMP connection status --><div layout=row class=tsa-debug-title-bar layout-align=\\\"center center\\\" ng-style=\\\" ctrl.stompService.isConnected() ? {\\'background-color\\': \\' rgba(139, 195, 74,0.2)\\'}: {\\'background-color\\': \\'rgba(244, 67, 54,0.2)\\'} \\\"><h3 class=md-headline ng-show=ctrl.stompService.isConnected() style=\\\"color: #8BC34A\\\">Connection enabled</h3><h3 class=md-headline ng-show=!ctrl.stompService.isConnected() style=\\\"color: #F44336\\\">Connection disabled</h3><div style=\\\"margin-left: 10px\\\" layout=row layout-align=\\\"center center\\\"><md-button class=\\\"md-raised md-primary\\\" ng-show=!ctrl.stompService.isConnected() ng-click=ctrl.startStompService()>Start</md-button><md-button class=\\\"md-raised md-primary\\\" ng-show=ctrl.stompService.isConnected() ng-click=ctrl.stopStompService()>Stop</md-button></div></div><md-divider></md-divider><!-- Titles --><div layout=row class=tsa-debug-title-bar><md-subheader flex>Topics managed by the STOMP service.</md-subheader><div layout=row layout-align=\\\"center center\\\"><md-icon style=\\\"color: #757575\\\">share</md-icon><md-subheader style=\\\"padding-right: 20px\\\">topic\\'s listeners</md-subheader></div></div><md-divider></md-divider><!--Topic list --><md-content flex><div ng-repeat=\\\"topic in ctrl.topicList\\\" layout=column><div layout=row layout-align=\\\"center center\\\"><p flex style=\\\"margin-left: 20px\\\">{{topic.id}}</p><div layout=row style=\\\"margin-right: 20px\\\"><p>{{topic.listeners.length}}</p><md-icon style=\\\"color: #757575\\\">share</md-icon></div></div><md-divider></md-divider></div></md-content></div></div><!--TOPIC --><md-content ng-switch-when=Topic flex layout=column><md-content md-whiteframe=3 layout=row layout-align=\\\"start center\\\" style=\\\"padding: 10px\\\"><md-input-container class=md-block><input ng-model=ctrl.topic placeholder=Topic ng-disabled=\\\"ctrl.currentTopic !== undefined\\\"><md-tooltip>Will be automatically prefixed by \\'/topic/\\'.</md-tooltip></md-input-container><md-button class=\\\"md-raised md-primary\\\" ng-show=\\\"ctrl.currentTopic === undefined\\\" ng-click=ctrl.connectToTopic()>Connect</md-button><md-button class=\\\"md-raised md-primary\\\" ng-show=\\\"ctrl.currentTopic !== undefined\\\" ng-click=ctrl.disconnectTopic()>Disconnect</md-button><md-button class=\\\"md-raised md-primary\\\" ng-click=ctrl.clearTopicConsole()>Clear</md-button></md-content><md-input-container flex layout=column style=\\\"margin-top: 0px; margin-bottom: 0px\\\"><textarea flex ng-model=ctrl.topicConsole md-no-autogrow md-no-resize readonly></textarea></md-input-container></md-content><!--BUFFER tab --><md-content ng-switch-when=Buffers layout=column><!-- Title --><div layout=row class=tsa-debug-title-bar><md-subheader flex>Buffers managed by the acquisitionBufffer service.</md-subheader><div layout=row layout-align=\\\"center center\\\"><md-icon style=\\\"color: #757575\\\">share</md-icon><md-subheader style=\\\"padding-right: 20px\\\">components using the buffers</md-subheader></div></div><md-divider></md-divider><!--Buffer list --><md-content><div layout=column ng-repeat=\\\"data in ctrl.bufferDeviceList\\\"><div layout=row layout-align=\\\"space-around center\\\"><h3 class=md-headline>{{data.dataId}}</h3><p>{{data.device.id}} - {{data.frameId}}</p><div layout=row><p>{{ data.listenerCount }}</p><md-icon>share</md-icon></div></div><md-divider></md-divider></div></md-content></md-content><!--REST REQUEST tab --><div ng-switch-when=REST layout=column><!-- Title --><div layout=row class=tsa-debug-title-bar><md-subheader flex>REST requests managed by the rest service. Request in progress:</md-subheader></div><md-divider></md-divider><!--Buffer list --><div ng-show=ctrl.restService.getCurrentRequest() layout=column layout-align=\\\"space-around center\\\" style=\\\"background: #1a75ae;color: white; min-height: 65px\\\"><h3 class=md-subhead style=\\\"margin-bottom: 0\\\">{{ctrl.restService.getCurrentRequest().name}} [#{{ctrl.restService.getCurrentRequest().id}}]</h3><p class=md-body-1>{{ctrl.restService.getCurrentRequest().description}}</p><md-progress-linear md-mode=indeterminate></md-progress-linear></div><div class=tsa-debug-title-bar ng-show=\\\"ctrl.requestStack.length > 0\\\"><md-subheader flex>Pending requests:</md-subheader><md-divider></md-divider></div><md-content flex><div layout=column ng-repeat=\\\"request in ctrl.requestStack\\\"><div layout=row layout-align=\\\"space-around center\\\"><div flex=90 layout=column layout-align=\\\"space-around center\\\"><h3 class=md-subhead>{{request.name}} [#{{request.id}}]</h3><p class=md-body-1>{{request.description}}</p></div><md-button flex=10 class=\\\"md-raised md-warn\\\" ng-click=ctrl.cancelRequest(request)>cancel</md-button></div><md-divider></md-divider></div></md-content></div></div>\");\n$templateCache.put(\"app/tsa-views/depth/depth.html\",\"<div layout=column><!-- Toolbar --><div layout=row class=tsa-toolbar><i class=\\\"mdi mdi-24px mdi-{{\\'views.depth.icon\\' | translate }}\\\"></i><p class=title>{{\\\"views.depth.title\\\" | translate }}</p><p class=device-id>- {{ctrl.deviceId}}</p><span flex></span><!-- Loading icon --><div ng-if=\\\"ctrl.bufferLoading[ctrl.selectedScale] > 0\\\" layout=column layout-align=\\\"center center\\\" style=\\\"width: 40px\\\"><md-tooltip>{{\\\"archive-loading\\\" | translate }}</md-tooltip><md-progress-circular md-diameter=20px></md-progress-circular></div><!-- Scale X --><md-input-container><md-select ng-model=ctrl.selectedScale ng-change=ctrl.onChangeXScale()><md-option ng-repeat=\\\"(name, value) in ctrl.scales\\\" value={{name}}>{{name}}</md-option></md-select><md-tooltip>{{\\\"Graphic scale\\\" | translate }}</md-tooltip></md-input-container><tsa-settings-button on-change-view=\\\"ctrl.onChangeCardType({type: type})\\\" card-id={{ctrl.cardId}}></tsa-settings-button></div><md-divider></md-divider><!-- Content --><div flex class=tsa-content layout=column><tsa-data-view data=ctrl.dataId opt-title=views.depth.title frame-id=ctrl.frameId device-id=ctrl.deviceId format=%.1f></tsa-data-view><!-- Chart --><div flex class=tsa-chart-container><canvas id={{ctrl.canvasId}}></canvas></div></div></div>\");\n$templateCache.put(\"app/tsa-views/devices/devices.html\",\"<div layout=column><!-- Toolbar --><div layout=row class=tsa-toolbar><i class=\\\"mdi mdi-24px mdi-{{\\'views.devices.icon\\' | translate }}\\\"></i><p class=title>{{\\\"views.devices.title\\\" | translate }}</p><span flex></span><tsa-settings-button on-change-view=\\\"ctrl.onChangeCardType({type: type})\\\" card-id={{ctrl.cardId}}></tsa-settings-button></div><md-divider></md-divider><!-- Content --><md-grid-list flex md-cols=4 md-row-height=60px md-gutter=8px><md-grid-tile ng-repeat=\\\"item in ctrl.itemList\\\" md-whiteframe=1 ng-class=\\\"item.isReceivingJSON ? \\'ok\\': \\'data-missing\\'\\\"><md-icon ng-if=item.isReceivingJSON>check_circle</md-icon><md-icon ng-if=!item.isReceivingJSON>highlight_off</md-icon><div flex layout=column layout-align=space-around><h2 class=\\\"title md-headline\\\">{{item.device.name}}</h2><p class=\\\"subtitle md-subhead\\\">{{item.device.id}}</p></div></md-grid-tile></md-grid-list></div>\");\n$templateCache.put(\"app/tsa-views/driverPreview/driverPreview.html\",\"<div layout=column><!-- Toolbar --><div layout=row class=tsa-toolbar><md-icon class=material-icons>developer_mode</md-icon><p class=title>{{ctrl.title}}</p><span flex></span><tsa-settings-button on-change-view=\\\"ctrl.onChangeCardType({type: type})\\\" card-id={{ctrl.cardId}}></tsa-settings-button></div><md-divider></md-divider><!-- Content --><form name=driverForm class=tsa-content><div layout=row><md-input-container flex=20><label>Id</label><input required name=ctrl.driver.configuration.id ng-model=ctrl.driver.configuration.id><div ng-messages=driverForm.driverName.$error><div ng-message=required>This is required.</div></div></md-input-container><md-input-container flex=20><label>Header</label><input required name=ctrl.driver.configuration.header ng-model=ctrl.driver.configuration.header><div ng-messages=driverForm.driverHeader.$error><div ng-message=required>This is required.</div></div></md-input-container><!-- Driver selection --><md-input-container flex=60><label>Driver</label><md-select name=driver ng-model=ctrl.driver.configuration.driverClassName required><md-option ng-repeat=\\\"driver in ctrl.driverList\\\" value={{driver}}>{{driver.split(\\'.\\').pop()}}</md-option></md-select><div class=errors ng-messages=driverForm.driver.$error><div ng-message=required>Required</div></div></md-input-container></div><!-- Message --><md-input-container class=md-block><label>Message</label><textarea ng-model=ctrl.driver.message md-maxlength=150 rows=2 md-select-on-focus></textarea></md-input-container><md-list><md-list-item><p flex=20>Field number</p><p flex=40>Data name</p><p flex=30>Result</p><div flex=10><md-button class=md-icon-button ng-click=ctrl.addField()><md-icon>add</md-icon></md-button></div></md-list-item><md-divider></md-divider><md-list-item ng-repeat=\\\"field in ctrl.fieldList\\\"><md-input-container flex=20><input ng-model=field.number placeholder=\\\"Field number\\\"></md-input-container><md-input-container flex=40><input ng-model=field.name placeholder=\\\"Field name\\\"></md-input-container><p flex=20>{{field.result}}</p><div flex=10><md-button class=md-icon-button ng-click=ctrl.result()><md-icon>gavel</md-icon></md-button></div><div flex=10><md-button class=md-icon-button ng-click=ctrl.removeField(field)><md-icon>remove</md-icon></md-button></div></md-list-item></md-list></form></div>\");\n$templateCache.put(\"app/tsa-views/ef-aum/ef-aum.html\",\"<div layout=column><!-- Toolbar --><div layout=row class=tsa-toolbar><i class=\\\"mdi mdi-24px mdi-{{\\'views.pefaum.icon\\' | translate }}\\\"></i><p class=title>{{\\\"views.pefaum.title\\\" | translate }}</p><p class=device-id>- {{ctrl.deviceId}}</p><span flex></span><tsa-settings-button on-change-view=\\\"ctrl.onChangeCardType({type: type})\\\" card-id={{ctrl.cardId}}></tsa-settings-button></div><md-divider></md-divider><!-- Data views --><md-content flex layout=column layout-align=\\\"center center\\\" class=tsa-content><tsa-data-view data=ctrl.PEFAUM.TURBIDITYL frame-id=ctrl.frameId device-id=ctrl.deviceId format=%.2f units=FTU opt-title=views.pefaum.turbidityL></tsa-data-view></md-content><md-content flex layout=column layout-align=\\\"center center\\\" class=tsa-content><tsa-data-view data=ctrl.PEFAUM.TURBIDITYH frame-id=ctrl.frameId device-id=ctrl.deviceId format=%.2f units=FTU opt-title=views.pefaum.turbidityH></tsa-data-view></md-content><md-content flex layout=column layout-align=\\\"center center\\\" class=tsa-content><tsa-data-view data=ctrl.PEFAUM.OBSL frame-id=ctrl.frameId device-id=ctrl.deviceId format=%.2f units=FTU opt-title=views.pefaum.obsL></tsa-data-view></md-content><md-content flex layout=column layout-align=\\\"center center\\\" class=tsa-content><tsa-data-view data=ctrl.PEFAUM.OBSH frame-id=ctrl.frameId device-id=ctrl.deviceId format=%.2f units=FTU opt-title=views.pefaum.obsH></tsa-data-view></md-content><md-content flex layout=column layout-align=\\\"center center\\\" class=tsa-content><tsa-data-view data=ctrl.PEFAUM.CHLOROPHYLL frame-id=ctrl.frameId device-id=ctrl.deviceId format=%.2f units=g/l opt-title=views.pefaum.chlorophyll></tsa-data-view></md-content><md-content flex layout=column layout-align=\\\"center center\\\" class=tsa-content><tsa-data-view data=ctrl.PEFAUM.BLUEALGAE frame-id=ctrl.frameId device-id=ctrl.deviceId format=%.2f units=g/l opt-title=views.pefaum.bluealgae></tsa-data-view></md-content><md-content flex layout=column layout-align=\\\"center center\\\" class=tsa-content><tsa-data-view data=ctrl.PEFAUM.CDOM frame-id=ctrl.frameId device-id=ctrl.deviceId format=%.2f units=g/l opt-title=views.pefaum.cdom></tsa-data-view></md-content><md-content flex layout=column layout-align=\\\"center center\\\" class=tsa-content><tsa-data-view data=ctrl.PEFAUM.PH frame-id=ctrl.frameId device-id=ctrl.deviceId format=%.2f units=\\\"\\\" opt-title=views.pefaum.ph></tsa-data-view></md-content><md-content flex layout=column layout-align=\\\"center center\\\" class=tsa-content><tsa-data-view data=ctrl.PEFAUM.FLUORESCENCE frame-id=ctrl.frameId device-id=ctrl.deviceId format=%.2f units=g/l opt-title=views.pefaum.fluorescence></tsa-data-view></md-content><md-content flex layout=column layout-align=\\\"center center\\\" class=tsa-content><tsa-data-view data=ctrl.PEFAUM.PCO2 frame-id=ctrl.frameId device-id=ctrl.deviceId format=%.2f units=Atm opt-title=views.pefaum.pco2></tsa-data-view></md-content><md-content flex layout=column layout-align=\\\"center center\\\" class=tsa-content><tsa-data-view data=ctrl.PEFAUM.PAR frame-id=ctrl.frameId device-id=ctrl.deviceId format=%.2f units=mol/S/m2 opt-title=views.pefaum.par></tsa-data-view></md-content></div>\");\n$templateCache.put(\"app/tsa-views/ef-map/ef-map.html\",\"<div layout=column style=\\\"height: 100%\\\"><!-- Toolbar --><div layout=row layout-align=\\\"center center\\\" class=tsa-toolbar flex=none><i class=\\\"mdi mdi-24px mdi-{{\\'views.map.icon\\' | translate }}\\\"></i><p class=title>{{\\\"views.map.title\\\" | translate }}</p><p class=device-id>- {{ctrl.config.deviceId}}</p><span flex></span><md-menu md-position-mode=\\\"target-right target\\\"><md-button class=md-icon-button ng-click=$mdOpenMenu($event)><i md-menu-origin class=\\\"mdi mdi-24px mdi-math-compass\\\" ng-style=\\\"ctrl.currentMeasureTool !== \\'Disabled\\' ?{\\'color\\': \\' #1a75ad\\'}: {}\\\"></i><md-tooltip>{{\\\"views.map.measure-tool\\\" | translate }}</md-tooltip></md-button><md-menu-content><md-menu-item><div layout=row layout-align=\\\"center center\\\" style=\\\"padding-right: 0\\\"><p flex>{{\\\"views.map.measure-tool\\\" | translate }}</p><md-button ng-click=\\\"\\\" class=md-icon-button style=\\\"background-color: transparent !important\\\"><md-icon md-menu-align-target style=\\\"margin: auto 3px auto 0\\\">close</md-icon></md-button></div></md-menu-item><md-menu-divider></md-menu-divider><md-menu-item><md-button ng-click=\\\"ctrl.onMeasureToolChange(\\'Free\\')\\\" ng-style=\\\"ctrl.currentMeasureTool === \\'Free\\' ?{\\'color\\': \\' #1a75ad\\'}: {}\\\"><div layout=row flex><p flex>{{\\\"views.map.free\\\" | translate }}</p></div></md-button></md-menu-item><md-menu-item><md-button ng-click=\\\"ctrl.onMeasureToolChange(\\'From boat\\')\\\" ng-style=\\\"ctrl.currentMeasureTool === \\'From boat\\' ?{\\'color\\': \\' #1a75ad\\'}: {}\\\"><div layout=row flex><p flex>{{\\\"views.map.from-boat\\\" | translate }}</p></div></md-button></md-menu-item><md-menu-item><md-button ng-click=\\\"ctrl.onMeasureToolChange(\\'Disabled\\')\\\" ng-style=\\\"ctrl.currentMeasureTool === \\'Disabled\\' ?{\\'color\\': \\' #1a75ad\\'}: {}\\\"><div layout=row flex><p flex>{{\\\"views.map.disabled\\\" | translate }}</p></div></md-button></md-menu-item><md-menu-divider></md-menu-divider><md-menu-item><md-button ng-click=ctrl.clearMeasures()><div layout=row flex><p flex>{{\\\"views.map.clear-measure\\\" | translate }}</p></div></md-button></md-menu-item></md-menu-content></md-menu><!-- Navigation mode buttons --><md-button class=md-icon-button ng-click=ctrl.showTrace()><md-icon ng-class=\\\"{enabled: ctrl.traceEnabled}\\\">timeline</md-icon><md-tooltip>{{\\\"views.map.show-trace\\\" | translate }}</md-tooltip></md-button><md-button class=md-icon-button ng-if=ctrl.isModeNavigation() ng-click=ctrl.focusOnBoat()><md-icon ng-class=\\\"{enabled: ctrl.autoCenterEnabled}\\\">center_focus_strong</md-icon><md-tooltip>{{\\\"views.map.focus-on-boat\\\" | translate }}</md-tooltip></md-button><md-button class=md-icon-button ng-if=ctrl.isModeNavigation() ng-click=ctrl.showGrid()><md-icon ng-class=\\\"{enabled: ctrl.gridEnabled}\\\">grid_on</md-icon><md-tooltip>{{\\\"views.map.grid-on\\\" | translate }}</md-tooltip></md-button><md-button class=md-icon-button ng-click=ctrl.showBottomBar()><md-icon ng-class=\\\"{enabled: ctrl.bottomBarEnabled}\\\">info</md-icon><md-tooltip>{{\\\"views.map.show-info\\\" | translate }}</md-tooltip></md-button><tsa-settings-button on-change-view=\\\"ctrl.onChangeCardType({type: type})\\\" card-id={{ctrl.cardId}} button-list=ctrl.settingsButton></tsa-settings-button></div><md-divider></md-divider><!-- Map  --><div class=tsa-map-container flex><div class=map-element flex id={{ctrl.mapId}}><div class=day-night-layer ng-class=\\\"{\\'station-unavailable\\': ctrl.stationIsUnvailable}\\\"><p class=md-subhead>{{\\\"views.station.unvailable\\\" | translate }}</p></div></div></div><div layout=row class=bottom-bar ng-show=ctrl.bottomBarEnabled layout-align=\\\"start center\\\" flex=none><p>lat: {{ctrl.stringMouseLatitude}}</p><p>long: {{ctrl.stringMouseLongitude}}</p><span flex></span><p hide-sm>SOG: {{ctrl.position.gndspeed}}kn</p><p hide-sm>{{\\\"views.map.heading\\\" | translate }}: {{ctrl.position.heading | number:0}}</p><p>lat: {{ctrl.position.stringLatitude}}</p><p>long: {{ctrl.position.stringLongitude}}</p></div></div>\");\n$templateCache.put(\"app/tsa-views/ef-met/ef-met.html\",\"<div layout=column><!-- Toolbar --><div layout=row class=tsa-toolbar><i class=\\\"mdi mdi-24px mdi-{{\\'views.pefmet.icon\\' | translate }}\\\"></i><p class=title>{{\\\"views.pefmet.title\\\" | translate }}</p><p class=device-id>- {{ctrl.deviceId}}</p><span flex></span><tsa-settings-button on-change-view=\\\"ctrl.onChangeCardType({type: type})\\\" card-id={{ctrl.cardId}}></tsa-settings-button></div><md-divider></md-divider><!-- Data views --><md-content flex layout=column layout-align=\\\"center center\\\" class=tsa-content><tsa-data-view data=ctrl.PEFMET.VELOCITY frame-id=ctrl.frameId device-id=ctrl.deviceId format=%.2f units=m/s opt-title=views.pefmet.velocity></tsa-data-view></md-content><md-content flex layout=column layout-align=\\\"center center\\\" class=tsa-content><tsa-data-view data=ctrl.PEFMET.GUST frame-id=ctrl.frameId device-id=ctrl.deviceId format=%.2f units=m/s opt-title=views.pefmet.gust></tsa-data-view></md-content><md-content flex layout=column layout-align=\\\"center center\\\" class=tsa-content><tsa-data-view data=ctrl.PEFMET.DIRECTION frame-id=ctrl.frameId device-id=ctrl.deviceId format=%.2f units= opt-title=views.pefmet.direction></tsa-data-view></md-content><md-content flex layout=column layout-align=\\\"center center\\\" class=tsa-content><tsa-data-view data=ctrl.PEFMET.AIRTEMP frame-id=ctrl.frameId device-id=ctrl.deviceId format=%.2f units=C opt-title=views.pefmet.airtemp></tsa-data-view></md-content><md-content flex layout=column layout-align=\\\"center center\\\" class=tsa-content><tsa-data-view data=ctrl.PEFMET.HUMIDITY frame-id=ctrl.frameId device-id=ctrl.deviceId format=%.2f units=% opt-title=views.pefmet.humidity></tsa-data-view></md-content><md-content flex layout=column layout-align=\\\"center center\\\" class=tsa-content><tsa-data-view data=ctrl.PEFMET.RADIATION frame-id=ctrl.frameId device-id=ctrl.deviceId format=%.2f units=W/m2 opt-title=views.pefmet.radiation></tsa-data-view></md-content><md-content flex layout=column layout-align=\\\"center center\\\" class=tsa-content><tsa-data-view data=ctrl.PEFMET.PRESSURE frame-id=ctrl.frameId device-id=ctrl.deviceId format=%.2f units=hPa opt-title=views.pefmet.pressure></tsa-data-view></md-content><md-content flex layout=column layout-align=\\\"center center\\\" class=tsa-content><tsa-data-view data=ctrl.PEFMET.WATERTEMP frame-id=ctrl.frameId device-id=ctrl.deviceId format=%.2f units=C opt-title=views.pefmet.watertemp></tsa-data-view></md-content></div>\");\n$templateCache.put(\"app/tsa-views/ef-pos/ef-pos.html\",\"<div layout=column><!-- Toolbar --><div layout=row class=tsa-toolbar><i class=\\\"mdi mdi-24px mdi-{{\\'views.pefpos.icon\\' | translate }}\\\"></i><p class=title>{{\\\"views.pefpos.title\\\" | translate }}</p><p class=device-id>- {{ctrl.deviceId}}</p><span flex></span><tsa-settings-button on-change-view=\\\"ctrl.onChangeCardType({type: type})\\\" card-id={{ctrl.cardId}}></tsa-settings-button></div><md-divider></md-divider><!-- Data views --><md-content flex layout=column layout-align=\\\"center center\\\" class=tsa-content><tsa-data-view data=ctrl.PEFPOS.LATITUDE frame-id=ctrl.frameId device-id=ctrl.deviceId format=%.2f units= opt-title=views.pefpos.latitude></tsa-data-view></md-content><md-content flex layout=column layout-align=\\\"center center\\\" class=tsa-content><tsa-data-view data=ctrl.PEFPOS.LONGITUDE frame-id=ctrl.frameId device-id=ctrl.deviceId format=%.2f units= opt-title=views.pefpos.longitude></tsa-data-view></md-content><md-content flex layout=column layout-align=\\\"center center\\\" class=tsa-content><tsa-data-view data=ctrl.PEFPOS.HEADING frame-id=ctrl.frameId device-id=ctrl.deviceId format=%.2f units= opt-title=views.pefpos.heading></tsa-data-view></md-content><md-content flex layout=column layout-align=\\\"center center\\\" class=tsa-content><tsa-data-view data=ctrl.PEFPOS.SPEED frame-id=ctrl.frameId device-id=ctrl.deviceId format=%.2f units=kn opt-title=views.pefpos.speed></tsa-data-view></md-content><md-content flex layout=column layout-align=\\\"center center\\\" class=tsa-content><tsa-data-view data=ctrl.PEFPOS.DEPTH frame-id=ctrl.frameId device-id=ctrl.deviceId format=%.2f units=m opt-title=views.pefpos.depth></tsa-data-view></md-content><md-content flex layout=column layout-align=\\\"center center\\\" class=tsa-content><tsa-data-view data=ctrl.PEFPOS.COG frame-id=ctrl.frameId device-id=ctrl.deviceId format=%.2f units= opt-title=views.pefpos.cog></tsa-data-view></md-content><md-content flex layout=column layout-align=\\\"center center\\\" class=tsa-content><tsa-data-view data=ctrl.PEFPOS.SOG frame-id=ctrl.frameId device-id=ctrl.deviceId format=%.2f units=kn opt-title=views.pefpos.sog></tsa-data-view></md-content></div>\");\n$templateCache.put(\"app/tsa-views/ef-tss/ef-tss.html\",\"<div layout=column><!-- Toolbar --><div layout=row class=tsa-toolbar><i class=\\\"mdi mdi-24px mdi-{{\\'views.peftss.icon\\' | translate }}\\\"></i><p class=title>{{\\\"views.peftss.title\\\" | translate }}</p><p class=device-id>- {{ctrl.deviceId}}</p><span flex></span><tsa-settings-button on-change-view=\\\"ctrl.onChangeCardType({type: type})\\\" card-id={{ctrl.cardId}}></tsa-settings-button></div><md-divider></md-divider><!-- Data views --><md-content flex layout=column layout-align=\\\"center center\\\" class=tsa-content><tsa-data-view data=ctrl.PEFTSS.SALINITY frame-id=ctrl.frameId device-id=ctrl.deviceId format=%.2f units=C opt-title=views.peftss.watertemp></tsa-data-view></md-content><md-content flex layout=column layout-align=\\\"center center\\\" class=tsa-content><tsa-data-view data=ctrl.PEFTSS.WATERTEMP frame-id=ctrl.frameId device-id=ctrl.deviceId format=%.2f units=psu opt-title=views.peftss.salinity></tsa-data-view></md-content><md-content flex layout=column layout-align=\\\"center center\\\" class=tsa-content><tsa-data-view data=ctrl.PEFTSS.FLUO frame-id=ctrl.frameId device-id=ctrl.deviceId format=%.2f units=kg/m3 opt-title=views.peftss.sigmat></tsa-data-view></md-content><md-content flex layout=column layout-align=\\\"center center\\\" class=tsa-content><tsa-data-view data=ctrl.PEFTSS.CONDUCT frame-id=ctrl.frameId device-id=ctrl.deviceId format=%.2f units=S/m opt-title=views.peftss.conduct></tsa-data-view></md-content><md-content flex layout=column layout-align=\\\"center center\\\" class=tsa-content><tsa-data-view data=ctrl.PEFTSS.SIGMAT frame-id=ctrl.frameId device-id=ctrl.deviceId format=%.2f units=V opt-title=views.peftss.fluo></tsa-data-view></md-content></div>\");\n$templateCache.put(\"app/tsa-views/ephemeride/ephemeride.html\",\"<div layout=column><!-- Toolbar --><div layout=row class=tsa-toolbar><i class=\\\"mdi mdi-24px mdi-{{\\'views.ephemeride.icon\\' | translate }}\\\"></i><p class=title>{{\\\"views.ephemeride.title\\\" | translate }}</p><p class=device-id>- {{ctrl.deviceId}}</p><span flex></span><tsa-settings-button on-change-view=\\\"ctrl.onChangeCardType({type: type})\\\" card-id={{ctrl.cardId}}></tsa-settings-button></div><md-divider></md-divider><!-- Content --><div flex layout=column class=tsa-content layout-align=\\\"center center\\\"><div layout=row><md-button class=md-raised ng-click=ctrl.prevDay()><i class=\\\"mdi mdi-24px mdi-arrow-left-bold\\\"></i></md-button><md-grid-list md-cols=2 md-gutter=1em md-row-height=fit style=\\\"width: 800px; height: 400px\\\"><md-grid-tile md-colspan=2><h2 class=md-headline>{{ctrl.day | translate}} {{ctrl.nbDate}} {{ctrl.month | translate}} {{ctrl.year}}</h2><br><p class=\\\"subtitle md-subhead\\\"><i>{{ctrl.saint}}</i></p></md-grid-tile><md-grid-tile md-colspan=1><p class=md-headline>{{\\\"views.ephemeride.sunrise\\\" | translate}}: {{ctrl.times.sunrise | date: \\\"HH:mm\\\" : ctrl.timeOffset}} {{ctrl.timeLabel}}</p></md-grid-tile><md-grid-tile md-colspan=1><p class=md-headline>{{\\\"views.ephemeride.sunset\\\" | translate}}: {{ctrl.times.sunset | date: \\\"HH:mm\\\" : ctrl.timeOffset}} {{ctrl.timeLabel}}</p></md-grid-tile><md-grid-tile md-colspan=1><p class=md-headline>{{\\\"views.ephemeride.moon\\\" | translate}}:</p></md-grid-tile><md-grid-tile md-colspan=1><img ng-src=resources/images/icons/moon/{{ctrl.moonImage}} alt=\\\"Moon phase\\\"></md-grid-tile></md-grid-list><md-button class=md-raised ng-click=ctrl.nextDay()><i class=\\\"mdi mdi-24px mdi-arrow-right-bold\\\"></i></md-button></div></div></div>\");\n$templateCache.put(\"app/tsa-views/ferryboxFluo/ferryboxFluo.html\",\"<div layout=column><!-- Toolbar --><div layout=row class=tsa-toolbar><i class=\\\"mdi mdi-24px mdi-{{\\'views.ferrybox-fluo.icon\\' | translate }}\\\"></i><p class=title>{{\\\"views.ferrybox-fluo.title\\\" | translate }}</p><p class=device-id>- {{ctrl.deviceId}}</p><span flex></span><!-- Loading icon --><div ng-if=\\\"ctrl.bufferLoading[ctrl.selectedScale] > 0\\\" layout=column layout-align=\\\"center center\\\" style=\\\"width: 40px\\\"><md-tooltip>{{\\\"archive-loading\\\" | translate }}</md-tooltip><md-progress-circular md-diameter=20px></md-progress-circular></div><!-- Scale X --><md-input-container><md-select ng-model=ctrl.selectedScale ng-change=ctrl.onChangeXScale()><md-option ng-repeat=\\\"(name, value) in ctrl.scales\\\" value={{name}}>{{name}}</md-option></md-select><md-tooltip>{{\\\"Graphic scale\\\" | translate }}</md-tooltip></md-input-container><tsa-settings-button on-change-view=\\\"ctrl.onChangeCardType({type: type})\\\" card-id={{ctrl.cardId}}></tsa-settings-button></div><md-divider></md-divider><!-- Content --><div flex class=tsa-content layout=row><!-- Chart --><div flex=60 class=tsa-chart-container><canvas id={{ctrl.canvasId}}></canvas></div><md-divider></md-divider><!-- Data views --><div flex=40 layout=column><div layout=row ng-repeat=\\\"data in ctrl.dataList\\\" class={{data.cssClass}}><md-checkbox ng-checked=data.showInChart ng-click=ctrl.showInChart(data)></md-checkbox><tsa-data-view data=data.id frame-id=ctrl.frameId device-id=ctrl.deviceId units=\\\"eq. g/L\\\"></tsa-data-view></div></div></div></div>\");\n$templateCache.put(\"app/tsa-views/ferryboxScience/ferryboxScience.html\",\"<div layout=column><!-- Toolbar --><div layout=row class=tsa-toolbar><i class=\\\"mdi mdi-24px mdi-{{\\'views.ferrybox-science.icon\\' | translate }}\\\"></i><p class=title>{{\\\"views.ferrybox-science.title\\\" | translate }}</p><p class=device-id>- {{ctrl.deviceId}}</p><span flex></span><tsa-settings-button on-change-view=\\\"ctrl.onChangeCardType({type: type})\\\" card-id={{ctrl.cardId}}></tsa-settings-button></div><md-divider></md-divider><!-- Content --><div flex layout=row class=tsa-content><div flex=50 layout=column><tsa-data-view data=ctrl.FERRYBOX_SCIENCE.QUALITY frame-id=ctrl.frameId device-id=ctrl.deviceId></tsa-data-view><md-divider></md-divider><tsa-data-view data=ctrl.FERRYBOX_SCIENCE.SBE45_SEA_TEMP frame-id=ctrl.frameId device-id=ctrl.deviceId></tsa-data-view><tsa-data-view data=ctrl.FERRYBOX_SCIENCE.SBE45_COND frame-id=ctrl.frameId device-id=ctrl.deviceId></tsa-data-view><tsa-data-view data=ctrl.FERRYBOX_SCIENCE.SBE45_SAL frame-id=ctrl.frameId device-id=ctrl.deviceId></tsa-data-view><tsa-data-view data=ctrl.FERRYBOX_SCIENCE.SBE45_SOUND_VEL frame-id=ctrl.frameId device-id=ctrl.deviceId></tsa-data-view><md-divider></md-divider><tsa-data-view data=ctrl.FERRYBOX_SCIENCE.OPTODE_OXYGEN frame-id=ctrl.frameId device-id=ctrl.deviceId></tsa-data-view><tsa-data-view data=ctrl.FERRYBOX_SCIENCE.OPTODE_SATURATION frame-id=ctrl.frameId device-id=ctrl.deviceId></tsa-data-view></div><md-divider></md-divider><div flex=50 layout=column><tsa-data-view data=ctrl.FERRYBOX_SCIENCE.SEA_POINT_TURB frame-id=ctrl.frameId device-id=ctrl.deviceId></tsa-data-view><md-divider></md-divider><tsa-data-view data=ctrl.FERRYBOX_SCIENCE.AOA_GREEN_ALGAE frame-id=ctrl.frameId device-id=ctrl.deviceId></tsa-data-view><tsa-data-view data=ctrl.FERRYBOX_SCIENCE.AOA_BLUE_ALGAE frame-id=ctrl.frameId device-id=ctrl.deviceId></tsa-data-view><tsa-data-view data=ctrl.FERRYBOX_SCIENCE.AOA_DIATOMS frame-id=ctrl.frameId device-id=ctrl.deviceId></tsa-data-view><tsa-data-view data=ctrl.FERRYBOX_SCIENCE.AOA_CRYPTOPHYTA frame-id=ctrl.frameId device-id=ctrl.deviceId></tsa-data-view><tsa-data-view data=ctrl.FERRYBOX_SCIENCE.AOA_YELLOW_SUB frame-id=ctrl.frameId device-id=ctrl.deviceId></tsa-data-view><tsa-data-view data=ctrl.FERRYBOX_SCIENCE.AOA_TOTAL_ALGAE frame-id=ctrl.frameId device-id=ctrl.deviceId></tsa-data-view></div></div></div>\");\n$templateCache.put(\"app/tsa-views/ferryboxTechnic/ferryboxTechnic.html\",\"<div layout=column><!-- Toolbar --><div layout=row class=tsa-toolbar><i class=\\\"mdi mdi-24px mdi-{{\\'views.ferrybox-technic.icon\\' | translate }}\\\"></i><p class=title>{{\\\"views.ferrybox-technic.title\\\" | translate }}</p><p class=device-id>- {{ctrl.deviceId}}</p><span flex></span><tsa-settings-button on-change-view=\\\"ctrl.onChangeCardType({type: type})\\\" card-id={{ctrl.cardId}}></tsa-settings-button></div><md-divider></md-divider><!-- Content  --><div flex layout=row class=tsa-content><div flex=50 layout=column><tsa-data-view data=ctrl.FERRYBOX_SCIENCE.QUALITY frame-id=ctrl.frameId device-id=ctrl.deviceId format=qualityFbx></tsa-data-view><md-divider></md-divider><tsa-data-view data=ctrl.FERRYBOX_TECHNIC.FLOW_IN frame-id=ctrl.frameId device-id=ctrl.deviceId></tsa-data-view><tsa-data-view data=ctrl.FERRYBOX_TECHNIC.FLOW_MAIN frame-id=ctrl.frameId device-id=ctrl.deviceId></tsa-data-view><tsa-data-view data=ctrl.FERRYBOX_TECHNIC.FLOW_PCO2 frame-id=ctrl.frameId device-id=ctrl.deviceId></tsa-data-view><tsa-data-view data=ctrl.FERRYBOX_TECHNIC.FLOW_BYPASS_2 frame-id=ctrl.frameId device-id=ctrl.deviceId></tsa-data-view><tsa-data-view data=ctrl.FERRYBOX_TECHNIC.FLOW_AOA frame-id=ctrl.frameId device-id=ctrl.deviceId></tsa-data-view><md-divider></md-divider><tsa-data-view data=ctrl.FERRYBOX_TECHNIC.PRESSURE frame-id=ctrl.frameId device-id=ctrl.deviceId></tsa-data-view><tsa-data-view data=ctrl.FERRYBOX_TECHNIC.FB_PH_VALUE frame-id=ctrl.frameId device-id=ctrl.deviceId></tsa-data-view></div><md-divider></md-divider><div flex=50 layout=column><tsa-data-view data=ctrl.FERRYBOX_TECHNIC.FB_AIR_TEMP frame-id=ctrl.frameId device-id=ctrl.deviceId></tsa-data-view><tsa-data-view data=ctrl.FERRYBOX_SCIENCE.SBE45_SEA_TEMP frame-id=ctrl.frameId device-id=ctrl.deviceId></tsa-data-view><tsa-data-view data=ctrl.FERRYBOX_TECHNIC.OPTODE_SEA_TEMP frame-id=ctrl.frameId device-id=ctrl.deviceId></tsa-data-view><tsa-data-view data=ctrl.FERRYBOX_TECHNIC.AOA_SEA_TEMP frame-id=ctrl.frameId device-id=ctrl.deviceId></tsa-data-view><tsa-data-view data=ctrl.FERRYBOX_TECHNIC.FB_PH_SEA_TEMP frame-id=ctrl.frameId device-id=ctrl.deviceId></tsa-data-view><md-divider></md-divider><tsa-data-view data=ctrl.FERRYBOX_TECHNIC.FULL frame-id=ctrl.frameId device-id=ctrl.deviceId></tsa-data-view><tsa-data-view data=ctrl.FERRYBOX_TECHNIC.HALFFULL frame-id=ctrl.frameId device-id=ctrl.deviceId></tsa-data-view></div></div></div>\");\n$templateCache.put(\"app/tsa-views/flow/flow.html\",\"<div layout=column><!-- Toolbar --><div layout=row class=tsa-toolbar><i class=\\\"mdi mdi-24px mdi-{{\\'views.flow.icon\\' | translate }}\\\"></i><p class=title>{{\\\"views.flow.title\\\" | translate }}</p><p class=device-id>- {{ctrl.deviceId}}</p><span flex></span><tsa-settings-button on-change-view=\\\"ctrl.onChangeCardType({type: type})\\\" card-id={{ctrl.cardId}}></tsa-settings-button></div><md-divider></md-divider><!-- Data views --><md-content flex layout=column layout-align=\\\"center center\\\" class=tsa-content><tsa-data-view data=ctrl.FLOW.DATA frame-id=ctrl.frameId device-id=ctrl.deviceId format=%.2f units=l/min opt-title=views.flow.data></tsa-data-view></md-content></div>\");\n$templateCache.put(\"app/tsa-views/funesWinch/funesWinch.html\",\"<div layout=column><!-- Toolbar --><div layout=row class=tsa-toolbar><i class=\\\"mdi mdi-24px mdi-{{\\'views.funes-winch.icon\\' | translate }}\\\"></i><p class=title>{{\\\"views.funes-winch.title\\\" | translate }}</p><p class=device-id>- {{ctrl.deviceId}}</p><span flex></span><!-- Loading icon --><div ng-if=\\\"ctrl.bufferLoading[ctrl.selectedScale] > 0\\\" layout=column layout-align=\\\"center center\\\" style=\\\"width: 40px\\\"><md-tooltip>{{\\\"archive-loading\\\" | translate }}</md-tooltip><md-progress-circular md-diameter=20px></md-progress-circular></div><!-- Scale X --><md-input-container><md-select ng-model=ctrl.selectedScale ng-change=ctrl.onChangeXScale()><md-option ng-repeat=\\\"(name, value) in ctrl.scales\\\" value={{name}}>{{name}}</md-option></md-select><md-tooltip>{{\\\"Graphic scale\\\" | translate }}</md-tooltip></md-input-container><tsa-settings-button on-change-view=\\\"ctrl.onChangeCardType({type: type})\\\" card-id={{ctrl.cardId}}></tsa-settings-button></div><md-divider></md-divider><!-- Content --><div flex layout=row class=tsa-content><div flex=50 layout=column class=port><p class=md-headline>{{ \\\"views.funes-winch.port\\\" | translate | uppercase }}</p><tsa-data-view data=ctrl.portLength frame-id=ctrl.frameId device-id=ctrl.deviceId opt-title=views.funes-winch.length></tsa-data-view><tsa-data-view data=ctrl.portSpeed frame-id=ctrl.frameId device-id=ctrl.deviceId opt-title=views.funes-winch.speed></tsa-data-view><md-divider></md-divider><tsa-data-view data=ctrl.portTension frame-id=ctrl.frameId device-id=ctrl.deviceId opt-title=views.funes-winch.tension></tsa-data-view><div flex class=tsa-chart-container><canvas id={{ctrl.canvasId2}}></canvas></div></div><div flex=50 layout=column class=starboard><p class=md-headline>{{ \\\"views.funes-winch.starboard\\\" | translate | uppercase }}</p><tsa-data-view data=ctrl.starboardLength frame-id=ctrl.frameId device-id=ctrl.deviceId opt-title=views.funes-winch.length></tsa-data-view><tsa-data-view data=ctrl.starboardSpeed frame-id=ctrl.frameId device-id=ctrl.deviceId opt-title=views.funes-winch.speed></tsa-data-view><md-divider></md-divider><tsa-data-view data=ctrl.starboardTension frame-id=ctrl.frameId device-id=ctrl.deviceId opt-title=views.funes-winch.tension></tsa-data-view><div flex class=tsa-chart-container><canvas id={{ctrl.canvasId1}}></canvas></div></div></div></div>\");\n$templateCache.put(\"app/tsa-views/generic/generic.html\",\"<div layout=column><!-- Toolbar --><div layout=row class=tsa-toolbar><i class=\\\"mdi mdi-24px mdi-{{ctrl.config.icon}}\\\"></i><p class=title>{{ctrl.config.title}}</p><p class=device-id ng-show=\\\"ctrl.config.deviceId != undefined\\\">- {{ctrl.config.deviceId}}</p><span flex></span><tsa-settings-button on-change-view=\\\"ctrl.onChangeCardType({type: type})\\\" card-id={{ctrl.cardId}}></tsa-settings-button></div><md-divider></md-divider><!-- Data views --><md-content flex layout=column layout-align=\\\"start center\\\" class=tsa-content><tsa-data-view ng-repeat=\\\"data in ctrl.config.dataList\\\" data=data.dataId frame-id=data.frameId device-id=data.deviceId opt-title={{data.name}} format={{data.format}} units={{data.units}}></tsa-data-view></md-content></div>\");\n$templateCache.put(\"app/tsa-views/gps/gps.html\",\"<div layout=column><!-- Toolbar --><div layout=row class=tsa-toolbar><i class=\\\"mdi mdi-24px mdi-{{\\'views.gps.icon\\' | translate }}\\\"></i><p class=title>{{\\\"views.gps.title\\\" | translate }}</p><p class=device-id>- {{ctrl.deviceId}}</p><span flex></span><tsa-settings-button on-change-view=\\\"ctrl.onChangeCardType({type: type})\\\" card-id={{ctrl.cardId}}></tsa-settings-button></div><md-divider></md-divider><!-- Content --><div layout=column class=tsa-content><tsa-data-view data=ctrl.latitude frame-id=ctrl.framePosition device-id=ctrl.deviceId opt-title=views.gps.latitude format=coordinate></tsa-data-view><tsa-data-view data=ctrl.longitude frame-id=ctrl.framePosition device-id=ctrl.deviceId opt-title=views.gps.longitude format=coordinate></tsa-data-view><tsa-data-view data=ctrl.groundSpeed frame-id=ctrl.framePosition device-id=ctrl.deviceId opt-title=views.gps.ground-speed></tsa-data-view><tsa-data-view data=ctrl.groundCourse frame-id=ctrl.framePosition device-id=ctrl.deviceId opt-title=views.gps.ground-course></tsa-data-view><md-divider></md-divider><tsa-data-view data=ctrl.satNumber frame-id=ctrl.frameSatInfo device-id=ctrl.deviceId opt-title=views.gps.satellite-number></tsa-data-view><tsa-data-view data=ctrl.hdop frame-id=ctrl.frameSatInfo device-id=ctrl.deviceId opt-title=views.gps.hdop></tsa-data-view></div></div>\");\n$templateCache.put(\"app/tsa-views/graphics/graphics.html\",\"<md-content layout=column><!-- Title bar --><div layout=row class=tsa-toolbar><tsa-data-view flex=100 ng-hide=\\\"ctrl.frameDataId1 === undefined && ctrl.frameDataId2 !== undefined\\\" data=ctrl.dataId1 frame-id=ctrl.frameId1 device-id=ctrl.deviceId1 opt-title={{ctrl.chartTitle1}} show-subtitle=true on-update-title=ctrl.updateTitle1Callback(title)></tsa-data-view><tsa-data-view flex=100 style=\\\"margin-left: 12px;color: {{ctrl.dataColor2}}\\\" ng-show=\\\"ctrl.frameDataId2 !== undefined\\\" data=ctrl.dataId2 frame-id=ctrl.frameId2 device-id=ctrl.deviceId2 opt-title={{ctrl.chartTitle2}} show-subtitle=true on-update-title=ctrl.updateTitle2Callback(title)></tsa-data-view><div layout=row><md-button class=md-icon-button ng-click=\\\"ctrl.showSettings = !ctrl.showSettings\\\"><md-icon>edit</md-icon><md-tooltip>{{\\\"Settings\\\" | translate }}</md-tooltip></md-button><tsa-settings-button card-id={{ctrl.cardId}} on-change-view=\\\"ctrl.onChangeCardType({type: type})\\\"></tsa-settings-button></div></div><!-- Chart --><div flex class=tsa-chart-container><div ng-if=\\\"ctrl.dataLoaders != 0\\\" layout=row layout-align=\\\"center center\\\" class=load-msg><md-progress-circular md-diameter=20px></md-progress-circular><p class=md-body-1>{{\\\"archive-loading\\\" | translate }}</p></div><canvas id={{ctrl.canvasId}}></canvas></div><!-- Settings --><md-sidenav class=\\\"md-sidenav-right md-whiteframe-4dp\\\" md-component-id=right md-is-open=ctrl.showSettings layout=column><md-toolbar class=md-primary><div class=md-toolbar-tools><h2><span>{{\\\"Settings\\\" | translate }}</span></h2><span flex></span><md-button class=md-icon-button aria-label=Favorite ng-click=\\\"ctrl.showSettings = !ctrl.showSettings\\\"><i class=material-icons>close</i></md-button></div></md-toolbar><md-content flex><!-- Device - Data 1 --><div layout=row><md-input-container flex=35><label>{{\\\"Device\\\" | translate }} 1</label><md-select ng-model=ctrl.deviceId1 ng-change=ctrl.updateDataList1()><md-option ng-show=device.isEnabled value={{device.id}} ng-repeat=\\\"device in ctrl.deviceList | orderObjectBy:\\'name\\'\\\">{{device.name}}</md-option></md-select></md-input-container><md-input-container flex=50><label>{{\\\"Data\\\" | translate }} 1</label><md-select ng-model=ctrl.frameDataId1 ng-change=ctrl.onChangeData1()><div ng-repeat=\\\"(frameName, frame) in ctrl.frameList1\\\"><md-optgroup label={{frameName}}><md-option value={{frameName}}!{{data.name}} ng-repeat=\\\"data in frame | orderObjectBy:\\'longName\\'\\\">{{data.longName}}</md-option></md-optgroup></div></md-select></md-input-container><div flex=15 layout=row layout-align=\\\"center center\\\"><md-button style=margin:0 class=md-icon-button ng-click=ctrl.onClearData1()><md-icon class=material-icons>clear</md-icon><md-tooltip>Clear selection</md-tooltip></md-button></div></div><!-- Device - Data 2 --><div layout=row><md-input-container flex=35><label>{{\\\"Device\\\" | translate }} 2</label><md-select ng-model=ctrl.deviceId2 ng-change=ctrl.updateDataList2()><md-option ng-show=device.isEnabled value={{device.id}} ng-repeat=\\\"device in ctrl.deviceList | orderObjectBy:\\'name\\'\\\">{{device.name}}</md-option></md-select></md-input-container><md-input-container flex=50><label>{{\\\"Data\\\" | translate }} 2</label><md-select ng-model=ctrl.frameDataId2 ng-change=ctrl.onChangeData2()><div ng-repeat=\\\"(frameName, frame) in ctrl.frameList2\\\"><md-optgroup label={{frameName}}><md-option value={{frameName}}!{{data.name}} ng-repeat=\\\"data in frame | orderObjectBy:\\'longName\\'\\\">{{data.longName}}</md-option></md-optgroup></div></md-select></md-input-container><div flex=15 layout=row layout-align=\\\"center center\\\"><md-button style=margin:0 class=md-icon-button ng-click=ctrl.onClearData2()><md-icon class=material-icons>clear</md-icon><md-tooltip>Clear selection</md-tooltip></md-button></div></div><div layout=row><!-- Scale X --><md-input-container flex=50><label>{{\\\"Scale\\\" | translate }} X</label><md-select ng-model=ctrl.selectedScale ng-change=ctrl.onChangeXScale()><md-option ng-repeat=\\\"(name, value) in ctrl.scales\\\" value={{name}}>{{name | translate }}</md-option></md-select></md-input-container><!-- Scale Y --><md-input-container flex=50><label>{{\\\"Scale\\\" | translate }} Y</label><md-select ng-model=ctrl.selectedYScaleMode md-on-close=ctrl.updateYAxesMode()><md-option ng-repeat=\\\"(name, value) in ctrl.YScaleModes\\\" value={{value}}>{{value | translate }}</md-option></md-select></md-input-container></div><!-- Others settings --><div layout=row style=\\\"margin-top: 16px\\\" layout-align=\\\"space-around center\\\"><md-checkbox flex=40 ng-disabled=\\\"ctrl.frameDataId1 === undefined || ctrl.frameDataId2 === undefined\\\" ng-model=ctrl.doubleYAxes ng-change=ctrl.updateChartOptions()>{{\\\"views.graphics.2-y-axes\\\" | translate }}</md-checkbox><md-checkbox flex=40 ng-model=ctrl.zeroOption ng-change=ctrl.updateChartOptions()>{{\\\"views.graphics.zero-on\\\" | translate }}</md-checkbox><md-checkbox flex=20 ng-model=ctrl.fill ng-change=ctrl.updateChartOptions()>{{\\\"views.graphics.fill\\\" | translate }}</md-checkbox></div><p>{{\\\"views.graphics.y-axes-manual\\\" | translate }}</p><div layout=row><md-button flex=33 class=\\\"md-raised md-primary\\\" ng-disabled=\\\"ctrl.selectedYScaleMode != ctrl.YScaleModes.MANUAL\\\" ng-click=ctrl.onZoomY()>Zoom +</md-button><md-button flex=33 class=\\\"md-raised md-primary\\\" ng-disabled=\\\"ctrl.selectedYScaleMode != ctrl.YScaleModes.MANUAL\\\" ng-click=ctrl.onZoomY(true)>Zoom -</md-button><md-button flex=33 class=\\\"md-raised md-primary\\\" ng-disabled=\\\"ctrl.selectedYScaleMode != ctrl.YScaleModes.MANUAL\\\" ng-click=ctrl.onCenterYAxes()>{{\\\"views.graphics.center\\\" | translate }}</md-button></div></md-content></md-sidenav></md-content>\");\n$templateCache.put(\"app/tsa-views/gravimeter/gravimeter.html\",\"<div layout=column><!-- Toolbar --><div layout=row class=tsa-toolbar><i class=\\\"mdi mdi-24px mdi-{{\\'views.gravimeter.icon\\' | translate }}\\\"></i><p class=title>{{\\\"views.gravimeter.title\\\" | translate }}</p><p class=device-id>- {{ctrl.deviceId}}</p><span flex></span><tsa-settings-button on-change-view=\\\"ctrl.onChangeCardType({type: type})\\\" card-id={{ctrl.cardId}}></tsa-settings-button></div><md-divider></md-divider><!-- Content --><div flex layout=column class=tsa-content><tsa-data-view data=ctrl.GRAVIMETER.ACC_X frame-id=ctrl.frameId device-id=ctrl.deviceId opt-title=views.gravimeter.acc-X units=m/s></tsa-data-view><tsa-data-view data=ctrl.GRAVIMETER.ACC_Y frame-id=ctrl.frameId device-id=ctrl.deviceId opt-title=views.gravimeter.acc-Y units=m/s></tsa-data-view><tsa-data-view data=ctrl.GRAVIMETER.GRAVITY frame-id=ctrl.frameId device-id=ctrl.deviceId opt-title=views.gravimeter.gravity units=mgal></tsa-data-view><tsa-data-view data=ctrl.GRAVIMETER.SCALE frame-id=ctrl.frameId device-id=ctrl.deviceId opt-title=views.gravimeter.scale format=%.2f></tsa-data-view><tsa-data-view data=ctrl.GRAVIMETER.FILTER_ORDER frame-id=ctrl.frameId device-id=ctrl.deviceId opt-title=views.gravimeter.filter-order format=%.0f></tsa-data-view><tsa-data-view data=ctrl.GRAVIMETER.FILTER_TAU frame-id=ctrl.frameId device-id=ctrl.deviceId opt-title=views.gravimeter.filter-tau format=%.0f></tsa-data-view><tsa-data-view data=ctrl.GRAVIMETER.GPS_ON frame-id=ctrl.frameId device-id=ctrl.deviceId opt-title=views.gravimeter.gps format=%.0f></tsa-data-view><tsa-data-view data=ctrl.GRAVIMETER.STATUS frame-id=ctrl.frameId device-id=ctrl.deviceId opt-title=views.gravimeter.status format=%.0f></tsa-data-view></div></div>\");\n$templateCache.put(\"app/tsa-views/haulComposition/haulComposition.html\",\"<div layout=column><!-- Toolbar --><div layout=row class=tsa-toolbar><i class=\\\"mdi mdi-24px mdi-{{\\'views.haul-composition.icon\\' | translate }}\\\"></i><p class=title>{{\\\"views.haul-composition.title\\\" | translate }}</p><p class=device-id>- {{ctrl.deviceId}}</p><span flex></span><tsa-settings-button on-change-view=\\\"ctrl.onChangeCardType({type: type})\\\" card-id={{ctrl.cardId}}></tsa-settings-button></div><md-divider></md-divider><!-- Content --><div flex class=tsa-content layout=column><div layout=row><tsa-data-view flex=33 data=ctrl.haul frame-id=ctrl.frameId device-id=ctrl.deviceId opt-title=views.haul-composition.haul></tsa-data-view><md-divider></md-divider><tsa-data-view flex=33 data=ctrl.pocket frame-id=ctrl.frameId device-id=ctrl.deviceId opt-title=views.haul-composition.pocket></tsa-data-view><md-divider></md-divider><tsa-data-view flex=33 data=ctrl.totalPocket frame-id=ctrl.frameId device-id=ctrl.deviceId opt-title=views.haul-composition.total-pocket></tsa-data-view></div><!-- Species table --><div flex layout=column class=tsa-table><div layout=row class=\\\"title tsa-table-title\\\"><p flex=25>{{\\\"views.haul-composition.species\\\" | translate }}</p><p flex=25>{{\\\"views.haul-composition.sign\\\" | translate }}</p><p flex=25>{{\\\"views.haul-composition.estimation\\\" | translate }}</p><div flex=25 layout=row><p>{{\\\"views.haul-composition.weight\\\" | translate }}</p><span flex></span><p>Page {{ctrl.selectedPage}}/{{ctrl.pageArray.length}}</p></div></div><div flex id=array class=tsa-table-content><div flex layout=row ng-repeat=\\\"species in ctrl.speciesListToDisplay\\\"><p flex=25>{{species.id}}</p><p flex=25>{{species.sign}}</p><p flex=25>{{species.estimation}}</p><p flex=25>{{species.weight}}</p></div></div></div><div layout=row class=pages layout-align=end><p class=md-body>Page :</p><md-button ng-repeat=\\\"page in ctrl.pageArray\\\" class=page ng-class=\\\"{\\'md-primary md-raised\\': ctrl.selectedPage == page}\\\" ng-click=ctrl.selectPage(page)>{{page}}</md-button><md-button ng-show=!ctrl.playEnabled class=\\\"play md-primary\\\" ng-click=\\\"ctrl.playEnabled = !ctrl.playEnabled\\\"><i class=\\\"mdi mdi-play-circle\\\"></i> play</md-button><md-button ng-show=ctrl.playEnabled class=\\\"stop md-warn\\\" ng-click=\\\"ctrl.playEnabled = !ctrl.playEnabled\\\"><i class=\\\"mdi mdi-stop\\\"></i> stop</md-button></div><div layout=row><tsa-data-view flex=50 data=ctrl.totalSortedSpecies frame-id=ctrl.frameId device-id=ctrl.deviceId opt-title=views.haul-composition.total-sorted></tsa-data-view><md-divider></md-divider><tsa-data-view flex=50 opt-value=ctrl.sortedPercentage opt-title=views.haul-composition.sorted-prc></tsa-data-view></div></div></div>\");\n$templateCache.put(\"app/tsa-views/hullSoundSpeed/hullSoundSpeed.html\",\"<div layout=column><!-- Toolbar --><div layout=row class=tsa-toolbar><i class=\\\"mdi mdi-24px mdi-{{\\'views.hullsoundspeed.icon\\' | translate }}\\\"></i><p class=title>{{\\\"views.hullsoundspeed.title\\\" | translate }}</p><p class=device-id>- {{ctrl.deviceId}}</p><span flex></span><!-- Loading icon --><div ng-if=\\\"ctrl.bufferLoading[ctrl.selectedScale] > 0\\\" layout=column layout-align=\\\"center center\\\" style=\\\"width: 40px\\\"><md-tooltip>{{\\\"archive-loading\\\" | translate }}</md-tooltip><md-progress-circular md-diameter=20px></md-progress-circular></div><!-- Scale X --><md-input-container><md-select ng-model=ctrl.selectedScale ng-change=ctrl.onChangeXScale()><md-option ng-repeat=\\\"(name, value) in ctrl.scales\\\" value={{name}}>{{name}}</md-option></md-select><md-tooltip>{{\\\"Graphic scale\\\" | translate }}</md-tooltip></md-input-container><tsa-settings-button on-change-view=\\\"ctrl.onChangeCardType({type: type})\\\" card-id={{ctrl.cardId}}></tsa-settings-button></div><md-divider></md-divider><!-- Data views --><!-- Chart --><div flex class=tsa-content layout=column><tsa-data-view data=ctrl.HULLSOUNDSPEED.DATA frame-id=ctrl.frameId device-id=ctrl.deviceId format=%.2f units=m/s opt-title=views.hullsoundspeed.data></tsa-data-view><div flex class=tsa-chart-container><canvas id={{ctrl.canvasId}}></canvas></div></div></div>\");\n$templateCache.put(\"app/tsa-views/kley-state/kley-state.html\",\"<div layout=column><!-- Toolbar --><div layout=row class=tsa-toolbar><i class=\\\"mdi mdi-24px mdi-{{\\'views.kley-state.icon\\' | translate }}\\\"></i><p class=title>{{\\\"views.kley-state.title\\\" | translate }}</p><!-- <p class=\\\"device-id\\\">- {{ctrl.deviceId}}</p> --> <span flex></span><tsa-settings-button on-change-view=\\\"ctrl.onChangeCardType({type: type})\\\" card-id={{ctrl.cardId}}></tsa-settings-button></div><md-divider></md-divider><!-- Content --><div flex layout=row layout-align=space-around class=tsa-content><!-- Data views --><div flex layout=column layout-align=space-around><tsa-data-view ng-repeat=\\\"data in ctrl.KLEY_STATE.datasLeft\\\" data=data.id frame-id=ctrl.KLEY_STATE.frameId device-id=ctrl.deviceId opt-title={{data.name}} on-off=true></tsa-data-view></div><md-divider></md-divider><div flex=50 layout=column><tsa-data-view ng-repeat=\\\"data in ctrl.KLEY_STATE.datasRight\\\" data=data.id frame-id=ctrl.KLEY_STATE.frameId device-id=ctrl.deviceId opt-title={{data.name}} format={{data.cFormat}}></tsa-data-view></div></div></div>\");\n$templateCache.put(\"app/tsa-views/kss31/kss31.html\",\"<div layout=column><!-- Toolbar --><div layout=row class=tsa-toolbar><i class=\\\"mdi mdi-24px mdi-{{\\'views.gravimeter.icon\\' | translate }}\\\"></i><p class=title>{{\\\"views.gravimeter.title\\\" | translate }}</p><p class=device-id>- {{ctrl.deviceId}}</p><span flex></span><tsa-settings-button on-change-view=\\\"ctrl.onChangeCardType({type: type})\\\" card-id={{ctrl.cardId}}></tsa-settings-button></div><md-divider></md-divider><!-- Content --><div flex layout=column class=tsa-content><tsa-data-view data=ctrl.KSS31.ACC_X frame-id=ctrl.frameId device-id=ctrl.deviceId opt-title=views.kss31.acc-X units=m/s></tsa-data-view><tsa-data-view data=ctrl.KSS31.ACC_Y frame-id=ctrl.frameId device-id=ctrl.deviceId opt-title=views.kss31.acc-Y units=m/s></tsa-data-view><tsa-data-view data=ctrl.KSS31.GRAVITY frame-id=ctrl.frameId device-id=ctrl.deviceId opt-title=views.kss31.gravity units=mgal></tsa-data-view><tsa-data-view data=ctrl.KSS31.DATATION frame-id=ctrl.frameId device-id=ctrl.deviceId opt-title=views.kss31.datation></tsa-data-view><tsa-data-view data=ctrl.KSS31.SEASTATE frame-id=ctrl.frameId device-id=ctrl.deviceId opt-title=views.kss31.seastate></tsa-data-view><tsa-data-view data=ctrl.KSS31.EOETVOES frame-id=ctrl.frameId device-id=ctrl.deviceId opt-title=views.kss31.eoetvoes units=mgal></tsa-data-view><tsa-data-view data=ctrl.KSS31.BOUGUER frame-id=ctrl.frameId device-id=ctrl.deviceId opt-title=views.kss31.bouguer units=mgal></tsa-data-view><tsa-data-view data=ctrl.KSS31.FREEAIR frame-id=ctrl.frameId device-id=ctrl.deviceId opt-title=views.kss31.freeair units=mgal></tsa-data-view></div></div>\");\n$templateCache.put(\"app/tsa-views/landing-at/landing-at.html\",\"<meta charset=utf-8><div layout=column><!-- Toolbar --><div layout=row class=tsa-toolbar><i class=\\\"mdi mdi-24px mdi-{{\\'views.propulsion.icon\\' | translate }}\\\"></i><p class=title>{{\\\"views.propulsion.title\\\" | translate }}</p><p class=device-id>- {{ctrl.deviceId}}</p><span flex></span><tsa-settings-button on-change-view=\\\"ctrl.onChangeCardType({type: type})\\\" card-id={{ctrl.cardId}}></tsa-settings-button></div><md-divider></md-divider><!-- Content --><div class=tsa-content layout=row><div class=landingcols flex=25><!-- Wind data --><div layout=column><tsa-double-data-view class=true-wind title=views.weather.true-wind data1=ctrl.trueWindHeadingId frame-id1=ctrl.weatherFrame device-id1=ctrl.weatherDeviceId format1=%.0f data2=ctrl.trueWindSpeedId frame-id2=ctrl.weatherFrame device-id2=ctrl.weatherDeviceId format2=%.1f></tsa-double-data-view><tsa-double-data-view class=relative-wind title=views.weather.rel-wind data1=ctrl.relWindHeadingId frame-id1=ctrl.weatherFrame device-id1=ctrl.weatherDeviceId format1=%.0f data2=ctrl.relWindSpeedId frame-id2=ctrl.weatherFrame device-id2=ctrl.weatherDeviceId format2=%.1f></tsa-double-data-view><canvas flex id={{ctrl.windCanvasId}}><p>Error during the display of the canvas (maybe due to the browser version)</p></canvas></div></div><div class=landingcols flex=50><canvas id={{ctrl.propulsionCanvasId}} class=navcanvas><p>Error during the display of the canvas (maybe due to the browser version)</p></canvas><!-- Data views --><tsa-data-view class=propulsion id=fronttrans data=ctrl.frontTrans.id frame-id=ctrl.frameId device-id=ctrl.deviceId format=%.0f title-disabled=true units=\\\"\\\" ng-style=\\\"{top:ctrl.frontTrans.y + \\'px\\', left: ctrl.frontTrans.x + \\'px\\'};\\\"></tsa-data-view><tsa-data-view class=propulsion id=frontpropangle data=ctrl.frontPropAngle.id frame-id=ctrl.frameId device-id=ctrl.deviceId format=%.0f title-disabled=true units= ng-style=\\\"{top:ctrl.frontPropAngle.y + \\'px\\', left: ctrl.frontPropAngle.x + \\'px\\'};\\\"></tsa-data-view><tsa-data-view class=propulsion id=mainleft data=ctrl.mainLeft.id frame-id=ctrl.frameId device-id=ctrl.deviceId format=%.0f title-disabled=true units=rpm abs=true ng-style=\\\"{top:ctrl.mainLeft.y + \\'px\\', left: ctrl.mainLeft.x + \\'px\\'};\\\"></tsa-data-view><tsa-data-view class=propulsion id=mainright data=ctrl.mainRight.id frame-id=ctrl.frameId device-id=ctrl.deviceId format=%.0f title-disabled=true units=rpm abs=true ng-style=\\\"{top:ctrl.mainRight.y + \\'px\\', left: ctrl.mainRight.x + \\'px\\'};\\\"></tsa-data-view><tsa-data-view class=propulsion id=angle data=ctrl.angle.id frame-id=ctrl.frameId device-id=ctrl.deviceId format=%.0f title-disabled=true units= redgreen=true abs=true ng-style=\\\"{top:ctrl.angle.y + \\'px\\', left: ctrl.angle.x + \\'px\\'};\\\"></tsa-data-view></div><div class=landingcols flex=25><div flex layout=column><h2 class=sub>{{\\\"views.propulsion.heading\\\" | translate }} :</h2><tsa-data-view class=navigation id=heading data=ctrl.heading.id frame-id=ctrl.navFrameId; device-id=ctrl.navId format=%.0f title-disabled=true units=></tsa-data-view><h2 class=sub>{{\\\"views.propulsion.surfspeed\\\" | translate }} :</h2><div layout=row><div flex layout=column></div><div flex layout=column><tsa-data-view class=navigation opt-value=ctrl.surfNorth units=nd format=%.1f title-disabled=true></tsa-data-view></div><div flex layout=column></div></div><div layout=row><div flex layout=column><tsa-data-view class=navigation opt-value=ctrl.surfWest units=nd format=%.1f title-disabled=true></tsa-data-view></div><div flex layout=column></div><div flex layout=column><tsa-data-view class=navigation opt-value=ctrl.surfEast units=nd format=%.1f title-disabled=true></tsa-data-view></div></div><div layout=row><div flex layout=column></div><div flex layout=column><tsa-data-view class=navigation opt-value=ctrl.surfSouth units=nd format=%.1f title-disabled=true></tsa-data-view></div><div flex layout=column></div></div><h2 class=sub>{{\\\"views.propulsion.gndspeed\\\" | translate }} :</h2><div layout=row><div flex layout=column></div><div flex layout=column><tsa-data-view class=navigation opt-value=ctrl.gndNorth units=nd format=%.1f title-disabled=true></tsa-data-view></div><div flex layout=column></div></div><div layout=row><div flex layout=column><tsa-data-view class=navigation opt-value=ctrl.gndWest units=nd format=%.1f title-disabled=true></tsa-data-view></div><div flex layout=column></div><div flex layout=column><tsa-data-view class=navigation opt-value=ctrl.gndEast units=nd format=%.1f title-disabled=true></tsa-data-view></div></div><div layout=row><div flex layout=column></div><div flex layout=column><tsa-data-view class=navigation opt-value=ctrl.gndSouth units=nd format=%.1f title-disabled=true></tsa-data-view></div><div flex layout=column></div></div></div></div></div></div>\");\n$templateCache.put(\"app/tsa-views/magnetometer/magnetometer.html\",\"<div layout=column><!-- Toolbar --><div layout=row class=tsa-toolbar><i class=\\\"mdi mdi-24px mdi-{{\\'views.magnetometer.icon\\' | translate }}\\\"></i><p class=title>{{\\\"views.magnetometer.title\\\" | translate }}</p><p class=device-id>- {{ctrl.deviceId}}</p><span flex></span><tsa-settings-button on-change-view=\\\"ctrl.onChangeCardType({type: type})\\\" card-id={{ctrl.cardId}}></tsa-settings-button></div><md-divider></md-divider><!-- Content --><div flex layout=column class=tsa-content layout-align=\\\"center center\\\"><tsa-data-view data=ctrl.MAGNETOMETER.MAG frame-id=ctrl.frameId device-id=ctrl.deviceId opt-title=views.magnetometer.mag units=gamma format=%.3f></tsa-data-view><tsa-data-view data=ctrl.MAGNETOMETER.DEPTH frame-id=ctrl.frameId device-id=ctrl.deviceId opt-title=views.magnetometer.depth units=m format=%.2f></tsa-data-view></div></div>\");\n$templateCache.put(\"app/tsa-views/map/map.html\",\"<div layout=column style=\\\"height: 100%\\\"><!-- Toolbar --><div layout=row layout-align=\\\"center center\\\" class=tsa-toolbar flex=none><i ng-if=ctrl.isModeNavigation() class=\\\"mdi mdi-24px mdi-{{\\'views.map.icon\\' | translate }}\\\"></i> <i ng-if=!ctrl.isModeNavigation() class=\\\"mdi mdi-24px mdi-{{\\'views.station.icon\\' | translate }}\\\"></i><p ng-if=ctrl.isModeNavigation() class=title>{{\\\"views.map.title\\\" | translate }}</p><p ng-if=!ctrl.isModeNavigation() class=title>{{\\\"views.station.title\\\" | translate }}</p><p class=device-id>- {{ctrl.config.deviceId}}</p><span flex></span><md-input-container ng-if=!ctrl.isModeNavigation()><md-select ng-model=ctrl.stationViewScale ng-change=ctrl.onStationViewScaleChange()><md-option ng-repeat=\\\"scale in ctrl.stationViewScaleList\\\" value={{scale}}>{{scale}}</md-option></md-select><md-tooltip>{{\\\"Scale\\\" | translate }}</md-tooltip></md-input-container><!-- LAYERS --><md-button class=md-icon-button ng-click=ctrl.toggleLayerMenu() ng-if=ctrl.trackingEnabled><md-icon ng-class=\\\"{enabled: ctrl.showLayerMenu}\\\">layers</md-icon><md-tooltip>{{\\\"views.map.layers\\\" | translate }}</md-tooltip></md-button><md-menu md-position-mode=\\\"target-right target\\\"><md-button class=md-icon-button ng-click=$mdOpenMenu($event)><i md-menu-origin class=\\\"mdi mdi-24px mdi-math-compass\\\" ng-style=\\\"ctrl.currentMeasureTool !== \\'Disabled\\' ?{\\'color\\': \\' #1a75ad\\'}: {}\\\"></i><md-tooltip>{{\\\"views.map.measure-tool\\\" | translate }}</md-tooltip></md-button><md-menu-content><md-menu-item><div layout=row layout-align=\\\"center center\\\" style=\\\"padding-right: 0\\\"><p flex>{{\\\"views.map.measure-tool\\\" | translate }}</p><md-button ng-click=\\\"\\\" class=md-icon-button style=\\\"background-color: transparent !important\\\"><md-icon md-menu-align-target style=\\\"margin: auto 3px auto 0\\\">close</md-icon></md-button></div></md-menu-item><md-menu-divider></md-menu-divider><md-menu-item><md-button ng-click=\\\"ctrl.onMeasureToolChange(\\'Free\\')\\\" ng-style=\\\"ctrl.currentMeasureTool === \\'Free\\' ?{\\'color\\': \\' #1a75ad\\'}: {}\\\"><div layout=row flex><p flex>{{\\\"views.map.free\\\" | translate }}</p></div></md-button></md-menu-item><md-menu-item><md-button ng-click=\\\"ctrl.onMeasureToolChange(\\'From boat\\')\\\" ng-style=\\\"ctrl.currentMeasureTool === \\'From boat\\' ?{\\'color\\': \\' #1a75ad\\'}: {}\\\"><div layout=row flex><p flex>{{\\\"views.map.from-boat\\\" | translate }}</p></div></md-button></md-menu-item><md-menu-item><md-button ng-click=\\\"ctrl.onMeasureToolChange(\\'Disabled\\')\\\" ng-style=\\\"ctrl.currentMeasureTool === \\'Disabled\\' ?{\\'color\\': \\' #1a75ad\\'}: {}\\\"><div layout=row flex><p flex>{{\\\"views.map.disabled\\\" | translate }}</p></div></md-button></md-menu-item><md-menu-divider></md-menu-divider><md-menu-item><md-button ng-click=ctrl.clearMeasures()><div layout=row flex><p flex>{{\\\"views.map.clear-measure\\\" | translate }}</p></div></md-button></md-menu-item></md-menu-content></md-menu><!-- Navigation mode buttons --><md-button class=md-icon-button ng-if=ctrl.isModeNavigation() ng-click=ctrl.showAIS()><md-icon ng-class=\\\"{enabled: ctrl.aisEnabled}\\\">{{\\\"views.mobile.icon\\\" | translate }}</md-icon><md-tooltip>{{\\\"views.map.show-ais\\\" | translate }}</md-tooltip></md-button><md-button class=md-icon-button ng-if=ctrl.isModeNavigation() ng-click=ctrl.showRoute()><md-icon ng-class=\\\"{enabled: ctrl.routeEnabled}\\\">trending_up</md-icon><md-tooltip>{{\\\"views.map.show-route\\\" | translate }}</md-tooltip></md-button><md-button class=md-icon-button ng-click=ctrl.showTrace()><md-icon ng-class=\\\"{enabled: ctrl.traceEnabled}\\\">timeline</md-icon><md-tooltip>{{\\\"views.map.show-trace\\\" | translate }}</md-tooltip></md-button><md-button class=md-icon-button ng-if=ctrl.isModeNavigation() ng-click=ctrl.focusOnBoat()><md-icon ng-class=\\\"{enabled: ctrl.autoCenterEnabled}\\\">center_focus_strong</md-icon><md-tooltip>{{\\\"views.map.focus-on-boat\\\" | translate }}</md-tooltip></md-button><md-button class=md-icon-button ng-if=ctrl.isModeNavigation() ng-click=ctrl.showGrid()><md-icon ng-class=\\\"{enabled: ctrl.gridEnabled}\\\">grid_on</md-icon><md-tooltip>{{\\\"views.map.grid-on\\\" | translate }}</md-tooltip></md-button><md-button class=md-icon-button ng-if=ctrl.isModeNavigation() ng-click=ctrl.showMultibeam()><md-icon ng-class=\\\"{enabled: ctrl.multibeamEnabled}\\\">clear_all</md-icon><md-tooltip>{{\\\"views.map.draw-mb\\\" | translate }}</md-tooltip></md-button><md-button class=md-icon-button ng-click=ctrl.showBottomBar()><md-icon ng-class=\\\"{enabled: ctrl.bottomBarEnabled}\\\">info</md-icon><md-tooltip>{{\\\"views.map.show-info\\\" | translate }}</md-tooltip></md-button><tsa-settings-button on-change-view=\\\"ctrl.onChangeCardType({type: type})\\\" card-id={{ctrl.cardId}} button-list=ctrl.settingsButton></tsa-settings-button></div><md-divider></md-divider><!-- Map  --><div class=tsa-map-container flex><div class=sidenav-tooltip ng-if=\\\"ctrl.showLayerMenu && (ctrl.getCustomPointMode() !== \\'readonly\\' || ctrl.getCustomRouteMode() !== \\'readonly\\')\\\" ng-if=ctrl.trackingEnabled ng-class=\\\"{\\'edit\\': ctrl.getCustomPointMode() === \\'add\\'}\\\"><div ng-if=\\\"ctrl.getCustomPointMode() === \\'edit\\' || ctrl.getCustomPointMode() === \\'add\\'\\\" layout=row><div flex><span ng-if=\\\"ctrl.getCustomPointMode() === \\'add\\'\\\">{{\\\"views.map.tooltip.point-add\\\" | translate }}</span> <span ng-if=\\\"ctrl.getCustomPointMode() === \\'edit\\'\\\">{{\\\"views.map.tooltip.point-edit\\\" | translate }}</span><div class=tooltip-actions><md-button class=\\\"md-raised md-primary\\\" ng-click=\\\"ctrl.onToggleCustomPointMode(\\'edit\\')\\\" ng-if=\\\"ctrl.getCustomPointMode() !== \\'edit\\'\\\">Ajouter</md-button><md-button class=md-raised ng-click=\\\"ctrl.onToggleCustomPointMode(\\'add\\')\\\" ng-if=\\\"ctrl.getCustomPointMode() !== \\'add\\'\\\">Ajouter</md-button></div></div><div flex=nogrow layout-align=\\\"center center\\\"><md-button class=md-raised ng-click=\\\"ctrl.onToggleCustomPointMode(\\'readonly\\')\\\">Quittez le mode edition</md-button></div></div><div ng-if=\\\"ctrl.getCustomRouteMode() === \\'edit\\' || ctrl.getCustomRouteMode() === \\'add\\'\\\" layout=row><div flex><span ng-if=\\\"ctrl.getCustomRouteMode() === \\'add\\'\\\">{{\\\"views.map.tooltip.route-add\\\" | translate }}</span> <span ng-if=\\\"ctrl.getCustomRouteMode() === \\'edit\\'\\\">{{\\\"views.map.tooltip.route-edit\\\" | translate }}</span><div class=tooltip-actions><md-button class=\\\"md-raised md-primary\\\" ng-click=\\\"ctrl.onToggleCustomRouteMode(\\'edit\\')\\\" ng-if=\\\"ctrl.getCustomRouteMode() !== \\'edit\\'\\\">Ajouter</md-button><md-button class=md-raised ng-click=\\\"ctrl.onToggleCustomRouteMode(\\'add\\')\\\" ng-if=\\\"ctrl.getCustomRouteMode() !== \\'add\\'\\\">Ajouter</md-button></div></div><div flex=nogrow layout-align=\\\"center center\\\"><md-button class=md-raised ng-click=\\\"ctrl.onToggleCustomRouteMode(\\'readonly\\')\\\">Quittez le mode edition</md-button></div></div></div><tsa-map-sidemenu map-component=ctrl.mapComponent ng-show=ctrl.showLayerMenu ng-if=ctrl.trackingEnabled></tsa-map-sidemenu><div class=map-element flex id={{ctrl.mapId}}><div class=day-night-layer ng-class=\\\"{\\'station-unavailable\\': ctrl.stationIsUnvailable}\\\"><p class=md-subhead>{{\\\"views.station.unvailable\\\" | translate }}</p></div></div></div><div layout=row class=bottom-bar ng-show=ctrl.bottomBarEnabled layout-align=\\\"start center\\\" flex=none><p>lat: {{ctrl.stringMouseLatitude}}</p><p>long: {{ctrl.stringMouseLongitude}}</p><span flex></span><p hide-sm>SOG: {{ctrl.position.gndspeed}}kn</p><p hide-sm>{{\\\"views.map.heading\\\" | translate }}: {{ctrl.position.heading | number:0}}</p><p>lat: {{ctrl.position.stringLatitude}}</p><p>long: {{ctrl.position.stringLongitude}}</p></div></div>\");\n$templateCache.put(\"app/tsa-views/map-sidemenu/map-sidemenu.html\",\"<div><div class=config-menu><div class=layers-control-dialog-container><div class=layer-control-swhitch-background><h3>{{\\\"views.map.layers\\\" | translate }}</h3></div><div class=\\\"layer-control-branch swicth-background\\\"><div class=layer-control-branch-header><div class=layer-control-branch-checkbox>{{\\\"views.map.background\\\" | translate }}</div><md-menu><md-button aria-label=\\\"Open more interaction\\\" class=md-icon-button ng-click=\\\"ctrl.openMenu($mdMenu, $event, ctrl.getBackgroundLayer())\\\"><md-icon class=material-icons>more_horiz</md-icon></md-button><md-menu-content width=4><md-menu-item><div class=tsa-sidenav-contextual-option-menu-opacity><md-icon>brightness_medium</md-icon><md-slider flex ng-model=ctrl.opacity ng-change=ctrl.setLayerOpacity() class=md-primary step=.1 min=0 max=1 aria-label=opacity></md-slider></div></md-menu-item><md-radio-group ng-model=ctrl.background ng-change=ctrl.toggleMapBackground()><md-menu-item><md-radio-button value=OpenSeaMap class=\\\"md-primary md-button\\\">{{\\\"layers.background.openseamap\\\" | translate }}</md-radio-button></md-menu-item><md-menu-item><md-radio-button value=Geomod class=\\\"md-primary md-button\\\">{{\\\"layers.background.geomod\\\" | translate }}</md-radio-button></md-menu-item><md-menu-item><md-radio-button value=Emodnet class=\\\"md-primary md-button\\\">{{\\\"layers.background.emodnet\\\" | translate }}</md-radio-button></md-menu-item></md-radio-group></md-menu-content></md-menu></div></div><div ng-repeat=\\\"branch in ctrl.getTreeLayer()\\\" class=layer-control-branch><div class=layer-control-branch-header><div class=layer-control-branch-checkbox><md-checkbox ng-model=branch.__visible class=md-primary ng-checked=branch.getVisible() md-indeterminate=ctrl.isBranchIsIndeterminate(branch) ng-change=branch.setVisible(branch.getVisible())>{{ branch.getName() | translate }}</md-checkbox></div><md-menu><md-button aria-label=\\\"Open more interaction\\\" class=md-icon-button ng-click=\\\"ctrl.openMenu($mdMenu, $event, branch)\\\"><md-icon class=material-icons>more_horiz</md-icon></md-button><md-menu-content width=4><md-menu-item><div class=tsa-sidenav-contextual-option-menu-opacity><md-icon>brightness_medium</md-icon><md-slider flex ng-model=ctrl.opacity ng-change=ctrl.setLayerOpacity() class=md-primary step=.1 min=0 max=1 aria-label=opacity></md-slider></div></md-menu-item><md-menu-item ng-if=\\\"branch.getName() === \\'layers.casino\\'\\\"><md-button ng-click=ctrl.onOpenCasinoDialog()><md-icon>casino</md-icon>{{\\\"views.map.casino.connection.button\\\" | translate }}</md-button></md-menu-item><!-- COMMONS --><md-menu-divider ng-if=\\\"branch.getName() === \\'layers.commons\\' && ctrl.isConnected\\\"></md-menu-divider><md-menu-item ng-if=\\\"branch.getName() === \\'layers.commons\\' && ctrl.isConnected\\\"><md-button ng-click=ctrl.openUploadQGISDialog($event)><md-icon>file_upload</md-icon>{{\\\"views.map.gqis.upload-title\\\" | translate }}</md-button></md-menu-item></md-menu-content></md-menu></div><div ng-repeat=\\\"child in branch.getChildren()\\\" class=layer-control-children><md-checkbox ng-model=child.__visible class=md-primary ng-disabled=!branch.getVisible() ng-change=child.setVisible(child.getVisible())>{{ child.getName() | translate }}</md-checkbox><md-menu><md-button aria-label=\\\"Open more interaction\\\" class=md-icon-button ng-click=\\\"ctrl.openMenu($mdMenu, $event, child)\\\"><md-icon class=material-icons>more_horiz</md-icon></md-button><md-menu-content width=10><md-menu-item><div class=tsa-sidenav-contextual-option-menu-opacity><md-icon>brightness_medium</md-icon><md-slider flex ng-model=ctrl.opacity ng-change=ctrl.setLayerOpacity() class=md-primary step=.1 min=0 max=1 aria-label={{child.getName()}}></md-slider></div></md-menu-item><!-- CUSTOM POINTS --><md-menu-item ng-if=\\\"child.getName() === \\'layers.custom.points\\'\\\"><md-button class=layer-control-branch-checkbox ng-click=ctrl.onToggleCustomPointMode()><md-checkbox ng-model=pointsEditionEnabled class=md-primary ng-checked=\\\"ctrl.getCustomPointMode() !== \\'readonly\\'\\\">{{\\\"views.map.custom-point.editionMode\\\" | translate }}</md-checkbox></md-button></md-menu-item><md-menu-item ng-if=\\\"child.getName() === \\'layers.custom.points\\'\\\"><md-button ng-click=ctrl.toggleCustomPointLabel() ng-class=\\\"{enabled: ctrl.getCustomPointLabelState() === true}\\\"><md-icon>label</md-icon>{{\\\"views.map.custom-point.show-label\\\" | translate }}</md-button></md-menu-item><md-menu-item ng-if=\\\"child.getName() === \\'layers.custom.points\\'\\\"><md-button ng-click=ctrl.onRemoveAllCustomPoints()><md-icon>delete_forever</md-icon>{{\\\"views.map.custom-point.remove-all\\\" | translate }}</md-button></md-menu-item><md-menu-divider ng-if=\\\"child.getName() === \\'layers.custom.points\\'\\\"></md-menu-divider><md-menu-item ng-if=\\\"child.getName() === \\'layers.custom.points\\'\\\"><md-button ng-click=ctrl.openUploadPointDialog($event)><md-icon>file_upload</md-icon>{{\\\"views.map.custom-point.import\\\" | translate }}</md-button></md-menu-item><md-menu-divider ng-if=\\\"child.getName() === \\'layers.custom.points\\'\\\"></md-menu-divider><md-menu-item ng-if=\\\"child.getName() === \\'layers.custom.points\\'\\\"><md-menu style=\\\"padding:0; margin: 0\\\"><md-button class=sidemenu-underbutton aria-label=\\\"Open more interaction\\\" ng-click=$mdMenu.open($event)><md-icon>file_download</md-icon>{{\\\"views.map.custom-point.export\\\" | translate }}</md-button><md-menu-content width=4><md-menu-item ng-if=\\\"child.getName() === \\'layers.custom.points\\'\\\"><md-button ng-click=\\\"ctrl.onExportPoints(\\'gpx\\')\\\" href=# id=custom-points-export-gpx download=points.gpx><md-icon>file_download</md-icon>{{\\\"views.map.custom-point.export-gpx\\\" | translate }}</md-button></md-menu-item><md-menu-item ng-if=\\\"child.getName() === \\'layers.custom.points\\'\\\"><md-button ng-click=\\\"ctrl.onExportPoints(\\'html\\')\\\" href=# id=custom-points-export-html download=points.html><md-icon>file_download</md-icon>{{\\\"views.map.custom-point.export-html\\\" | translate }}</md-button></md-menu-item><md-menu-item ng-if=\\\"child.getName() === \\'layers.custom.points\\'\\\"><md-button ng-click=\\\"ctrl.onExportPoints(\\'csv\\')\\\" href=# id=custom-points-export-csv download=points.csv><md-icon>file_download</md-icon>{{\\\"views.map.custom-point.export-csv\\\" | translate }}</md-button></md-menu-item></md-menu-content></md-menu></md-menu-item><!-- CUSTOM ROUTES --><md-menu-item ng-if=\\\"child.getName() === \\'layers.custom.routes\\'\\\"><md-button class=layer-control-branch-checkbox ng-click=ctrl.onToggleCustomRouteMode()><md-checkbox ng-model=routesEditionEnabled class=md-primary ng-checked=\\\"ctrl.getCustomRouteMode() !== \\'readonly\\'\\\">{{\\\"views.map.custom-route.editionMode\\\" | translate }}</md-checkbox></md-button></md-menu-item><md-menu-item ng-if=\\\"child.getName() === \\'layers.custom.routes\\'\\\"><md-button ng-click=ctrl.onRemoveAllCustomRoutes()><md-icon>delete_forever</md-icon>{{\\\"views.map.custom-route.remove-all\\\" | translate }}</md-button></md-menu-item><md-menu-divider ng-if=\\\"child.getName() === \\'layers.custom.routes\\'\\\"></md-menu-divider><md-menu-item ng-if=\\\"child.getName() === \\'layers.custom.routes\\'\\\"><md-button ng-click=ctrl.openUploadRouteDialog($event)><md-icon>file_upload</md-icon>{{\\\"views.map.custom-route.import\\\" | translate }}</md-button></md-menu-item><md-menu-divider ng-if=\\\"child.getName() === \\'layers.custom.routes\\'\\\"></md-menu-divider><md-menu-item ng-if=\\\"child.getName() === \\'layers.custom.routes\\'\\\"><md-menu style=\\\"padding:0; margin: 0\\\"><md-button class=sidemenu-underbutton aria-label=\\\"Open more interaction\\\" ng-click=$mdMenu.open($event)><md-icon>file_download</md-icon>{{\\\"views.map.custom-route.export\\\" | translate }}</md-button><md-menu-content width=4><md-menu-item ng-if=\\\"child.getName() === \\'layers.custom.routes\\'\\\"><md-button ng-click=\\\"ctrl.onExportRoutes(\\'gpx\\')\\\" href=# id=custom-routes-export-gpx download=routes.gpx><md-icon>file_download</md-icon>{{\\\"views.map.custom-route.export-gpx\\\" | translate }}</md-button></md-menu-item><md-menu-item ng-if=\\\"child.getName() === \\'layers.custom.routes\\'\\\"><md-button ng-click=\\\"ctrl.onExportRoutes(\\'html\\')\\\" href=# id=custom-routes-export-html download=routes.html><md-icon>file_download</md-icon>{{\\\"views.map.custom-route.export-html\\\" | translate }}</md-button></md-menu-item><md-menu-item ng-if=\\\"child.getName() === \\'layers.custom.routes\\'\\\"><md-button ng-click=\\\"ctrl.onExportRoutes(\\'csv\\')\\\" href=# id=custom-routes-export-csv download=routes.csv><md-icon>file_download</md-icon>{{\\\"views.map.custom-route.export-csv\\\" | translate }}</md-button></md-menu-item><md-menu-item ng-if=\\\"child.getName() === \\'layers.custom.routes\\'\\\"><md-button ng-click=\\\"ctrl.onExportRoutes(\\'rtz\\')\\\" href=# id=custom-routes-export-rtz download=routes.rtz><md-icon>file_download</md-icon>{{\\\"views.map.custom-route.export-rtz\\\" | translate }}</md-button></md-menu-item></md-menu-content></md-menu></md-menu-item></md-menu-content></md-menu></div></div></div></div><!-- CASINO DIALOG --><div style=\\\"visibility: hidden\\\"><div class=\\\"md-dialog-container upload-dialog\\\" id=casino-dialog><md-dialog class=casino-dialog-container style=\\\"width: 50%; height: 100%\\\"><div class=casino-state-container ng-show=\\\"ctrl.casinoState === \\'init\\'\\\"><h3>{{\\\"views.map.casino.connection.title\\\" | translate }}</h3><md-input-container><label>{{\\\"views.map.casino.url\\\" | translate }}</label><input ng-model=ctrl.casinoConnectionParams.url></md-input-container><md-input-container><label>{{\\\"views.map.casino.login\\\" | translate }}</label><input ng-model=ctrl.casinoConnectionParams.login></md-input-container><md-input-container><label>{{\\\"views.map.casino.password\\\" | translate }}</label><input type=password ng-model=ctrl.casinoConnectionParams.password></md-input-container><div ng-hide=!ctrl.casinoErrorLoad class=casino-error>{{\\\"views.map.casino.loading.error\\\" | translate }}</div><div class=casino-dialog-footer><md-button class=\\\"md-raised md-primary\\\" ng-click=ctrl.casinoConnection() ng-disabled=ctrl.casinoCanConnect()>{{\\\"views.map.casino.connection.button\\\" | translate }}</md-button></div></div><div class=casino-state-container ng-show=\\\"ctrl.casinoState === \\'cruises\\'\\\"><h3>{{\\\"views.map.casino.cruises.title\\\" | translate }}</h3><div class=casino-cruises><div ng-repeat=\\\"cruise in ctrl.cruises\\\"><md-checkbox ng-model=cruise.selected ng-change=ctrl.onChangeCruise(cruise)>{{cruise.FullName}}</md-checkbox></div></div><div ng-hide=!ctrl.casinoErrorLoad class=casino-error>{{\\\"views.map.casino.loading.error\\\" | translate }}</div><div class=casino-dialog-footer><md-button class=\\\"md-raised md-primary\\\" ng-click=ctrl.casinoSelectCruises() ng-disabled=\\\"ctrl.casinoLoading || ctrl.selectedCruises.length === 0\\\">{{\\\"views.map.casino.cruises.select-button\\\" | translate }}</md-button></div></div><div class=casino-state-container ng-show=\\\"ctrl.casinoState === \\'devices\\'\\\"><h3>{{\\\"views.map.casino.devices.title\\\" | translate }}</h3><div ng-repeat=\\\"device in ctrl.devices\\\"><md-checkbox ng-model=device.selected md-indeterminate=\\\"device.indeterminate || false\\\" ng-change=ctrl.onChangeDevices(device)>{{ device.DeviceName }}</md-checkbox><div class=casino_device-actions><md-checkbox ng-repeat=\\\"action in device.actions\\\" ng-model=action.selected ng-disabled=!device.selected ng-change=ctrl.onChangeAction(device)>{{action.ActionName}}</md-checkbox></div></div><div class=casino-dialog-footer><md-button class=\\\"md-raised md-primary\\\" ng-click=ctrl.casinoSelectDevices() ng-disabled=\\\"ctrl.selectedDevices.length === 0\\\">{{\\\"views.map.casino.devices.select-button\\\" | translate }}</md-button></div></div><div class=casino-state-container ng-show=\\\"ctrl.casinoState === \\'loadData\\'\\\"><div ng-if=ctrl.casinoErrorLoad>{{\\\"views.map.casino.loading.error\\\" | translate }}</div></div></md-dialog></div></div><!-- CUSTOM POINT IMPORT DIALOG --><div style=\\\"visibility: hidden\\\"><div class=\\\"md-dialog-container upload-dialog\\\" id=custom-points-upload-dialog><md-dialog><md-toolbar layout-padding><h2 class=md-title>{{\\\"views.map.custom-point.title\\\" | translate }}</h2></md-toolbar><md-content layout-padding><div class=geolayer-uploading-zone><input type=file id=custom-point-file name=customPointFiles[]></div><i>{{\\\"views.map.custom-point.import-files\\\" | translate }}</i><div><md-button class=md-raised ng-click=ctrl.cancelImportPoint()>{{\\\"views.map.custom-point.cancel\\\" | translate }}</md-button><md-button class=\\\"md-raised md-primary\\\" ng-click=ctrl.onUploadPoints() ng-disabled=saveUploadPoint>{{\\\"views.map.custom-point.upload\\\" | translate }}</md-button></div></md-content></md-dialog></div></div><!-- CUSTOM POINT EDIT LABEL AND COORDINATES DIALOG --><div style=\\\"visibility: hidden\\\"><div class=\\\"md-dialog-container upload-dialog\\\" id=custom-points-create-dialog><md-dialog class=geolayer-dialog-edit-point style=\\\"width: 50%\\\"><md-toolbar layout-padding><h2 class=md-title ng-if=!ctrl.currentCustomPoint.edited>{{\\\"views.map.custom-point.title.add\\\" | translate }}</h2><h2 class=md-title ng-if=ctrl.currentCustomPoint.edited>{{\\\"views.map.custom-point.title.edit\\\" | translate }}</h2></md-toolbar><md-content layout-padding><div class=geolayer-edit-point><form name=customPointForm id=customPointForm><md-input-container><label>{{\\\"views.map.custom-point.label\\\" | translate }}</label><input ng-model=ctrl.currentCustomPoint.label></md-input-container><md-input-container><label>{{\\\"views.map.custom-point.longitude\\\" | translate }}</label><input ng-model=ctrl.currentCustomPoint.coordinates[0] required></md-input-container><md-input-container><label>{{\\\"views.map.custom-point.latitude\\\" | translate }}</label><input ng-model=ctrl.currentCustomPoint.coordinates[1] required></md-input-container><div><md-button class=md-raised ng-click=ctrl.closePointDialog()>{{\\\"views.map.custom-point.cancel\\\" | translate }}</md-button><md-button class=\\\"md-raised md-primary\\\" ng-disabled=!customPointForm.$valid ng-click=ctrl.saveCustomPoint()>{{\\\"views.map.custom-point.save\\\" | translate }}</md-button></div></form></div></md-content></md-dialog></div></div><div ng-show=ctrl.currentPointEdit><div id=custom-points-edit-dialog ng-style=\\\"{\\'left\\': ctrl.currentPointEdit.left, \\'top\\': ctrl.currentPointEdit.top}\\\"><md-button class=\\\"md-raised md-primary\\\" ng-click=ctrl.deleteCustomPoint()>{{\\\"views.map.custom-point.delete\\\" | translate }}</md-button><md-button class=md-raised ng-click=ctrl.openCustomPointCreatedDialog()>{{\\\"views.map.custom-point.edit\\\" | translate }}</md-button></div></div><!-- CUSTOM ROUTE IMPORT DIALOG --><div style=\\\"visibility: hidden\\\"><div class=\\\"md-dialog-container upload-dialog\\\" id=custom-routes-upload-dialog><md-dialog><md-toolbar layout-padding><h2 class=md-title>{{\\\"views.map.custom-route.import\\\" | translate }}</h2></md-toolbar><md-content layout-padding><div class=geolayer-uploading-zone><input type=file id=custom-route-file name=customRouteFiles[]></div><i>{{\\\"views.map.custom-route.import-files\\\" | translate }}</i><div><md-button class=md-raised ng-click=ctrl.cancelImportRoutes()>{{\\\"views.map.custom-point.cancel\\\" | translate }}</md-button><md-button class=\\\"md-raised md-primary\\\" ng-click=ctrl.onUploadRoutes() ng-disabled=saveUploadRoute>{{\\\"views.map.custom-point.upload\\\" | translate }}</md-button></div></md-content></md-dialog></div></div><!-- CUSTOM ROUTE EDIT COORDINATES DIALOG --><div style=\\\"visibility: hidden\\\"><div class=\\\"md-dialog-container upload-dialog\\\" id=custom-routes-edit-dialog><md-dialog layout-padding class=geolayer-dialog-edit-point style=\\\"width: 50%\\\"><div class=geolayer-edit-route><form name=customRouteForm><md-input-container><label>{{\\\"views.map.custom-route.longitude\\\" | translate }}</label><input ng-model=ctrl.currentCustomRoute.coordinates[0] required></md-input-container><md-input-container><label>{{\\\"views.map.custom-route.latitude\\\" | translate }}</label><input ng-model=ctrl.currentCustomRoute.coordinates[1] required></md-input-container><div><md-button class=md-raised ng-click=ctrl.closeRouteDialog()>{{\\\"views.map.custom-route.cancel\\\" | translate }}</md-button><md-button class=\\\"md-raised md-primary\\\" ng-disabled=!customRouteForm.$valid ng-click=ctrl.saveCustomRoute()>{{\\\"views.map.custom-route.save\\\" | translate }}</md-button></div></form></div></md-dialog></div></div><div ng-show=ctrl.currentRouteEdit><div id=custom-road-edit-dialog ng-style=\\\"{\\'left\\': ctrl.currentRouteEdit.left, \\'top\\': ctrl.currentRouteEdit.top}\\\"><md-button class=\\\"md-raised md-primary\\\" ng-click=ctrl.deleteCustomRoute()>{{\\\"views.map.custom-route.delete\\\" | translate }}</md-button><md-button class=md-raised ng-click=ctrl.openCustomRouteDialog()>{{\\\"views.map.custom-route.edit\\\" | translate }}</md-button></div></div><!-- QGIS IMPORT DIALOG --><div style=\\\"visibility: hidden\\\"><div class=\\\"md-dialog-container upload-dialog\\\" id=qgis-upload-project-dialog><md-dialog><md-toolbar layout-padding><h2 class=md-title>{{\\\"views.map.qgis.import-title\\\" | translate }}</h2></md-toolbar><md-content layout-padding><div class=sdiv-uploading-zone><input type=file id=qgis-upload-project name=qgisFiles[]></div><i>{{\\\"views.map.qgis.import-files\\\" | translate }}</i><div><md-button class=md-raised ng-click=ctrl.closeUploadQGISDialog()>{{\\\"views.map.qgis.cancel\\\" | translate }}</md-button><md-button class=\\\"md-raised md-primary\\\" ng-click=ctrl.onQGISFileUpload() ng-disabled=!ctrl.saveUploadQGIS>{{\\\"views.map.qgis.upload\\\" | translate }}</md-button></div></md-content></md-dialog></div></div></div>\");\n$templateCache.put(\"app/tsa-views/menu/menu.html\",\"<div layout=column><!-- Toolbar --><div layout=row class=tsa-toolbar><i class=\\\"mdi mdi-24px mdi-{{\\'views.menu.icon\\' | translate }}\\\"></i><p class=title>{{\\\"views.menu.title\\\" | translate }}</p><span flex></span><tsa-settings-button on-change-view=\\\"ctrl.onChangeCardType({type: type})\\\" card-id={{ctrl.cardId}}></tsa-settings-button></div><md-divider></md-divider><!-- Content --><div flex layout=row layout-align=space-around class=tsa-content><pre>\\n            {{ ctrl.menu }}\\n        </pre></div></div>\");\n$templateCache.put(\"app/tsa-views/message/message.html\",\"<meta charset=utf-8><div layout=column><!-- Toolbar --><div layout=row class=tsa-toolbar><i class=\\\"mdi mdi-24px mdi-{{\\'views.message.icon\\' | translate }}\\\"></i><p class=title>{{\\\"views.message.title\\\" | translate }}</p><span flex></span><tsa-settings-button on-change-view=\\\"ctrl.onChangeCardType({type: type})\\\" card-id={{ctrl.cardId}}></tsa-settings-button></div><md-divider></md-divider><div flex layout=column class=tsa-content><p id=content>{{ctrl.lastMessage.message}}</p><md-divider></md-divider><div layout=row><p id=timestamp>{{ctrl.lastMessage.messageTime | date : \\\"dd MMM yyyy - HH:mm:ss\\\" : \\\"+0\\\"}}</p><p id=DefaultUser ng-if=\\\"ctrl.lastMessage.user===\\'user\\'\\\">{{\\'views.message.from\\' | translate }}{{\\'dialog.messaging.user\\' | translate }}</p><p id=user ng-if=\\\"ctrl.lastMessage.user!==\\'user\\'\\\">{{\\'views.message.from\\' | translate }}{{ctrl.lastMessage.user}}</p></div></div></div>\");\n$templateCache.put(\"app/tsa-views/mobile/mobile.html\",\"<div layout=column><!-- Toolbar --><div layout=row class=tsa-toolbar><i class=\\\"mdi mdi-24px mdi-{{\\'views.mobile.icon\\' | translate }}\\\"></i><p class=title>{{\\'views.mobile.title\\' | translate}}</p><p class=device-id ng-show=\\\"ctrl.deviceId != undefined\\\">- {{ctrl.deviceId}}</p><span flex></span><tsa-settings-button on-change-view=\\\"ctrl.onChangeCardType({type: type})\\\" card-id={{ctrl.cardId}}></tsa-settings-button></div><md-divider></md-divider><!-- Data views --><div layout=row style=\\\"height: 24px; margin-left: 12px\\\"><p class=device-id>ROV</p></div><div layout=column class=tsa-content layout-align=\\\"start center\\\"><tsa-data-view data=ctrl.MOBILE.LATITUDE frame-id=ctrl.frameId device-id=ctrl.deviceId opt-title=views.mobile.lat></tsa-data-view><tsa-data-view data=ctrl.MOBILE.LONGITUDE frame-id=ctrl.frameId device-id=ctrl.deviceId opt-title=views.mobile.long></tsa-data-view><tsa-data-view data=ctrl.MOBILE.IMMERSION frame-id=ctrl.frameId device-id=ctrl.deviceId opt-title=views.mobile.imm format=%.2f units=m></tsa-data-view></div><md-divider></md-divider><div layout=row style=\\\"height: 24px; margin-left: 12px\\\"><p class=device-id>LEST</p></div><div layout=column class=tsa-content layout-align=\\\"start center\\\"><tsa-data-view data=ctrl.MOBILE.LATITUDE frame-id=ctrl.frameId device-id=ctrl.lestDeviceId opt-title=views.mobile.lat></tsa-data-view><tsa-data-view data=ctrl.MOBILE.LONGITUDE frame-id=ctrl.frameId device-id=ctrl.lestDeviceId opt-title=views.mobile.long></tsa-data-view><tsa-data-view data=ctrl.MOBILE.IMMERSION frame-id=ctrl.frameId device-id=ctrl.lestDeviceId opt-title=views.mobile.imm format=%.2f units=m></tsa-data-view></div></div>\");\n$templateCache.put(\"app/tsa-views/navigation/navigation.html\",\"<div layout=column><!-- Toolbar --><div layout=row class=tsa-toolbar><i class=\\\"mdi mdi-24px mdi-{{\\'views.navigation.icon\\' | translate }}\\\"></i><p class=title>{{\\\"views.navigation.title\\\" | translate }}</p><p class=device-id>- {{ctrl.deviceId}}</p><span flex></span><tsa-settings-button on-change-view=\\\"ctrl.onChangeCardType({type: type})\\\" card-id={{ctrl.cardId}}></tsa-settings-button></div><md-divider></md-divider><div class=tsa-content layout=column><!-- Lat --><tsa-data-view data=ctrl.latitude frame-id=ctrl.frameId device-id=ctrl.deviceId format=lat opt-title=views.navigation.latitude></tsa-data-view><!-- Longitude --><tsa-data-view data=ctrl.longitude frame-id=ctrl.frameId device-id=ctrl.deviceId format=long opt-title=views.navigation.longitude></tsa-data-view><!-- Heading --><tsa-data-view data=ctrl.heading frame-id=ctrl.frameId device-id=ctrl.deviceId format=%.0f opt-title=views.navigation.heading></tsa-data-view><!-- Sounder --><tsa-data-view data=ctrl.sounder frame-id=ctrl.frameId device-id=ctrl.deviceId format=%.1f opt-title=views.navigation.sounder></tsa-data-view></div><div class=tsa-content layout=row><!-- Info vecteurs vitesses --><div flex=50 class=tsa-content layout=column><div class=tsa-speed-title><h3 class=md-headline>{{\\\"views.navigation.speed-vectors\\\" | translate }}</h3></div><!-- Ground speed vector --><tsa-double-data-view title=views.navigation.ground data1=ctrl.groundCourse frame-id1=ctrl.frameId device-id1=ctrl.deviceId format1=%.0f data2=ctrl.groundSpeed frame-id2=ctrl.frameId device-id2=ctrl.deviceId format2=%.1f></tsa-double-data-view><!-- Surface speed vector --><tsa-double-data-view title=views.navigation.surface data1=ctrl.surfaceCourse frame-id1=ctrl.frameId device-id1=ctrl.deviceId format1=%.0f data2=ctrl.surfaceSpeed frame-id2=ctrl.frameId device-id2=ctrl.deviceId format2=%.1f ng-show=!ctrl.isMD></tsa-double-data-view><!-- Drift speed vector --><tsa-double-data-view title=views.navigation.drift data1=ctrl.driftCourse frame-id1=ctrl.frameId device-id1=ctrl.deviceId format1=%.0f data2=ctrl.driftSpeed frame-id2=ctrl.frameId device-id2=ctrl.deviceId format2=%.1f ng-show=!ctrl.isMD></tsa-double-data-view></div><!-- Info routing --><div flex=50 class=tsa-content layout=column><div class=tsa-speed-title><h3 ng-if=\\\"ctrl.currentMode === ctrl.MODE.NAVIGATION\\\" class=md-headline>{{\\\"views.navigation.profil.title\\\" | translate }}</h3><h3 ng-if=\\\"ctrl.currentMode === ctrl.MODE.STATION\\\" class=md-headline>{{\\\"views.navigation.station.title\\\" | translate }}</h3></div><!-- Previous --><tsa-double-data-view ng-if=\\\"ctrl.currentMode === ctrl.MODE.NAVIGATION\\\" title=views.navigation.profil.previous data1=ctrl.prevCourse frame-id1=ctrl.frameRoutingId device-id1=ctrl.deviceId format1=%.0f data2=ctrl.prevDist frame-id2=ctrl.frameRoutingId device-id2=ctrl.deviceId format2=marineDistance ng-show=!ctrl.isMD></tsa-double-data-view><!-- Current --><tsa-double-data-view ng-if=\\\"ctrl.currentMode === ctrl.MODE.NAVIGATION\\\" title=views.navigation.profil.current data1=ctrl.curCourse frame-id1=ctrl.frameRoutingId device-id1=ctrl.deviceId format1=%.1f data2=ctrl.curDist frame-id2=ctrl.frameRoutingId device-id2=ctrl.deviceId format2=marineDistance ng-show=!ctrl.isMD></tsa-double-data-view><!-- ETA --><tsa-data-view ng-show=!ctrl.isMD ng-if=\\\"ctrl.currentMode === ctrl.MODE.NAVIGATION\\\" data=ctrl.eta frame-id=ctrl.frameRoutingId device-id=ctrl.deviceId format=excelDateNoSec opt-title=views.navigation.profil.etaZ units=\\\"\\\"></tsa-data-view><tsa-double-data-view ng-if=\\\"ctrl.currentMode === ctrl.MODE.STATION\\\" title=views.navigation.station.text data1=ctrl.prevCourse frame-id1=ctrl.frameRoutingId device-id1=ctrl.deviceId format1=%.0f data2=ctrl.prevDist frame-id2=ctrl.frameRoutingId device-id2=ctrl.deviceId format2=%.1f></tsa-double-data-view><!-- Marion --><tsa-data-view ng-show=ctrl.isMD data=ctrl.curDist frame-id=ctrl.frameRoutingId device-id=ctrl.deviceId format=marineDistance opt-title=views.navigation.profil.current></tsa-data-view><tsa-data-view ng-show=ctrl.isMD ng-show=ctrl.statusService.getLocalTimeZoneOffset() ng-if=\\\"ctrl.currentMode === ctrl.MODE.NAVIGATION\\\" data=ctrl.eta frame-id=ctrl.frameRoutingId device-id=ctrl.deviceId format=excelDateNoSecTZ opt-title=views.navigation.profil.eta units=\\\"\\\"></tsa-data-view><tsa-data-view ng-show=ctrl.isMD opt-value=ctrl.currentWptName opt-title=views.navigation.currentWpt format=%s></tsa-data-view></div></div></div>\");\n$templateCache.put(\"app/tsa-views/multibeam/multibeam.html\",\"<div layout=column><!-- Toolbar --><div layout=row class=tsa-toolbar><i class=\\\"mdi mdi-24px mdi-{{\\'views.multibeam.icon\\' | translate }}\\\"></i><p class=title>{{\\\"views.multibeam.title\\\" | translate }}</p><p class=device-id>- {{ctrl.deviceId}}</p><span flex></span><tsa-settings-button on-change-view=\\\"ctrl.onChangeCardType({type: type})\\\" card-id={{ctrl.cardId}}></tsa-settings-button></div><md-divider></md-divider><!-- Content --><div flex layout=column class=tsa-content ng-class=\\\"{\\'data-missing\\': ctrl.dataMissing}\\\"><div flex class=tsa-chart-container><canvas id={{ctrl.canvasId}}></canvas></div><div layout=row layout-align=space-between style=\\\"min-height: 46px\\\"><tsa-data-view flex opt-title=views.multibeam.number opt-value=ctrl.nbValue red-green=true></tsa-data-view><md-divider></md-divider><tsa-data-view flex data=ctrl.pocket frame-id=ctrl.frameId device-id=ctrl.deviceId opt-title=views.multibeam.depth opt-value=ctrl.verticalDepth units=m format=%.1f></tsa-data-view><md-divider></md-divider><tsa-data-view flex opt-title=views.multibeam.swath opt-value=ctrl.swathValue units=m format=%.1f></tsa-data-view></div></div></div>\");\n$templateCache.put(\"app/tsa-views/numerical/numerical.html\",\"<div layout=column><!-- Toolbar --><div layout=row class=tsa-toolbar><i class=\\\"mdi mdi-24px mdi-{{\\'views.numerical.icon\\' | translate }}\\\"></i><p class=title>{{\\\"views.numerical.title\\\" | translate }}</p><span flex></span><md-button ng-if=!numerical.editionMode class=md-icon-button ng-click=\\\"numerical.editionMode = !numerical.editionMode\\\"><md-icon>edit</md-icon><md-tooltip>{{\\\"views.numerical.switch\\\" | translate }}</md-tooltip></md-button><tsa-settings-button on-change-view=\\\"numerical.onChangeCardType({type: type})\\\" card-id={{numerical.cardId}} button-list=numerical.settingsButton></tsa-settings-button></div><md-divider></md-divider><!-- Data list --><div flex class=tsa-content><div class=tsa-numerical-data ng-repeat=\\\"item in numerical.itemList\\\" layout=row layout-align=space-around><div ng-show=numerical.editionMode layout=row style=\\\"width=200px\\\"><md-button class=md-icon-button ng-click=item.up() ng-cloak><md-icon>keyboard_arrow_up</md-icon></md-button><md-button class=md-icon-button ng-click=item.down()><md-icon>keyboard_arrow_down</md-icon></md-button></div><tsa-data-view data=item.dataId frame-id=item.frameId device-id=item.deviceId show-subtitle=true on-update-title=numerical.updateItemTitleCallback(item,title)></tsa-data-view><md-button ng-if=numerical.editionMode class=md-icon-button ng-click=item.remove()><md-icon>delete</md-icon></md-button></div></div><!-- Edition buttons --><div layout=row layout-align=end ng-if=numerical.editionMode class=md-whiteframe-5dp><md-button class=\\\"md-fab md-mini md-primary\\\" ng-click=numerical.addItem()><md-icon>add</md-icon><md-tooltip>{{\\\"Add data\\\" | translate }}</md-tooltip></md-button><md-button class=\\\"md-fab md-mini md-primary\\\" ng-click=\\\"numerical.editionMode = !numerical.editionMode\\\"><md-icon>check</md-icon><md-tooltip>{{\\\"views.numerical.close-edition\\\" | translate }}</md-tooltip></md-button></div></div>\");\n$templateCache.put(\"app/tsa-views/propulsion-at/propulsion-at.html\",\"<meta charset=utf-8><div layout=column><!-- Toolbar --><div layout=row class=tsa-toolbar><i class=\\\"mdi mdi-24px mdi-{{\\'views.propulsion.icon\\' | translate }}\\\"></i><p class=title>{{\\\"views.propulsion.title\\\" | translate }}</p><p class=device-id>- {{ctrl.deviceId}}</p><span flex></span><tsa-settings-button on-change-view=\\\"ctrl.onChangeCardType({type: type})\\\" card-id={{ctrl.cardId}}></tsa-settings-button></div><md-divider></md-divider><!-- Content --><div flex layout=row class=tsa-content><div flex layout=column><canvas id={{ctrl.canvasId}}><p>Error during the display of the canvas (maybe due to the browser version)</p></canvas><!-- Data views --><tsa-data-view class=propulsion id=fronttrans data=ctrl.frontTrans.id frame-id=ctrl.frameId device-id=ctrl.deviceId format=%.0f title-disabled=true units=\\\"\\\" ng-style=\\\"{top:ctrl.frontTrans.y + \\'px\\', left: ctrl.frontTrans.x + \\'px\\'};\\\"></tsa-data-view><tsa-data-view class=propulsion id=frontpropangle data=ctrl.frontPropAngle.id frame-id=ctrl.frameId device-id=ctrl.deviceId format=%.0f title-disabled=true units= ng-style=\\\"{top:ctrl.frontPropAngle.y + \\'px\\', left: ctrl.frontPropAngle.x + \\'px\\'};\\\"></tsa-data-view><tsa-data-view class=propulsion id=mainleft data=ctrl.mainLeft.id frame-id=ctrl.frameId device-id=ctrl.deviceId format=%.0f title-disabled=true units=rpm abs=true ng-style=\\\"{top:ctrl.mainLeft.y + \\'px\\', left: ctrl.mainLeft.x + \\'px\\'};\\\"></tsa-data-view><tsa-data-view class=propulsion id=mainright data=ctrl.mainRight.id frame-id=ctrl.frameId device-id=ctrl.deviceId format=%.0f title-disabled=true units=rpm abs=true ng-style=\\\"{top:ctrl.mainRight.y + \\'px\\', left: ctrl.mainRight.x + \\'px\\'};\\\"></tsa-data-view><tsa-data-view class=propulsion id=angle data=ctrl.angle.id frame-id=ctrl.frameId device-id=ctrl.deviceId format=%.0f title-disabled=true units= redgreen=true abs=true ng-style=\\\"{top:ctrl.angle.y + \\'px\\', left: ctrl.angle.x + \\'px\\'};\\\"></tsa-data-view></div><div flex layout=column><h2 class=sub>{{\\\"views.propulsion.heading\\\" | translate }} :</h2><tsa-data-view class=navigation id=heading data=ctrl.heading.id frame-id=ctrl.navFrameId; device-id=ctrl.navId format=%.0f title-disabled=true units=></tsa-data-view><h2 class=sub>{{\\\"views.propulsion.surfspeed\\\" | translate }} :</h2><div layout=row><div flex layout=column></div><div flex layout=column><tsa-data-view class=navigation opt-value=ctrl.surfNorth units=nd format=%.1f title-disabled=true></tsa-data-view></div><div flex layout=column></div></div><div layout=row><div flex layout=column><tsa-data-view class=navigation opt-value=ctrl.surfWest units=nd format=%.1f title-disabled=true></tsa-data-view></div><div flex layout=column></div><div flex layout=column><tsa-data-view class=navigation opt-value=ctrl.surfEast units=nd format=%.1f title-disabled=true></tsa-data-view></div></div><div layout=row><div flex layout=column></div><div flex layout=column><tsa-data-view class=navigation opt-value=ctrl.surfSouth units=nd format=%.1f title-disabled=true></tsa-data-view></div><div flex layout=column></div></div><h2 class=sub>{{\\\"views.propulsion.gndspeed\\\" | translate }} :</h2><div layout=row><div flex layout=column></div><div flex layout=column><tsa-data-view class=navigation opt-value=ctrl.gndNorth units=nd format=%.1f title-disabled=true></tsa-data-view></div><div flex layout=column></div></div><div layout=row><div flex layout=column><tsa-data-view class=navigation opt-value=ctrl.gndWest units=nd format=%.1f title-disabled=true></tsa-data-view></div><div flex layout=column></div><div flex layout=column><tsa-data-view class=navigation opt-value=ctrl.gndEast units=nd format=%.1f title-disabled=true></tsa-data-view></div></div><div layout=row><div flex layout=column></div><div flex layout=column><tsa-data-view class=navigation opt-value=ctrl.gndSouth units=nd format=%.1f title-disabled=true></tsa-data-view></div><div flex layout=column></div></div></div></div></div>\");\n$templateCache.put(\"app/tsa-views/propulsion-pp/propulsion-pp.html\",\"<meta charset=utf-8><div layout=column><!-- Toolbar --><div layout=row class=tsa-toolbar><i class=\\\"mdi mdi-24px mdi-{{\\'views.propulsion.icon\\' | translate }}\\\"></i><p class=title>{{\\\"views.propulsion.title\\\" | translate }}</p><span flex></span><tsa-settings-button on-change-view=\\\"ctrl.onChangeCardType({type: type})\\\" card-id={{ctrl.cardId}}></tsa-settings-button></div><md-divider></md-divider><!-- Content --><div flex layout=row class=tsa-content><div flex=30><tsa-data-view ng-repeat=\\\"data in ctrl.DA.datas\\\" data=data.dataId frame-id=ctrl.DA.frameId device-id=ctrl.DA.deviceId opt-title=\\\"{{\\'DA \\' + ($index+1)}}\\\" format=%.0f units=kW></tsa-data-view></div><div flex=70><canvas id={{ctrl.canvasId}}><p>Error during the display of the canvas (maybe due to the browser version)</p></canvas><tsa-data-view class=propulsion id=trans1 data=ctrl.PROP_VDR.trans1.id frame-id=ctrl.PROP_VDR.frameId device-id=ctrl.PROP_VDR.deviceId format=%.0f title-disabled=true units=% red-green=true ng-style=\\\"{top:ctrl.PROP_VDR.trans1.y + \\'px\\', left: ctrl.PROP_VDR.trans1.x + \\'px\\'};\\\"></tsa-data-view><tsa-data-view class=propulsion id=trans2 data=ctrl.PROP_VDR.trans2.id frame-id=ctrl.PROP_VDR.frameId device-id=ctrl.PROP_VDR.deviceId format=%.0f title-disabled=true units=% red-green=true ng-style=\\\"{top:ctrl.PROP_VDR.trans2.y + \\'px\\', left: ctrl.PROP_VDR.trans2.x + \\'px\\'};\\\"></tsa-data-view><tsa-data-view class=propulsion id=trans3 data=ctrl.PROP_VDR.trans3.id frame-id=ctrl.PROP_VDR.frameId device-id=ctrl.PROP_VDR.deviceId format=%.0f title-disabled=true units=% red-green=true ng-style=\\\"{top:ctrl.PROP_VDR.trans3.y + \\'px\\', left: ctrl.PROP_VDR.trans3.x + \\'px\\'};\\\"></tsa-data-view><tsa-data-view class=propulsion id=trans4 data=ctrl.PROP_VDR.trans4.id frame-id=ctrl.PROP_VDR.frameId device-id=ctrl.PROP_VDR.deviceId format=%.0f title-disabled=true units=% red-green=true ng-style=\\\"{top:ctrl.PROP_VDR.trans4.y + \\'px\\', left: ctrl.PROP_VDR.trans4.x + \\'px\\'};\\\"></tsa-data-view><tsa-data-view class=propulsion id=rudderPort data=ctrl.PROP_VDR.portRudder.id frame-id=ctrl.PROP_VDR.frameId device-id=ctrl.PROP_VDR.deviceId format=%.0f title-disabled=true units= red-green=true ng-style=\\\"{top:ctrl.PROP_VDR.portRudder.y + \\'px\\', left: ctrl.PROP_VDR.portRudder.x + \\'px\\'};\\\"></tsa-data-view><tsa-data-view class=propulsion id=rudderStarboard data=ctrl.PROP_VDR.starboardRudder.id frame-id=ctrl.PROP_VDR.frameId device-id=ctrl.PROP_VDR.deviceId format=%.0f title-disabled=true units= red-green=true ng-style=\\\"{top:ctrl.PROP_VDR.starboardRudder.y + \\'px\\', left: ctrl.PROP_VDR.starboardRudder.x + \\'px\\'};\\\"></tsa-data-view><tsa-data-view class=propulsion id=portMain data=ctrl.PROP_ENGINE.portMain.id frame-id=ctrl.PROP_ENGINE.frameId device-id=ctrl.PROP_ENGINE.deviceId format=%.0f title-disabled=true units=\\\"\\\" ng-style=\\\"{top:ctrl.PROP_ENGINE.portMain.y + \\'px\\', left: ctrl.PROP_ENGINE.portMain.x + \\'px\\'};\\\"></tsa-data-view><tsa-data-view class=propulsion id=starboardMain data=ctrl.PROP_ENGINE.starboardMain.id frame-id=ctrl.PROP_ENGINE.frameId device-id=ctrl.PROP_ENGINE.deviceId format=%.0f title-disabled=true units=\\\"\\\" ng-style=\\\"{top:ctrl.PROP_ENGINE.starboardMain.y + \\'px\\', left: ctrl.PROP_ENGINE.starboardMain.x + \\'px\\'};\\\"></tsa-data-view></div></div><!-- <canvas id={{ctrl.canvasId}}>\\n                <p>Error during the display of the canvas (maybe due to the browser version)</p>\\n            </canvas> --><!-- Data views --><!-- <tsa-data-view\\n                class=\\\"propulsion\\\"\\n                id=\\\"frontpropangle\\\"\\n                data=ctrl.frontPropAngle.id\\n                frame-id=ctrl.frameId\\n                device-id=ctrl.deviceId\\n                format=\\\"%.0f\\\"\\n                title-disabled=\\\"true\\\"\\n                units=\\\"\\\"\\n                ng-style=\\\"{top:ctrl.frontPropAngle.y + \\'px\\', left: ctrl.frontPropAngle.x + \\'px\\'};\\\">\\n            </tsa-data-view>\\n\\n            <tsa-data-view\\n                class=\\\"propulsion\\\"\\n                id=\\\"mainleft\\\"\\n                data=ctrl.mainLeft.id\\n                frame-id=ctrl.frameId\\n                device-id=ctrl.deviceId\\n                format=\\\"%.0f\\\"\\n                title-disabled=\\\"true\\\"\\n                units=\\\"rpm\\\"\\n                abs=\\\"true\\\"\\n                ng-style=\\\"{top:ctrl.mainLeft.y + \\'px\\', left: ctrl.mainLeft.x + \\'px\\'};\\\">\\n            </tsa-data-view>\\n\\n            <tsa-data-view\\n                class=\\\"propulsion\\\"\\n                id=\\\"mainright\\\"\\n                data=ctrl.mainRight.id\\n                frame-id=ctrl.frameId\\n                device-id=ctrl.deviceId\\n                format=\\\"%.0f\\\"\\n                title-disabled=\\\"true\\\"\\n                units=\\\"rpm\\\"\\n                abs=\\\"true\\\"\\n                ng-style=\\\"{top:ctrl.mainRight.y + \\'px\\', left: ctrl.mainRight.x + \\'px\\'};\\\">\\n            </tsa-data-view>\\n\\n            <tsa-data-view\\n                class=\\\"propulsion\\\"\\n                id=\\\"angle\\\"\\n                data=ctrl.angle.id\\n                frame-id=ctrl.frameId\\n                device-id=ctrl.deviceId\\n                format=\\\"%.0f\\\"\\n                title-disabled=\\\"true\\\"\\n                units=\\\"\\\"\\n                redGreen=\\\"true\\\"\\n                abs=\\\"true\\\"\\n                ng-style=\\\"{top:ctrl.angle.y + \\'px\\', left: ctrl.angle.x + \\'px\\'};\\\">\\n            </tsa-data-view>\\n        </div>\\n\\n        <div flex layout=\\\"column\\\">\\n            <h2 class=\\\"sub\\\">{{\\\"views.propulsion.heading\\\" | translate }} :</h2>\\n            <tsa-data-view\\n                class=\\\"navigation\\\"\\n                id=\\\"heading\\\"\\n                data=ctrl.heading.id\\n                frame-id=ctrl.navFrameId;\\n                device-id=ctrl.navId\\n                format=\\\"%.0f\\\"\\n                title-disabled=\\\"true\\\"\\n                units=\\\"\\\">\\n            </tsa-data-view>\\n            <h2 class=\\\"sub\\\">{{\\\"views.propulsion.surfspeed\\\" | translate }} :</h2>\\n            <div layout=\\\"row\\\">\\n                <div flex layout=\\\"column\\\">\\n                </div>\\n                <div flex layout=\\\"column\\\">\\n                    <tsa-data-view\\n                        class=\\\"navigation\\\"\\n                        opt-value=ctrl.surfNorth\\n                        units=\\\"nd\\\"\\n                        format=\\\"%.1f\\\"\\n                        title-disabled=\\\"true\\\">\\n                    </tsa-data-view>\\n                </div>\\n                <div flex layout=\\\"column\\\">\\n                </div>\\n            </div>\\n            <div layout=\\\"row\\\">\\n                <div flex layout=\\\"column\\\">\\n                    <tsa-data-view\\n                        class=\\\"navigation\\\"\\n                        opt-value=ctrl.surfWest\\n                        units=\\\"nd\\\"\\n                        format=\\\"%.1f\\\"\\n                        title-disabled=\\\"true\\\">\\n                    </tsa-data-view>\\n                </div>\\n                <div flex layout=\\\"column\\\">\\n                </div>\\n                <div flex layout=\\\"column\\\">\\n                    <tsa-data-view\\n                        class=\\\"navigation\\\"\\n                        opt-value=ctrl.surfEast\\n                        units=\\\"nd\\\"\\n                        format=\\\"%.1f\\\"\\n                        title-disabled=\\\"true\\\">\\n                    </tsa-data-view>\\n                </div>\\n            </div>\\n            <div layout=\\\"row\\\">\\n                <div flex layout=\\\"column\\\">\\n                </div>\\n                <div flex layout=\\\"column\\\">\\n                    <tsa-data-view\\n                        class=\\\"navigation\\\"\\n                        opt-value=ctrl.surfSouth\\n                        units=\\\"nd\\\"\\n                        format=\\\"%.1f\\\"\\n                        title-disabled=\\\"true\\\">\\n                    </tsa-data-view>\\n                </div>\\n                <div flex layout=\\\"column\\\">\\n                </div>\\n            </div>\\n\\n            <h2 class=\\\"sub\\\">{{\\\"views.propulsion.gndspeed\\\" | translate }} :</h2>\\n            <div layout=\\\"row\\\">\\n                <div flex layout=\\\"column\\\">\\n                </div>\\n                <div flex layout=\\\"column\\\">\\n                    <tsa-data-view\\n                        class=\\\"navigation\\\"\\n                        opt-value=ctrl.gndNorth\\n                        units=\\\"nd\\\"\\n                        format=\\\"%.1f\\\"\\n                        title-disabled=\\\"true\\\">\\n                    </tsa-data-view>\\n                </div>\\n                <div flex layout=\\\"column\\\">\\n                </div>\\n            </div>\\n            <div layout=\\\"row\\\">\\n                <div flex layout=\\\"column\\\">\\n                    <tsa-data-view\\n                        class=\\\"navigation\\\"\\n                        opt-value=ctrl.gndWest\\n                        units=\\\"nd\\\"\\n                        format=\\\"%.1f\\\"\\n                        title-disabled=\\\"true\\\">\\n                    </tsa-data-view>\\n                </div>\\n                <div flex layout=\\\"column\\\">\\n                </div>\\n                <div flex layout=\\\"column\\\">\\n                    <tsa-data-view\\n                        class=\\\"navigation\\\"\\n                        opt-value=ctrl.gndEast\\n                        units=\\\"nd\\\"\\n                        format=\\\"%.1f\\\"\\n                        title-disabled=\\\"true\\\">\\n                    </tsa-data-view>\\n                </div>\\n            </div>\\n            <div layout=\\\"row\\\">\\n                <div flex layout=\\\"column\\\">\\n                </div>\\n                <div flex layout=\\\"column\\\">\\n                    <tsa-data-view\\n                        class=\\\"navigation\\\"\\n                        opt-value=ctrl.gndSouth\\n                        units=\\\"nd\\\"\\n                        format=\\\"%.1f\\\"\\n                        title-disabled=\\\"true\\\">\\n                    </tsa-data-view>\\n                </div>\\n                <div flex layout=\\\"column\\\">\\n                </div>\\n            </div>\\n        </div> --></div>\");\n$templateCache.put(\"app/tsa-views/propulsion-tl/propulsion-tl.html\",\"<meta charset=utf-8><div layout=column><!-- Toolbar --><div layout=row class=tsa-toolbar><i class=\\\"mdi mdi-24px mdi-{{\\'views.propulsion.icon\\' | translate }}\\\"></i><p class=title>{{\\\"views.propulsion.title\\\" | translate }}</p><p class=device-id>- {{ctrl.deviceId}}</p><span flex></span><tsa-settings-button on-change-view=\\\"ctrl.onChangeCardType({type: type})\\\" card-id={{ctrl.cardId}}></tsa-settings-button></div><md-divider></md-divider><!-- Content --><div flex layout=column layout-align=space-around><tsa-data-view id=gene1 data=ctrl.gene1.id frame-id=ctrl.frameId device-id=ctrl.deviceId format=%.0f title-disabled=false units=kW abs=true ng-style=\\\"{top:ctrl.gene1.y + \\'px\\', left: ctrl.gene1.x + \\'px\\'}\\\"></tsa-data-view><tsa-data-view id=gene2 data=ctrl.gene2.id frame-id=ctrl.frameId device-id=ctrl.deviceId format=%.0f title-disabled=false units=kW abs=true ng-style=\\\"{top:ctrl.gene2.y + \\'px\\', left: ctrl.gene2.x + \\'px\\'}\\\"></tsa-data-view><tsa-data-view id=gene3 data=ctrl.gene3.id frame-id=ctrl.frameId device-id=ctrl.deviceId format=%.0f title-disabled=false units=kW abs=true ng-style=\\\"{top:ctrl.gene3.y + \\'px\\', left: ctrl.gene3.x + \\'px\\'}\\\"></tsa-data-view><tsa-data-view id=gene4 data=ctrl.gene4.id frame-id=ctrl.frameId device-id=ctrl.deviceId format=%.0f title-disabled=false units=kW abs=true ng-style=\\\"{top:ctrl.gene4.y + \\'px\\', left: ctrl.gene4.x + \\'px\\'}\\\"></tsa-data-view><canvas id={{ctrl.canvasId}} class=ship><p>Error during the display of the canvas (maybe due to the browser version)</p></canvas><!-- Data views --><tsa-data-view id=fronttrans data=ctrl.frontTrans.id frame-id=ctrl.frameId device-id=ctrl.deviceId format=%.0f title-disabled=true units=\\\"\\\" abs=true ng-style=\\\"{top:ctrl.frontTrans.y + \\'px\\', left: ctrl.frontTrans.x + \\'px\\'}\\\"></tsa-data-view><tsa-data-view id=reartrans data=ctrl.rearTrans.id frame-id=ctrl.frameId device-id=ctrl.deviceId format=%.0f title-disabled=true units=\\\"\\\" abs=true ng-style=\\\"{top:ctrl.rearTrans.y + \\'px\\', left: ctrl.rearTrans.x + \\'px\\'};\\\"></tsa-data-view><tsa-data-view id=main data=ctrl.main.id frame-id=ctrl.frameId device-id=ctrl.deviceId format=%.0f title-disabled=true units=rpm abs=true ng-style=\\\"{top:ctrl.main.y + \\'px\\', left: ctrl.main.x + \\'px\\'};\\\"></tsa-data-view><tsa-data-view id=angle data=ctrl.angle.id frame-id=ctrl.frameId device-id=ctrl.deviceId format=%.0f title-disabled=true units= redgreen=true abs=true ng-style=\\\"{top:ctrl.angle.y + \\'px\\', left: ctrl.angle.x + \\'px\\'};\\\"></tsa-data-view></div></div>\");\n$templateCache.put(\"app/tsa-views/route/route.html\",\"<div layout=column><!-- Toolbar --><div layout=row class=tsa-toolbar><i class=\\\"mdi mdi-24px mdi-{{\\'views.route.icon\\' | translate }}\\\"></i><p class=title>{{\\\"views.route.title\\\" | translate }}</p><span flex></span><tsa-settings-button on-change-view=\\\"ctrl.onChangeCardType({type: type})\\\" card-id={{ctrl.cardId}}></tsa-settings-button></div><md-divider></md-divider><!-- Content --><div flex class=tsa-content layout=column><!-- Route table --><div flex layout=column class=tsa-table><div layout=row class=\\\"title tsa-table-title\\\"><p flex ng-repeat=\\\"column in ctrl.header\\\">{{ column | translate }}</p></div><div class=tsa-table-content ng-show=!ctrl.ready>Loading...</div><div class=tsa-table-content ng-show=ctrl.ready><div id={{wpt.name}} flex layout=row ng-repeat=\\\"wpt in ctrl.route\\\"><p flex>{{ wpt.name }}</p><p flex>{{ wpt.type }}</p><p flex>{{ wpt.eta && (wpt.eta | date: \\\"dd/MM HH:mm\\\" : ctrl.statusService.getLocalTimeZoneOffset()) || \\'\\' }}</p><p flex>{{ wpt.duration && (wpt.duration | timeInHoursMins) || \\'\\'}}</p><!-- <p flex>{{ wpt.duration && (wpt.duration | date: \\\"HH:mm\\\" : \\'UTC\\') || \\'\\'}}</p> --><p flex>{{ wpt.etanext && (wpt.etanext | date: \\\"dd/MM HH:mm\\\" : ctrl.statusService.getLocalTimeZoneOffset()) || \\'\\' }}</p><p flex>{{ wpt.distance && (wpt.distance | marineDistance) || \\'\\' }}</p><p flex>{{ wpt.time && (wpt.time | timeInHoursMins) || \\'\\'}}</p><!-- <p flex>{{ wpt.time && (wpt.time | date: \\\"HH:mm\\\" : \\'UTC\\') || \\'\\'}}</p> --></div></div></div></div></div>\");\n$templateCache.put(\"app/tsa-views/species/species.html\",\"<div layout=column><!-- Toolbar --><div layout=row class=tsa-toolbar><i class=\\\"mdi mdi-24px mdi-{{\\'views.species.icon\\' | translate }}\\\"></i><p class=title>{{\\\"views.species.title\\\" | translate }}</p><p class=device-id>- {{ctrl.deviceId}}</p><span flex></span><tsa-settings-button on-change-view=\\\"ctrl.onChangeCardType({type: type})\\\" card-id={{ctrl.cardId}}></tsa-settings-button></div><md-divider></md-divider><!-- Content --><div flex layout=column class=tsa-content><div layout=row style=\\\"min-height: 46px\\\"><tsa-data-view flex=33 data=ctrl.haul frame-id=ctrl.frameId device-id=ctrl.deviceId opt-title=views.haul-composition.haul></tsa-data-view><md-divider></md-divider><tsa-data-view flex=33 data=ctrl.pocket frame-id=ctrl.frameId device-id=ctrl.deviceId opt-title=views.haul-composition.pocket></tsa-data-view><md-divider></md-divider><tsa-data-view flex=33 data=ctrl.totalPocket frame-id=ctrl.frameId device-id=ctrl.deviceId opt-title=views.haul-composition.total-pocket></tsa-data-view></div><md-divider></md-divider><tsa-data-view data=ctrl.speciesId frame-id=ctrl.frameId device-id=ctrl.deviceId opt-title=views.species.species-rubbin-code></tsa-data-view><tsa-data-view data=ctrl.sign frame-id=ctrl.frameId device-id=ctrl.deviceId opt-title=views.species.sign></tsa-data-view><md-divider></md-divider><tsa-data-view data=ctrl.box frame-id=ctrl.frameId device-id=ctrl.deviceId opt-title=views.species.box-type></tsa-data-view><tsa-data-view data=ctrl.boxWeight frame-id=ctrl.frameId device-id=ctrl.deviceId opt-title=views.haul-composition.weight></tsa-data-view><tsa-data-view data=ctrl.boxDest frame-id=ctrl.frameId device-id=ctrl.deviceId opt-title=views.species.destination></tsa-data-view><md-divider></md-divider><tsa-data-view data=ctrl.totalSpecies frame-id=ctrl.frameId device-id=ctrl.deviceId opt-title=views.species.total-species></tsa-data-view><tsa-data-view data=ctrl.totalSorted frame-id=ctrl.frameId device-id=ctrl.deviceId opt-title=views.species.total-sorted></tsa-data-view></div></div>\");\n$templateCache.put(\"app/tsa-views/thermoConfig/thermoConfig.html\",\"<md-content style=\\\"height: 100%\\\" layout=column ng-init=ctrl.init() ng-switch=ctrl.view class=tsa-thermo-config><!-- Nav bar --><md-nav-bar md-selected-nav-item=ctrl.view style=\\\"padding-right: 30px\\\" class=tsa-thermo-config><md-nav-item md-nav-click=\\\"ctrl.view=\\'General\\'\\\" name=General>General</md-nav-item><md-nav-item md-nav-click=\\\"ctrl.view=\\'Temperature\\'\\\" name=Temperature>Temperature</md-nav-item><md-nav-item md-nav-click=\\\"ctrl.view=\\'Conductivity\\'\\\" name=Conductivity>Conductivity</md-nav-item><md-nav-item md-nav-click=\\\"ctrl.view=\\'Intake Temperature\\'\\\" name=\\\"Intake Temperature\\\">Intake Temperature</md-nav-item></md-nav-bar><!-- Settings button --><tsa-settings-button class=tsa-thermo-config on-change-view=\\\"ctrl.onChangeCardType({type: type})\\\" card-id={{ctrl.cardId}}></tsa-settings-button><!-- DEVICES tab --><md-content ng-switch-when=General flex layout=column><!--Device list title and legends --><md-divider></md-divider><div style=\\\"margin-left: 10px\\\" layout=row layout-align=\\\"center center\\\"><md-button class=\\\"md-raised md-primary\\\"><label for=file-input>Select a SEABIRD file</label></md-button><input id=file-input type=file nv-file-select uploader=ctrl.uploader style=display:none></div><ul><li ng-repeat=\\\"item in ctrl.uploader.queue\\\">Name: <span ng-bind=item.file.name></span><md-button class=\\\"md-raised md-primary\\\" ng-click=item.upload()>Upload</md-button></li></ul><md-divider></md-divider><!--Device list --><md-content><md-list flex style=\\\"padding: 0px\\\"><md-list-item class=md-2-line ng-click=null style=\\\"padding: 0px\\\" layout-align=\\\"center center\\\"><div flex=60 class=md-list-item-text><h3>Sensor Name</h3></div><div flex=30 layout=row><p>{{ctrl.instrument.name}}</p></div><span flex=5></span><md-divider></md-divider></md-list-item></md-list></md-content></md-content><!--TOPICS tab --><md-content ng-switch-when=Temperature layout=column><md-list flex style=\\\"padding: 0px\\\"><md-list-item class=md-2-line ng-click=null style=\\\"padding: 0px\\\" layout-align=\\\"center center\\\" ng-repeat=\\\"(key, value) in ctrl.temperatureSensor\\\"><div flex=80 class=md-list-item-text><h3>{{key}}</h3></div><div flex=10 layout=row><p>{{value}}</p></div><span flex=5></span><md-divider></md-divider></md-list-item></md-list></md-content><!--TOPICS tab --><md-content ng-switch-when=Conductivity layout=column><md-list flex style=\\\"padding: 0px\\\"><md-list-item class=md-2-line ng-click=null style=\\\"padding: 0px\\\" layout-align=\\\"center center\\\" ng-repeat=\\\"(key, value) in ctrl.conductivitySensor\\\"><div flex=80 class=md-list-item-text><h3>{{key}}</h3></div><div flex=10 layout=row><p>{{value}}</p></div><span flex=5></span><md-divider></md-divider></md-list-item></md-list></md-content><!--TOPICS tab --><md-content ng-switch-when=\\\"Intake Temperature\\\" layout=column><md-list flex style=\\\"padding: 0px\\\"><md-list-item class=md-2-line ng-click=null style=\\\"padding: 0px\\\" layout-align=\\\"center center\\\" ng-repeat=\\\"(key, value) in ctrl.intakeTemperatureSensor\\\"><div flex=80 class=md-list-item-text><h3>{{key}}</h3></div><div flex=10 layout=row><p>{{value}}</p></div><span flex=5></span><md-divider></md-divider></md-list-item></md-list></md-content></md-content>\");\n$templateCache.put(\"app/tsa-views/thermometer/thermometer.html\",\"<div layout=column><!-- Toolbar --><div layout=row class=tsa-toolbar><i class=\\\"mdi mdi-24px mdi-{{\\'views.thermometer.icon\\' | translate }}\\\"></i><p class=title>{{\\\"views.thermometer.title\\\" | translate }}</p><p class=device-id>- {{ctrl.deviceId}}</p><span flex></span><tsa-settings-button on-change-view=\\\"ctrl.onChangeCardType({type: type})\\\" card-id={{ctrl.cardId}}></tsa-settings-button></div><md-divider></md-divider><!-- Content --><div flex layout=column class=tsa-content layout-align=\\\"center center\\\"><tsa-data-view data=ctrl.THERMOMETER.TEMPERATURE frame-id=ctrl.frameId device-id=ctrl.deviceId opt-title=views.thermometer.temperature format=%.2f units=C></tsa-data-view></div></div>\");\n$templateCache.put(\"app/tsa-views/thermosal/thermosal.html\",\"<div layout=column><!-- Toolbar --><div layout=row class=tsa-toolbar><i class=\\\"mdi mdi-24px mdi-{{\\'views.thermosal.icon\\' | translate }}\\\"></i><p class=title>{{\\\"views.thermosal.title\\\" | translate }}</p><p class=device-id>- {{ctrl.deviceId}}</p><span flex></span><tsa-settings-button on-change-view=\\\"ctrl.onChangeCardType({type: type})\\\" card-id={{ctrl.cardId}}></tsa-settings-button></div><md-divider></md-divider><div class=tsa-content layout=column><!-- Tank temp --><tsa-data-view data=ctrl.TS.TANK_TEMP frame-id=ctrl.frameId device-id=ctrl.deviceId format=%.3f units=C opt-title=views.thermosal.tank-temp></tsa-data-view><!-- Temperature --><tsa-data-view data=ctrl.TS.TEMP frame-id=ctrl.frameId device-id=ctrl.deviceId format=%.3f units=C opt-title=views.thermosal.temp></tsa-data-view><!-- Salinity --><tsa-data-view data=ctrl.TS.SALINITY frame-id=ctrl.frameId device-id=ctrl.deviceId format=%.3f units=PSU opt-title=views.thermosal.salinity></tsa-data-view><!-- Anomaly --><tsa-data-view data=ctrl.TS.ANOMALY frame-id=ctrl.frameId device-id=ctrl.deviceId format=%.3f units=kg/m opt-title=views.thermosal.anomaly></tsa-data-view><!-- Sound speed --><tsa-data-view data=ctrl.TS.SOUND_SPEED frame-id=ctrl.frameId device-id=ctrl.deviceId format=%.1f units=m/s opt-title=views.thermosal.sound-speed></tsa-data-view><!-- Conductivity --><tsa-data-view data=ctrl.TS.CONDUCTIVITY frame-id=ctrl.frameId device-id=ctrl.deviceId format=%.2f units=S/m opt-title=views.thermosal.conductivity></tsa-data-view><!-- Flow --><tsa-data-view data=ctrl.TS.FLOW frame-id=ctrl.TS.FRAME_FLOW device-id=ctrl.flowDeviceId format=%.2f units=l/mn alert-value=0.5 opt-title=views.thermosal.flow></tsa-data-view></div></div>\");\n$templateCache.put(\"app/tsa-views/trawl/trawl.html\",\"<div layout=column><!-- Toolbar --><div layout=row class=tsa-toolbar><i class=\\\"mdi mdi-24px mdi-{{\\'views.trawl.icon\\' | translate }}\\\"></i><p class=title>{{\\\"views.trawl.title\\\" | translate }}</p><p class=device-id>- {{ctrl.deviceId}}</p><span flex></span><tsa-settings-button on-change-view=\\\"ctrl.onChangeCardType({type: type})\\\" card-id={{ctrl.cardId}}></tsa-settings-button></div><md-divider></md-divider><div flex layout=column class=tsa-content><div class=canvas flex layout=column><!-- Wind canvas --><canvas flex id={{ctrl.canvasId}}><p>Error during the display of the canvas (maybe due to the browser version)</p></canvas><!-- Data views --><tsa-data-view data=ctrl.horSpread.id frame-id=ctrl.frameId device-id=ctrl.deviceId format=%.1f units=m title-disabled=true ng-style=\\\"{top:ctrl.horSpread.y + \\'px\\', left: ctrl.horSpread.x + \\'px\\'};\\\"></tsa-data-view><!--opt-title=\\\"Hori. spread\\\"--><tsa-data-view data=ctrl.verSpread.id frame-id=ctrl.frameId device-id=ctrl.deviceId format=%.1f units=m title-disabled=true ng-style=\\\"{top:ctrl.verSpread.y + \\'px\\', left: ctrl.verSpread.x + \\'px\\'};\\\"></tsa-data-view><!--opt-title=\\\"Vert. spread\\\"--><tsa-data-view data=ctrl.doorDistance.id frame-id=ctrl.frameId device-id=ctrl.deviceId format=%.1f units=m title-disabled=true ng-style=\\\"{top:ctrl.doorDistance.y + \\'px\\', left: ctrl.doorDistance.x + \\'px\\'};\\\"></tsa-data-view><!--opt-title=\\\"Door dist.\\\"--><tsa-data-view data=ctrl.clearance.id frame-id=ctrl.frameId device-id=ctrl.deviceId format=%.1f units=m title-disabled=true ng-style=\\\"{top:ctrl.clearance.y + \\'px\\', left: ctrl.clearance.x + \\'px\\'};\\\"></tsa-data-view><!--opt-title=\\\"Clearance\\\"--><tsa-data-view data=ctrl.immersion.id frame-id=ctrl.frameId device-id=ctrl.deviceId format=%.1f units=m title-disabled=true ng-style=\\\"{top:ctrl.immersion.y + \\'px\\', left: ctrl.immersion.x + \\'px\\'};\\\"></tsa-data-view><!--opt-title=\\\"Immersion\\\"--><tsa-data-view data=ctrl.altitude.id frame-id=ctrl.frameId device-id=ctrl.deviceId format=%.1f units=m title-disabled=true ng-style=\\\"{top:ctrl.altitude.y + \\'px\\', left: ctrl.altitude.x + \\'px\\'};\\\"></tsa-data-view><!--opt-title=\\\"Altitude\\\"--></div><div layout=row><tsa-data-view flex=50 class=temp data=ctrl.temp frame-id=ctrl.frameId device-id=ctrl.deviceId format=%.1f units= opt-title=views.trawl.water-temp></tsa-data-view><md-divider></md-divider><tsa-data-view flex=50 class=sounder data=ctrl.sounder.data frame-id=ctrl.sounder.frameId device-id=ctrl.sounder.deviceId format=%.1f units=m opt-title=views.trawl.sounder></tsa-data-view></div></div></div>\");\n$templateCache.put(\"app/tsa-views/trawling/trawling.html\",\"<div layout=column><!-- Toolbar --><div layout=row class=tsa-toolbar><i class=\\\"mdi mdi-24px mdi-{{\\'views.trawling.icon\\' | translate }}\\\"></i><p class=title>{{\\\"views.trawling.title\\\" | translate }}</p><p class=device-id>- {{ctrl.deviceId}}</p><span flex></span><tsa-settings-button on-change-view=\\\"ctrl.onChangeCardType({type: type})\\\" card-id={{ctrl.cardId}}></tsa-settings-button></div><md-divider></md-divider><div flex=40 layout=row class=tsa-content><div flex=20 layout=column class=tsa-content><md-button class=\\\"md-raised md-primary\\\" ng-disabled=\\\"(ctrl.isAcquiring || (!(ctrl.currentUserProvider.currentUser.login === \\'admin\\') && !(ctrl.currentUserProvider.currentUser.login === \\'europe\\')))\\\" ng-click=ctrl.startAcquire()>START <img class=logo-image src=resources/images/icons/garnstart.png></md-button><md-button class=\\\"md-raised md-primary\\\" ng-disabled=\\\"(!ctrl.isAcquiring || (!(ctrl.currentUserProvider.currentUser.login === \\'admin\\') && !(ctrl.currentUserProvider.currentUser.login === \\'europe\\')))\\\" ng-click=ctrl.stopAcquire()>STOP <img class=logo-image src=resources/images/icons/garnstopp.png></md-button></div><div flex=30 layout=column class=tsa-content><p ng-show=\\\"(ctrl.currentUserProvider.currentUser.login !== \\'admin\\')\\\"><i>You need to be logged as admin or europe</i></p></div><fieldset flex=50><legend>Distances</legend><div flex layout=column class=tsa-content><!-- Data views --><tsa-data-view opt-title=\\\"Dist. ligne droite \\\" data=ctrl.distance_straight.id frame-id=ctrl.frameId device-id=ctrl.deviceId format=%.3f units=NM title-disabled=false></tsa-data-view><tsa-data-view opt-title=\\\"Dist. parcourue \\\" data=ctrl.distance_real.id frame-id=ctrl.frameId device-id=ctrl.deviceId format=%.3f units=NM title-disabled=false></tsa-data-view><tsa-data-view opt-title=\\\"Ratio (/)\\\" data=ctrl.ratio.id frame-id=ctrl.frameId device-id=ctrl.deviceId format=%.1f units=% title-disabled=false></tsa-data-view></div></fieldset></div><div flex=60 layout=row class=tsa-content><fieldset flex><legend>Valeurs moyennes chalut</legend><tsa-data-view opt-title=OHM opt-value=ctrl.horspread_mean opt-subtitle=ctrl.horspread_mean_nb show-subtitle=true format=%.1f units=m title-disabled=false></tsa-data-view><tsa-data-view opt-title=OVM opt-value=ctrl.verspread_mean opt-subtitle=ctrl.verspread_mean_nb show-subtitle=true format=%.1f units=m title-disabled=false></tsa-data-view><tsa-data-view opt-title=Altitude opt-value=ctrl.altitude_mean opt-subtitle=ctrl.altitude_mean_nb show-subtitle=true format=%.1f units=m title-disabled=false></tsa-data-view></fieldset><fieldset flex><legend>Valeurs moyennes treuil</legend><div flex layout=column class=tsa-content><!-- Data views --><tsa-data-view opt-title=\\\"longueur tribord\\\" opt-value=ctrl.starboardunwound_mean opt-subtitle=ctrl.starboardunwound_mean_nb show-subtitle=true format=%.1f units=m title-disabled=false></tsa-data-view><tsa-data-view opt-title=\\\"longueur babord\\\" opt-value=ctrl.portunwound_mean opt-subtitle=ctrl.portunwound_mean_nb show-subtitle=true format=%.1f units=m title-disabled=false></tsa-data-view></div></fieldset><div flex layout=column class=tsa-content><!-- Data views --><tsa-data-view data=ctrl.comment.id frame-id=ctrl.frameId device-id=ctrl.deviceId format=%s title-disabled=true></tsa-data-view><tsa-data-view data=ctrl.lat.id frame-id=ctrl.frameId device-id=ctrl.deviceId format=%.1f title-disabled=true></tsa-data-view><!--opt-title=\\\"Hori. spread\\\"--><tsa-data-view data=ctrl.lon.id frame-id=ctrl.frameId device-id=ctrl.deviceId format=%.1f title-disabled=true></tsa-data-view><!--opt-title=\\\"Vert. spread\\\"--><!--opt-title=\\\"Altitude\\\"--></div></div></div>\");\n$templateCache.put(\"app/tsa-views/video/video.html\",\"<div layout=column><!-- Toolbar --><div layout=row class=tsa-toolbar><i class=\\\"mdi mdi-24px mdi-video\\\"></i><p class=title>Video</p><p class=device-id>- {{ctrl.title | translate }}</p><span flex></span><tsa-settings-button on-change-view=\\\"ctrl.onChangeCardType({type: type})\\\" card-id={{ctrl.cardId}}></tsa-settings-button></div><md-divider></md-divider><!-- Content --><div flex layout=column layout-align=\\\"center center\\\" class=tsa-content id={{ctrl.videoId}}></div></div>\");\n$templateCache.put(\"app/tsa-views/videoCall/videoCall.html\",\"<div layout=column><!-- Toolbar --><div layout=row class=tsa-toolbar><i class=\\\"mdi mdi-24px mdi-video\\\"></i><p class=title>{{\\\"views.video-call.title\\\" | translate }}</p><span flex></span><!-- {{ ctrl.videoCallState.state }}\\n        {{ ctrl.videoCallState.currentUser.login }} --><md-button class=md-icon-button ng-click=ctrl.hangup() ng-show=\\\"ctrl.videoCallState.state > 1\\\"><md-icon class=material-icons>call_end</md-icon><md-tooltip>{{\\\"views.video-call.hangup\\\" | translate }}</md-tooltip></md-button><md-button class=md-icon-button ng-class=\\\"\\\" ng-click=ctrl.toggleVideo() ng-show=\\\"ctrl.videoCallState.state > 1\\\"><md-icon class=material-icons>{{ ctrl.disableVideo ? \\\"videocam_off\\\" : \\\"videocam\\\"}}</md-icon><md-tooltip>{{\\\"views.video-call.disableVideo\\\" | translate }}</md-tooltip></md-button><md-button class=md-icon-button ng-class=\\\"\\\" ng-click=ctrl.toggleAudio() ng-show=\\\"ctrl.videoCallState.state > 1\\\"><md-icon class=material-icons>{{ ctrl.disableAudio ? \\\"mic_off\\\" : \\\"mic\\\"}}</md-icon><md-tooltip>{{\\\"views.video-call.disableAudio\\\" | translate }}</md-tooltip></md-button><tsa-settings-button on-change-view=\\\"ctrl.onChangeCardType({type: type})\\\" card-id={{ctrl.cardId}}></tsa-settings-button></div><md-divider></md-divider><!-- Content --><div flex layout=column layout-align=\\\"center center\\\" class=tsa-content id={{ctrl.parentId}}><!-- No user --><div class=full ng-if=\\\"ctrl.videoCallState.state == 0\\\">You are not connected</div><div class=full ng-if=\\\"(ctrl.videoCallState.state == 1) && (ctrl.videoCallState.userList.length == 0)\\\">No user connected</div><div class=full ng-show=\\\"(ctrl.videoCallState.state == 1) && (ctrl.videoCallState.userList.length > 0)\\\"><table><tr ng-repeat=\\\"username in ctrl.videoCallState.userList\\\"><td>{{ username }}</td><td><md-button class=md-icon-button ng-click=ctrl.videoCall(username)><md-icon class=material-icons>call</md-icon><md-tooltip>{{\\\"views.video-call.call\\\" | translate }}</md-tooltip></md-button></td></tr></table></div><div class=video-container ng-show=\\\"ctrl.videoCallState.state > 1\\\"><video ng-class=\\\"{ calling: ctrl.videoCallState.state == 2 }\\\" id=remotevideo autoplay playsinline ng-show=\\\"ctrl.videoCallState.state == 3\\\"></video><video ng-class=\\\"{ calling: ctrl.videoCallState.state == 2 }\\\" id=localvideo autoplay playsinline></video></div></div></div>\");\n$templateCache.put(\"app/tsa-views/weather/weather.html\",\"<div layout=column><!-- Toolbar --><div layout=row class=tsa-toolbar><i ng-if=\\\"ctrl.mode != ctrl.MODE.ANEMOMETER\\\" class=\\\"mdi mdi-24px mdi-{{\\'views.weather.icon\\' | translate }}\\\"></i> <i ng-if=\\\"ctrl.mode == ctrl.MODE.ANEMOMETER\\\" class=\\\"mdi mdi-24px mdi-{{\\'views.anemometer.icon\\' | translate }}\\\"></i><p ng-if=\\\"ctrl.mode != ctrl.MODE.ANEMOMETER\\\" class=title>{{\\\"views.weather.title\\\" | translate }}</p><p ng-if=\\\"ctrl.mode == ctrl.MODE.ANEMOMETER\\\" class=title>{{\\\"views.anemometer.title\\\" | translate }}</p><p class=device-id>- {{ctrl.weatherDeviceId}}</p><span flex></span><tsa-settings-button on-change-view=\\\"ctrl.onChangeCardType({type: type})\\\" card-id={{ctrl.cardId}}></tsa-settings-button></div><md-divider></md-divider><!-- Content --><div flex layout=row layout-align=space-around class=tsa-content><div flex layout=column layout-align=space-around><!-- Wind canvas --><canvas flex id={{ctrl.canvasId}}><p>Error during the display of the canvas (maybe due to the browser version)</p></canvas><!-- Wind data --><div layout=column><tsa-double-data-view ng-if=\\\"ctrl.mode != ctrl.MODE.ANEMOMETER\\\" class=true-wind title=views.weather.true-wind data1=ctrl.trueWindHeadingId frame-id1=ctrl.weatherFrame device-id1=ctrl.weatherDeviceId format1=%.1f data2=ctrl.trueWindSpeedId frame-id2=ctrl.weatherFrame device-id2=ctrl.weatherDeviceId format2=%.1f></tsa-double-data-view><tsa-double-data-view class=relative-wind title=views.weather.rel-wind data1=ctrl.relWindHeadingId frame-id1=ctrl.weatherFrame device-id1=ctrl.weatherDeviceId format1=%.1f data2=ctrl.relWindSpeedId frame-id2=ctrl.weatherFrame device-id2=ctrl.weatherDeviceId format2=%.1f></tsa-double-data-view></div></div><md-divider ng-if=\\\"ctrl.mode != ctrl.MODE.ANEMOMETER\\\"></md-divider><!-- Data views --><div ng-if=\\\"ctrl.mode != ctrl.MODE.ANEMOMETER\\\" flex=50 layout=column><tsa-data-view ng-repeat=\\\"data in ctrl.weatherDataList\\\" data=data.id frame-id=ctrl.weatherFrame device-id=ctrl.weatherDeviceId opt-title={{data.title}} format=%.1f></tsa-data-view></div></div></div>\");\n$templateCache.put(\"app/tsa-views/winch/winch.html\",\"<div layout=column><!-- Toolbar --><div layout=row class=tsa-toolbar><i class=\\\"mdi mdi-24px mdi-{{\\'views.winch.icon\\' | translate }}\\\"></i><p class=title>{{\\\"views.winch.title\\\" | translate }}</p><p class=device-id>- {{ctrl.deviceId}}</p><span flex></span><!-- Loading icon --><div ng-if=\\\"ctrl.bufferLoading[ctrl.selectedScale] > 0\\\" layout=column layout-align=\\\"center center\\\" style=\\\"width: 40px\\\"><md-tooltip>{{\\\"archive-loading\\\" | translate }}</md-tooltip><md-progress-circular md-diameter=20px></md-progress-circular></div><!-- Scale X --><md-input-container><md-select ng-model=ctrl.selectedScale ng-change=ctrl.onChangeXScale()><md-option ng-repeat=\\\"(name, value) in ctrl.scales\\\" value={{name}}>{{name}}</md-option></md-select><md-tooltip>{{\\\"Graphic scale\\\" | translate }}</md-tooltip></md-input-container><tsa-settings-button on-change-view=\\\"ctrl.onChangeCardType({type: type})\\\" card-id={{ctrl.cardId}}></tsa-settings-button></div><md-divider></md-divider><!-- Content --><div flex class=tsa-content layout=column><div layout=row><tsa-data-view flex=50 opt-title=views.winch.length data=ctrl.length frame-id=ctrl.frameId device-id=ctrl.deviceId></tsa-data-view><tsa-data-view flex=50 opt-title={{ctrl.spinningText}} data=ctrl.spinning frame-id=ctrl.frameId device-id=ctrl.deviceId></tsa-data-view></div><div layout=row><tsa-data-view flex=50 opt-title=views.winch.sounding format=%.1f data=ctrl.sounding frame-id=ctrl.frameSounding device-id=ctrl.deviceSoundingId></tsa-data-view><span flex=50 style=\\\"padding: 8px\\\"></span></div><md-divider></md-divider><tsa-data-view opt-title=views.winch.tension data=ctrl.tension frame-id=ctrl.frameId device-id=ctrl.deviceId></tsa-data-view><!-- Chart --><div flex class=tsa-chart-container><canvas id={{ctrl.canvasId}}></canvas></div></div></div>\");\n$templateCache.put(\"app/tsa-views/winch-alarm-pp/winch-alarm-pp.html\",\"<meta charset=utf-8><div layout=column><!-- Toolbar --><div layout=row class=tsa-toolbar><i class=\\\"mdi mdi-24px mdi-{{\\'views.winchAlarmPp.icon\\' | translate }}\\\"></i><p class=title>{{\\\"views.winchAlarmPp.title\\\" | translate }}</p><!-- <p class=\\\"device-id\\\">- {{ctrl.deviceId}}</p> --> <span flex></span><tsa-settings-button on-change-view=\\\"ctrl.onChangeCardType({type: type})\\\" card-id={{ctrl.cardId}}></tsa-settings-button></div><md-divider></md-divider><table><tr><th>Info</th></tr></table><div class=alarm><table><tr ng-repeat=\\\"alarm in ctrl.alarms\\\"><td>{{ alarm.text }}</td></tr></table></div><!-- Content --><div flex layout=row class=tsa-content></div></div>\");\n$templateCache.put(\"app/tsa-views/winch-info/winch-info.html\",\"<div layout=column><!-- Toolbar --><div layout=row class=tsa-toolbar><i class=\\\"mdi mdi-24px mdi-{{\\'views.winch.icon\\' | translate }}\\\"></i><p class=title>{{\\\"views.winch-info.title\\\" | translate }}</p><p class=device-id>- {{ctrl.deviceId}}</p><span flex></span><tsa-settings-button on-change-view=\\\"ctrl.onChangeCardType({type: type})\\\" card-id={{ctrl.cardId}}></tsa-settings-button></div><md-divider></md-divider><div class=tsa-content layout=column><!--\\n            Longeur\\n            Vitesse\\n            Tension\\n            Profondeur\\n        --><!-- Length --><tsa-data-view data=ctrl.WINCH.LENGTH frame-id=ctrl.frameId device-id=ctrl.deviceId opt-title=views.winch.length></tsa-data-view><!-- Speed --><tsa-data-view data=ctrl.WINCH.SPINNING frame-id=ctrl.frameId device-id=ctrl.deviceId opt-title={{ctrl.spinningText}}></tsa-data-view><!-- Tension --><tsa-data-view data=ctrl.WINCH.TENSION frame-id=ctrl.frameId device-id=ctrl.deviceId opt-title=views.winch.tension></tsa-data-view><!-- Depth --><tsa-data-view data=ctrl.NAVIGATION.SOUNDER frame-id=ctrl.NAVIGATION.FRAME_SHIPNAV device-id=ctrl.navId format=%.1f opt-title=views.winch.sounding></tsa-data-view></div></div>\");\n$templateCache.put(\"app/pages/acquisition/addChannel/addChannel.html\",\"<md-dialog style=\\\"width: 800px\\\"><md-toolbar><div class=\\\"md-toolbar-tools md-hue-3\\\"><h2 style=\\\"padding: 16px\\\">{{ctrl.title}}</h2><span flex></span><md-button class=md-icon-button ng-click=ctrl.cancel()><md-icon class=material-icons>close</md-icon></md-button></div></md-toolbar><md-content layout=column style=\\\"padding-top: 16px\\\" layout-margin><div layout=row style=\\\"height: 54px\\\" layout-align=\\\"space-between center\\\"><md-input-container flex style=\\\"height: 54px\\\"><label>Channel</label><md-select ng-model=ctrl.channel ng-model-options=\\\"{trackBy: \\'$value.channelId\\'}\\\"><md-option ng-value=channel ng-repeat=\\\"channel in ctrl.channelList\\\">{{channel.channelId}} ({{channel.url}})</md-option><md-option value=\\\"New channel\\\"><md-icon>add</md-icon>New channel</md-option></md-select></md-input-container><md-input-container style=\\\"height: 54px\\\" ng-show=\\\"ctrl.channel === \\'New channel\\'\\\"><label>ID</label><input ng-model=ctrl.newChannelId></md-input-container><md-input-container style=\\\"height: 54px\\\" ng-show=\\\"ctrl.channel === \\'New channel\\'\\\"><label>URL</label><input ng-model=ctrl.newChannelURL></md-input-container></div><div layout=row layout-align=end><md-button class=\\\"md-primary md-raised\\\" ng-click=ctrl.cancel()>Cancel</md-button><md-button class=\\\"md-primary md-raised\\\" ng-click=ctrl.save()>Select</md-button></div></md-content></md-dialog>\");\n$templateCache.put(\"app/pages/acquisition/addDevice/editDevice.html\",\"<div class=tsa-edit-device style=\\\"height: 100%\\\" layout=column><md-toolbar><div class=\\\"md-toolbar-tools md-hue-3\\\"><md-button class=md-icon-button ui-sref=acquisition><md-icon class=material-icons>close</md-icon></md-button><h2 style=\\\"padding: 16px\\\">{{ctrl.title}}</h2><span flex></span><md-button ng-click=ctrl.save()>Save</md-button></div></md-toolbar><md-content flex style=\\\"padding: 8px\\\" class=tsa-background><div style=\\\"padding: 8px\\\" layout=row><md-card flex=50><md-card-title><md-card-title-text><span class=md-headline>Global properties</span></md-card-title-text></md-card-title><md-card-content layout=row><md-input-container flex=33><label>ID</label><input ng-model=ctrl.device.deviceId type=text></md-input-container><md-input-container flex=33><label>Name</label><input ng-model=ctrl.device.name></md-input-container><md-input-container flex=33><label>Period</label><input ng-model=ctrl.device.period></md-input-container></md-card-content></md-card><md-card flex=50><md-card-title><md-card-title-text><span class=\\\"md-headline md-primary\\\">Trigger</span></md-card-title-text></md-card-title><md-card-content layout=row><md-input-container flex=30><label>Type</label><md-select ng-model=ctrl.device.triggerMode><md-option value=FRAME>Frame</md-option><md-option value=TIME>Time</md-option></md-select></md-input-container><md-input-container flex=70><label>Value</label><input ng-model=ctrl.triggerValue></md-input-container></md-card-content></md-card></div><div style=\\\"padding: 8px\\\" layout=row><md-card flex=100><md-card-title><md-card-title-text><span class=md-headline>Channels</span></md-card-title-text></md-card-title><md-card-content><md-list style=\\\"margin:8px; padding: 8px\\\"><md-list-item style=\\\"padding:0px; min-height: 0px; height: 50px; color:#757575\\\"><p flex=30>ID</p><p flex=70>URL</p></md-list-item><md-divider></md-divider><md-list-item ng-repeat=\\\"channel in ctrl.channels\\\"><p>{{channel.channelId}}</p><p>{{channel.url}}</p><div flex=10><md-button class=md-icon-button ng-click=ctrl.removeChannel(channel)><md-icon>remove</md-icon></md-button></div><md-divider></md-divider></md-list-item></md-list><div layout=row layout-align=\\\"end end\\\"><md-button class=\\\"md-fab md-mini md-primary\\\" ng-click=ctrl.addChannel()><md-icon>add</md-icon><md-tooltip>Add channel</md-tooltip></md-button></div></md-card-content></md-card></div><div style=\\\"padding: 8px\\\" layout=row><md-card flex=100><md-card-title><md-card-title-text><span class=md-headline>Drivers</span></md-card-title-text></md-card-title><md-card-content><md-list style=\\\"margin:8px; padding: 8px\\\"><md-list-item style=\\\"padding:0px; min-height: 0px; height: 50px; color:#757575\\\"><p flex=20>Drivers</p><p flex=20>Channel</p><p flex=20>Driver</p><p flex=30>Fields</p><div flex=10></div></md-list-item><md-divider></md-divider><md-list-item ng-repeat=\\\"driver in ctrl.device.drivers\\\"><p flex=20 style=\\\"font-weight: bold\\\">{{driver.driverName}}</p><p flex=20>{{driver.channelId}}</p><p flex=20>{{driver.driverClassName.split(\\'.\\').pop()}}</p><div flex=30 layout=column style=\\\"padding-top: 8px; padding-bottom: 8px\\\"><p ng-repeat=\\\"field in driver.fields\\\" style=\\\"margin-top: 8px; margin-bottom: 8px\\\">{{field.fieldIndex}} - {{field.frame}}:{{field.data}}</p></div><div flex=10 layout=row layout-align=end><md-button class=md-icon-button ng-click=ctrl.editDriver(driver)><md-icon>edit</md-icon></md-button><md-button class=md-icon-button ng-click=ctrl.removeDriver($index)><md-icon>delete</md-icon></md-button></div><md-divider></md-divider></md-list-item></md-list><div layout=row layout-align=\\\"end end\\\"><md-button class=\\\"md-fab md-mini md-primary\\\" ng-click=ctrl.addDriver()><md-icon>add</md-icon><md-tooltip>Add driver</md-tooltip></md-button></div></md-card-content></md-card></div></md-content></div>\");\n$templateCache.put(\"app/pages/acquisition/addDriver/addDriver.html\",\"<md-dialog style=\\\"width: 800px\\\"><md-toolbar><div class=\\\"md-toolbar-tools md-hue-3\\\"><h2 style=\\\"padding: 16px\\\">{{ctrl.title}}</h2><span flex></span><md-button class=md-icon-button ng-click=ctrl.cancel()><md-icon class=material-icons>close</md-icon></md-button></div></md-toolbar><md-content layout=column style=\\\"padding-top: 16px\\\" layout-margin><md-input-container style=\\\"height: 54px\\\"><label>Driver</label><md-select ng-model=ctrl.driver.driverClassName ng-change=ctrl.changeDriverSelected()><md-option ng-repeat=\\\"driver in ctrl.driverList | orderBy\\\" value={{driver}}>{{driver.split(\\\".\\\").reverse()[0]}}</md-option></md-select></md-input-container><md-input-container style=\\\"height: 54px\\\"><label>Channel</label><md-select ng-model=ctrl.driver.channelId><md-option ng-repeat=\\\"channel in ctrl.channelList\\\" ng-value=channel.channelId>{{channel.channelId}}</md-option></md-select></md-input-container><div layout=row layout-align=\\\"space-between center\\\" style=\\\"height: 54px\\\" ng-if=ctrl.headerLine><md-input-container class=md-block flex=50><label>Header</label><input ng-model=ctrl.driver.header></md-input-container><md-input-container flex=50><label>Regex</label><input ng-model=ctrl.driver.parameters.regex></md-input-container></div><md-list style=margin:8px><md-list-item style=\\\"padding:0px; min-height: 0px; height: 40px;color:#757575\\\"><p flex=10>Index</p><p flex=30>Data</p><p flex=20>Option</p><p flex=20>Result</p><div flex=20><md-button class=md-icon-button ng-click=ctrl.addField()><md-icon>add</md-icon></md-button></div></md-list-item><md-divider></md-divider><md-list-item ng-repeat=\\\"field in ctrl.fieldList\\\" style=\\\"min-height: 0px; height: 40px\\\"><md-input-container flex=10 md-no-float class=md-block><input ng-model=field.fieldIndex placeholder=Index></md-input-container><md-select ng-model=field.frame flex=30><div ng-repeat=\\\"frame in ctrl.frameList | orderObjectBy:\\'name\\'\\\"><md-optgroup label=\\\"{{frame.name}} \\\"><md-option ng-repeat=\\\"data in frame.data | orderObjectBy:\\'longName\\'\\\" value={{frame.name}}:{{data.name}}>{{data.longName}}</md-option></md-optgroup></div></md-select><md-input-container flex=20 md-no-float class=md-block><input ng-model=field.options placeholder=Options></md-input-container><p flex=20>{{field.result}}</p><div flex=20><md-button class=md-icon-button ng-click=ctrl.removeField(field)><md-icon>remove</md-icon></md-button></div></md-list-item></md-list><div layout=row layout-align=end><md-button class=\\\"md-primary md-raised\\\" ng-click=ctrl.cancel()>Cancel</md-button><md-button class=\\\"md-primary md-raised\\\" ng-click=ctrl.save()>Save</md-button></div></md-content></md-dialog>\");\n$templateCache.put(\"app/services/dialog/dataSelection/dataSelection.html\",\"<md-dialog class=data-selection><!-- Toolbar --><md-toolbar><div class=md-toolbar-tools><h2>{{ \\\"dialog.data-selection.title\\\" | translate }}</h2><span flex></span><md-button class=md-icon-button ng-click=ctrl.cancel()><md-icon class=material-icons>close</md-icon></md-button></div></md-toolbar><div flex layout=column class=custom-selection><!-- Device selection --><div class=md-whiteframe-3dp><md-input-container style=\\\"width: 200px; margin-left: 16px; margin-top: 26px\\\"><label>{{ \\\"Device\\\" | translate }}</label><md-select ng-model=ctrl.deviceId><md-option value={{device.id}} ng-repeat=\\\"device in ctrl.deviceList | orderObjectBy:\\'name\\'\\\">{{device.name}}</md-option></md-select></md-input-container></div><div flex style=\\\"overflow: auto; padding: 16px\\\"><div ng-repeat=\\\"(frameName, frame) in ctrl.deviceList[ctrl.deviceId].frameList\\\" layout=column style=\\\"margin-left: 16px\\\"><!-- Frame checkbox --><md-checkbox ng-checked=\\\"ctrl.frameIsSelected(frame, frameName, ctrl.deviceId)\\\" ng-click=\\\"ctrl.selectFrame(frame, frameName, ctrl.deviceId)\\\" md-indeterminate=\\\"ctrl.frameIsSelected(frame, frameName, ctrl.deviceId) == \\'indeterminate\\'\\\">{{frameName}}</md-checkbox><!-- Data checkbox --><md-checkbox ng-repeat=\\\"data in frame | orderObjectBy:\\'longName\\'\\\" ng-checked=\\\"ctrl.selectedDataList.includes(data.name, frameName, ctrl.deviceId)\\\" ng-click=\\\"ctrl.selectData(data.name, frameName, ctrl.deviceId)\\\" style=\\\"margin-left: 24px\\\">{{data.longName}}</md-checkbox></div></div><md-dialog-actions layout=row class=md-whiteframe-3dp><p class=md-subhead>{{ctrl.selectedDataList.dataList.length}} {{ \\\"dialog.data-selection.data-selected\\\" | translate }}</p><span flex></span><md-button class=md-primary ng-click=ctrl.answer()>{{ \\\"dialog.data-selection.add\\\" | translate }}</md-button></md-dialog-actions></div></md-dialog>\");\n$templateCache.put(\"app/services/dialog/dateRangeSelection/dateRangeSelection.html\",\"<md-dialog class=date-range-selection><!-- Toolbar --><md-toolbar><div class=md-toolbar-tools><h2>{{ \\\"dialog.date-range-selection.title\\\" | translate }}</h2><span flex></span><md-button class=md-icon-button ng-click=ctrl.cancel()><md-icon class=material-icons>close</md-icon></md-button></div></md-toolbar><div layout=row layout-align=space-between><div layout=column layout-align=center class=column><h3 class=\\\"md-headline md-primary\\\" style=\\\"align-self: center\\\">{{ \\\"dialog.date-range-selection.start-date\\\" | translate }}</h3><md-calendar ng-model=ctrl.startDate md-whiteframe=1></md-calendar><md-input-container><md-icon class=\\\"material-icons md-primary\\\">access_time</md-icon><label>{{ \\\"dialog.date-range-selection.time\\\" | translate }} UTC (hh:mm:ss)</label><input ng-model=ctrl.startTime></md-input-container></div><div layout=column class=column><md-icon class=material-icons>arrow_forward</md-icon></div><div layout=column layout-align=center class=column><h3 class=\\\"md-headline md-primary\\\" style=\\\"align-self: center\\\">{{ \\\"dialog.date-range-selection.end-date\\\" | translate }}</h3><md-calendar ng-model=ctrl.endDate md-whiteframe=1></md-calendar><md-input-container><md-icon class=\\\"material-icons md-primary\\\">access_time</md-icon><label>{{ \\\"dialog.date-range-selection.time\\\" | translate }} UTC (hh:mm:ss)</label><input ng-model=ctrl.endTime></md-input-container></div></div><span flex></span><md-dialog-actions layout=row><span flex></span><md-button class=md-primary ng-click=ctrl.answer()>ok</md-button></md-dialog-actions></md-dialog>\");\n$templateCache.put(\"app/services/dialog/messaging/messaging.html\",\"<md-dialog class=messaging><!-- Toolbar --><md-toolbar><div class=md-toolbar-tools><md-icon class=material-icons style=\\\"margin-right: 16px\\\">chat</md-icon><h2>{{ \\\"dialog.messaging.title\\\" | translate }}</h2><span flex></span><md-button class=md-icon-button ng-click=ctrl.close()><md-icon class=material-icons>close</md-icon></md-button></div></md-toolbar><div flex style=overflow:auto><div class=message ng-repeat=\\\"msg in ctrl.messageList\\\"><p class=\\\"md-body-1 date\\\" ng-if=\\\"msg.user===\\'user\\'\\\">{{ msg.messageTime | date : \\\"dd MMM yyyy - HH:mm:ss\\\" : \\\"+0\\\"}}{{\\'views.message.from\\' | translate }}{{\\'dialog.messaging.user\\' | translate }}</p><p class=\\\"md-body-1 date\\\" ng-if=\\\"msg.user!==\\'user\\'\\\">{{ msg.messageTime | date : \\\"dd MMM yyyy - HH:mm:ss\\\" : \\\"+0\\\"}}{{\\'views.message.from\\' | translate }}{{msg.user}}</p><p class=\\\"md-body-1 body\\\">{{msg.message}}</p></div></div><md-divider></md-divider><div layout=row layout-align=\\\"center center\\\" style=\\\"padding: 16px\\\"><md-input-container flex class=md-block><label>{{\\\"dialog.messaging.label\\\"| translate}}</label><textarea ng-keydown=ctrl.tabFunction($event) ng-model=ctrl.currentMessage rows=2 md-select-on-focus value=keyboard! ng-trim=false></textarea></md-input-container><md-button class=\\\"md-fab md-primary\\\" ng-click=ctrl.send() ng-disabled=!ctrl.currentMessage><md-icon>send</md-icon><md-tooltip>{{\\\"dialog.messaging.submit\\\" | translate }}</md-tooltip></md-button></div></md-dialog>\");\n$templateCache.put(\"app/services/dialog/messagingAccess/messagingAccess.html\",\"<md-dialog class=messaging-access><md-toolbar><div class=md-toolbar-tools><md-icon class=material-icons>vpn_key</md-icon><h2>{{ \\\"dialog.messagingAccess.title\\\" | translate }}</h2><span flex></span><md-button class=md-icon-button ng-click=ctrl.close()><md-icon class=material-icons>close</md-icon></md-button></div></md-toolbar><div id=messageAccess layout=column><div layout=row class=div-password layout-align=\\\"center center\\\"><md-input-container class=md-block flex><label for=password>{{\\\"dialog.messagingAccess.label\\\"| translate}}</label><input type=password id=password ng-model=ctrl.passwordInput ng-keypress=ctrl.onKeyPressed($event)><div class=errorMessage><!-- <div ng-show=\\'\\' class=\\\"error\\\">{{ \\\"dialog.messagingAccess.CapsLockError\\\" | translate }}</div> Needs a caps lock detect function--><div ng-show=ctrl.inputMatch class=error>{{ \\\"dialog.messagingAccess.passwordError\\\" | translate }}</div></div></md-input-container></div><div class=redirect layout=row layout-align=end><md-button class=\\\"md-primary md-raised\\\" ng-click=ctrl.redirect() ng-disabled=!ctrl.passwordInput>{{\\\"dialog.messagingAccess.submit\\\"| translate}}</md-button></div></div></md-dialog><!--\\nmessageAccess.passwordInput.$error-->\");\n$templateCache.put(\"app/services/dialog/saveDashboard/saveDashboard.html\",\"<md-dialog><md-toolbar><div class=\\\"md-toolbar-tools md-hue-3\\\"><md-icon class=material-icons>save</md-icon><h2 style=\\\"padding: 16px\\\">{{ \\\"dialog.save-dashboard.title\\\" | translate }}</h2><span flex></span><md-button class=md-icon-button ng-click=ctrl.cancel()><md-icon class=material-icons>close</md-icon></md-button></div></md-toolbar><div layout=column layout-padding><md-input-container style=\\\"margin-bottom: 0\\\"><label>{{ \\\"dialog.save-dashboard.title-label\\\" | translate }}</label><input ng-model=ctrl.title type=text></md-input-container><md-button class=md-primary ng-click=ctrl.save() ng-disabled=\\\"ctrl.title == \\'\\'\\\">{{ \\\"dialog.save-dashboard.save\\\" | translate }}</md-button></div></md-dialog>\");\n$templateCache.put(\"app/services/dialog/validation/validation.html\",\"<md-dialog><md-toolbar><div class=\\\"md-toolbar-tools md-hue-3\\\"><md-icon class=material-icons>warning</md-icon><h2 style=\\\"padding: 16px\\\">{{ctrl.title}}</h2><span flex></span><md-button class=md-icon-button ng-click=ctrl.cancel()><md-icon class=material-icons>close</md-icon></md-button></div></md-toolbar><div layout=column layout-padding><h3 class=md-body-1>{{ctrl.msg}}</h3><div layout=row layout-align=\\\"center center\\\"><md-button class=md-primary ng-click=ctrl.disconnect()>{{ctrl.msgOk}}</md-button><md-button class=md-primary ng-click=ctrl.cancel()>{{ctrl.msgCancel}}</md-button></div></div></md-dialog>\");\n$templateCache.put(\"app/services/dialog/viewSelection/viewSelection.html\",\"<md-dialog class=view-selection><!-- Toolbar --><md-toolbar><div class=\\\"md-toolbar-tools md-hue-3\\\"><md-icon class=material-icons style=\\\"margin-right: 16px\\\">system_update_alt</md-icon><h2>{{ \\\"dialog.view-selection.title\\\" | translate }}</h2><span flex></span><md-button class=md-icon-button ng-click=ctrl.cancel()><md-icon class=material-icons>close</md-icon></md-button></div></md-toolbar><!-- Tabs (backup element used to load the video preview image and avoid flashing) --><!--      <span id=\\\"backup\\\" ng-style=ctrl.viewProvider.getBackupCss()></span> --> <span class=backup ng-repeat=\\\"mosaic in ctrl.mosaicList\\\" ng-style=ctrl.viewProvider.getBackupCss($index)>Coucou</span><!-- Tabs --><md-tabs flex md-border-bottom md-selected=ctrl.viewProvider.indexSelectedTab><md-tab ng-repeat=\\\"(listName, list) in ctrl.viewList\\\" label=\\\"{{listName | translate }}\\\"><md-grid-list flex md-cols=5 md-row-height=72px md-gutter=8px><md-grid-tile ng-repeat=\\\"view in list | orderBy: \\'title | translate\\'  track by $index \\\" md-whiteframe=1 md-rowspan={{view.rowspan}} md-ink-ripple tabindex=-1 ng-click=ctrl.selectView(view)><div layout=column layout-align=space-between><div layout=row layout-align=\\\"start center\\\" style=height:72px><i class=\\\"mdi mdi-24px mdi-{{view.icon | translate}}\\\"></i><!--md-icon class=\\\"material-icons\\\">{{view.icon}}</md-icon--><div class=md-list-item-text><h3 class=md-subhead>{{view.title | translate }}</h3><p class=md-subhead>{{view.config.deviceId | translate }}</p></div></div><div flex ng-if=\\\"view.imageCSSClass !== undefined\\\" ng-style=view.imageBackground class=\\\"preview {{view.imageCSSClass}}\\\"></div></div></md-grid-tile></md-grid-list></md-tab></md-tabs></md-dialog>\");\n$templateCache.put(\"app/tsa-views/casino/codeNameFields/codeNameFields.html\",\"<div flex layout=row layout-align=\\\"space-between stretch\\\" ng-if=ctrl.listItems><md-input-container flex=26><label>{{\\\"components.code-name-fields.\\\" + ctrl.itemType + \\\".code\\\" | translate }}</label><input type=text ng-model=ctrl.selectedItem.code disabled ng-class=\\\"{follow: ctrl.itemFollow}\\\"></md-input-container><md-input-container flex><label>{{\\\"components.code-name-fields.\\\" + ctrl.itemType + \\\".name\\\" | translate }}</label><md-select class=form-control required ng-model=ctrl.selectedItem ng-model-options=\\\"{trackBy: \\'$value.name\\'}\\\" ng-change=ctrl.updateItem() ng-class=\\\"{follow: ctrl.itemFollow}\\\" ng-disabled=ctrl.itemReadonly><md-option ng-value=item ng-repeat=\\\"item in ctrl.listItems\\\">{{item.name}}</md-option></md-select></md-input-container></div>\");\n$templateCache.put(\"app/pages/dataAccess/components/paramSelector/paramSelector.html\",\"<div layout=row><md-icon class=material-icons style=\\\"margin: 14px\\\">settings</md-icon><div flex><div layout=row ng-show=\\\"ctrl.mode==\\'simple\\'\\\"><p>{{\\\"pages.data-access.sampling-interval\\\" | translate}}:</p><md-select ng-model=ctrl.simpleSampingInterval style=\\\"margin: 8px\\\" class=md-no-underline><md-option value=1>1 s</md-option><md-option value=30>30 sec</md-option><md-option value=60>1 min</md-option><md-option value=300>5 min</md-option></md-select></div><div layout=column style=\\\"padding:8px 8px 14px 0px\\\" ng-show=\\\"ctrl.mode==\\'advanced\\'\\\"><md-input-container ng-show=\\\"ctrl.mode==\\'advanced\\'\\\"><label>{{\\\"pages.data-access.max-values\\\" | translate}}</label><input ng-model=ctrl.maxValues></md-input-container><div layout=row><p>{{\\\"pages.data-access.time-stamping-strat\\\" | translate}}:</p><md-select ng-model=ctrl.timeStampingStrategy style=\\\"margin: 8px\\\" class=md-no-underline><md-option value=resampling>{{\\\"pages.data-access.resampling\\\" | translate}}</md-option><md-option value=reference>{{\\\"pages.data-access.reference\\\" | translate}}</md-option></md-select></div><div layout=row ng-show=\\\"ctrl.timeStampingStrategy == \\'resampling\\'\\\"><md-input-container flex=40><label>{{\\\"pages.data-access.interval\\\" | translate}} (s)</label><input ng-model=ctrl.resampleInterval></md-input-container><md-input-container flex=60><label>{{\\\"pages.data-access.stamp-fraction-int\\\" | translate}} (s)</label><input ng-model=ctrl.intervalStampFraction></md-input-container></div><md-input-container ng-show=\\\"ctrl.timeStampingStrategy == \\'reference\\'\\\"><label>{{\\\"pages.data-access.reference\\\" | translate}}</label><input ng-model=ctrl.reference></md-input-container></div></div></div>\");\n$templateCache.put(\"app/pages/dataAccess/components/periodSelector/periodSelector.html\",\"<div layout=row><md-icon class=material-icons style=\\\"margin: 14px\\\">date_range</md-icon><div layout=column><div layout=row><p>{{\\\"pages.data-access.period\\\" | translate}}:</p><md-select ng-model=ctrl.currentSelection class=md-no-underline><md-option ng-repeat=\\\"selection in ctrl.selectionList\\\" value={{selection}}>{{selection | translate}}</md-option><md-option value={{ctrl.CUSTOM_RANGE}} ng-click=ctrl.setCustomRange()>{{ctrl.CUSTOM_RANGE | translate}}</md-option></md-select></div><!-- Custom range --><div layout=row layout-align=\\\"start center\\\" style=\\\"padding-bottom: 14px\\\" ng-show=\\\"ctrl.currentSelection == ctrl.CUSTOM_RANGE\\\"><p class=date>{{ctrl.startDate | date : \\\"dd MMM yyyy HH:mm:ss\\\" : \\\"+0\\\"}}</p><md-icon class=material-icons style=\\\"margin: 14px\\\">arrow_forward</md-icon><p class=date>{{ctrl.endDate | date : \\\"dd MMM yyyy HH:mm:ss\\\" : \\\"+0\\\"}}</p><md-button class=md-icon-button ng-click=ctrl.setCustomRange()><md-icon class=material-icons>edit</md-icon><md-tooltip>{{\\\"pages.data-access.edit-period\\\" | translate}}</md-tooltip></md-button></div></div></div>\");\n$templateCache.put(\"app/pages/dataAccess/components/resultCard/resultCard.html\",\"<md-card flex layout=column><!-- Toolbar --><div class=toolbar layout=row layout-align=\\\"center center\\\"><h3 class=md-headline>{{ctrl.frames.length}} {{\\\"pages.data-access.frames-received\\\" | translate}}</h3><span flex></span><md-button class=md-icon-button ng-click=\\\"ctrl.displayMode = \\'table\\'\\\"><md-icon ng-class=\\\"{\\'enabled\\': ctrl.displayMode == \\'table\\'}\\\">format_list_numbered</md-icon><md-tooltip>{{\\\"pages.data-access.show-table\\\" | translate}}</md-tooltip></md-button><md-button class=md-icon-button ng-click=\\\"ctrl.displayMode = \\'chart\\'\\\"><md-icon ng-class=\\\"{enabled: ctrl.displayMode == \\'chart\\'}\\\">show_chart</md-icon><md-tooltip>{{\\\"pages.data-access.show-chart\\\" | translate}}</md-tooltip></md-button></div><!-- Data table --><div flex layout=column layout-align=\\\"start start\\\" class=tsa-table ng-show=\\\"ctrl.displayMode == \\'table\\'\\\"><div class=tsa-table-title md-whiteframe=1><p>Date (UTC)</p><p ng-repeat=\\\"(columnTitle,value) in ctrl.framesTable[0]\\\" ng-if=\\\"columnTitle != \\'time\\'\\\">{{columnTitle}}</p></div><div flex class=tsa-table-content><div ng-repeat=\\\"frame in ctrl.framesTable\\\"><p ng-repeat=\\\"(key, value) in frame\\\">{{value}}</p></div></div></div><!-- Chart --><div class=checkbox-line ng-show=\\\"ctrl.displayMode == \\'chart\\'\\\"><md-checkbox ng-repeat=\\\"dataset in ctrl.chartData.datasets\\\" ng-true-value=false ng-false-value=true ng-model=dataset.hidden ng-change=ctrl.chart.update() ng-style=\\\"dataset.hidden ? \\'\\':{background: \\'{{dataset.borderColor}}\\', color: \\'{{dataset.borderColor}}\\'}\\\">{{dataset.label}}</md-checkbox></div><div flex class=tsa-chart-container ng-show=\\\"ctrl.displayMode == \\'chart\\'\\\"><canvas id={{ctrl.canvasId}}></canvas></div><!-- Map --><!--\\n    <div style=\\\"margin: 16px\\\" md-whiteframe=1 ng-show=\\\"ctrl.displayMode == \\'map\\'\\\" flex id=\\\"map\\\">\\n    </div>\\n--><!-- Map  \\n    <div class=\\\"map-element\\\" flex id=\\'{{ctrl.mapId}}\\'>\\n        <div class=\\\"day-night-layer\\\" ng-class=\\\"{\\'station-unavailable\\': ctrl.stationIsUnvailable}\\\">\\n            <p class=\\\"md-subhead\\\">{{\\\"views.station.unvailable\\\" | translate }}</p>\\n        </div>\\n    </div--></md-card>\");\n$templateCache.put(\"app/pages/dataAccess/components/variableSelector/variableSelector.html\",\"<div layout=column flex><div layout=row layout-align=\\\"center center\\\" class=toolbar><md-icon class=material-icons>storage</md-icon><!--h3 class=\\\"md-headline\\\">Data</h3--><p>{{ctrl.simpleDataList.length}} {{\\\"pages.data-access.data-selected\\\" | translate}}</p><!--md-select ng-model=\\\"ctrl.currentSelection\\\" class=\\\"md-no-underline\\\">\\n            <md-option ng-repeat=\\\"selection in ctrl.selectionList\\\" value=\\'{{selection}}\\'>{{selection}}</md-option>\\n        </md-select--> <span flex></span><md-button class=md-primary ng-click=ctrl.addNavData() ng-show=\\\"ctrl.mode == \\'simple\\'\\\"><md-tooltip>{{\\\"pages.data-access.add-navigation\\\" | translate}}</md-tooltip><md-icon>playlist_add</md-icon>{{\\\"pages.data-access.navigation\\\" | translate}}</md-button><md-button class=md-primary ng-click=ctrl.addWeatherData() ng-show=\\\"ctrl.mode == \\'simple\\'\\\"><md-tooltip>{{\\\"pages.data-access.add-weather\\\" | translate}}</md-tooltip><md-icon>playlist_add</md-icon>{{\\\"pages.data-access.weather\\\" | translate}}</md-button><md-button class=md-primary ng-click=ctrl.addTSData() ng-show=\\\"ctrl.mode == \\'simple\\'\\\"><md-tooltip>{{\\\"pages.data-access.add-thermosal\\\" | translate}}</md-tooltip><md-icon>playlist_add</md-icon>{{\\\"pages.data-access.thermosal\\\" | translate}}</md-button><md-button class=md-primary ng-click=ctrl.addData()><md-tooltip>{{\\\"pages.data-access.add-custom-data\\\" | translate}}</md-tooltip><md-icon>playlist_add</md-icon>{{\\\"pages.data-access.custom-data\\\" | translate}}</md-button></div><!-- Custom selection: simple data list --><div class=tsa-table ng-show=\\\"ctrl.mode == \\'simple\\'\\\"><div class=tsa-table-title layout=row layout-align=\\\"space-between center\\\"><p flex=20>{{\\\"Device\\\" | translate}}</p><p flex=20>{{\\\"Frame\\\" | translate}}</p><p flex=20>{{\\\"Data\\\" | translate}}</p><p flex=20>{{\\\"pages.data-access.column-name\\\" | translate}}</p><div flex=5><md-button class=md-icon-button ng-click=ctrl.clearAll()><md-icon>close</md-icon><md-tooltip>{{\\\"pages.data-access.remove-all\\\" | translate}}</md-tooltip></md-button></div></div><md-divider style=\\\"z-index: 2\\\"></md-divider><div class=tsa-table-content><div ng-repeat=\\\"data in ctrl.simpleDataList\\\" layout=row layout-align=\\\"space-between center\\\"><p flex=20>{{data.deviceId}}</p><p flex=20>{{data.frameId}}</p><p flex=20>{{data.id}}</p><md-input-container flex=20 md-no-float class=md-block><input ng-model=data.colname placeholder=\\\"Column Name\\\"></md-input-container><div flex=5><md-button class=md-icon-button ng-click=ctrl.simpleDataList.splice(ctrl.simpleDataList.indexOf(data),1)><md-icon>close</md-icon></md-button></div></div></div></div><!-- Advanced data list --><div class=tsa-table ng-show=\\\"ctrl.mode == \\'advanced\\'\\\"><div class=tsa-table-title layout=row layout-align=\\\"space-between center\\\"><p flex=25>Var ID</p><p flex=20>{{\\\"pages.data-access.column-name\\\" | translate}}</p><p flex=15>{{\\\"pages.data-access.aggregate\\\" | translate}}</p><p flex=10>{{\\\"pages.data-access.units\\\" | translate}}</p><p flex=10>{{\\\"pages.data-access.default\\\" | translate}}</p><p flex=5>Min</p><p flex=5>Max</p><div flex=5><md-button class=md-icon-button ng-click=ctrl.clearAll()><md-icon>close</md-icon><md-tooltip>{{\\\"pages.data-access.remove-all\\\" | translate}}</md-tooltip></md-button></div></div><md-divider></md-divider><div class=tsa-table-content><div ng-repeat=\\\"data in ctrl.advancedDataList\\\" layout=row layout-align=\\\"space-between center\\\"><!-- Var id --><md-input-container flex=25 md-no-float class=md-block><input ng-model=data.varid placeholder=\\\"Var ID\\\"></md-input-container><!-- Column name --><md-input-container flex=20 md-no-float class=md-block><input ng-model=data.colname placeholder=\\\"Column Name\\\"></md-input-container><!-- Aggregate --><md-input-container flex=15 md-no-float class=md-block><md-select ng-model=data.aggregate placeholder=Aggregate><md-option ng-repeat=\\\"aggr in ctrl.aggregateList\\\" value={{aggr}}>{{aggr}}</md-option></md-select></md-input-container><!-- Units --><md-input-container flex=10 md-no-float class=md-block><input ng-model=data.units placeholder=Units></md-input-container><!-- Default value --><md-input-container flex=10 md-no-float class=md-block><input ng-model=data.default placeholder=Default></md-input-container><!-- Min --><md-input-container flex=5 md-no-float class=md-block><input ng-model=data.min placeholder=Min></md-input-container><!-- Max --><md-input-container flex=5 md-no-float class=md-block><input ng-model=data.max placeholder=Max></md-input-container><!-- Remove button --><div flex=5><md-button class=md-icon-button ng-click=ctrl.advancedDataList.splice(ctrl.advancedDataList.indexOf(data),1)><md-icon>close</md-icon></md-button></div></div></div></div></div>\");}]);"],"sourceRoot":"/source/"}